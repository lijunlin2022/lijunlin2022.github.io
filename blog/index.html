<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-list-page plugin-blog plugin-id-default" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.0.1">
<title data-rh="true">Blog | 李俊霖的网络日志</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://lijunlin2022.github.io/blog"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="google-site-verification" content="z1w9iBabIBZmBrBiQPn3K-e8msiNRO_hR9O3oWhdcok"><meta data-rh="true" property="og:title" content="Blog | 李俊霖的网络日志"><meta data-rh="true" name="description" content="Blog"><meta data-rh="true" property="og:description" content="Blog"><meta data-rh="true" name="docusaurus_tag" content="blog_posts_list"><meta data-rh="true" name="docsearch:docusaurus_tag" content="blog_posts_list"><link data-rh="true" rel="icon" href="/img/logo.png"><link data-rh="true" rel="canonical" href="https://lijunlin2022.github.io/blog"><link data-rh="true" rel="alternate" href="https://lijunlin2022.github.io/blog" hreflang="en"><link data-rh="true" rel="alternate" href="https://lijunlin2022.github.io/blog" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="李俊霖的网络日志 RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="李俊霖的网络日志 Atom Feed">




<link rel="alternate" type="application/rss+xml" href="/life/rss.xml" title="李俊霖的网络日志 RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/life/atom.xml" title="李俊霖的网络日志 Atom Feed"><link rel="stylesheet" href="/assets/css/styles.ff15741f.css">
<script src="/assets/js/runtime~main.7c1db881.js" defer="defer"></script>
<script src="/assets/js/main.e5f7b9ee.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.png" alt="" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.png" alt="" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">李俊霖的网络日志</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">技术博客</a><a class="navbar__item navbar__link" href="/docs/category/html">技术笔记</a><a class="navbar__item navbar__link" href="/life">生活</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/lijunlin2022" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">Recent posts</div><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2023/12/14/loop-swiper">无复制元素的循环轮播</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2023/11/14/px-to-rem">移动端适配 lib-flexible 和 postcss-pxtorem</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2023/11/08/smoothly-scroll">requestAnimationFrame 实现平滑滚动</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2023/08/20/intersection-observer-infinite-scroll">IntersectionObserver 无限滚动</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2023/08/15/texts-follow-icon">文字图标两行显示，溢出省略号</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="https://schema.org/Blog"><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="https://schema.org/BlogPosting"><meta itemprop="description" content="大家好，我俊霖。"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/blog/2023/12/14/loop-swiper">无复制元素的循环轮播</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2023-12-14T00:00:00.000Z" itemprop="datePublished">December 14, 2023</time> · <!-- -->3 min read</div></header><div class="markdown" itemprop="articleBody"><p>大家好，我俊霖。</p>
<p>循环轮播大家都很熟悉。一般的实现方法，需要复制首尾的元素。比如需要轮播的元素是 1234，那么就需要复制 1 和 4，让轮播元素变为 412341。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="ant-design-mobile-swiper">Ant Design Mobile Swiper<a href="#ant-design-mobile-swiper" class="hash-link" aria-label="Direct link to Ant Design Mobile Swiper" title="Direct link to Ant Design Mobile Swiper">​</a></h2>
<p><a href="https://mobile.ant.design/components/swiper" target="_blank" rel="noopener noreferrer">Ant Design Mobile Swiper</a> 的循环轮播，就是一种无复制元素的循环轮播。如下图，可以在控制台看到元素个数始终是 4 个，没有多余的元素。</p>
<p><img loading="lazy" src="/assets/images/antd-mobile-fb968342e95cda93f287f9fd3c7b9933.gif" width="1150" height="180" class="img_ev3q"></p>
<p>它的原理是什么呢？</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="约定">约定<a href="#约定" class="hash-link" aria-label="Direct link to 约定" title="Direct link to 约定">​</a></h2>
<p>为方便读者理解下文，我需要和读者们做一些约定。</p>
<ul>
<li>轮播组件是整屏的轮播，轮播时只会向左切换一个元素，或者向右切换一个元素。</li>
<li>轮播容器称为 List，轮播元素称为 Item。</li>
<li>List 有 5 个 Item，分别是 Item0 到 Item4。之所以选择 5 个 Item，是因为奇数个 Item 更容易找到 List 的中心。</li>
<li>currentIndex 代表 List 中心 Item 的下标。轮播到 Item0 时，currentIndex 是 0。轮播到 Item5 时，currentIndex 是 5。</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="轮播原理">轮播原理<a href="#轮播原理" class="hash-link" aria-label="Direct link to 轮播原理" title="Direct link to 轮播原理">​</a></h2>
<p><strong>初始化</strong></p>
<p>下图是初始化时，List 中 Item 的排列。它是怎么得到的呢？</p>
<p><img loading="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfQAAAAZCAIAAABIGUs1AAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAEXRFWHRTb2Z0d2FyZQBTbmlwYXN0ZV0Xzt0AAAOgSURBVHic7d1bSFNxAMfx/yKXa3ZTKYNl2pLmKTBO4gWpKGzFIrsYlFQEmWURQRehhyTDEKErNnJqFCSyDCxrbIhFC4akoyaGTUOXZQsczRLbdJ092MPChyidJfz/5/D7vM2nL2Pn5/GcyZH1uwcIAABIy0zLdwftBhHQzeHxRoVPN4df0vSYdoVofNqyHZ+u8OFgDNMM2gEAADD9MO4AABKEcQcAkCCMOwCABGHcAQAkCOMOACBBDI273WQtTNYVJusqCor9Q8O0c8QhGBDqSvR2k5V2COveDXhWXyyVHT5aWFs3KgRp54iDy+GsK9EHAwLtENaZK42h7bq084Snz0075xdWxt3lcLY+eX715X1Dl0XNc4037uEjFY72py22egvtCtaNCsHrT58VbdaO3NITQh468C3pybkczsv7ztKuEAG7yTrkGbzZ3mjosmgP5daXVTFybsrKuKt57mRNqXL+XEKIJj1l8LNHCARoR7HOPzT85oWdy+Jph7Cu/+vXPq83NSFBIY84kJlh6+nFyfvEzJVGY+ktbf5u2iEikLZtw76SExGRckLI0lVJZGzM9w3j/hfdbR1qngsNPUzghdGclauNUcXRDmGd1+eTEVlsVFTo5Qfv4IiAvwsnoklPOf9Ir1qRSDsE/h1b4+5yOAuTde3NLalb1tJuYZ2nz/3DPxrPqWmHiENCbMxsuZwQEhsVtUA5m3YO69Q8RztBlF412WJUcdGLF9IOIYS1cVfznKHLkld8vOZ0OTv3JRgUDAgtDc1ZuVp5ZCTtFgAghBC7ydre3JJ9cEfoEg11bI17SDy3PDFF87Gzh3YIu/qdvbOUikWJKtohojF+Kcbr833zj9DOAamxm6zNdxoKrp1j56icSTvgD4RAYPCzJyNnI+0QdnW3dZgqak0VtaGXtnrLF/fA1mN5dKuY9dulmPFLNADTwm6ytj55fupuGVN3ClkZd5fDaa405l8uUs6f+9b2mhASt4yVX4AM2nosLzTlwYDwoLw6ac3KtG0baEexKz46ep5C0dTZuYvna1+2rk1arpBH0I4CiXA5nKFzdqaWnbAz7mqey8jZeCZzLyFEpVnG4DsF4qWQR5zalL2nqnr/7TtH16/bxePLozBtuts63N3vL+iOjP+kqO4KC3ekZYYu/AvM5PB8gCnBwzqmBA/rmBIcjGFi8YYqAAD8J4w7AIAEYdwBACQI4w4AIEEYdwAACZL1uwdoNwAAwDT7CfqRNhTklVPdAAAAAElFTkSuQmCC" width="500" height="25" class="img_ev3q"></p>
<p>可以这样理解，初始化时，我们希望 Item0 处于 List 中心时，两边的元素尽可能相等。</p>
<p>我们的做法是，Item0，Item1 和 Item2 位置保持不变。将 Item3 和 Item4 往前挪动 5 个位置。</p>
<p><img loading="lazy" src="data:image/png;base64,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" width="700" height="100" class="img_ev3q"></p>
<p><strong>Item1 为中心</strong></p>
<p>下图是 List 从 Item0 轮播到 Item1 时的排列，此时 Item1 处于 List 的中心。</p>
<p><img loading="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfQAAAAZCAIAAABIGUs1AAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAEXRFWHRTb2Z0d2FyZQBTbmlwYXN0ZV0Xzt0AAAOVSURBVHic7d1RSFNRHAbws0ibqSMT1GgVtYR5FcRrmLF6SGrIQit8KOlBMIpZElQYvYhCEZIVYUGWUJQsMxDM5QgLJ4yRjtwycgq6JJvkClPWrNv2UA8ThaCaMTj/Xb7f293Tx+Wc795zLuMoJr3TDAAA5GWl5auTdwbqDMki7lLkDMnihmdPeKeIGR+K92N0RQ6TMXIreAcAAIDoQ7kDAMgQyh0AQIZQ7gAAMoRyBwCQIZQ7AIAM0Sr3kBQ01d90mK28g1Dnm/BePFhtzDKY6m+GpCDvOLHBPu4xtpq+B0O8g1DXfavNmGUwZhkuHqz2TXh5x6HOYbaGb1fTsdr5OT/vOEtolbvrud3WbuGdgrqQFHxxv1NfWXbD1ckYcz23804UA+zjnp0Nl3mniAEOs3XON3PD1dk8YtFXlrVfuk2qsKjxON39Xb1XXz5qHrFoRKHz+gM6L1uEyn1+zv+mzyHoRN5BqPvy8dOMd3pTTmacMr6wtGhscJjOeKLpwtPuk6aHNcV63kFiQEHJ7iP11XHKeMbYppxM9vNnYBbl/kcaUTjVciFxjYoxpt2eOzPlC0oS71ALCJV7X1u3rkyfqs7gHYS6wKyfKRRJKarwJanxRFORVvu6rjZXreYdBORsdGBIIwrhoqeASrn7Jrw/5r9vFDS8g8SG1PXp8UolYywpRbValcQ7DnW6rRhX/+PVM1uqOmPtujTeQajzON3GLIOrx76teBfvLEtIlHtICto7enRl+nBhAQB3DrPV1WPfU3EgvEUDf6ERheYRS3ntiZYzDXQ+QZMo90n3+KrEhPTNWDVHanErJjDr/+YP8I4DcuMwW3vudhy7dh6zMnIbha2bc7Xv347xDrJgJe8AjDE2OjBkbmo1N7WGL23tls/e6X1V5XxTkfXbVsziFg1AVDjM1v6u3tP3LtHZPo4JQUmamfIVlhbxDrKARLnvqyoPV3lICj5uuJOZn11Qspt3KLrWrktLSE4ctg3m7dX1d/Vm5mdj4QzR4nG6w+/saPZIeJzu7lttRxtrEteohm2DjLGMLVTWOiTKHZYlThm/p+JAy5mGu+cadx0y5O3V8U4E8jE6MOQdfVdnOL74S43pikYUOEaiTCMKhaVFZ3ccZoyptVtIPRQVzSP409A/4HyAZcFhHcuCwzqWBZMxciQ+qAIAQHSh3AEAZAjlDgAgQyh3AAAZQrkDAMiQYtI7zTsDAABE2S/WtzYf9+X3ZQAAAABJRU5ErkJggg==" width="500" height="25" class="img_ev3q"></p>
<p>和初始化时理解方式一致，我们希望 Item1 处于 List 中心时，两边元素尽可能相等。</p>
<p>我们的做法是：Item1，Item2 和 Item3 位置保持不变。将 item4 和 Item1 往前挪动 5 个位置。</p>
<p><img loading="lazy" src="data:image/png;base64,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" width="700" height="100" class="img_ev3q"></p>
<p><strong>循环</strong></p>
<p>按照上述步骤，分别列出 List 中心是 Item0 到 Item4 的情况，可以得到下图：</p>
<p><img loading="lazy" src="data:image/png;base64,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" width="500" height="125" class="img_ev3q"></p>
<p>一个循环轮播就实现了。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="代码实现">代码实现<a href="#代码实现" class="hash-link" aria-label="Direct link to 代码实现" title="Direct link to 代码实现">​</a></h2></div></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="https://schema.org/BlogPosting"><meta itemprop="description" content="最近看到，一般移动端适配会配合使用阿里的 lib-flexible 和 postcss-pxtorem 插件。"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/blog/2023/11/14/px-to-rem">移动端适配 lib-flexible 和 postcss-pxtorem</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2023-11-14T00:00:00.000Z" itemprop="datePublished">November 14, 2023</time> · <!-- -->2 min read</div></header><div class="markdown" itemprop="articleBody"><p>最近看到，一般移动端适配会配合使用阿里的 <a href="https://github.com/amfe/lib-flexible" target="_blank" rel="noopener noreferrer">lib-flexible</a> 和 <a href="https://www.npmjs.com/package/postcss-pxtorem" target="_blank" rel="noopener noreferrer">postcss-pxtorem</a> 插件。</p>
<p>我们假设我们的手机屏幕和设计稿都是 750px 的。</p>
<p>使用 lib-flexible，会将 html 的 font-size 设置为屏幕宽度 <code>clientWidth</code> 的 1/10。也就是说 1rem = 75px;</p>
<p>这时候，如果设计稿上有一个元素 width 是 200px 的，为了让手机屏幕能够适配。我们需要写 CSS 的时候，直接将 width 写成 (200 / 75)rem。</p>
<p>当然，手动将 px 换算为 rem 还是对我们写代码还是很不友好。这时候就可以使用 postcss-pxtorem 了。我们将这个插件配置的 rootValue 写为 75px，这个插件会自动将我们的 css 从 px 换算为 rem。</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockTitle_Ktv7">postcss.config.js</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token keyword module" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token imports">pxtorem</span><span class="token plain"> </span><span class="token keyword module" style="color:hsl(301, 63%, 40%)">from</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">&#x27;postcss-pxtorem&#x27;</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword module" style="color:hsl(301, 63%, 40%)">export</span><span class="token plain"> </span><span class="token keyword module" style="color:hsl(301, 63%, 40%)">default</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token literal-property property" style="color:hsl(5, 74%, 59%)">plugins</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token function" style="color:hsl(221, 87%, 60%)">pxtorem</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> </span><span class="token literal-property property" style="color:hsl(5, 74%, 59%)">rootValue</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">75</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token literal-property property" style="color:hsl(5, 74%, 59%)">propList</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">[</span><span class="token string" style="color:hsl(119, 34%, 47%)">&#x27;*&#x27;</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">]</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token literal-property property" style="color:hsl(5, 74%, 59%)">selectorBlackList</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">[</span><span class="token string" style="color:hsl(119, 34%, 47%)">&#x27;html&#x27;</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">]</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="https://schema.org/BlogPosting"><meta itemprop="description" content="大家好，我俊霖。"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/blog/2023/11/08/smoothly-scroll">requestAnimationFrame 实现平滑滚动</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2023-11-08T00:00:00.000Z" itemprop="datePublished">November 8, 2023</time> · <!-- -->2 min read</div></header><div class="markdown" itemprop="articleBody"><p>大家好，我俊霖。</p>
<p>最近接到一个修复通知，iOS 15.4 ~ 17，使用 CSS <code>scroll-behavior: smooth</code> 或 JavaScript 的  <code>behavior: &#x27;smooth&#x27;</code> 可能导致 iOS App Crash。</p>
<p>我维护的 H5 有个锚定功能，是使用 <code>element.scrollIntoView({ behavior: &#x27;smooth&#x27; })</code> 来实现锚定并且带上动画的。现在得换种方法实现锚定。</p>
<p>参考修复通知，我决定使用 <code>requestAnimationFrame</code> 来实现动画。</p>
<p>首先，我准备改用 <code>window.scrollTo()</code> 替换掉 <code>scrollIntoView</code> 实现锚定。</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token keyword" style="color:hsl(301, 63%, 40%)">const</span><span class="token plain"> targetPosition </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> element</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token property-access">offsetTop</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token dom variable" style="color:hsl(221, 87%, 60%)">window</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token method function property-access" style="color:hsl(221, 87%, 60%)">scrollTo</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> targetPosition</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="requestanimationframe">requestAnimationFrame<a href="#requestanimationframe" class="hash-link" aria-label="Direct link to requestAnimationFrame" title="Direct link to requestAnimationFrame">​</a></h2>
<p>下面这段代码的作用是：将页面平滑滚动到某个位置。它首先会获取当前滚动条的位置，然后计算目标位置和当前位置的距离，之后将这个距离分为若干个部分，每隔一段时间就滚动一部分，直到滚动到目标位置。</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token keyword" style="color:hsl(301, 63%, 40%)">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:hsl(221, 87%, 60%)">smoothScrollTo</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token parameter">targetPosition</span><span class="token parameter punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token parameter"> part</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:hsl(221, 87%, 60%)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">const</span><span class="token plain"> startPosition </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token dom variable" style="color:hsl(221, 87%, 60%)">document</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token property-access">documentElement</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token property-access">scrollTop</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">||</span><span class="token plain"> </span><span class="token dom variable" style="color:hsl(221, 87%, 60%)">document</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token property-access">body</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token property-access">scrollTop</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">const</span><span class="token plain"> distance </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> targetPosition </span><span class="token operator" style="color:hsl(221, 87%, 60%)">-</span><span class="token plain"> startPosition</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">const</span><span class="token plain"> step </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token known-class-name class-name" style="color:hsl(35, 99%, 36%)">Math</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token method function property-access" style="color:hsl(221, 87%, 60%)">floor</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">distance </span><span class="token operator" style="color:hsl(221, 87%, 60%)">/</span><span class="token plain"> part</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">let</span><span class="token plain"> currentPosition </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> startPosition</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">const</span><span class="token plain"> t </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">setInterval</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:hsl(221, 87%, 60%)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword control-flow" style="color:hsl(301, 63%, 40%)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token known-class-name class-name" style="color:hsl(35, 99%, 36%)">Math</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token method function property-access" style="color:hsl(221, 87%, 60%)">abs</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">targetPosition </span><span class="token operator" style="color:hsl(221, 87%, 60%)">-</span><span class="token plain"> currentPosition</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">&gt;</span><span class="token plain"> </span><span class="token known-class-name class-name" style="color:hsl(35, 99%, 36%)">Math</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token method function property-access" style="color:hsl(221, 87%, 60%)">abs</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">step</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      currentPosition </span><span class="token operator" style="color:hsl(221, 87%, 60%)">+=</span><span class="token plain"> step</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token dom variable" style="color:hsl(221, 87%, 60%)">window</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token method function property-access" style="color:hsl(221, 87%, 60%)">scrollTo</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> currentPosition</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:hsl(301, 63%, 40%)">else</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token function" style="color:hsl(221, 87%, 60%)">clearInterval</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">t</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token dom variable" style="color:hsl(221, 87%, 60%)">window</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token method function property-access" style="color:hsl(221, 87%, 60%)">scrollTo</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> targetPosition</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">60</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>我对 <code>requestAnimationFrame</code> 的理解，大概就是把它当做了一个 <code>setInterval</code> 的替代品。</p>
<p>首先我用 <code>setInterval</code> 实现了一个锚定的滚动动画：</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token keyword" style="color:hsl(301, 63%, 40%)">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:hsl(221, 87%, 60%)">smoothScrollTo</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token parameter">targetPosition</span><span class="token parameter punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token parameter"> part</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:hsl(221, 87%, 60%)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">const</span><span class="token plain"> startPosition </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token dom variable" style="color:hsl(221, 87%, 60%)">document</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token property-access">documentElement</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token property-access">scrollTop</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">||</span><span class="token plain"> </span><span class="token dom variable" style="color:hsl(221, 87%, 60%)">document</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token property-access">body</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token property-access">scrollTop</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">const</span><span class="token plain"> distance </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> targetPosition </span><span class="token operator" style="color:hsl(221, 87%, 60%)">-</span><span class="token plain"> startPosition</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">const</span><span class="token plain"> step </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token known-class-name class-name" style="color:hsl(35, 99%, 36%)">Math</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token method function property-access" style="color:hsl(221, 87%, 60%)">floor</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">distance </span><span class="token operator" style="color:hsl(221, 87%, 60%)">/</span><span class="token plain"> part</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">let</span><span class="token plain"> currentPosition </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> startPosition</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">let</span><span class="token plain"> animationFrameId </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token keyword null nil" style="color:hsl(301, 63%, 40%)">null</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:hsl(221, 87%, 60%)">animation</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:hsl(221, 87%, 60%)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword control-flow" style="color:hsl(301, 63%, 40%)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token known-class-name class-name" style="color:hsl(35, 99%, 36%)">Math</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token method function property-access" style="color:hsl(221, 87%, 60%)">abs</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">targetPosition </span><span class="token operator" style="color:hsl(221, 87%, 60%)">-</span><span class="token plain"> currentPosition</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">&gt;</span><span class="token plain"> </span><span class="token known-class-name class-name" style="color:hsl(35, 99%, 36%)">Math</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token method function property-access" style="color:hsl(221, 87%, 60%)">abs</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">step</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      currentPosition </span><span class="token operator" style="color:hsl(221, 87%, 60%)">+=</span><span class="token plain"> step</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token dom variable" style="color:hsl(221, 87%, 60%)">window</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token method function property-access" style="color:hsl(221, 87%, 60%)">scrollTo</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> currentPosition</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      animationFrameId </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token dom variable" style="color:hsl(221, 87%, 60%)">window</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token method function property-access" style="color:hsl(221, 87%, 60%)">requestAnimationFrame</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">animation</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:hsl(301, 63%, 40%)">else</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token dom variable" style="color:hsl(221, 87%, 60%)">window</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token method function property-access" style="color:hsl(221, 87%, 60%)">scrollTo</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> targetPosition</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token dom variable" style="color:hsl(221, 87%, 60%)">window</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token method function property-access" style="color:hsl(221, 87%, 60%)">cancelAnimationFrame</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">animationFrameId</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token function" style="color:hsl(221, 87%, 60%)">animation</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/request-animation-frame">requestAnimationFrame</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="https://schema.org/BlogPosting"><meta itemprop="description" content="大家好，我俊霖。"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/blog/2023/08/20/intersection-observer-infinite-scroll">IntersectionObserver 无限滚动</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2023-08-20T00:00:00.000Z" itemprop="datePublished">August 20, 2023</time> · <!-- -->One min read</div></header><div class="markdown" itemprop="articleBody"><p>大家好，我俊霖。</p>
<p>日常开发中，我们常常需要实现一个无限滚动的效果。如下所示：</p>
<p><img loading="lazy" src="/assets/images/01-intersection-observer-pullup-64fe80b2b5864f262f18b52e5cd55798.gif" width="402" height="464" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="intersectionobserver">IntersectionObserver<a href="#intersectionobserver" class="hash-link" aria-label="Direct link to IntersectionObserver" title="Direct link to IntersectionObserver">​</a></h2>
<p>底部的元素出现到视口内部时，就可以触发 <code>pullUp</code> 函数。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="封装-scrollview">封装 ScrollView<a href="#封装-scrollview" class="hash-link" aria-label="Direct link to 封装 ScrollView" title="Direct link to 封装 ScrollView">​</a></h2>
<div class="language-jsx codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-jsx codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token keyword" style="color:hsl(301, 63%, 40%)">function</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:hsl(221, 87%, 60%)">ScrollView</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token parameter punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token parameter"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token parameter">  children</span><span class="token parameter punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token parameter"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token parameter">  pullUp</span><span class="token parameter punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token parameter"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token parameter">  bottomStatus</span><span class="token parameter punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token parameter"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token parameter">  bottomStyle</span><span class="token parameter punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token parameter"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token parameter"></span><span class="token parameter punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">const</span><span class="token plain"> bottomRef </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">useRef</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token keyword null nil" style="color:hsl(301, 63%, 40%)">null</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token function" style="color:hsl(221, 87%, 60%)">useEffect</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:hsl(221, 87%, 60%)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">const</span><span class="token plain"> observer </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">IntersectionObserver</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token parameter punctuation" style="color:hsl(119, 34%, 47%)">[</span><span class="token parameter">entry</span><span class="token parameter punctuation" style="color:hsl(119, 34%, 47%)">]</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:hsl(221, 87%, 60%)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token keyword control-flow" style="color:hsl(301, 63%, 40%)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">bottomStatus </span><span class="token operator" style="color:hsl(221, 87%, 60%)">===</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">&#x27;LOADING&#x27;</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token keyword control-flow" style="color:hsl(301, 63%, 40%)">return</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token keyword control-flow" style="color:hsl(301, 63%, 40%)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">entry</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token property-access">isIntersecting</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">&amp;&amp;</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">typeof</span><span class="token plain"> pullUp </span><span class="token operator" style="color:hsl(221, 87%, 60%)">===</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">&#x27;function&#x27;</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token function" style="color:hsl(221, 87%, 60%)">pullUp</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token literal-property property" style="color:hsl(5, 74%, 59%)">root</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token keyword null nil" style="color:hsl(301, 63%, 40%)">null</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token literal-property property" style="color:hsl(5, 74%, 59%)">rootMargin</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">&#x27;0px&#x27;</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token literal-property property" style="color:hsl(5, 74%, 59%)">thresolds</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">[</span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">]</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword control-flow" style="color:hsl(301, 63%, 40%)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">bottomRef</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token property-access">current</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      observer</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token method function property-access" style="color:hsl(221, 87%, 60%)">observe</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">bottomRef</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token property-access">current</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword control-flow" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:hsl(221, 87%, 60%)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token keyword control-flow" style="color:hsl(301, 63%, 40%)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">bottomRef</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token property-access">current</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        observer</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token method function property-access" style="color:hsl(221, 87%, 60%)">unobserve</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">bottomRef</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token property-access">current</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">[</span><span class="token plain">pullUp</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">]</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token keyword control-flow" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain-text"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain-text">      </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">div</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain">children</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">div</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain-text"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain-text">      </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">div</span><span class="token tag" style="color:hsl(5, 74%, 59%)"> </span><span class="token tag attr-name" style="color:hsl(35, 99%, 36%)">style</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:hsl(119, 34%, 47%)">=</span><span class="token tag script language-javascript punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token tag script language-javascript" style="color:hsl(5, 74%, 59%)">bottomStyle</span><span class="token tag script language-javascript punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain-text"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain-text">        </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain">bottomStatus </span><span class="token operator" style="color:hsl(221, 87%, 60%)">===</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">&#x27;LOADING&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">&amp;&amp;</span><span class="token plain"> </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag class-name" style="color:hsl(35, 99%, 36%)">LoadingView</span><span class="token tag" style="color:hsl(5, 74%, 59%)"> </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">/&gt;</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain-text"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain-text">        </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain">bottomStatus </span><span class="token operator" style="color:hsl(221, 87%, 60%)">===</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">&#x27;ERROR&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">&amp;&amp;</span><span class="token plain"> </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag class-name" style="color:hsl(35, 99%, 36%)">ErrorView</span><span class="token tag" style="color:hsl(5, 74%, 59%)"> </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">/&gt;</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain-text"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain-text">        </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain">bottomStatus </span><span class="token operator" style="color:hsl(221, 87%, 60%)">===</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">&#x27;NO_MORE&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">&amp;&amp;</span><span class="token plain"> </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag class-name" style="color:hsl(35, 99%, 36%)">NoMoreView</span><span class="token tag" style="color:hsl(5, 74%, 59%)"> </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">/&gt;</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain-text"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain-text">        </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain">bottomStatus </span><span class="token operator" style="color:hsl(221, 87%, 60%)">===</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">&#x27;HAS_MORE&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">&amp;&amp;</span><span class="token plain"> </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">div</span><span class="token tag" style="color:hsl(5, 74%, 59%)"> </span><span class="token tag attr-name" style="color:hsl(35, 99%, 36%)">ref</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:hsl(119, 34%, 47%)">=</span><span class="token tag script language-javascript punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token tag script language-javascript" style="color:hsl(5, 74%, 59%)">bottomRef</span><span class="token tag script language-javascript punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">div</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain-text"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain-text">      </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">div</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain-text"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain-text">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/intersection-observer">IntersectionObserver</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="https://schema.org/BlogPosting"><meta itemprop="description" content="大家好，我俊霖。"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/blog/2023/08/15/texts-follow-icon">文字图标两行显示，溢出省略号</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2023-08-15T00:00:00.000Z" itemprop="datePublished">August 15, 2023</time> · <!-- -->4 min read</div></header><div class="markdown" itemprop="articleBody"><p>大  家好，我俊霖。</p>
<p>日常开发中，我们常常需要实现一个 UI 效果。文字紧跟在一个图标后面，且文字和图标最多展示两行，溢出部分用省略号表示。以多点 App 的商品截图为例：</p>
<p><img loading="lazy" src="/assets/images/01-texts-follow-icon-7a2a0250dbcfaaf220da8f83ebf4addb.jpg" width="400" height="167" class="img_ev3q"></p>
<p>一些朋友可能会尝试用 flex 布局实现。遗憾的是，使用 flex 布局的话，图片下方的文字会被全部挤到右侧，无法实现 App 截图的效果。</p>
<p><img loading="lazy" src="data:image/png;base64,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" width="200" height="70" class="img_ev3q"></p>
<p>今天我们先介绍两种实现目标 UI 效果的方法，然后再对两种方法做一下优缺点对比。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="文本缩进和绝对定位">文本缩进和绝对定位。<a href="#文本缩进和绝对定位" class="hash-link" aria-label="Direct link to 文本缩进和绝对定位。" title="Direct link to 文本缩进和绝对定位。">​</a></h2>
<p>第一种方法，先给文字设置文本缩进属性 <code>text-indent</code>，空出一定的位置，然后再给图标设置绝对定位属性，将图标移动到刚才空出的位置上。</p>
<p>具体写法可以看例子：</p>
<p><a href="https://codepen.io/lijunlin2022/pen/abQewmE" target="_blank" rel="noopener noreferrer">文本缩进和绝对定位 | codepen</a>。</p>
<p><img loading="lazy" src="data:image/png;base64,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" width="200" height="70" class="img_ev3q"></p>
<p>这种方法优点是简单易懂，缺点是，**需要先实现知道图标的宽度，才能为图片空出准确的位置。**因此一旦下发的图标宽度有变化，就需要重新修改代码。</p>
<p>弥补这个缺陷的一个做法是，后端既下发图标的链接、也下发图标的宽度。这样即使图标改变了，前端代码也不需要改变。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="浮动和文字环绕图片">浮动和文字环绕图片<a href="#浮动和文字环绕图片" class="hash-link" aria-label="Direct link to 浮动和文字环绕图片" title="Direct link to 浮动和文字环绕图片">​</a></h2>
<p>第二种方法，利用浮动 <code>float</code> 的基础性质。浮动的最初用途，并不是做各种各样的布局，而是用来实现文字环绕图片。</p>
<p>具体写法可以看例子：</p>
<p><a href="https://codepen.io/lijunlin2022/pen/abQewmE" target="_blank" rel="noopener noreferrer">浮动和文字环绕图片 | codepen</a>。</p>
<p>这种方法的优点是可以实现图标的自适应，完全由图标撑开文字。缺点是里面用了一些 CSS 不常见的用法。</p>
<p>这种方法有两点需要注意：</p>
<p>其一，控制文本溢出的 css 类（例子中是 <code>ellipsis</code>），一定要放在图片和文字的父元素上。这是因为 <code>ellipsis</code> 自带 <code>display: -webkit-box;</code> 布局，如果此不放置在父元素上，会导致文字直接另起一行。</p>
<p><img loading="lazy" src="data:image/png;base64,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" width="200" height="100" class="img_ev3q"></p>
<p>其二，为了兼容 Safari，需要给图片和文字的父元素，再增加一层父元素，且把控制文本溢出的 css 类放到新增的元素上。这是因为 <code>display: -webkit-box;</code>，在 Safari 上会影响图片和文本的布局。<sup><a href="#user-content-fn-1-942f82" id="user-content-fnref-1-942f82" data-footnote-ref="true" aria-describedby="footnote-label">1</a></sup></p>
<section data-footnotes="true" class="footnotes"><h2 class="anchor anchorWithStickyNavbar_LWe7 sr-only" id="footnote-label">Footnotes<a href="#footnote-label" class="hash-link" aria-label="Direct link to Footnotes" title="Direct link to Footnotes">​</a></h2>
<ol>
<li id="user-content-fn-1-942f82">
<p><a href="https://www.51cto.com/article/686659.html" target="_blank" rel="noopener noreferrer">-Webkit-Box 在 Safari 中出现的兼容性问题</a> <a href="#user-content-fnref-1-942f82" data-footnote-backref="" aria-label="Back to reference 1" class="data-footnote-backref">↩</a></p>
</li>
</ol>
</section></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/css">css</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="https://schema.org/BlogPosting"><meta itemprop="description" content="大家好，我俊霖。"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/blog/2023/07/30/tab-scroll-to-center">Tab 滚动居中</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2023-07-30T00:00:00.000Z" itemprop="datePublished">July 30, 2023</time> · <!-- -->5 min read</div></header><div class="markdown" itemprop="articleBody"><p>大家好，我俊霖。</p>
<p>日常开发中，我们常常要开发这样的选项卡（Tabs）：当某个选项卡（Tab）被点击之后，如果这个 Tab 能够滚动，就会滚动到屏 幕中央。以网页版的拼多多为例：</p>
<p><img loading="lazy" src="/assets/images/01-tab-scroll-to-center-bbe07676c502413e147ffb0b5a48f9e0.gif" width="402" height="281" class="img_ev3q"></p>
<p>为了实现滚动居中，一些朋友首先会逐个相加 Tab 的宽度，得到居中时需要滚动的距离，然后利用 <code>scrollTo()</code> 实现居中；另一些朋友则使用锚点，利用 <code>scrollIntoView()</code> 实现居中。</p>
<p>第一种办法，如果每一个 Tab 的宽度是固定的，计算还比较简单。一旦每个 Tab 的宽度是不固定的，计算将会变得非常复杂。</p>
<p>第二种办法，相比第一种方法要简单，能够处理 Tab 宽度不固定的情况。但由于 <code>scrollIntoView()</code> 的配置项（options）中没有居中的相关配置，因此只能保证选中的 Tab 处于视口（Viewport）内，无法实现严格的居中。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="计算滚动距离的等式">计算滚动距离的等式<a href="#计算滚动距离的等式" class="hash-link" aria-label="Direct link to 计算滚动距离的等式" title="Direct link to 计算滚动距离的等式">​</a></h2>
<p>现在我们介绍一种同样新方法，它同样使用 <code>scrollTo()</code>，但是它计算滚动距离（scrollLeft）的等式更简单。且这个等式，在 Tab 宽度不固定时，依然能够成立。请看这种方法的示意图：</p>
<p><img loading="lazy" src="https://raw.githubusercontent.com/lijunlin2022/draw.io/main/2023-08-04-scroll-to-center.drawio.svg" alt="" class="img_ev3q"></p>
<p>当一个 Tab 居中时：</p>
<ul>
<li><code>offsetWidth / 2</code> 是 Tab 一半的宽度。</li>
<li><code>offsetLeft</code> 是 Tab 距离父容器的距离。</li>
<li><code>window.innerWidth / 2</code> 是屏幕一半的宽度。</li>
<li><code>scrollLeft</code> 是 Tab 父容器应该滚动的距离。</li>
</ul>
<p>不难看出：</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">target.offsetWidth / 2 + offsetLeft = window.innerWidth / 2 + scrollLeft</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>简单变化式子后，就可以得出计算滚动距离的等式：</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">scrollLeft = offsetLeft + target.offsetWidth / 2 - window.innerWidth / 2</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="react-版-tab-滚动居中">React 版 Tab 滚动居中<a href="#react-版-tab-滚动居中" class="hash-link" aria-label="Direct link to React 版 Tab 滚动居中" title="Direct link to React 版 Tab 滚动居中">​</a></h2>
<p>现在我们给出一个 React 实现滚动居中的例子：</p>
<p><a href="https://codesandbox.io/s/center-the-scrollable-tab-using-scrollto-22939z" target="_blank" rel="noopener noreferrer">Tab 滚动居中 | codesandbox</a></p>
<div class="language-jsx codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-jsx codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token keyword" style="color:hsl(301, 63%, 40%)">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:hsl(221, 87%, 60%)">tabClick</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token parameter">index</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:hsl(221, 87%, 60%)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token function" style="color:hsl(221, 87%, 60%)">setActiveIndex</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">index</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">const</span><span class="token plain"> tabList </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> tabListRef</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token property-access">current</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">const</span><span class="token plain"> tab </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> tabList</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token property-access">children</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">[</span><span class="token plain">index</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">const</span><span class="token plain"> tabRect </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> tab</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token method function property-access" style="color:hsl(221, 87%, 60%)">getBoundingClientRect</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">const</span><span class="token plain"> scrollLeft </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    tab</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token property-access">offsetLeft</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">+</span><span class="token plain"> tabRect</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token property-access">width</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">/</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">2</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">-</span><span class="token plain"> </span><span class="token dom variable" style="color:hsl(221, 87%, 60%)">window</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token property-access">innerWidth</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">/</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">2</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  tabList</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token property-access">scrollLeft</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> scrollLeft</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>在这个例子中，我们利用 <code>useRef()</code> 生成 <code>tabListRef</code>，再通过 <code>tabListRef.current.children[index]</code> 获取到点击的 Tab 实例。</p>
<p>此外，我们利用 <code>tab.getBoundingClientRect().width</code> 替代了 <code>tab.offsetWidth</code>，二者的值是一致的。</p>
<p>最后，需要由父容器 tabList 直接调用 <code>scrollTo()</code> 方法。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="微信小程序版-tab-滚动居中">微信小程序版 Tab 滚动居中<a href="#微信小程序版-tab-滚动居中" class="hash-link" aria-label="Direct link to 微信小程序版 Tab 滚动居中" title="Direct link to 微信小程序版 Tab 滚动居中">​</a></h2>
<p>现在我们给出微信小程序中实现滚动居中的例子：</p>
<p><a href="https://developers.weixin.qq.com/s/npBjVpmj7XKc" target="_blank" rel="noopener noreferrer">Tab 滚动居中 | 微信小程序</a></p>
<p>微信小程序 <code>scroll-view</code> 组件中，有 <code>scroll-left</code> 这个属性，是指滚动条距离视口左边的距离。如果  想实现 Tab 居中，同样可以利用上文我们提到的公式来计算。</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token function" style="color:hsl(221, 87%, 60%)">tabClick</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token parameter">e</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">const</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> </span><span class="token literal-property property" style="color:hsl(5, 74%, 59%)">dataset</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> index </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> offsetLeft </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> e</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token property-access">currentTarget</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">const</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> windowWidth </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> wx</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token method function property-access" style="color:hsl(221, 87%, 60%)">getSystemInfoSync</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">const</span><span class="token plain"> query </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> wx</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token method function property-access" style="color:hsl(221, 87%, 60%)">createSelectorQuery</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  query</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token method function property-access" style="color:hsl(221, 87%, 60%)">select</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token template-string template-punctuation string" style="color:hsl(119, 34%, 47%)">`</span><span class="token template-string string" style="color:hsl(119, 34%, 47%)">#item-</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:hsl(119, 34%, 47%)">${</span><span class="token template-string interpolation">index</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token template-string template-punctuation string" style="color:hsl(119, 34%, 47%)">`</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token method function property-access" style="color:hsl(221, 87%, 60%)">boundingClientRect</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  query</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token method function property-access" style="color:hsl(221, 87%, 60%)">exec</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token parameter">res</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:hsl(221, 87%, 60%)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">const</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> width </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> res</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">[</span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">const</span><span class="token plain"> scrollLeft </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> offsetLeft </span><span class="token operator" style="color:hsl(221, 87%, 60%)">+</span><span class="token plain"> width </span><span class="token operator" style="color:hsl(221, 87%, 60%)">/</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">2</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">-</span><span class="token plain"> windowWidth </span><span class="token operator" style="color:hsl(221, 87%, 60%)">/</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">2</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">this</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token method function property-access" style="color:hsl(221, 87%, 60%)">setData</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token literal-property property" style="color:hsl(5, 74%, 59%)">currentView</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> index</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      scrollLeft</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>由于小程序中的 API 和浏览器中的 API 差异比较大，因此需要我们做一些调整，主要需要注意的点如下：</p>
<ul>
<li>Tab 距离父容器  左边的距离 <code>offsetLeft</code> 要从 <code>e.currentTarget</code> 中获取。</li>
<li>视口的宽度需要从 <code>wx.getSystemInfoSync()</code> 中获取。</li>
<li>Tab 自身的宽度，需要使用 <code>wx.createSelectorQuery()</code> 选取到目标元素后，从 <code>exec()</code> 的执行结果中获取。</li>
</ul>
<p>不过殊途同归，微信小程序 Tab 的滚动居中，和 React Tab 的滚动居中，最终都可以用同样的原理实现。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="vue2-版-tab-滚动居中">Vue2 版 Tab 滚动居中<a href="#vue2-版-tab-滚动居中" class="hash-link" aria-label="Direct link to Vue2 版 Tab 滚动居中" title="Direct link to Vue2 版 Tab 滚动居中">​</a></h2>
<p><a href="https://codesandbox.io/s/vue-tab-scroll-to-center-qxw4vc" target="_blank" rel="noopener noreferrer">Tab 滚动居中 | Vue2</a></p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/react">react</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/miniprogram">miniprogram</a></li></ul></div></footer></article><nav class="pagination-nav" aria-label="Blog list page navigation"></nav></main></div></div></div></div>
</body>
</html>