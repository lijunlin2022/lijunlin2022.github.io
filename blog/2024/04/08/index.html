<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="generator" content="Rspress v1.35.3">
  <title data-rh="true">对比小红书与电商三巨头的瀑布流，H5 瀑布流实现方案应该如何选择？ - 小霖家的混江龙</title>
<script>{;const saved = localStorage.getItem('rspress-theme-appearance');const preferDark = window.matchMedia('(prefers-color-scheme: dark)').matches;const isDark = !saved || saved === 'auto' ? preferDark : saved === 'dark';document.documentElement.classList.toggle('dark', isDark);document.documentElement.style.colorScheme = isDark ? 'dark' : 'light';}</script><link rel="icon" href="/logo.png"><script defer src="/static/js/styles.cf493e1b.js"></script><script defer src="/static/js/lib-react.17191d3c.js"></script><script defer src="/static/js/lib-router.de59624a.js"></script><script defer src="/static/js/index.708ea2ce.js"></script><link href="/static/css/styles.7ee5c3f8.css" rel="stylesheet"></head>

<body >
  <div id="root"><div><div class="navContainer_f6cde rspress-nav px-6 " style="position:sticky"><div class="container_f6cde flex justify-between items-center h-full"><div class="navBarTitle_f6cde"><a class="link_03735 flex items-center w-full h-full text-base font-semibold transition-opacity duration-300 hover:opacity-60 cursor-pointer" target="" href="/index"><div class="mr-1 min-w-8"><img src="/img/logo.png" alt="logo" id="logo" class="rspress-logo"/></div><span>小霖家的混江龙</span></a></div><div class="flex flex-1 justify-end items-center"><div class="rightNav_f6cde"><div class="flex sm:flex-1 items-center sm:pl-4 sm:pr-2"><div class="rspress-nav-search-button navSearchButton_6e282"><button><svg width="18" height="18" viewBox="0 0 32 32"><path fill="var(--rp-c-gray)" d="m29 27.586-7.552-7.552a11.018 11.018 0 1 0-1.414 1.414L27.586 29ZM4 13a9 9 0 1 1 9 9 9.01 9.01 0 0 1-9-9Z"></path></svg><p class="searchWord_6e282">Search Docs</p><div style="opacity:0"><span></span><span>K</span></div></button></div><div class="mobileNavSearchButton_6e282"><svg width="24" height="24" viewBox="0 0 32 32"><path fill="var(--rp-c-gray)" d="m29 27.586-7.552-7.552a11.018 11.018 0 1 0-1.414 1.414L27.586 29ZM4 13a9 9 0 1 1 9 9 9.01 9.01 0 0 1-9-9Z"></path></svg></div></div><div class="rspress-nav-menu menu h-14"><a class="link_03735  cursor-pointer" target="" href="/blog"><div class="rspress-nav-menu-item singleItem_f6cde activeItem_f6cde text-sm font-medium mx-1.5 px-3 py-2 flex items-center">博客</div></a><a class="link_03735  cursor-pointer" target="" href="/docs"><div class="rspress-nav-menu-item singleItem_f6cde  text-sm font-medium mx-1.5 px-3 py-2 flex items-center">笔记</div></a></div><div class="flex-center flex-row"><div class="mx-2"><div class="md:mr-2 rspress-nav-appearance"><div class="p-1 border border-solid border-gray-300 text-gray-400  cursor-pointer rounded-md hover:border-gray-600 hover:text-gray-600 dark:hover:border-gray-200 dark:hover:text-gray-200 transition-all duration-300 w-7 h-7"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" viewBox="0 0 24 24" class="dark:hidden" width="18" height="18" fill="currentColor"><path d="M12 18c-3.3 0-6-2.7-6-6s2.7-6 6-6 6 2.7 6 6-2.7 6-6 6zm0-10c-2.2 0-4 1.8-4 4s1.8 4 4 4 4-1.8 4-4-1.8-4-4-4zM12 4c-.6 0-1-.4-1-1V1c0-.6.4-1 1-1s1 .4 1 1v2c0 .6-.4 1-1 1zM12 24c-.6 0-1-.4-1-1v-2c0-.6.4-1 1-1s1 .4 1 1v2c0 .6-.4 1-1 1zM5.6 6.6c-.3 0-.5-.1-.7-.3L3.5 4.9c-.4-.4-.4-1 0-1.4s1-.4 1.4 0l1.4 1.4c.4.4.4 1 0 1.4-.1.2-.4.3-.7.3zM19.8 20.8c-.3 0-.5-.1-.7-.3l-1.4-1.4c-.4-.4-.4-1 0-1.4s1-.4 1.4 0l1.4 1.4c.4.4.4 1 0 1.4-.2.2-.5.3-.7.3zM3 13H1c-.6 0-1-.4-1-1s.4-1 1-1h2c.6 0 1 .4 1 1s-.4 1-1 1zM23 13h-2c-.6 0-1-.4-1-1s.4-1 1-1h2c.6 0 1 .4 1 1s-.4 1-1 1zM4.2 20.8c-.3 0-.5-.1-.7-.3-.4-.4-.4-1 0-1.4l1.4-1.4c.4-.4 1-.4 1.4 0s.4 1 0 1.4l-1.4 1.4c-.2.2-.4.3-.7.3zM18.4 6.6c-.3 0-.5-.1-.7-.3-.4-.4-.4-1 0-1.4l1.4-1.4c.4-.4 1-.4 1.4 0s.4 1 0 1.4l-1.4 1.4c-.2.2-.5.3-.7.3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" viewBox="0 0 24 24" class="hidden dark:block" width="18" height="18" fill="currentColor"><path d="M12.1 22h-.9c-5.5-.5-9.5-5.4-9-10.9.4-4.8 4.2-8.6 9-9 .4 0 .8.2 1 .5.2.3.2.8-.1 1.1-2 2.7-1.4 6.4 1.3 8.4 2.1 1.6 5 1.6 7.1 0 .3-.2.7-.3 1.1-.1.3.2.5.6.5 1-.2 2.7-1.5 5.1-3.6 6.8-1.9 1.4-4.1 2.2-6.4 2.2zM9.3 4.4c-2.9 1-5 3.6-5.2 6.8-.4 4.4 2.8 8.3 7.2 8.7 2.1.2 4.2-.4 5.8-1.8 1.1-.9 1.9-2.1 2.4-3.4-2.5.9-5.3.5-7.5-1.1-2.8-2.2-3.9-5.9-2.7-9.2z"></path></svg></div></div></div></div></div><div class="mobileNavMenu_f6cde"><div class="navScreen_457e8 " id="navScreen"><div class="container_457e8"><div class="navMenu_457e8"><div class="navMenuItem_457e8 w-full"><a class="link_03735  cursor-pointer" target="" href="/blog"><div class="rspress-nav-menu-item singleItem_f6cde activeItem_f6cde text-sm font-medium mx-1.5 px-3 py-2 flex items-center">博客</div></a></div><div class="navMenuItem_457e8 w-full"><a class="link_03735  cursor-pointer" target="" href="/docs"><div class="rspress-nav-menu-item singleItem_f6cde  text-sm font-medium mx-1.5 px-3 py-2 flex items-center">笔记</div></a></div></div><div class="flex-center flex-col gap-2"><div class="mt-2 navAppearance_457e8 flex justify-center"></div></div></div></div><button aria-label="mobile hamburger" class=" navHamburger_e7b06 text-gray-500"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32" fill="currentColor"><circle cx="8" cy="16" r="2" fill="currentColor"></circle><circle cx="16" cy="16" r="2" fill="currentColor"></circle><circle cx="24" cy="16" r="2" fill="currentColor"></circle></svg></button></div></div></div></div><section><div class="docLayout_edeb4 pt-0"><div class="rspress-sidebar-menu"><button class="flex-center mr-auto"><div class="text-md mr-2"><svg width="1em" height="1em" viewBox="0 0 32 32"><path fill="currentColor" d="M4 6h24v2H4zm0 18h24v2H4zm0-12h24v2H4zm0 6h24v2H4z"></path></svg></div><span class="text-sm">Menu</span></button><button class="flex-center ml-auto"><span class="text-sm">ON THIS PAGE</span><div class="text-md mr-2" style="transform:rotate(0deg);transition:transform 0.2s ease-out;margin-top:2px"><svg width="1em" height="1em" viewBox="0 0 32 32"><path fill="currentColor" d="M22 16 12 26l-1.4-1.4 8.6-8.6-8.6-8.6L12 6z"></path></svg></div></button></div><aside class="sidebar_71eca rspress-sidebar "><div class="navTitleMask_71eca"><div class="navBarTitle_f6cde"><a class="link_03735 flex items-center w-full h-full text-base font-semibold transition-opacity duration-300 hover:opacity-60 cursor-pointer" target="" href="/index"><div class="mr-1 min-w-8"><img src="/img/logo.png" alt="logo" id="logo" class="rspress-logo"/></div><span>小霖家的混江龙</span></a></div></div><div class="rspress-scrollbar sidebarContent_71eca"><nav class="pb-2"></nav></div></aside><div class="content_edeb4 rspress-doc-container flex flex-shrink-0 mx-auto"><div class="w-full flex-1"><div><div class="rspress-doc"><!--$--><h1 id="对比小红书与电商三巨头的瀑布流h5-瀑布流实现方案应该如何选择" class="text-3xl mb-10 leading-10 tracking-tight title_3b154"><a class="link_3b154 header-anchor" aria-hidden="true" href="#对比小红书与电商三巨头的瀑布流h5-瀑布流实现方案应该如何选择">#</a>对比小红书与电商三巨头的瀑布流，H5 瀑布流实现方案应该如何选择？</h1>
<span data-dark="false" class="rp-reading-time">预计阅读时间: 11 分钟</span>
<p class="my-4 leading-7">瀑布流布局，我们既能在小红书这类图文网站看到，也能在拼多多、京东和淘宝这类电商网站看到。小红书的瀑布流，是利用绝对定位计算高度实现。而电商三巨头的瀑布流，则是利用 Flex 布局实现。</p>
<p class="my-4 leading-7">那么，同样是瀑布流，两种实现方式的优点、缺点是什么呢？如果想用 H5 实现瀑布流，应该用哪一种方案呢？</p>
<p class="my-4 leading-7"><img src="/static/image/xiaohongshu.c85885bd.png"/></p>
<p class="my-4 leading-7"><img src="/static/image/pdd-jd-taobao.7482133f.png"/></p>
<p class="my-4 leading-7">本文中，我会首先介绍瀑布流是什么，接着我会介绍小红书瀑布流实现方式，并给出示例代码；然后，我会给出电商三巨头瀑布流实现方式，并给出示例代码；最后，我会做一个两种方案的对比总结。</p>
<p class="my-4 leading-7">拳打 H5，脚踢小程序。我是「小霖家的混江龙」，关注我，带你了解更多实用的 H5、小程序武学。</p>
<h2 id="瀑布流是什么" class="mt-12 mb-6 pt-8 text-2xl tracking-tight border-t-[1px] border-divider-light title_3b154"><a class="link_3b154 header-anchor" aria-hidden="true" href="#瀑布流是什么">#</a>瀑布流是什么</h2>
<p class="my-4 leading-7">瀑布流是一种宽度相同，高度不同的卡片布局方式。</p>
<p class="my-4 leading-7">如下图所示，传统布局中宽度相同、高度不同的卡片排列在一起时，会出现大量空白。这样既浪费了空间、又不美观。</p>
<p class="my-4 leading-7"><img src="/static/image/traditional-layout.6d331f1e.png"/></p>
<p class="my-4 leading-7">而瀑布流布局，则可以有效利用空白的空间，实现美观的效果。</p>
<p class="my-4 leading-7"><img src="/static/image/waterfall-layout.db929653.png"/></p>
<p class="my-4 leading-7">在开始介绍瀑布流如何实现之前，我们先给出一个工具函数，这个工具函数可以生成长度为 len 的图片数组，且每张图片都是 svg，宽度范围在 300px 到 400px，高度在 250px 到 500px。我们会使用数组中的图片实现瀑布流布局。</p>
<div class="language-js"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-js" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span class="token" style="color:var(--code-token-comment)">// 随机生成宽度在 300~400，高度在 250~500 的图片</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span></span><span class="token" style="color:var(--code-token-keyword)">function</span><span> </span><span class="token" style="color:var(--code-token-function)">getItems</span><span class="token" style="color:var(--code-token-punctuation)">(</span><span class="token parameter">len</span><span class="token" style="color:var(--code-token-punctuation)">)</span><span> </span><span class="token" style="color:var(--code-token-punctuation)">{</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>  </span><span class="token" style="color:var(--code-token-keyword)">const</span><span> items </span><span class="token operator">=</span><span> </span><span class="token" style="color:var(--code-token-punctuation)">[</span><span class="token" style="color:var(--code-token-punctuation)">]</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>  </span><span class="token" style="color:var(--code-token-keyword)">for</span><span> </span><span class="token" style="color:var(--code-token-punctuation)">(</span><span class="token" style="color:var(--code-token-keyword)">let</span><span> i </span><span class="token operator">=</span><span> </span><span class="token number">0</span><span class="token" style="color:var(--code-token-punctuation)">;</span><span> i </span><span class="token operator">&lt;</span><span> len</span><span class="token" style="color:var(--code-token-punctuation)">;</span><span> i</span><span class="token operator">++</span><span class="token" style="color:var(--code-token-punctuation)">)</span><span> </span><span class="token" style="color:var(--code-token-punctuation)">{</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>    </span><span class="token" style="color:var(--code-token-keyword)">const</span><span> width </span><span class="token operator">=</span><span> Math</span><span class="token" style="color:var(--code-token-punctuation)">.</span><span class="token" style="color:var(--code-token-function)">floor</span><span class="token" style="color:var(--code-token-punctuation)">(</span><span>Math</span><span class="token" style="color:var(--code-token-punctuation)">.</span><span class="token" style="color:var(--code-token-function)">random</span><span class="token" style="color:var(--code-token-punctuation)">(</span><span class="token" style="color:var(--code-token-punctuation)">)</span><span> </span><span class="token operator">*</span><span> </span><span class="token" style="color:var(--code-token-punctuation)">(</span><span class="token number">400</span><span> </span><span class="token operator">-</span><span> </span><span class="token number">300</span><span> </span><span class="token operator">+</span><span> </span><span class="token number">1</span><span class="token" style="color:var(--code-token-punctuation)">)</span><span> </span><span class="token operator">+</span><span> </span><span class="token number">300</span><span class="token" style="color:var(--code-token-punctuation)">)</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>    </span><span class="token" style="color:var(--code-token-keyword)">const</span><span> height </span><span class="token operator">=</span><span> Math</span><span class="token" style="color:var(--code-token-punctuation)">.</span><span class="token" style="color:var(--code-token-function)">floor</span><span class="token" style="color:var(--code-token-punctuation)">(</span><span>Math</span><span class="token" style="color:var(--code-token-punctuation)">.</span><span class="token" style="color:var(--code-token-function)">random</span><span class="token" style="color:var(--code-token-punctuation)">(</span><span class="token" style="color:var(--code-token-punctuation)">)</span><span> </span><span class="token operator">*</span><span> </span><span class="token" style="color:var(--code-token-punctuation)">(</span><span class="token number">500</span><span> </span><span class="token operator">-</span><span> </span><span class="token number">250</span><span> </span><span class="token operator">+</span><span> </span><span class="token number">1</span><span class="token" style="color:var(--code-token-punctuation)">)</span><span> </span><span class="token operator">+</span><span> </span><span class="token number">250</span><span class="token" style="color:var(--code-token-punctuation)">)</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>    </span><span class="token" style="color:var(--code-token-keyword)">let</span><span> url </span><span class="token operator">=</span><span> </span><span class="token template-string template-punctuation" style="color:var(--code-token-string)">`</span><span class="token template-string" style="color:var(--code-token-string)">
</span></span><span style="display:block;padding:0 1.25rem;color:var(--code-token-string)" class="token template-string">      data:image/svg+xml;charset=utf-8,
</span><span style="display:block;padding:0 1.25rem;color:var(--code-token-string)" class="token template-string">      &lt;svg
</span><span style="display:block;padding:0 1.25rem;color:var(--code-token-string)" class="token template-string">        xmlns=&quot;http://www.w3.org/2000/svg&quot;
</span><span style="display:block;padding:0 1.25rem"><span class="token template-string" style="color:var(--code-token-string)">        width=&quot;</span><span class="token template-string interpolation interpolation-punctuation" style="color:var(--code-token-punctuation)">${</span><span class="token template-string interpolation">width</span><span class="token template-string interpolation interpolation-punctuation" style="color:var(--code-token-punctuation)">}</span><span class="token template-string" style="color:var(--code-token-string)">&quot;
</span></span><span style="display:block;padding:0 1.25rem"><span class="token template-string" style="color:var(--code-token-string)">        height=&quot;</span><span class="token template-string interpolation interpolation-punctuation" style="color:var(--code-token-punctuation)">${</span><span class="token template-string interpolation">height</span><span class="token template-string interpolation interpolation-punctuation" style="color:var(--code-token-punctuation)">}</span><span class="token template-string" style="color:var(--code-token-string)">&quot;
</span></span><span style="display:block;padding:0 1.25rem"><span class="token template-string" style="color:var(--code-token-string)">        viewBox=&quot;0 0 </span><span class="token template-string interpolation interpolation-punctuation" style="color:var(--code-token-punctuation)">${</span><span class="token template-string interpolation">width</span><span class="token template-string interpolation interpolation-punctuation" style="color:var(--code-token-punctuation)">}</span><span class="token template-string" style="color:var(--code-token-string)"> </span><span class="token template-string interpolation interpolation-punctuation" style="color:var(--code-token-punctuation)">${</span><span class="token template-string interpolation">height</span><span class="token template-string interpolation interpolation-punctuation" style="color:var(--code-token-punctuation)">}</span><span class="token template-string" style="color:var(--code-token-string)">&quot;
</span></span><span style="display:block;padding:0 1.25rem;color:var(--code-token-string)" class="token template-string">      &gt;
</span><span style="display:block;padding:0 1.25rem;color:var(--code-token-string)" class="token template-string">        &lt;text
</span><span style="display:block;padding:0 1.25rem;color:var(--code-token-string)" class="token template-string">          x=&quot;50%&quot;
</span><span style="display:block;padding:0 1.25rem;color:var(--code-token-string)" class="token template-string">          y=&quot;50%&quot;
</span><span style="display:block;padding:0 1.25rem;color:var(--code-token-string)" class="token template-string">          dominant-baseline=&quot;middle&quot;
</span><span style="display:block;padding:0 1.25rem;color:var(--code-token-string)" class="token template-string">          text-anchor=&quot;middle&quot;
</span><span style="display:block;padding:0 1.25rem;color:var(--code-token-string)" class="token template-string">          font-size=&quot;20&quot;
</span><span style="display:block;padding:0 1.25rem;color:var(--code-token-string)" class="token template-string">          fill=&quot;black&quot;
</span><span style="display:block;padding:0 1.25rem;color:var(--code-token-string)" class="token template-string">        &gt;
</span><span style="display:block;padding:0 1.25rem"><span class="token template-string" style="color:var(--code-token-string)">          </span><span class="token template-string interpolation interpolation-punctuation" style="color:var(--code-token-punctuation)">${</span><span class="token template-string interpolation">width</span><span class="token template-string interpolation interpolation-punctuation" style="color:var(--code-token-punctuation)">}</span><span class="token template-string" style="color:var(--code-token-string)"> * </span><span class="token template-string interpolation interpolation-punctuation" style="color:var(--code-token-punctuation)">${</span><span class="token template-string interpolation">height</span><span class="token template-string interpolation interpolation-punctuation" style="color:var(--code-token-punctuation)">}</span><span class="token template-string" style="color:var(--code-token-string)">
</span></span><span style="display:block;padding:0 1.25rem;color:var(--code-token-string)" class="token template-string">        &lt;/text&gt;
</span><span style="display:block;padding:0 1.25rem;color:var(--code-token-string)" class="token template-string">      &lt;/svg&gt;
</span><span style="display:block;padding:0 1.25rem"><span class="token template-string" style="color:var(--code-token-string)">    </span><span class="token template-string template-punctuation" style="color:var(--code-token-string)">`</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>    url </span><span class="token operator">=</span><span> url</span><span class="token" style="color:var(--code-token-punctuation)">.</span><span class="token" style="color:var(--code-token-function)">replace</span><span class="token" style="color:var(--code-token-punctuation)">(</span><span class="token regex-delimiter" style="color:var(--code-token-keyword)">/</span><span class="token regex-source language-regex" style="color:var(--code-token-keyword)">[\r\n]+</span><span class="token regex-delimiter" style="color:var(--code-token-keyword)">/</span><span class="token regex-flags" style="color:var(--code-token-keyword)">g</span><span class="token" style="color:var(--code-token-punctuation)">,</span><span> </span><span class="token" style="color:var(--code-token-string)">&#x27;&#x27;</span><span class="token" style="color:var(--code-token-punctuation)">)</span><span class="token" style="color:var(--code-token-punctuation)">.</span><span class="token" style="color:var(--code-token-function)">replace</span><span class="token" style="color:var(--code-token-punctuation)">(</span><span class="token regex-delimiter" style="color:var(--code-token-keyword)">/</span><span class="token regex-source language-regex" style="color:var(--code-token-keyword)">\s+</span><span class="token regex-delimiter" style="color:var(--code-token-keyword)">/</span><span class="token regex-flags" style="color:var(--code-token-keyword)">g</span><span class="token" style="color:var(--code-token-punctuation)">,</span><span> </span><span class="token" style="color:var(--code-token-string)">&#x27; &#x27;</span><span class="token" style="color:var(--code-token-punctuation)">)</span><span class="token" style="color:var(--code-token-punctuation)">.</span><span class="token" style="color:var(--code-token-function)">trim</span><span class="token" style="color:var(--code-token-punctuation)">(</span><span class="token" style="color:var(--code-token-punctuation)">)</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>    items</span><span class="token" style="color:var(--code-token-punctuation)">.</span><span class="token" style="color:var(--code-token-function)">push</span><span class="token" style="color:var(--code-token-punctuation)">(</span><span class="token" style="color:var(--code-token-punctuation)">{</span><span> width</span><span class="token" style="color:var(--code-token-punctuation)">,</span><span> height</span><span class="token" style="color:var(--code-token-punctuation)">,</span><span> url </span><span class="token" style="color:var(--code-token-punctuation)">}</span><span class="token" style="color:var(--code-token-punctuation)">)</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>  </span><span class="token" style="color:var(--code-token-punctuation)">}</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>  </span><span class="token" style="color:var(--code-token-keyword)">return</span><span> items
</span></span><span style="display:block;padding:0 1.25rem"><span></span><span class="token" style="color:var(--code-token-punctuation)">}</span></span></code></pre></div><div class="code-button-group_15153"><button title="Toggle code wrap"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_15153"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_15153"><path fill="currentColor" d="M16 7H3V5h13v2M3 19h13v-2H3v2m19-7-4-3v2H3v2h15v2l4-3Z"></path></svg></button><button class="code-copy-button_15153" title="Copy code"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_15153"><path fill="currentColor" d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_15153"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9 13 24z"></path></svg></button></div></div></div>
<p class="my-4 leading-7"><img src="/static/image/getItems.bd02768d.png"/></p>
<h2 id="小红书的瀑布流" class="mt-12 mb-6 pt-8 text-2xl tracking-tight border-t-[1px] border-divider-light title_3b154"><a class="link_3b154 header-anchor" aria-hidden="true" href="#小红书的瀑布流">#</a>小红书的瀑布流</h2>
<h3 id="原理" class="mt-10 mb-2 leading-7 text-xl title_3b154"><a class="link_3b154 header-anchor" aria-hidden="true" href="#原理">#</a>原理</h3>
<p class="my-4 leading-7">假如小红书需要实现左、中、右三列的瀑布流，它会先找高度最低的列放置图片，如果相同高度的列，则按照从左到右的顺序放置。</p>
<p class="my-4 leading-7">如下图所示，初始时每一列初始高度都为 0，所以图片应该先放最左侧的列。</p>
<p class="my-4 leading-7"><img src="data:image/png;base64,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"/></p>
<p class="my-4 leading-7">放完第 0 张图片后，此时中、右两列高度为 0，所以第 1 张图放在中列。</p>
<p class="my-4 leading-7"><img src="data:image/png;base64,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"/></p>
<p class="my-4 leading-7">放完第 1 张图片后，此时右列高度为 0，是最低的列，所以第 2 张图放在右列。</p>
<p class="my-4 leading-7"><img src="data:image/png;base64,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"/></p>
<p class="my-4 leading-7">放完第 2 张图片后，此时右列高度最低，所以第 3 张图放在右列。</p>
<p class="my-4 leading-7"><img src="/static/image/left-to-right-3.264ec168.png"/></p>
<p class="my-4 leading-7">放完第 3 张图片后，此时中、右两列高度相同，所以第 4 张图放在中列。</p>
<p class="my-4 leading-7"><img src="/static/image/left-to-right-4.2dce8063.png"/></p>
<p class="my-4 leading-7">放完第 4 张图片后，此时右列高度最低，所以第 5 张图片放在右列。</p>
<p class="my-4 leading-7"><img src="/static/image/left-to-right-5.7e59ac08.png"/></p>
<p class="my-4 leading-7">我们可以打开小红书网页版的控制台，在控制台可以检查元素，可以看到它的布局完全符合这个规律。</p>
<p class="my-4 leading-7"><img src="/static/image/xiaohongshu.7d114b30.gif"/></p>
<h3 id="关键代码解释" class="mt-10 mb-2 leading-7 text-xl title_3b154"><a class="link_3b154 header-anchor" aria-hidden="true" href="#关键代码解释">#</a>关键代码解释</h3>
<p class="my-4 leading-7">说完原理，我们现在来看下关键代码，代码整体思路，可以理解为先插入图片，再设置图片位置。</p>
<h4 id="插入图片" class="mt-8 leading-6 text-lg title_3b154"><a class="link_3b154 header-anchor" aria-hidden="true" href="#插入图片">#</a>插入图片</h4>
<p class="my-4 leading-7">先看基础布局，布局非常简单，就是一个定位为 relative 的盒子元素。之后我们会在盒子中元素中一张张插入图片，每一个图片的定位都是 absolute。</p>
<div class="language-html"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-html" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span class="token" style="color:var(--code-token-punctuation)">&lt;</span><span class="token" style="color:var(--code-token-function)">style</span><span class="token" style="color:var(--code-token-punctuation)">&gt;</span><span class="token style language-css">
</span></span><span style="display:block;padding:0 1.25rem"><span class="token style language-css">  </span><span class="token style language-css selector">...
</span></span><span style="display:block;padding:0 1.25rem"><span class="token style language-css selector">  #box</span><span class="token style language-css"> </span><span class="token style language-css" style="color:var(--code-token-punctuation)">{</span><span class="token style language-css">
</span></span><span style="display:block;padding:0 1.25rem"><span class="token style language-css">    </span><span class="token style language-css" style="color:var(--code-token-parameter)">position</span><span class="token style language-css" style="color:var(--code-token-punctuation)">:</span><span class="token style language-css"> relative</span><span class="token style language-css" style="color:var(--code-token-punctuation)">;</span><span class="token style language-css">
</span></span><span style="display:block;padding:0 1.25rem"><span class="token style language-css">  </span><span class="token style language-css" style="color:var(--code-token-punctuation)">}</span><span class="token style language-css">
</span></span><span style="display:block;padding:0 1.25rem"><span class="token style language-css">  </span><span class="token style language-css selector">#box img</span><span class="token style language-css"> </span><span class="token style language-css" style="color:var(--code-token-punctuation)">{</span><span class="token style language-css">
</span></span><span style="display:block;padding:0 1.25rem"><span class="token style language-css">    </span><span class="token style language-css" style="color:var(--code-token-parameter)">position</span><span class="token style language-css" style="color:var(--code-token-punctuation)">:</span><span class="token style language-css"> absolute</span><span class="token style language-css" style="color:var(--code-token-punctuation)">;</span><span class="token style language-css">
</span></span><span style="display:block;padding:0 1.25rem"><span class="token style language-css">    </span><span class="token style language-css" style="color:var(--code-token-parameter)">object-fit</span><span class="token style language-css" style="color:var(--code-token-punctuation)">:</span><span class="token style language-css"> cover</span><span class="token style language-css" style="color:var(--code-token-punctuation)">;</span><span class="token style language-css">
</span></span><span style="display:block;padding:0 1.25rem"><span class="token style language-css">    </span><span class="token style language-css" style="color:var(--code-token-parameter)">background-color</span><span class="token style language-css" style="color:var(--code-token-punctuation)">:</span><span class="token style language-css"> #eee</span><span class="token style language-css" style="color:var(--code-token-punctuation)">;</span><span class="token style language-css">
</span></span><span style="display:block;padding:0 1.25rem"><span class="token style language-css">  </span><span class="token style language-css" style="color:var(--code-token-punctuation)">}</span><span class="token style language-css">
</span></span><span style="display:block;padding:0 1.25rem" class="token style language-css">  ...
</span><span style="display:block;padding:0 1.25rem"><span class="token style language-css"></span><span class="token" style="color:var(--code-token-punctuation)">&lt;/</span><span class="token" style="color:var(--code-token-function)">style</span><span class="token" style="color:var(--code-token-punctuation)">&gt;</span><span>
</span></span><span style="display:block;padding:0 1.25rem">...
</span><span style="display:block;padding:0 1.25rem"><span></span><span class="token" style="color:var(--code-token-punctuation)">&lt;</span><span class="token" style="color:var(--code-token-function)">div</span><span class="token" style="color:var(--code-token-function)"> </span><span class="token" style="color:var(--code-token-symbol)">id</span><span class="token attr-equals" style="color:var(--code-token-punctuation)">=</span><span class="token" style="color:var(--code-token-punctuation)">&quot;</span><span class="token" style="color:var(--code-token-string-expression)">box</span><span class="token" style="color:var(--code-token-punctuation)">&quot;</span><span class="token" style="color:var(--code-token-punctuation)">&gt;</span><span class="token" style="color:var(--code-token-punctuation)">&lt;/</span><span class="token" style="color:var(--code-token-function)">div</span><span class="token" style="color:var(--code-token-punctuation)">&gt;</span></span></code></pre></div><div class="code-button-group_15153"><button title="Toggle code wrap"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_15153"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_15153"><path fill="currentColor" d="M16 7H3V5h13v2M3 19h13v-2H3v2m19-7-4-3v2H3v2h15v2l4-3Z"></path></svg></button><button class="code-copy-button_15153" title="Copy code"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_15153"><path fill="currentColor" d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_15153"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9 13 24z"></path></svg></button></div></div></div>
<p class="my-4 leading-7">插入图片的 JavaScript 代码如下，入参 items 可以前文提到的工具函数 <code>getItems()</code> 生成。至于 imgWidth 则是每一列的宽度，我们可以自行指定。</p>
<p class="my-4 leading-7">我们在 <code>getItems()</code> 中生成了宽高不一的图片，当图片实际显示在屏幕上时，它们的宽度都会缩写为 imgWidth，因此我们也要将它们的高度等比例缩放。</p>
<p class="my-4 leading-7">我们的做法就是计算出 imgWidth 与每一张图片 width 的比例 ratio，然后用每一张图片的 height * ratio 获得等比例缩放的高度。</p>
<div class="language-js"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-js" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span class="token" style="color:var(--code-token-comment)">// 加入图片元素</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span></span><span class="token" style="color:var(--code-token-keyword)">function</span><span> </span><span class="token" style="color:var(--code-token-function)">createImgs</span><span class="token" style="color:var(--code-token-punctuation)">(</span><span class="token parameter">items</span><span class="token parameter" style="color:var(--code-token-punctuation)">,</span><span class="token parameter"> imgWidth</span><span class="token" style="color:var(--code-token-punctuation)">)</span><span> </span><span class="token" style="color:var(--code-token-punctuation)">{</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>  </span><span class="token" style="color:var(--code-token-keyword)">for</span><span> </span><span class="token" style="color:var(--code-token-punctuation)">(</span><span class="token" style="color:var(--code-token-keyword)">let</span><span> i </span><span class="token operator">=</span><span> </span><span class="token number">0</span><span class="token" style="color:var(--code-token-punctuation)">;</span><span> i </span><span class="token operator">&lt;</span><span> items</span><span class="token" style="color:var(--code-token-punctuation)">.</span><span>length</span><span class="token" style="color:var(--code-token-punctuation)">;</span><span> i</span><span class="token operator">++</span><span class="token" style="color:var(--code-token-punctuation)">)</span><span> </span><span class="token" style="color:var(--code-token-punctuation)">{</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>    </span><span class="token" style="color:var(--code-token-keyword)">const</span><span> </span><span class="token" style="color:var(--code-token-punctuation)">{</span><span> url</span><span class="token" style="color:var(--code-token-punctuation)">,</span><span> </span><span class="token literal-property" style="color:var(--code-token-parameter)">width</span><span class="token operator">:</span><span> w</span><span class="token" style="color:var(--code-token-punctuation)">,</span><span> </span><span class="token literal-property" style="color:var(--code-token-parameter)">height</span><span class="token operator">:</span><span> h </span><span class="token" style="color:var(--code-token-punctuation)">}</span><span> </span><span class="token operator">=</span><span> items</span><span class="token" style="color:var(--code-token-punctuation)">[</span><span>i</span><span class="token" style="color:var(--code-token-punctuation)">]</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>    </span><span class="token" style="color:var(--code-token-keyword)">const</span><span> img </span><span class="token operator">=</span><span> document</span><span class="token" style="color:var(--code-token-punctuation)">.</span><span class="token" style="color:var(--code-token-function)">createElement</span><span class="token" style="color:var(--code-token-punctuation)">(</span><span class="token" style="color:var(--code-token-string)">&#x27;img&#x27;</span><span class="token" style="color:var(--code-token-punctuation)">)</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>    </span><span class="token" style="color:var(--code-token-keyword)">const</span><span> ratio </span><span class="token operator">=</span><span> imgWidth </span><span class="token operator">/</span><span> w
</span></span><span style="display:block;padding:0 1.25rem"><span>    </span><span class="token" style="color:var(--code-token-keyword)">const</span><span> imgHeight </span><span class="token operator">=</span><span> Math</span><span class="token" style="color:var(--code-token-punctuation)">.</span><span class="token" style="color:var(--code-token-function)">floor</span><span class="token" style="color:var(--code-token-punctuation)">(</span><span>h </span><span class="token operator">*</span><span> ratio</span><span class="token" style="color:var(--code-token-punctuation)">)</span><span>
</span></span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem"><span>    img</span><span class="token" style="color:var(--code-token-punctuation)">.</span><span>width </span><span class="token operator">=</span><span> imgWidth
</span></span><span style="display:block;padding:0 1.25rem"><span>    img</span><span class="token" style="color:var(--code-token-punctuation)">.</span><span>height </span><span class="token operator">=</span><span> imgHeight
</span></span><span style="display:block;padding:0 1.25rem"><span>    img</span><span class="token" style="color:var(--code-token-punctuation)">.</span><span>src </span><span class="token operator">=</span><span> url
</span></span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem"><span>    box</span><span class="token" style="color:var(--code-token-punctuation)">.</span><span class="token" style="color:var(--code-token-function)">appendChild</span><span class="token" style="color:var(--code-token-punctuation)">(</span><span>img</span><span class="token" style="color:var(--code-token-punctuation)">)</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>  </span><span class="token" style="color:var(--code-token-punctuation)">}</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span></span><span class="token" style="color:var(--code-token-punctuation)">}</span></span></code></pre></div><div class="code-button-group_15153"><button title="Toggle code wrap"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_15153"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_15153"><path fill="currentColor" d="M16 7H3V5h13v2M3 19h13v-2H3v2m19-7-4-3v2H3v2h15v2l4-3Z"></path></svg></button><button class="code-copy-button_15153" title="Copy code"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_15153"><path fill="currentColor" d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_15153"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9 13 24z"></path></svg></button></div></div></div>
<h4 id="设置图片位置" class="mt-8 leading-6 text-lg title_3b154"><a class="link_3b154 header-anchor" aria-hidden="true" href="#设置图片位置">#</a>设置图片位置</h4>
<p class="my-4 leading-7">设置图片位置之前，我们需要知道瀑布流被分为几列，以及每一列的间隙。</p>
<p class="my-4 leading-7">如下图所示，瀑布流的列数 <code>colNumber = Math.floor(boxWidth / imgWidth)</code>，间隙的列数则是 <code>colNumber - 1</code>。</p>
<p class="my-4 leading-7"><img src="/static/image/column-info.e9f57dca.png"/></p>
<div class="language-js"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-js" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span class="token" style="color:var(--code-token-comment)">// 计算会有多少列，以及每列的间隙</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span></span><span class="token" style="color:var(--code-token-keyword)">function</span><span> </span><span class="token" style="color:var(--code-token-function)">getColumnInfo</span><span class="token" style="color:var(--code-token-punctuation)">(</span><span class="token parameter">imgWidth</span><span class="token" style="color:var(--code-token-punctuation)">)</span><span> </span><span class="token" style="color:var(--code-token-punctuation)">{</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>  </span><span class="token" style="color:var(--code-token-keyword)">const</span><span> boxWidth </span><span class="token operator">=</span><span> box</span><span class="token" style="color:var(--code-token-punctuation)">.</span><span>clientWidth
</span></span><span style="display:block;padding:0 1.25rem"><span>  </span><span class="token" style="color:var(--code-token-keyword)">const</span><span> colNumber </span><span class="token operator">=</span><span> Math</span><span class="token" style="color:var(--code-token-punctuation)">.</span><span class="token" style="color:var(--code-token-function)">floor</span><span class="token" style="color:var(--code-token-punctuation)">(</span><span>boxWidth </span><span class="token operator">/</span><span> imgWidth</span><span class="token" style="color:var(--code-token-punctuation)">)</span><span> </span><span class="token" style="color:var(--code-token-comment)">// 列的数量</span><span>
</span></span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem"><span>  </span><span class="token" style="color:var(--code-token-keyword)">const</span><span> spaceNumber </span><span class="token operator">=</span><span> colNumber </span><span class="token operator">-</span><span> </span><span class="token number">1</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>  </span><span class="token" style="color:var(--code-token-keyword)">const</span><span> leftSpace </span><span class="token operator">=</span><span> boxWidth </span><span class="token operator">-</span><span> colNumber </span><span class="token operator">*</span><span> imgWidth
</span></span><span style="display:block;padding:0 1.25rem"><span>  </span><span class="token" style="color:var(--code-token-keyword)">const</span><span> colSpace </span><span class="token operator">=</span><span> </span><span class="token" style="color:var(--code-token-function)">parseFloat</span><span class="token" style="color:var(--code-token-punctuation)">(</span><span class="token" style="color:var(--code-token-punctuation)">(</span><span>leftSpace </span><span class="token operator">/</span><span> spaceNumber</span><span class="token" style="color:var(--code-token-punctuation)">)</span><span class="token" style="color:var(--code-token-punctuation)">.</span><span class="token" style="color:var(--code-token-function)">toFixed</span><span class="token" style="color:var(--code-token-punctuation)">(</span><span class="token number">2</span><span class="token" style="color:var(--code-token-punctuation)">)</span><span class="token" style="color:var(--code-token-punctuation)">,</span><span> </span><span class="token number">10</span><span class="token" style="color:var(--code-token-punctuation)">)</span><span>
</span></span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem"><span>  </span><span class="token" style="color:var(--code-token-keyword)">return</span><span> </span><span class="token" style="color:var(--code-token-punctuation)">{</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>    colSpace</span><span class="token" style="color:var(--code-token-punctuation)">,</span><span>
</span></span><span style="display:block;padding:0 1.25rem">    colNumber
</span><span style="display:block;padding:0 1.25rem"><span>  </span><span class="token" style="color:var(--code-token-punctuation)">}</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span></span><span class="token" style="color:var(--code-token-punctuation)">}</span></span></code></pre></div><div class="code-button-group_15153"><button title="Toggle code wrap"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_15153"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_15153"><path fill="currentColor" d="M16 7H3V5h13v2M3 19h13v-2H3v2m19-7-4-3v2H3v2h15v2l4-3Z"></path></svg></button><button class="code-copy-button_15153" title="Copy code"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_15153"><path fill="currentColor" d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_15153"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9 13 24z"></path></svg></button></div></div></div>
<p class="my-4 leading-7">接下来，我们需要设置每一张图片的位置。因为图片定位是 absolute，所以如果要设置位置，我们需要知道每一张图片到顶部的距离 top，以及到左侧的距离 left。</p>
<p class="my-4 leading-7"><code>setPosition()</code> 函数有四个入参：</p>
<ul class="list-disc pl-5 my-4 leading-7">
<li class="[&amp;:not(:first-child)]:mt-2"><code>items</code> 代表图片数组，也就是之前提到的工具函数 <code>getItems()</code> 的结果。</li>
<li class="[&amp;:not(:first-child)]:mt-2"><code>colNumber</code> 代表瀑布流有几列，之前 <code>getColumnsInfo()</code> 结果中包含这个结果。</li>
<li class="[&amp;:not(:first-child)]:mt-2"><code>colSpace</code> 代表瀑布流列与列之间的间隙，之前的 <code>getColumnsInfo()</code> 结果中也包含这个结果。</li>
<li class="[&amp;:not(:first-child)]:mt-2"><code>rolSpace</code> 代表瀑布流行与行之间的间隙，这个间隙我们可以自行设置，我们也设置 <code>rolSpace</code> 等于 <code>colSpace</code>。</li>
</ul>
<p class="my-4 leading-7">我们在瀑布流原理一节已经知道，设置瀑布流图片时，要找到瀑布流高度最低的列放置图片，如果相同高度的列，则按照从左到右的顺序放置。为此，在 <code>setPosition()</code> 函数中，我们设置了一个长度为 colNumber 的数组，数组保留了一行瀑布流图片的 top 的数组。</p>
<p class="my-4 leading-7">需要注意的是，我们这里用 <code>Math.min.apply(null, nextTops)</code> 找出最低 top 的下标。</p>
<p class="my-4 leading-7">每摆放一个图片，nextTops 都会更新对应下标的 top 值。下一行图片的 top 值，就是本行图片的 top + 本行图片的高度 + 行之间的间隙。至于 left 值，则是（图片本身的宽度 + 列之间的间隙）* 下标。</p>
<div class="language-js"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-js" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span class="token" style="color:var(--code-token-comment)">// 设置每张图片的位置</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span></span><span class="token" style="color:var(--code-token-keyword)">function</span><span> </span><span class="token" style="color:var(--code-token-function)">setPosition</span><span class="token" style="color:var(--code-token-punctuation)">(</span><span class="token parameter">items</span><span class="token parameter" style="color:var(--code-token-punctuation)">,</span><span class="token parameter"> colNumber</span><span class="token parameter" style="color:var(--code-token-punctuation)">,</span><span class="token parameter"> colSpace</span><span class="token parameter" style="color:var(--code-token-punctuation)">,</span><span class="token parameter"> rowSpace</span><span class="token" style="color:var(--code-token-punctuation)">)</span><span> </span><span class="token" style="color:var(--code-token-punctuation)">{</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>  </span><span class="token" style="color:var(--code-token-comment)">// 数组长度为列数，每一项代表下一行的图片的 top 值</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>  </span><span class="token" style="color:var(--code-token-keyword)">const</span><span> nextTops </span><span class="token operator">=</span><span> </span><span class="token" style="color:var(--code-token-keyword)">new</span><span> </span><span class="token class-name">Array</span><span class="token" style="color:var(--code-token-punctuation)">(</span><span>colNumber</span><span class="token" style="color:var(--code-token-punctuation)">)</span><span class="token" style="color:var(--code-token-punctuation)">.</span><span class="token" style="color:var(--code-token-function)">fill</span><span class="token" style="color:var(--code-token-punctuation)">(</span><span class="token number">0</span><span class="token" style="color:var(--code-token-punctuation)">)</span><span>
</span></span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem"><span>  </span><span class="token" style="color:var(--code-token-keyword)">for</span><span> </span><span class="token" style="color:var(--code-token-punctuation)">(</span><span class="token" style="color:var(--code-token-keyword)">let</span><span> i </span><span class="token operator">=</span><span> </span><span class="token number">0</span><span class="token" style="color:var(--code-token-punctuation)">;</span><span> i </span><span class="token operator">&lt;</span><span> items</span><span class="token" style="color:var(--code-token-punctuation)">.</span><span>length</span><span class="token" style="color:var(--code-token-punctuation)">;</span><span> i</span><span class="token operator">++</span><span class="token" style="color:var(--code-token-punctuation)">)</span><span> </span><span class="token" style="color:var(--code-token-punctuation)">{</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>    </span><span class="token" style="color:var(--code-token-keyword)">const</span><span> img </span><span class="token operator">=</span><span> box</span><span class="token" style="color:var(--code-token-punctuation)">.</span><span>children</span><span class="token" style="color:var(--code-token-punctuation)">[</span><span>i</span><span class="token" style="color:var(--code-token-punctuation)">]</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>    </span><span class="token" style="color:var(--code-token-keyword)">const</span><span> top </span><span class="token operator">=</span><span> Math</span><span class="token" style="color:var(--code-token-punctuation)">.</span><span class="token" style="color:var(--code-token-function)">min</span><span class="token" style="color:var(--code-token-punctuation)">.</span><span class="token" style="color:var(--code-token-function)">apply</span><span class="token" style="color:var(--code-token-punctuation)">(</span><span class="token" style="color:var(--code-token-keyword)">null</span><span class="token" style="color:var(--code-token-punctuation)">,</span><span> nextTops</span><span class="token" style="color:var(--code-token-punctuation)">)</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>    img</span><span class="token" style="color:var(--code-token-punctuation)">.</span><span>style</span><span class="token" style="color:var(--code-token-punctuation)">.</span><span>top </span><span class="token operator">=</span><span> top </span><span class="token operator">+</span><span> </span><span class="token" style="color:var(--code-token-string)">&#x27;px&#x27;</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>    </span><span class="token" style="color:var(--code-token-keyword)">const</span><span> index </span><span class="token operator">=</span><span> nextTops</span><span class="token" style="color:var(--code-token-punctuation)">.</span><span class="token" style="color:var(--code-token-function)">indexOf</span><span class="token" style="color:var(--code-token-punctuation)">(</span><span>top</span><span class="token" style="color:var(--code-token-punctuation)">)</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>    nextTops</span><span class="token" style="color:var(--code-token-punctuation)">[</span><span>index</span><span class="token" style="color:var(--code-token-punctuation)">]</span><span> </span><span class="token operator">=</span><span> nextTops</span><span class="token" style="color:var(--code-token-punctuation)">[</span><span>index</span><span class="token" style="color:var(--code-token-punctuation)">]</span><span> </span><span class="token operator">+</span><span> img</span><span class="token" style="color:var(--code-token-punctuation)">.</span><span>height </span><span class="token operator">+</span><span> rowSpace
</span></span><span style="display:block;padding:0 1.25rem"><span>    </span><span class="token" style="color:var(--code-token-keyword)">const</span><span> left </span><span class="token operator">=</span><span> index </span><span class="token operator">*</span><span> colSpace </span><span class="token operator">+</span><span> index </span><span class="token operator">*</span><span> img</span><span class="token" style="color:var(--code-token-punctuation)">.</span><span>width
</span></span><span style="display:block;padding:0 1.25rem"><span>    img</span><span class="token" style="color:var(--code-token-punctuation)">.</span><span>style</span><span class="token" style="color:var(--code-token-punctuation)">.</span><span>left </span><span class="token operator">=</span><span> left </span><span class="token operator">+</span><span> </span><span class="token" style="color:var(--code-token-string)">&#x27;px&#x27;</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>  </span><span class="token" style="color:var(--code-token-punctuation)">}</span><span>
</span></span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem"><span>  </span><span class="token" style="color:var(--code-token-keyword)">const</span><span> max </span><span class="token operator">=</span><span> Math</span><span class="token" style="color:var(--code-token-punctuation)">.</span><span class="token" style="color:var(--code-token-function)">max</span><span class="token" style="color:var(--code-token-punctuation)">.</span><span class="token" style="color:var(--code-token-function)">apply</span><span class="token" style="color:var(--code-token-punctuation)">(</span><span class="token" style="color:var(--code-token-keyword)">null</span><span class="token" style="color:var(--code-token-punctuation)">,</span><span> nextTops</span><span class="token" style="color:var(--code-token-punctuation)">)</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>  box</span><span class="token" style="color:var(--code-token-punctuation)">.</span><span>style</span><span class="token" style="color:var(--code-token-punctuation)">.</span><span>height </span><span class="token operator">=</span><span> max </span><span class="token operator">+</span><span> </span><span class="token" style="color:var(--code-token-string)">&#x27;px&#x27;</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span></span><span class="token" style="color:var(--code-token-punctuation)">}</span></span></code></pre></div><div class="code-button-group_15153"><button title="Toggle code wrap"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_15153"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_15153"><path fill="currentColor" d="M16 7H3V5h13v2M3 19h13v-2H3v2m19-7-4-3v2H3v2h15v2l4-3Z"></path></svg></button><button class="code-copy-button_15153" title="Copy code"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_15153"><path fill="currentColor" d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_15153"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9 13 24z"></path></svg></button></div></div></div>
<h4 id="重新设置位置" class="mt-8 leading-6 text-lg title_3b154"><a class="link_3b154 header-anchor" aria-hidden="true" href="#重新设置位置">#</a>重新设置位置</h4>
<p class="my-4 leading-7">我们可以把设置位置的函数封装为 <code>init()</code> 函数，并给页面宽高变化的事件绑定上 <code>init()</code> 函数，这样就能实现当窗口变化时，瀑布流也重新改变的效果。</p>
<p class="my-4 leading-7">我们实现的瀑布流效果如下：</p>
<p class="my-4 leading-7"><img src="/static/image/waterfall-absolute.8e5a2edc.gif"/></p>
<h3 id="完整代码" class="mt-10 mb-2 leading-7 text-xl title_3b154"><a class="link_3b154 header-anchor" aria-hidden="true" href="#完整代码">#</a>完整代码</h3>
<p class="my-4 leading-7"><a target="_blank" rel="noopener noreferrer" href="https://codepen.io/lijunlin2022/pen/ZEZjrza" class="link_03735  link_3b154 inline-link_3b154">absolute-waterfall | codepen</a></p>
<h2 id="电商三巨头的瀑布流" class="mt-12 mb-6 pt-8 text-2xl tracking-tight border-t-[1px] border-divider-light title_3b154"><a class="link_3b154 header-anchor" aria-hidden="true" href="#电商三巨头的瀑布流">#</a>电商三巨头的瀑布流</h2>
<h3 id="原理-1" class="mt-10 mb-2 leading-7 text-xl title_3b154"><a class="link_3b154 header-anchor" aria-hidden="true" href="#原理-1">#</a>原理</h3>
<p class="my-4 leading-7">电商三巨头中，我们以京东首页为例。我们也是需要找到瀑布流中高度最低的一例，然后把图片放置到这一列中。不同的是，小红书的绝对定位布局中，瀑布流的列只是一个概念，并没有实际的 Dom 元素；而京东的瀑布流的列，则是一个实际的 Dom 元素。</p>
<p class="my-4 leading-7">当列变为 Dom 元素之后，我们便不再需要计算 top 和 left 值，只需要知道目前那一列比较低，就把图片元素插入到哪一列中。</p>
<p class="my-4 leading-7">我们可以打开京东网站的控制台，并检查它瀑布流的元素：</p>
<p class="my-4 leading-7"><img src="/static/image/jd.20eaf348.gif"/></p>
<h3 id="关键代码解释-1" class="mt-10 mb-2 leading-7 text-xl title_3b154"><a class="link_3b154 header-anchor" aria-hidden="true" href="#关键代码解释-1">#</a>关键代码解释</h3>
<p class="my-4 leading-7">之前我们提到，小红书的关键代码可以认为是「为先插入图片，再设置图片位置」。而京东的关键代码则可以理解为「先算出图片要插入的列，再插入图片」。</p>
<p class="my-4 leading-7">和小红书的关键代码类似，我们先是让图片的高度做了一个等比例的缩放。</p>
<p class="my-4 leading-7">为了确认图片应该插入到左右哪一列中，我们分别设置了 leftHeight、rightHeight。如果左列较低，就把图片插入到左列，并更新左列的高度；如果右列较低，就把图片插入到右列，并更新右列的高度。如此循环往复，就实现了双列的瀑布流。</p>
<div class="language-js"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-js" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span class="token" style="color:var(--code-token-keyword)">function</span><span> </span><span class="token" style="color:var(--code-token-function)">createImgs</span><span class="token" style="color:var(--code-token-punctuation)">(</span><span class="token parameter">items</span><span class="token parameter" style="color:var(--code-token-punctuation)">,</span><span class="token parameter"> imgWidth</span><span class="token parameter" style="color:var(--code-token-punctuation)">,</span><span class="token parameter"> rowSpace</span><span class="token" style="color:var(--code-token-punctuation)">)</span><span> </span><span class="token" style="color:var(--code-token-punctuation)">{</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>  </span><span class="token" style="color:var(--code-token-keyword)">let</span><span> leftHeight </span><span class="token operator">=</span><span> </span><span class="token number">0</span><span class="token" style="color:var(--code-token-punctuation)">,</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>    rightHeight </span><span class="token operator">=</span><span> </span><span class="token number">0</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>  </span><span class="token" style="color:var(--code-token-keyword)">for</span><span> </span><span class="token" style="color:var(--code-token-punctuation)">(</span><span class="token" style="color:var(--code-token-keyword)">let</span><span> i </span><span class="token operator">=</span><span> </span><span class="token number">0</span><span class="token" style="color:var(--code-token-punctuation)">;</span><span> i </span><span class="token operator">&lt;</span><span> items</span><span class="token" style="color:var(--code-token-punctuation)">.</span><span>length</span><span class="token" style="color:var(--code-token-punctuation)">;</span><span> i</span><span class="token operator">++</span><span class="token" style="color:var(--code-token-punctuation)">)</span><span> </span><span class="token" style="color:var(--code-token-punctuation)">{</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>    </span><span class="token" style="color:var(--code-token-keyword)">const</span><span> </span><span class="token" style="color:var(--code-token-punctuation)">{</span><span> </span><span class="token literal-property" style="color:var(--code-token-parameter)">width</span><span class="token operator">:</span><span> w</span><span class="token" style="color:var(--code-token-punctuation)">,</span><span> </span><span class="token literal-property" style="color:var(--code-token-parameter)">height</span><span class="token operator">:</span><span> h</span><span class="token" style="color:var(--code-token-punctuation)">,</span><span> url </span><span class="token" style="color:var(--code-token-punctuation)">}</span><span> </span><span class="token operator">=</span><span> items</span><span class="token" style="color:var(--code-token-punctuation)">[</span><span>i</span><span class="token" style="color:var(--code-token-punctuation)">]</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>    </span><span class="token" style="color:var(--code-token-keyword)">const</span><span> img </span><span class="token operator">=</span><span> document</span><span class="token" style="color:var(--code-token-punctuation)">.</span><span class="token" style="color:var(--code-token-function)">createElement</span><span class="token" style="color:var(--code-token-punctuation)">(</span><span class="token" style="color:var(--code-token-string)">&#x27;img&#x27;</span><span class="token" style="color:var(--code-token-punctuation)">)</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>    </span><span class="token" style="color:var(--code-token-keyword)">const</span><span> ratio </span><span class="token operator">=</span><span> imgWidth </span><span class="token operator">/</span><span> w
</span></span><span style="display:block;padding:0 1.25rem"><span>    </span><span class="token" style="color:var(--code-token-keyword)">const</span><span> imgHeight </span><span class="token operator">=</span><span> Math</span><span class="token" style="color:var(--code-token-punctuation)">.</span><span class="token" style="color:var(--code-token-function)">floor</span><span class="token" style="color:var(--code-token-punctuation)">(</span><span>h </span><span class="token operator">*</span><span> ratio</span><span class="token" style="color:var(--code-token-punctuation)">)</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>    img</span><span class="token" style="color:var(--code-token-punctuation)">.</span><span>width </span><span class="token operator">=</span><span> imgWidth
</span></span><span style="display:block;padding:0 1.25rem"><span>    img</span><span class="token" style="color:var(--code-token-punctuation)">.</span><span>height </span><span class="token operator">=</span><span> imgHeight
</span></span><span style="display:block;padding:0 1.25rem"><span>    img</span><span class="token" style="color:var(--code-token-punctuation)">.</span><span>src </span><span class="token operator">=</span><span> url
</span></span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem"><span>    </span><span class="token" style="color:var(--code-token-keyword)">if</span><span> </span><span class="token" style="color:var(--code-token-punctuation)">(</span><span>leftHeight </span><span class="token operator">&lt;=</span><span> rightHeight</span><span class="token" style="color:var(--code-token-punctuation)">)</span><span> </span><span class="token" style="color:var(--code-token-punctuation)">{</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>      leftHeight </span><span class="token operator">=</span><span> leftHeight </span><span class="token operator">+</span><span> imgHeight </span><span class="token operator">+</span><span> rowSpace
</span></span><span style="display:block;padding:0 1.25rem"><span>      leftBox</span><span class="token" style="color:var(--code-token-punctuation)">.</span><span class="token" style="color:var(--code-token-function)">appendChild</span><span class="token" style="color:var(--code-token-punctuation)">(</span><span>img</span><span class="token" style="color:var(--code-token-punctuation)">)</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>    </span><span class="token" style="color:var(--code-token-punctuation)">}</span><span> </span><span class="token" style="color:var(--code-token-keyword)">else</span><span> </span><span class="token" style="color:var(--code-token-punctuation)">{</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>      rightHeight </span><span class="token operator">=</span><span> rightHeight </span><span class="token operator">+</span><span> imgHeight </span><span class="token operator">+</span><span> rowSpace
</span></span><span style="display:block;padding:0 1.25rem"><span>      rightBox</span><span class="token" style="color:var(--code-token-punctuation)">.</span><span class="token" style="color:var(--code-token-function)">appendChild</span><span class="token" style="color:var(--code-token-punctuation)">(</span><span>img</span><span class="token" style="color:var(--code-token-punctuation)">)</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>    </span><span class="token" style="color:var(--code-token-punctuation)">}</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>  </span><span class="token" style="color:var(--code-token-punctuation)">}</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span></span><span class="token" style="color:var(--code-token-punctuation)">}</span></span></code></pre></div><div class="code-button-group_15153"><button title="Toggle code wrap"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_15153"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_15153"><path fill="currentColor" d="M16 7H3V5h13v2M3 19h13v-2H3v2m19-7-4-3v2H3v2h15v2l4-3Z"></path></svg></button><button class="code-copy-button_15153" title="Copy code"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_15153"><path fill="currentColor" d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_15153"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9 13 24z"></path></svg></button></div></div></div>
<p class="my-4 leading-7">双列瀑布流可以结合我之前的文章 <a target="_blank" rel="noopener noreferrer" href="https://juejin.cn/post/7341329626357973029" class="link_03735  link_3b154 inline-link_3b154">H5 上滑加载（触底加载）如何实现</a>，得到如下效果。</p>
<p class="my-4 leading-7"><img src="/static/image/waterfall-flex.8464cf74.gif"/></p>
<h3 id="完整代码-1" class="mt-10 mb-2 leading-7 text-xl title_3b154"><a class="link_3b154 header-anchor" aria-hidden="true" href="#完整代码-1">#</a>完整代码</h3>
<p class="my-4 leading-7"><a target="_blank" rel="noopener noreferrer" href="https://codepen.io/lijunlin2022/pen/vYMadxY" class="link_03735  link_3b154 inline-link_3b154">flex-waterfall | codepen</a></p>
<h2 id="对比总结" class="mt-12 mb-6 pt-8 text-2xl tracking-tight border-t-[1px] border-divider-light title_3b154"><a class="link_3b154 header-anchor" aria-hidden="true" href="#对比总结">#</a>对比总结</h2>
<p class="my-4 leading-7">现在我们对小红书的瀑布流和电商三巨头的瀑布流做一个对比总结：</p>
<table class="block border-collapse text-base my-5 overflow-x-auto leading-7 border-gray-light-3 dark:border-divider"><thead><tr class="border border-solid transition-colors duration-500 even:bg-soft border-gray-light-3 dark:border-divider"><th class="border border-solid px-4 py-2 text-text-1 text-base font-semibold border-gray-light-3 dark:border-divider"></th><th class="border border-solid px-4 py-2 text-text-1 text-base font-semibold border-gray-light-3 dark:border-divider">小红书</th><th class="border border-solid px-4 py-2 text-text-1 text-base font-semibold border-gray-light-3 dark:border-divider">拼多多、京东、淘宝</th></tr></thead><tbody><tr class="border border-solid transition-colors duration-500 even:bg-soft border-gray-light-3 dark:border-divider"><td class="border border-solid px-4 py-2 border-gray-light-3 dark:border-divider">实现方式</td><td class="border border-solid px-4 py-2 border-gray-light-3 dark:border-divider">绝对定位</td><td class="border border-solid px-4 py-2 border-gray-light-3 dark:border-divider">Flex 布局</td></tr><tr class="border border-solid transition-colors duration-500 even:bg-soft border-gray-light-3 dark:border-divider"><td class="border border-solid px-4 py-2 border-gray-light-3 dark:border-divider">计算量</td><td class="border border-solid px-4 py-2 border-gray-light-3 dark:border-divider">大</td><td class="border border-solid px-4 py-2 border-gray-light-3 dark:border-divider">小</td></tr><tr class="border border-solid transition-colors duration-500 even:bg-soft border-gray-light-3 dark:border-divider"><td class="border border-solid px-4 py-2 border-gray-light-3 dark:border-divider">复杂程度</td><td class="border border-solid px-4 py-2 border-gray-light-3 dark:border-divider">高</td><td class="border border-solid px-4 py-2 border-gray-light-3 dark:border-divider">低</td></tr><tr class="border border-solid transition-colors duration-500 even:bg-soft border-gray-light-3 dark:border-divider"><td class="border border-solid px-4 py-2 border-gray-light-3 dark:border-divider">列数是否可以改变</td><td class="border border-solid px-4 py-2 border-gray-light-3 dark:border-divider">是</td><td class="border border-solid px-4 py-2 border-gray-light-3 dark:border-divider">否</td></tr></tbody></table>
<p class="my-4 leading-7">如果瀑布流的列数不会改变，那么推荐使用 Flex 布局，它的计算量更小、复杂程度更低；如果瀑布流的列数需要改变，那么推荐使用绝对定位实现。</p>
<p class="my-4 leading-7">通常来说，C 端 H5 总是会保留两列，用 Flex 布局更合适。但是有部分产品会推出单双列切换的功能，此时用绝对定位方式会更好。</p>
<h2 id="总结" class="mt-12 mb-6 pt-8 text-2xl tracking-tight border-t-[1px] border-divider-light title_3b154"><a class="link_3b154 header-anchor" aria-hidden="true" href="#总结">#</a>总结</h2>
<p class="my-4 leading-7">本文我们介绍了小红书和电商三巨头（拼多多、京东、淘宝）的瀑布流实现方案，并给出了两种实现瀑布流的代码，最后我们做了一个对比，无论是实现计算量还是难度，Flex 布局均比较简单。但是 Flex 布局无法实现列数切换的情况。</p>
<p class="my-4 leading-7">拳打 H5，脚踢小程序。我是「小霖家的混江龙」，关注我，带你了解更多实用的 H5、小程序武学。</p><!--/$--></div><div class="rspress-doc-footer"><footer class="mt-8"><div class="xs:flex pb-5 px-2 justify-end items-center"></div><div class="flex flex-col"></div><div class="flex flex-col sm:flex-row sm:justify-around gap-4 pt-6"><div class="prev_e7091 flex flex-col"></div><div class="next_e7091 flex flex-col"></div></div></footer></div></div></div><div class="aside-container_edeb4"><div><div class="flex flex-col"><div class="&lt;lg:hidden"><div id="aside-container" class="relative text-sm font-medium"><div class="leading-7 block text-sm font-semibold pl-3">ON THIS PAGE</div><nav class="mt-1"><ul class="relative"><li><a href="#瀑布流是什么" title="瀑布流是什么" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="margin-left:0;font-weight:semibold"><span class="aside-link-text block">瀑布流是什么</span></a></li><li><a href="#小红书的瀑布流" title="小红书的瀑布流" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="margin-left:0;font-weight:semibold"><span class="aside-link-text block">小红书的瀑布流</span></a></li><li><a href="#原理" title="原理" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="margin-left:12px;font-weight:semibold"><span class="aside-link-text block">原理</span></a></li><li><a href="#关键代码解释" title="关键代码解释" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="margin-left:12px;font-weight:semibold"><span class="aside-link-text block">关键代码解释</span></a></li><li><a href="#插入图片" title="插入图片" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="margin-left:24px;font-weight:semibold"><span class="aside-link-text block">插入图片</span></a></li><li><a href="#设置图片位置" title="设置图片位置" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="margin-left:24px;font-weight:semibold"><span class="aside-link-text block">设置图片位置</span></a></li><li><a href="#重新设置位置" title="重新设置位置" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="margin-left:24px;font-weight:semibold"><span class="aside-link-text block">重新设置位置</span></a></li><li><a href="#完整代码" title="完整代码" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="margin-left:12px;font-weight:semibold"><span class="aside-link-text block">完整代码</span></a></li><li><a href="#电商三巨头的瀑布流" title="电商三巨头的瀑布流" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="margin-left:0;font-weight:semibold"><span class="aside-link-text block">电商三巨头的瀑布流</span></a></li><li><a href="#原理-1" title="原理" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="margin-left:12px;font-weight:semibold"><span class="aside-link-text block">原理</span></a></li><li><a href="#关键代码解释-1" title="关键代码解释" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="margin-left:12px;font-weight:semibold"><span class="aside-link-text block">关键代码解释</span></a></li><li><a href="#完整代码-1" title="完整代码" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="margin-left:12px;font-weight:semibold"><span class="aside-link-text block">完整代码</span></a></li><li><a href="#对比总结" title="对比总结" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="margin-left:0;font-weight:semibold"><span class="aside-link-text block">对比总结</span></a></li><li><a href="#总结" title="总结" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="margin-left:0;font-weight:semibold"><span class="aside-link-text block">总结</span></a></li></ul></nav></div></div></div></div></div></div></div></section></div></div>
  <div id="search-container"></div>
</body>

</html>
