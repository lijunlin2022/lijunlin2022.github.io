<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:content="http://purl.org/rss/1.0/modules/content/">
    <channel>
        <title>李俊霖的网络日志 Blog</title>
        <link>https://lijunlin2022.github.io/blog</link>
        <description>李俊霖的网络日志 Blog</description>
        <lastBuildDate>Thu, 14 Dec 2023 00:00:00 GMT</lastBuildDate>
        <docs>https://validator.w3.org/feed/docs/rss2.html</docs>
        <generator>https://github.com/jpmonette/feed</generator>
        <language>en</language>
        <item>
            <title><![CDATA[无复制元素的循环轮播]]></title>
            <link>https://lijunlin2022.github.io/blog/2023/12/14/loop-swiper</link>
            <guid>https://lijunlin2022.github.io/blog/2023/12/14/loop-swiper</guid>
            <pubDate>Thu, 14 Dec 2023 00:00:00 GMT</pubDate>
            <description><![CDATA[大家好，我俊霖。]]></description>
            <content:encoded><![CDATA[<p>大家好，我俊霖。</p>
<p>循环轮播大家都很熟悉。一般的实现方法，需要复制首尾的元素。比如需要轮播的元素是 1234，那么就需要复制 1 和 4，让轮播元素变为 412341。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="ant-design-mobile-swiper">Ant Design Mobile Swiper<a href="https://lijunlin2022.github.io/blog/2023/12/14/loop-swiper#ant-design-mobile-swiper" class="hash-link" aria-label="Direct link to Ant Design Mobile Swiper" title="Direct link to Ant Design Mobile Swiper">​</a></h2>
<p><a href="https://mobile.ant.design/components/swiper" target="_blank" rel="noopener noreferrer">Ant Design Mobile Swiper</a> 的循环轮播，就是一种无复制元素的循环轮播。如下图，可以在控制台看到元素个数始终是 4 个，没有多余的元素。</p>
<p><img loading="lazy" src="https://lijunlin2022.github.io/assets/images/antd-mobile-fb968342e95cda93f287f9fd3c7b9933.gif" width="1150" height="180" class="img_ev3q"></p>
<p>它的原理是什么呢？</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="约定">约定<a href="https://lijunlin2022.github.io/blog/2023/12/14/loop-swiper#%E7%BA%A6%E5%AE%9A" class="hash-link" aria-label="Direct link to 约定" title="Direct link to 约定">​</a></h2>
<p>为方便读者理解下文，我需要和读者们做一些约定。</p>
<ul>
<li>轮播组件是整屏的轮播，轮播时只会向左切换一个元素，或者向右切换一个元素。</li>
<li>轮播容器称为 List，轮播元素称为 Item。</li>
<li>List 有 5 个 Item，分别是 Item0 到 Item4。之所以选择 5 个 Item，是因为奇数个 Item 更容易找到 List 的中心。</li>
<li>currentIndex 代表 List 中心 Item 的下标。轮播到 Item0 时，currentIndex 是 0。轮播到 Item5 时，currentIndex 是 5。</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="轮播原理">轮播原理<a href="https://lijunlin2022.github.io/blog/2023/12/14/loop-swiper#%E8%BD%AE%E6%92%AD%E5%8E%9F%E7%90%86" class="hash-link" aria-label="Direct link to 轮播原理" title="Direct link to 轮播原理">​</a></h2>
<p><strong>初始化</strong></p>
<p>下图是初始化时，List 中 Item 的排列。它是怎么得到的呢？</p>
<p><img loading="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfQAAAAZCAIAAABIGUs1AAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAEXRFWHRTb2Z0d2FyZQBTbmlwYXN0ZV0Xzt0AAAOgSURBVHic7d1bSFNxAMfx/yKXa3ZTKYNl2pLmKTBO4gWpKGzFIrsYlFQEmWURQRehhyTDEKErNnJqFCSyDCxrbIhFC4akoyaGTUOXZQsczRLbdJ092MPChyidJfz/5/D7vM2nL2Pn5/GcyZH1uwcIAABIy0zLdwftBhHQzeHxRoVPN4df0vSYdoVofNqyHZ+u8OFgDNMM2gEAADD9MO4AABKEcQcAkCCMOwCABGHcAQAkCOMOACBBDI273WQtTNYVJusqCor9Q8O0c8QhGBDqSvR2k5V2COveDXhWXyyVHT5aWFs3KgRp54iDy+GsK9EHAwLtENaZK42h7bq084Snz0075xdWxt3lcLY+eX715X1Dl0XNc4037uEjFY72py22egvtCtaNCsHrT58VbdaO3NITQh468C3pybkczsv7ztKuEAG7yTrkGbzZ3mjosmgP5daXVTFybsrKuKt57mRNqXL+XEKIJj1l8LNHCARoR7HOPzT85oWdy+Jph7Cu/+vXPq83NSFBIY84kJlh6+nFyfvEzJVGY+ktbf5u2iEikLZtw76SExGRckLI0lVJZGzM9w3j/hfdbR1qngsNPUzghdGclauNUcXRDmGd1+eTEVlsVFTo5Qfv4IiAvwsnoklPOf9Ir1qRSDsE/h1b4+5yOAuTde3NLalb1tJuYZ2nz/3DPxrPqWmHiENCbMxsuZwQEhsVtUA5m3YO69Q8RztBlF412WJUcdGLF9IOIYS1cVfznKHLkld8vOZ0OTv3JRgUDAgtDc1ZuVp5ZCTtFgAghBC7ydre3JJ9cEfoEg11bI17SDy3PDFF87Gzh3YIu/qdvbOUikWJKtohojF+Kcbr833zj9DOAamxm6zNdxoKrp1j56icSTvgD4RAYPCzJyNnI+0QdnW3dZgqak0VtaGXtnrLF/fA1mN5dKuY9dulmPFLNADTwm6ytj55fupuGVN3ClkZd5fDaa405l8uUs6f+9b2mhASt4yVX4AM2nosLzTlwYDwoLw6ac3KtG0baEexKz46ep5C0dTZuYvna1+2rk1arpBH0I4CiXA5nKFzdqaWnbAz7mqey8jZeCZzLyFEpVnG4DsF4qWQR5zalL2nqnr/7TtH16/bxePLozBtuts63N3vL+iOjP+kqO4KC3ekZYYu/AvM5PB8gCnBwzqmBA/rmBIcjGFi8YYqAAD8J4w7AIAEYdwBACQI4w4AIEEYdwAACZL1uwdoNwAAwDT7CfqRNhTklVPdAAAAAElFTkSuQmCC" width="500" height="25" class="img_ev3q"></p>
<p>可以这样理解，初始化时，我们希望 Item0 处于 List 中心时，两边的元素尽可能相等。</p>
<p>我们的做法是，Item0，Item1 和 Item2 位置保持不变。将 Item3 和 Item4 往前挪动 5 个位置。</p>
<p><img loading="lazy" src="data:image/png;base64,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" width="700" height="100" class="img_ev3q"></p>
<p><strong>Item1 为中心</strong></p>
<p>下图是 List 从 Item0 轮播到 Item1 时的排列，此时 Item1 处于 List 的中心。</p>
<p><img loading="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfQAAAAZCAIAAABIGUs1AAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAEXRFWHRTb2Z0d2FyZQBTbmlwYXN0ZV0Xzt0AAAOVSURBVHic7d1RSFNRHAbws0ibqSMT1GgVtYR5FcRrmLF6SGrIQit8KOlBMIpZElQYvYhCEZIVYUGWUJQsMxDM5QgLJ4yRjtwycgq6JJvkClPWrNv2UA8ThaCaMTj/Xb7f293Tx+Wc795zLuMoJr3TDAAA5GWl5auTdwbqDMki7lLkDMnihmdPeKeIGR+K92N0RQ6TMXIreAcAAIDoQ7kDAMgQyh0AQIZQ7gAAMoRyBwCQIZQ7AIAM0Sr3kBQ01d90mK28g1Dnm/BePFhtzDKY6m+GpCDvOLHBPu4xtpq+B0O8g1DXfavNmGUwZhkuHqz2TXh5x6HOYbaGb1fTsdr5OT/vOEtolbvrud3WbuGdgrqQFHxxv1NfWXbD1ckYcz23804UA+zjnp0Nl3mniAEOs3XON3PD1dk8YtFXlrVfuk2qsKjxON39Xb1XXz5qHrFoRKHz+gM6L1uEyn1+zv+mzyHoRN5BqPvy8dOMd3pTTmacMr6wtGhscJjOeKLpwtPuk6aHNcV63kFiQEHJ7iP11XHKeMbYppxM9vNnYBbl/kcaUTjVciFxjYoxpt2eOzPlC0oS71ALCJV7X1u3rkyfqs7gHYS6wKyfKRRJKarwJanxRFORVvu6rjZXreYdBORsdGBIIwrhoqeASrn7Jrw/5r9vFDS8g8SG1PXp8UolYywpRbValcQ7DnW6rRhX/+PVM1uqOmPtujTeQajzON3GLIOrx76teBfvLEtIlHtICto7enRl+nBhAQB3DrPV1WPfU3EgvEUDf6ERheYRS3ntiZYzDXQ+QZMo90n3+KrEhPTNWDVHanErJjDr/+YP8I4DcuMwW3vudhy7dh6zMnIbha2bc7Xv347xDrJgJe8AjDE2OjBkbmo1N7WGL23tls/e6X1V5XxTkfXbVsziFg1AVDjM1v6u3tP3LtHZPo4JQUmamfIVlhbxDrKARLnvqyoPV3lICj5uuJOZn11Qspt3KLrWrktLSE4ctg3m7dX1d/Vm5mdj4QzR4nG6w+/saPZIeJzu7lttRxtrEteohm2DjLGMLVTWOiTKHZYlThm/p+JAy5mGu+cadx0y5O3V8U4E8jE6MOQdfVdnOL74S43pikYUOEaiTCMKhaVFZ3ccZoyptVtIPRQVzSP409A/4HyAZcFhHcuCwzqWBZMxciQ+qAIAQHSh3AEAZAjlDgAgQyh3AAAZQrkDAMiQYtI7zTsDAABE2S/WtzYf9+X3ZQAAAABJRU5ErkJggg==" width="500" height="25" class="img_ev3q"></p>
<p>和初始化时理解方式一致，我们希望 Item1 处于 List 中心时，两边元素尽可能相等。</p>
<p>我们的做法是：Item1，Item2 和 Item3 位置保持不变。将 item4 和 Item1 往前挪动 5 个位置。</p>
<p><img loading="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAArwAAABkCAIAAADrKnR/AAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAEXRFWHRTb2Z0d2FyZQBTbmlwYXN0ZV0Xzt0AAAfQSURBVHic7d1vaF3lHQfwc5ObP02bmFrxb9pa05Y2OpxxqCMTZqelRKy6MrSOIbM4qitjczo2mFNQpMxtjOqmm+DYSuccCNWsQaqYQg3ToKkdtnbYTFYja7Vd7641pkkb9yJd20gTnoM5O+eEz+fVSbgvvvzuTc4353nOSaFcLkecSqk80NhQl3aK3DCuWIwrFuOKxbhiMa5YKtIOAADkg9IAAAQp7Onfm3YGACAHitZyxmOhKxbjisW4YjGuWIwrFuOKxfIEABBEaQAAgigNAEAQpQEACKI0AABBlAYAIIjSAAAEURoAgCBKAwAQRGkAAIIoDQAk6OX9R6/cMvjlLYMv7z+adhY+K6UBgAT9+M3h7aWR3tLIj94cTjsLn5XSAECC3vjPyOjB9tLIkU/SzcJnpTQAkKCak84zh0fSy8FkUBoASFBtZeH48eBRlxryTWkAIEG1J51nlIa8UxoASNDY5YnC+C8kB5QGABJUY3liClEaAEhQbeWJ4yEbIXNOaQAgQTVj9jSkl4PJoDQAkKAxd0+MWJ7IN6UBgAR5TsNUUiyVB9LOkF2GE4txxWJcsRhXLJkaV+VJReHAocOlaelFGUemxpVxxcaGurQzZFSpPGA44YwrFuOKxbhiydq4ZlQfjqJjexmKNTWNDZUTv/7/LGvjyjjLEwAkyBMhpxKlAYAEnXzLpdKQd0oDAAnyRMipRGkAIEETLE+47JA7SgMAk+nvH45s3X/0+BMZqk91y+WO8sidvUOvHXQLZs4U0w4AwJQyp65w7cuHayujW+YUV84ufmpPw4vvjzzy9lDXByML6yt+1eoP15xRGgCYTNMqC2vmF3+yY3jtruG1u4bPqDmxPPHrviPrdh8ZPf7m+UUbHHJHywNgkq2aV3Va1bHj/YdPbF048r/DmsrCLbOz9cAGQigNAEyy+mJ0R3PVBC+44dyKmdUuNOSP0gDA5Ft9QbFu/EsJq86fqFKQWUoDAJPv9OrCqnmn3ja3uKHi8lnOPrnkbQMgEWvmV1VXnGIN4jZbIHNLaQAgEefUFr4x99NLFNMqCzfPduNeXikNACTluwuqKsdeVfjqeZWn2c+QW0oDAEmZW1f4WtOYiw3jbXQgF5QGABJ018ITFxY+d1rFpTOdd3LMmwdAghbVVyw/99jFBk+BzDulAYBk3b2wKoqiusroJlsgc877B0CyPt9Y8ZUzK5qmVdQ75+ScNxCAxN29sKrO0kT+KQ0AJK7tDP+eaiqwpwEACFLY07837QwAQA4UGxvq0s6QUaXygOGEK5UHZj//bNopcuPdZdd3ftibdorcaK9vNa5wxhWLccVieQIACKI0AABBlAYAIIjSAAAEURoAgCBKAwAQRGlgiuve3bd6/YaPh4bTDpJ1mx57avXi9tWL2x+8cc2+d/rTjpN1PR1do+Nad/u9H5XKacfJh+HBoQ33P9rT0ZV2kKzb907/gzeuWb24fcP9jw4PDqUdZwylgamse3ffl9b+NO0UOdDT0VXad+CRbRsff6tz6W0rnn7oN06EE+jr3fnKcy/9/K9/evytzubWlo2//EPWfrNn07YXurc+3Zl2iqwbHhx68fcbl9624pFtG6Mo2vZCd9qJxlAamLIe+Mumb2/44z3LlqYdJAcuu+6qr9+/pqq2OoqiuRctiD755NBBpWFcza0t33nigemNDVEULbr84gPv7RsaHEw7VNZ9VCr/bUtPS1tr2kGy7t//ev9A/965Fy2oqq2+YvmSt1/fkalKqjQwZS1ZtOiN++69uKkp7SBMZbte3d7c2jJaIJjAlqc2ta1YOqvp7LSDZN2hg+WoUJgx89gnKmuVVGlgymqb35x2hFx67fmts5rOPv2cM9MOknV9vTtXL27ftrn7C8uuTDtL1u17p//wRx/PafEjGWTWeWdV19ZGUTRjZkNdw4y044yhNAAn9HR0bdvcffWtN4wuVTCB5taWx9/qXHnvnU/ctdbW0QkMDw51P7O5bcXS0RMhuaY0AMf0dHRtfvKZ23/xw7PmWdMJNadl/ryLF/3zzbfTDpJde3burpk+zYcq3PEliUMHywPlQ2nHGaOYdgAgE3o6ul557qXv/e4hy/OxDA0OHnhv3xXLl6QdJLt2vbq9Y936jnXrR7/c+nTnB/17r71jZbqpMutTSxLHlyoyQmkAor7enaPXGDSGEH29Ozc99tSqh++Z3tiwY+vrURSdfYE/o8d17R0rRyvC8ODQn9f+dsGlF1523VVph8qu0885c1r99B1bX7/kmrZXnntpwaUXZmqtUGkAol2vbu/f9Y/72r91/Dv3bPhZc2tLipGyrLm15YrlS77/xZujKGpadIGyxSSqqq2++tYbnrhr7ZM/ePjKm9ovuaYt7URjFMpld2OfWqk80NhQl3aK3CiVB2Y//2zaKXLj3WXXd37Ym3aK3GivbzWucMYVi3HFYiMkABBEaQAAgigNAEAQpQEACKI0AABBCnv696adAQDIgaK7CsfjlstYjCsW44rFuGIxrliMKxbLEwBAEKUBAAiiNAAAQZQGACCI0gAABFEaAIAgSgMAEERpAACCKA0AQBClAQAIojQAAEGUBgAgiNIAAARRGgCAIEoDABBEaQAAgigNAEAQpQEACKI0AABBlAYAIIjSAAAEURoAgCCFPf17084AAOTAfwFudC6svplA1AAAAABJRU5ErkJggg==" width="700" height="100" class="img_ev3q"></p>
<p><strong>循环</strong></p>
<p>按照上述步骤，分别列出 List 中心是 Item0 到 Item4 的情况，可以得到下图：</p>
<p><img loading="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfQAAAB9CAIAAADbfAZ5AAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAEXRFWHRTb2Z0d2FyZQBTbmlwYXN0ZV0Xzt0AABBPSURBVHic7d1xTJNpngfwpxfogCCnYBSzXRRKY6kmrNUIpsNdJNA1ZeV0mazDcRMTEa1zxDtxMCYnIxuMIceMa5ATkDknM6TXwYS1R6eNix5lt9PYNtIenpROpOKwNUNnqJBugU77B/dHJ3U1CrxeN8/T976f/9q/vnnzvt++fd6n/QkCgQCB15sLLKzLWEM7RcLA4eIEh4sTHC5O/op2AAAAiD/BlHeadgYAAIizJOOfHLQzME21Vo5DtHqqtfKf3v5P2ikSxh/3/x3OrtXDxcgJlmUAAHgI5Q4AwEModwAAHkK5AwDwEModAICHUO4AADzERLnb9SZ1gUpdoGqva5qfwy9mVyUSCmuaO+x6E+0grPt62vezX7cIjp1Q92oWwxHacRKDx+HSNHdEQmHaQVhn6NRGu+vioXrfpJd2nBfQL3ePw2UdGPr43hdd40axXKa78jlOqdVw3rGY+4y0U7BuMRz5zZ27jT9XLlzrIIT81oFd0ivzOFxtNR/QTpEA7HrTnM9/1anrGjcqj1b1Xepm6t6UfrmL5bJTPS1p6zIIIdKiQv9TXzgUoh2KdfNzgQfDdplCTjsI66aePZucmdm9dWuqMPm9vcXmRxO4eV+eoVOrbbmmrH2HdpAEsOfAvprm+uQUISFkyw4JWVoKzqLcX8NtGxXLZdGih2UMaw2KKmWWKJt2ENbNBIMCItiQnh59+WTGvxDG98LlSIsKz9/qEG3LpR0E/q9YKXePw6UuUDkHLbv3l9DOwjrfpPeH+cUcmZh2kMSwdUPWGqGQELIhPX19Gv5TcAViuYx2hIR0/7Y5S5SduXkj7SDPsVLuYrmsa9xY3fR+T0Mra88lmBIJhS39g4oqpTAlhXYWACCEELve5By0lB05GF2iYQQr5R6VI8vPLZR+8/AR7SDsmnJNvJWWuilXRDtIwogtxcwEg7PzC7TjAN/Y9abBG/11l8+xdlUm0Q7wgnAo5H/qK64spR2EXW7bqL69V9/eG31p7jN+752uOFlNNxWzXlqKiS3RAMSFXW+yDgyd/vQSg08K6Ze7x+EydGpr2xrT1mWMmUcIIdl5bH0AMqXiZHW0yiOh8M3W65Jd2/cc2Ec7FLtyMjP/OjX19sOHv5TLe+9ZSyT5qcJk2qGAJzwOV/SencFmJyyUu1guK64sPbP3XUKISJrH7JGCRJQqTD5dXna4+/o/fHLjxN/+zS/l2DwKceO2jXrdjy+ojsfeadR8xM4TaUHXOH4IsxzMB+AEwzo4wbAOTnAxcsLWA1UAAIgLlDsAAA+h3AEAeAjlDgDAQyh3AAAeEkx5p2lnAACAOEvC1qLlYfcVJ9gKyQm2QnKCi5ETLMsAAPAQyh0AgIdQ7gAAPIRyBwDgIZQ7AAAPodwBAHiIoXKPhMKa5g673kQ7COt8k96Lh+rVBSpNc0ckhHHPq2KZ8Kh7NYvhCO0grDN0atUFKnWB6uKhegy8XJFdb4oerva6pvm5AO04L2Co3J13LOY+/P/wCiKh8N3PdMqjVVedOkKI846FdqIEYJnwvN36r7RTJAC73jTn81916rrGjcqjVX2XulkrLKZ4HC7rwNDH977oGjeK5TLdlc+Zutlipdzn5wIPhu0yBWYprODZt9/5vdNbdkiSU4TFlaWPRsaYOp8Y1PKl4R81/9G4X0k7SALYc2BfTXN9dMrzlh0SsrQUnEW5v5ZYLjvV0xIdLiQtKvQ/9YVDIdqhnmOl3Ie1BkWVMkuUTTsI64KzASIQpK//cVgVa+cTg0ql0v++0FQowuxG+Aty20bFchlTU+SYKHffpPeH+cUcmZh2kMSQ9ZNNwpQUQkj6+ow1Gem047BOkY/z6k3cv23OEmVnbt5IOwjrPA6XukDlHLTs3l9CO8sL6Jd7JBS29A8qqpTRwgIA6ux6k3PQUnbkYHSJBpYhlsu6xo3VTe/3NLQy9QiafrlPuSbeSkvdlItvzasVW4oJzgYWAkHacYBv7HrT4I3+usvncFWuXo4sP7dQ+s3DR7SDPJdEOwBx20b17b369t7oS3Of8XvvdMXJarqpmPXSUkxsiQYgLux6k3Vg6PSnl5haPmZfOBTyP/UVV5bSDvIc/XKvOFkdrfJIKHyz9bpk1/Y9B/bRDsWuzM0bU9emjZlHdpYrrANDkl3b8cUZ4sXjcEXv2dHsq+FxuAyd2tq2xrR1GWPmEUJIdh5D33XolztwkpwiLDtysKeh9cbZtpLDqp3lCtqJgD/ctlGv+/EF1fHYO42aj8RyGcVILBPLZcWVpWf2vksIEUnzWPtQFHSN43dDy8F8AE4wrIMTDOvgBBcjJ/QfqAIAQNyh3AEAeAjlDgDAQyh3AAAeQrkDAPCQYMo7TTsDAADEWRK2Fi0Pu684wVZITrAVkhNcjJxgWQYAgIdQ7gAAPIRyBwDgIZQ7AAAPodwBAHgI5Q4AwENMlLtv0nvxUL26QKVp7oiEwrTjJAaPw4XDtRotXxoEx04Ijp342a9bvp720Y7DOrvepC5QqQtU7XVN83MB2nESQyQU1jR32PUm2kFeQL/cI6Hw3c90yqNVV506QojzjoV2ogTgcbjaaj6gnSIBaKy2p7NzC9c6lj7pbvy58p+0ff7gPO1Q7PI4XNaBoY/vfdE1bhTLZborn+PuYTWcdyzmPub+O51+uT/79ju/d3rLDklyirC4svTRyBjOp+UZOrXalmvK2ndoB0kANcVFXe/VpAqTCSG7t25dIkszQUydfS2xXHaqpyU6cUJaVBib1gvLmJ8LPBi2yxRy2kFeRr/cg7MBIhCkr/9xggnOpxVJiwrP3+oQbculHQT4zG0bFctlTI0WYtOw1qCoUmaJsmkHeRn9cid/NuX5penP8EoYe/Zmbt6/n7thQ05mJu0grPM4XOoClXPQsnt/Ce0srPNNen+YX8yRiWkHeQUmyh3gL01jtfWPOE6Xl0WXaGAZYrmsa9xY3fR+T0Orb9JLOw67IqGwpX9QUaWM3puyholyjy3FBGcDCwEsiUKcaay2tt8N9p04vi17E+0sCSNHlp9bKP3m4SPaQdg15Zp4Ky11U66IdpBXS6Id4OWlmNgSDUBcaKy23nu2/zrTkJWeRjtLIgmHQv6nvuLKUtpB2OW2jerbe/XtvdGX5j7j997pipPVdFPF0C/3zM0bU9emjZlHdpYrrANDkl3bk1OEtEMBT1gmPNF7djT7angcLkOntratMW1dxph5hBCSncfobSkLKk5WR6s8EgrfbL0u2bV9z4F9tEM9R7/ck1OEZUcO9jS03jjbVnJYtbNcQTsR8MeQ2z36R6/0/Iexd746d1aRz+LjLxaI5bLiytIze98lhIikeXWXz2G3TOISdI0zt/eeKZgPwAmGdXCCYR2c4GLkhIkHqgAAEF8odwAAHkK5AwDwEModAICHUO4AADwkmPJO084AAABxloStRcvD7itOsBWSE2yF5AQXIydYlgEA4CGUOwAAD6HcAQB4COUOAMBDKHcAAB5CuQMA8BBD5e5xuDTNHZFQmHYQ1hk6teoClbpAdfFQPaagrUhjtQmOnRAcO7H/N+3+4DztOIkhEgprmjvsehPtIKzzTXovHqpXF6gY7C5Wyt3jcLXVfEA7RQKw601zPv9Vp65r3Kg8WtV3qXt+LkA7FLssE57ee7aZK5eXPulWSMT/cku3GI7QDpUAnHcs5j78GfgKIqHw3c90yqNVV506QojzjoV2ohcwUe6GTq225Zqy9h3aQRLAngP7aprro8OqtuyQkKWl4CzK/bUU+eLbp09FxzCVSqVPZvwLYbZurxg0Pxd4MGyXKeS0g7Du2bff+b3TW3ZIklOExZWlj0bGmLp5Z6LcpUWF5291iLbl0g4CfDbkdiskYszbW9Gw1qCoUmaJsmkHYV1wNkAEgvT1Pw6r8j/1hUMhupH+HBPlLpbLaEdISPdvm7NE2ZmbN9IOwjrLhEdw7ET/iONXu3fTzsI636T3h/nFHBkmEa5K1k82CVNSCCHp6zPWZKTTjvMCJsod3oBdb3IOWsqOHMQ88RUp8sVLn3T/W83fH+6+/vW0j3YcdkVCYUv/oKJKGS0sSGgo94Rk15sGb/TXXT63KRfD6VdLnpNTnJd3/8kT2kHYNeWaeCstFSfV6sWWYoKzgYVAkHacFyTRDgCc2fUm68DQ6U8vYTI9Jwvh8JMZ/3t7i2kHYZfbNqpv79W390ZfmvuM33unK05W003FrJeWYmJLNIxAuScYj8MVvWdHs6+GZcLTojdo6mqz0tNuP3xICJFm4znha1WcrI5WeSQUvtl6XbJr+54D+2iHYlfm5o2pa9PGzCM7yxXWgSHJru1MrZGi3BOM2zbqdT++oDoee6dR8xGeSL+OIl/83t6iDf/cQAgp/Kmo78Rx7JaBeElOEZYdOdjT0HrjbFvJYdXOcgXtRC8QdI3jpwrLwXwATjCsgxMM6+AEFyMneKAKAMBDKHcAAB5CuQMA8BDKHQCAh1DuAAA8JJjyTtPOAAAAcZaErUXLw+4rTrAVkhNsheQEFyMnWJYBAOAhlDsAAA+h3AEAeAjlDgDAQyh3AAAeQrkDAPAQE+Vu6NSqC1TqAtXFQ/W+SS/tOKyz603Rw9Ve1zQ/F6AdJzEshiPqXo3GaqMdhHW+Se/FQ/XqApWmuSMSCtOOkxg8DheDh4t+udv1pjmf/6pT1zVuVB6t6rvUjcJahsfhsg4MfXzvi65xo1gu0135nLVTik2/dTi6f/8H2ilYFwmF736mUx6tuurUEUKcdyy0EyUAj8PVVvMB7RSvQL/c9xzYV9NcH51gsmWHhCwtBWdR7q8llstO9bRExzBJiwpjIxxhGf7g/JcP/ke5HSNNVvDs2+/83uktOyTJKcLiytJHI2O4dVieoVOrbbmmrH2HdpBXoF/u8MbctlGxXIZ5eyu6Njx89G1F7oYNtIOwLjgbIAJB+vofzyjcOqxIWlR4/laHaFsu7SCvwFa5379tzhJlZ27eSDsI6zwOl7pA5Ry07N5fQjsL676e9v0pFJLn5NAOkhhiU55fmv4Mr8TyhEuGyt2uNzkHLWVHDjI1ZJZNYrmsa9xY3fR+T0MrHkEvYzEc+fevvqp9++01QpxU8P8LK+Vu15sGb/TXXT63KVdEO0vCyJHl5xZKv3n4iHYQdjmmptampGzL3kQ7SMKILcUEZwMLgSDtOPDmkmgHIIQQu95kHRg6/eklLB9zEg6F/E99xZWltIOwa8jt/lA38KFuIPqy+/d/eDwz0/SLCrqpmPXSUkxsiQYSEf1y9zhc0Xt2NPtqeBwuQ6e2tq0xbV3GmHmEEJKdh+86r9X0i4polS+GI6f7bpZI8muKi2iHYlfm5o2pa9PGzCM7yxXWgSHJru1YI01c9MvdbRv1uh9fUB2PvdOo+YjlxxR0ieWy4srSM3vfJYSIpHn4UIQ4Sk4Rlh052NPQeuNsW8lh1c5yBe1E8OYEXeNG2hmYhvkAnGBYBycY1sEJLkZOWHmgCgAAcYRyBwDgIZQ7AAAPodwBAHgI5Q4AwEOCKe807QwAABBnSesy1tDOwLS5wAIO0erhcHGCw8UJDhcnWJYBAOCh/wX8mx7aTtQ2mgAAAABJRU5ErkJggg==" width="500" height="125" class="img_ev3q"></p>
<p>一个循环轮播就实现了。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="代码实现">代码实现<a href="https://lijunlin2022.github.io/blog/2023/12/14/loop-swiper#%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0" class="hash-link" aria-label="Direct link to 代码实现" title="Direct link to 代码实现">​</a></h2>]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[移动端适配 lib-flexible 和 postcss-pxtorem]]></title>
            <link>https://lijunlin2022.github.io/blog/2023/11/14/px-to-rem</link>
            <guid>https://lijunlin2022.github.io/blog/2023/11/14/px-to-rem</guid>
            <pubDate>Tue, 14 Nov 2023 00:00:00 GMT</pubDate>
            <description><![CDATA[最近看到，一般移动端适配会配合使用阿里的 lib-flexible 和 postcss-pxtorem 插件。]]></description>
            <content:encoded><![CDATA[<p>最近看到，一般移动端适配会配合使用阿里的 <a href="https://github.com/amfe/lib-flexible" target="_blank" rel="noopener noreferrer">lib-flexible</a> 和 <a href="https://www.npmjs.com/package/postcss-pxtorem" target="_blank" rel="noopener noreferrer">postcss-pxtorem</a> 插件。</p>
<p>我们假设我们的手机屏幕和设计稿都是 750px 的。</p>
<p>使用 lib-flexible，会将 html 的 font-size 设置为屏幕宽度 <code>clientWidth</code> 的 1/10。也就是说 1rem = 75px;</p>
<p>这时候，如果设计稿上有一个元素 width 是 200px 的，为了让手机屏幕能够适配。我们需要写 CSS 的时候，直接将 width 写成 (200 / 75)rem。</p>
<p>当然，手动将 px 换算为 rem 还是对我们写代码还是很不友好。这时候就可以使用 postcss-pxtorem 了。我们将这个插件配置的 rootValue 写为 75px，这个插件会自动将我们的 css 从 px 换算为 rem。</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockTitle_Ktv7">postcss.config.js</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token keyword module" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token imports">pxtorem</span><span class="token plain"> </span><span class="token keyword module" style="color:hsl(301, 63%, 40%)">from</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'postcss-pxtorem'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword module" style="color:hsl(301, 63%, 40%)">export</span><span class="token plain"> </span><span class="token keyword module" style="color:hsl(301, 63%, 40%)">default</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token literal-property property" style="color:hsl(5, 74%, 59%)">plugins</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token function" style="color:hsl(221, 87%, 60%)">pxtorem</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> </span><span class="token literal-property property" style="color:hsl(5, 74%, 59%)">rootValue</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">75</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token literal-property property" style="color:hsl(5, 74%, 59%)">propList</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">[</span><span class="token string" style="color:hsl(119, 34%, 47%)">'*'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">]</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token literal-property property" style="color:hsl(5, 74%, 59%)">selectorBlackList</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">[</span><span class="token string" style="color:hsl(119, 34%, 47%)">'html'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">]</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[requestAnimationFrame 实现平滑滚动]]></title>
            <link>https://lijunlin2022.github.io/blog/2023/11/08/smoothly-scroll</link>
            <guid>https://lijunlin2022.github.io/blog/2023/11/08/smoothly-scroll</guid>
            <pubDate>Wed, 08 Nov 2023 00:00:00 GMT</pubDate>
            <description><![CDATA[大家好，我俊霖。]]></description>
            <content:encoded><![CDATA[<p>大家好，我俊霖。</p>
<p>最近接到一个修复通知，iOS 15.4 ~ 17，使用 CSS <code>scroll-behavior: smooth</code> 或 JavaScript 的  <code>behavior: 'smooth'</code> 可能导致 iOS App Crash。</p>
<p>我维护的 H5 有个锚定功能，是使用 <code>element.scrollIntoView({ behavior: 'smooth' })</code> 来实现锚定并且带上动画的。现在得换种方法实现锚定。</p>
<p>参考修复通知，我决定使用 <code>requestAnimationFrame</code> 来实现动画。</p>
<p>首先，我准备改用 <code>window.scrollTo()</code> 替换掉 <code>scrollIntoView</code> 实现锚定。</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token keyword" style="color:hsl(301, 63%, 40%)">const</span><span class="token plain"> targetPosition </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> element</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token property-access">offsetTop</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token dom variable" style="color:hsl(221, 87%, 60%)">window</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token method function property-access" style="color:hsl(221, 87%, 60%)">scrollTo</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> targetPosition</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="requestanimationframe">requestAnimationFrame<a href="https://lijunlin2022.github.io/blog/2023/11/08/smoothly-scroll#requestanimationframe" class="hash-link" aria-label="Direct link to requestAnimationFrame" title="Direct link to requestAnimationFrame">​</a></h2>
<p>下面这段代码的作用是：将页面平滑滚动到某个位置。它首先会获取当前滚动条的位置，然后计算目标位置和当前位置的距离，之后将这个距离分为若干个部分，每隔一段时间就滚动一部分，直到滚动到目标位置。</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token keyword" style="color:hsl(301, 63%, 40%)">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:hsl(221, 87%, 60%)">smoothScrollTo</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token parameter">targetPosition</span><span class="token parameter punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token parameter"> part</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:hsl(221, 87%, 60%)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">const</span><span class="token plain"> startPosition </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token dom variable" style="color:hsl(221, 87%, 60%)">document</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token property-access">documentElement</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token property-access">scrollTop</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">||</span><span class="token plain"> </span><span class="token dom variable" style="color:hsl(221, 87%, 60%)">document</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token property-access">body</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token property-access">scrollTop</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">const</span><span class="token plain"> distance </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> targetPosition </span><span class="token operator" style="color:hsl(221, 87%, 60%)">-</span><span class="token plain"> startPosition</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">const</span><span class="token plain"> step </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token known-class-name class-name" style="color:hsl(35, 99%, 36%)">Math</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token method function property-access" style="color:hsl(221, 87%, 60%)">floor</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">distance </span><span class="token operator" style="color:hsl(221, 87%, 60%)">/</span><span class="token plain"> part</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">let</span><span class="token plain"> currentPosition </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> startPosition</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">const</span><span class="token plain"> t </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">setInterval</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:hsl(221, 87%, 60%)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword control-flow" style="color:hsl(301, 63%, 40%)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token known-class-name class-name" style="color:hsl(35, 99%, 36%)">Math</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token method function property-access" style="color:hsl(221, 87%, 60%)">abs</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">targetPosition </span><span class="token operator" style="color:hsl(221, 87%, 60%)">-</span><span class="token plain"> currentPosition</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">&gt;</span><span class="token plain"> </span><span class="token known-class-name class-name" style="color:hsl(35, 99%, 36%)">Math</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token method function property-access" style="color:hsl(221, 87%, 60%)">abs</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">step</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      currentPosition </span><span class="token operator" style="color:hsl(221, 87%, 60%)">+=</span><span class="token plain"> step</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token dom variable" style="color:hsl(221, 87%, 60%)">window</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token method function property-access" style="color:hsl(221, 87%, 60%)">scrollTo</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> currentPosition</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:hsl(301, 63%, 40%)">else</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token function" style="color:hsl(221, 87%, 60%)">clearInterval</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">t</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token dom variable" style="color:hsl(221, 87%, 60%)">window</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token method function property-access" style="color:hsl(221, 87%, 60%)">scrollTo</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> targetPosition</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">60</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>我对 <code>requestAnimationFrame</code> 的理解，大概就是把它当做了一个 <code>setInterval</code> 的替代品。</p>
<p>首先我用 <code>setInterval</code> 实现了一个锚定的滚动动画：</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token keyword" style="color:hsl(301, 63%, 40%)">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:hsl(221, 87%, 60%)">smoothScrollTo</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token parameter">targetPosition</span><span class="token parameter punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token parameter"> part</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:hsl(221, 87%, 60%)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">const</span><span class="token plain"> startPosition </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token dom variable" style="color:hsl(221, 87%, 60%)">document</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token property-access">documentElement</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token property-access">scrollTop</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">||</span><span class="token plain"> </span><span class="token dom variable" style="color:hsl(221, 87%, 60%)">document</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token property-access">body</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token property-access">scrollTop</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">const</span><span class="token plain"> distance </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> targetPosition </span><span class="token operator" style="color:hsl(221, 87%, 60%)">-</span><span class="token plain"> startPosition</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">const</span><span class="token plain"> step </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token known-class-name class-name" style="color:hsl(35, 99%, 36%)">Math</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token method function property-access" style="color:hsl(221, 87%, 60%)">floor</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">distance </span><span class="token operator" style="color:hsl(221, 87%, 60%)">/</span><span class="token plain"> part</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">let</span><span class="token plain"> currentPosition </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> startPosition</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">let</span><span class="token plain"> animationFrameId </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token keyword null nil" style="color:hsl(301, 63%, 40%)">null</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:hsl(221, 87%, 60%)">animation</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:hsl(221, 87%, 60%)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword control-flow" style="color:hsl(301, 63%, 40%)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token known-class-name class-name" style="color:hsl(35, 99%, 36%)">Math</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token method function property-access" style="color:hsl(221, 87%, 60%)">abs</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">targetPosition </span><span class="token operator" style="color:hsl(221, 87%, 60%)">-</span><span class="token plain"> currentPosition</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">&gt;</span><span class="token plain"> </span><span class="token known-class-name class-name" style="color:hsl(35, 99%, 36%)">Math</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token method function property-access" style="color:hsl(221, 87%, 60%)">abs</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">step</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      currentPosition </span><span class="token operator" style="color:hsl(221, 87%, 60%)">+=</span><span class="token plain"> step</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token dom variable" style="color:hsl(221, 87%, 60%)">window</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token method function property-access" style="color:hsl(221, 87%, 60%)">scrollTo</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> currentPosition</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      animationFrameId </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token dom variable" style="color:hsl(221, 87%, 60%)">window</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token method function property-access" style="color:hsl(221, 87%, 60%)">requestAnimationFrame</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">animation</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:hsl(301, 63%, 40%)">else</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token dom variable" style="color:hsl(221, 87%, 60%)">window</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token method function property-access" style="color:hsl(221, 87%, 60%)">scrollTo</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> targetPosition</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token dom variable" style="color:hsl(221, 87%, 60%)">window</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token method function property-access" style="color:hsl(221, 87%, 60%)">cancelAnimationFrame</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">animationFrameId</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token function" style="color:hsl(221, 87%, 60%)">animation</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>]]></content:encoded>
            <category>requestAnimationFrame</category>
        </item>
        <item>
            <title><![CDATA[IntersectionObserver 无限滚动]]></title>
            <link>https://lijunlin2022.github.io/blog/2023/08/20/intersection-observer-infinite-scroll</link>
            <guid>https://lijunlin2022.github.io/blog/2023/08/20/intersection-observer-infinite-scroll</guid>
            <pubDate>Sun, 20 Aug 2023 00:00:00 GMT</pubDate>
            <description><![CDATA[大家好，我俊霖。]]></description>
            <content:encoded><![CDATA[<p>大家好，我俊霖。</p>
<p>日常开发中，我们常常需要实现一个无限滚动的效果。如下所示：</p>
<p><img loading="lazy" src="https://lijunlin2022.github.io/assets/images/01-intersection-observer-pullup-64fe80b2b5864f262f18b52e5cd55798.gif" width="402" height="464" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="intersectionobserver">IntersectionObserver<a href="https://lijunlin2022.github.io/blog/2023/08/20/intersection-observer-infinite-scroll#intersectionobserver" class="hash-link" aria-label="Direct link to IntersectionObserver" title="Direct link to IntersectionObserver">​</a></h2>
<p>底部的元素出现到视口内部时，就可以触发 <code>pullUp</code> 函数。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="封装-scrollview">封装 ScrollView<a href="https://lijunlin2022.github.io/blog/2023/08/20/intersection-observer-infinite-scroll#%E5%B0%81%E8%A3%85-scrollview" class="hash-link" aria-label="Direct link to 封装 ScrollView" title="Direct link to 封装 ScrollView">​</a></h2>
<div class="language-jsx codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-jsx codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token keyword" style="color:hsl(301, 63%, 40%)">function</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:hsl(221, 87%, 60%)">ScrollView</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token parameter punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token parameter"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token parameter">  children</span><span class="token parameter punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token parameter"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token parameter">  pullUp</span><span class="token parameter punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token parameter"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token parameter">  bottomStatus</span><span class="token parameter punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token parameter"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token parameter">  bottomStyle</span><span class="token parameter punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token parameter"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token parameter"></span><span class="token parameter punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">const</span><span class="token plain"> bottomRef </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">useRef</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token keyword null nil" style="color:hsl(301, 63%, 40%)">null</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token function" style="color:hsl(221, 87%, 60%)">useEffect</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:hsl(221, 87%, 60%)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">const</span><span class="token plain"> observer </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">IntersectionObserver</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token parameter punctuation" style="color:hsl(119, 34%, 47%)">[</span><span class="token parameter">entry</span><span class="token parameter punctuation" style="color:hsl(119, 34%, 47%)">]</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:hsl(221, 87%, 60%)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token keyword control-flow" style="color:hsl(301, 63%, 40%)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">bottomStatus </span><span class="token operator" style="color:hsl(221, 87%, 60%)">===</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'LOADING'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token keyword control-flow" style="color:hsl(301, 63%, 40%)">return</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token keyword control-flow" style="color:hsl(301, 63%, 40%)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">entry</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token property-access">isIntersecting</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">&amp;&amp;</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">typeof</span><span class="token plain"> pullUp </span><span class="token operator" style="color:hsl(221, 87%, 60%)">===</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'function'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token function" style="color:hsl(221, 87%, 60%)">pullUp</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token literal-property property" style="color:hsl(5, 74%, 59%)">root</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token keyword null nil" style="color:hsl(301, 63%, 40%)">null</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token literal-property property" style="color:hsl(5, 74%, 59%)">rootMargin</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'0px'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token literal-property property" style="color:hsl(5, 74%, 59%)">thresolds</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">[</span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">]</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword control-flow" style="color:hsl(301, 63%, 40%)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">bottomRef</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token property-access">current</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      observer</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token method function property-access" style="color:hsl(221, 87%, 60%)">observe</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">bottomRef</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token property-access">current</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword control-flow" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:hsl(221, 87%, 60%)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token keyword control-flow" style="color:hsl(301, 63%, 40%)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">bottomRef</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token property-access">current</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        observer</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token method function property-access" style="color:hsl(221, 87%, 60%)">unobserve</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">bottomRef</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token property-access">current</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">[</span><span class="token plain">pullUp</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">]</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token keyword control-flow" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain-text"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain-text">      </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">div</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain">children</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">div</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain-text"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain-text">      </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">div</span><span class="token tag" style="color:hsl(5, 74%, 59%)"> </span><span class="token tag attr-name" style="color:hsl(35, 99%, 36%)">style</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:hsl(119, 34%, 47%)">=</span><span class="token tag script language-javascript punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token tag script language-javascript" style="color:hsl(5, 74%, 59%)">bottomStyle</span><span class="token tag script language-javascript punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain-text"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain-text">        </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain">bottomStatus </span><span class="token operator" style="color:hsl(221, 87%, 60%)">===</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'LOADING'</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">&amp;&amp;</span><span class="token plain"> </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag class-name" style="color:hsl(35, 99%, 36%)">LoadingView</span><span class="token tag" style="color:hsl(5, 74%, 59%)"> </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">/&gt;</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain-text"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain-text">        </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain">bottomStatus </span><span class="token operator" style="color:hsl(221, 87%, 60%)">===</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'ERROR'</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">&amp;&amp;</span><span class="token plain"> </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag class-name" style="color:hsl(35, 99%, 36%)">ErrorView</span><span class="token tag" style="color:hsl(5, 74%, 59%)"> </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">/&gt;</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain-text"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain-text">        </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain">bottomStatus </span><span class="token operator" style="color:hsl(221, 87%, 60%)">===</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'NO_MORE'</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">&amp;&amp;</span><span class="token plain"> </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag class-name" style="color:hsl(35, 99%, 36%)">NoMoreView</span><span class="token tag" style="color:hsl(5, 74%, 59%)"> </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">/&gt;</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain-text"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain-text">        </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain">bottomStatus </span><span class="token operator" style="color:hsl(221, 87%, 60%)">===</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'HAS_MORE'</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">&amp;&amp;</span><span class="token plain"> </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">div</span><span class="token tag" style="color:hsl(5, 74%, 59%)"> </span><span class="token tag attr-name" style="color:hsl(35, 99%, 36%)">ref</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:hsl(119, 34%, 47%)">=</span><span class="token tag script language-javascript punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token tag script language-javascript" style="color:hsl(5, 74%, 59%)">bottomRef</span><span class="token tag script language-javascript punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">div</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain-text"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain-text">      </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">div</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain-text"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain-text">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>]]></content:encoded>
            <category>IntersectionObserver</category>
        </item>
        <item>
            <title><![CDATA[跟随图标的多行文本，如何溢出显示省略号]]></title>
            <link>https://lijunlin2022.github.io/blog/2023/08/15/texts-follow-icon</link>
            <guid>https://lijunlin2022.github.io/blog/2023/08/15/texts-follow-icon</guid>
            <pubDate>Tue, 15 Aug 2023 00:00:00 GMT</pubDate>
            <description><![CDATA[带图标的名字，是电商商品的常见组成部分，一般被用来区分特殊商品和普通商品。例如掘金的 VIP 课程、京东的自营商品等等。由于商品名称普遍比较长，UI 往往会要求程序员实现单行截断（双行截断）并显示省略号。]]></description>
            <content:encoded><![CDATA[<p>带图标的名字，是电商商品的常见组成部分，一般被用来区分特殊商品和普通商品。例如掘金的 VIP 课程、京东的自营商品等等。由于商品名称普遍比较长，UI 往往会要求程序员实现单行截断（双行截断）并显示省略号。</p>
<p><img loading="lazy" src="https://lijunlin2022.github.io/assets/images/juejin-2fe26724805d4b341bb49f98098e01db.png" width="359" height="117" class="img_ev3q"></p>
<p><img loading="lazy" src="https://lijunlin2022.github.io/assets/images/jd-41890352cdd65ff1330e7e590b0ac80b.png" width="212" height="316" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="文本缩进和绝对定位">文本缩进和绝对定位。<a href="https://lijunlin2022.github.io/blog/2023/08/15/texts-follow-icon#%E6%96%87%E6%9C%AC%E7%BC%A9%E8%BF%9B%E5%92%8C%E7%BB%9D%E5%AF%B9%E5%AE%9A%E4%BD%8D" class="hash-link" aria-label="Direct link to 文本缩进和绝对定位。" title="Direct link to 文本缩进和绝对定位。">​</a></h2>
<p>第一种方法，先给文字设置文本缩进属性 <code>text-indent</code>，空出一定的位置，然后再给图标设置绝对定位属性，将图标移动到刚才空出的位置上。</p>
<p>具体写法可以看例子：</p>
<p><a href="https://codepen.io/lijunlin2022/pen/abQewmE" target="_blank" rel="noopener noreferrer">文本缩进和绝对定位 | codepen</a>。</p>
<p><img loading="lazy" src="data:image/png;base64,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" width="200" height="70" class="img_ev3q"></p>
<p>这种方法优点是简单易懂，缺点是，**需要先实现知道图标的宽度，才能为图片空出准确的位置。**因此一旦下发的图标宽度有变化，就需要重新修改代码。</p>
<p>弥补这个缺陷的一个做法是，后端既下发图标的链接、也下发图标的宽度。这样即使图标改变了，前端代码也不需要改变。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="浮动和文字环绕图片">浮动和文字环绕图片<a href="https://lijunlin2022.github.io/blog/2023/08/15/texts-follow-icon#%E6%B5%AE%E5%8A%A8%E5%92%8C%E6%96%87%E5%AD%97%E7%8E%AF%E7%BB%95%E5%9B%BE%E7%89%87" class="hash-link" aria-label="Direct link to 浮动和文字环绕图片" title="Direct link to 浮动和文字环绕图片">​</a></h2>
<p>第二种方法，利用浮动 <code>float</code> 的基础性质。浮动的最初用途，并不是做各种各样的布局，而是用来实现文字环绕图片。</p>
<p>具体写法可以看例子：</p>
<p><a href="https://codepen.io/lijunlin2022/pen/abQewmE" target="_blank" rel="noopener noreferrer">浮动和文字环绕图片 | codepen</a>。</p>
<p>这种方法的优点是可以实现图标的自适应，完全由图标撑开文字。缺点是里面用了一些 CSS 不常见的用法。</p>
<p>这种方法有两点需要注意：</p>
<p>其一，控制文本溢出的 css 类（例子中是 <code>ellipsis</code>），一定要放在图片和文字的父元素上。这是因为 <code>ellipsis</code> 自带 <code>display: -webkit-box;</code> 布局，如果此不放置在父元素上，会导致文字直接另起一行。</p>
<p><img loading="lazy" src="data:image/png;base64,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" width="200" height="100" class="img_ev3q"></p>
<p>其二，为了兼容 Safari，需要给图片和文字的父元素，再增加一层父元素，且把控制文本溢出的 css 类放到新增的元素上。这是因为 <code>display: -webkit-box;</code>，在 Safari 上会影响图片和文本的布局。<sup><a href="https://lijunlin2022.github.io/blog/2023/08/15/texts-follow-icon#user-content-fn-1-942f82" id="user-content-fnref-1-942f82" data-footnote-ref="true" aria-describedby="footnote-label">1</a></sup></p>
<section data-footnotes="true" class="footnotes"><h2 class="anchor anchorWithStickyNavbar_LWe7 sr-only" id="footnote-label">Footnotes<a href="https://lijunlin2022.github.io/blog/2023/08/15/texts-follow-icon#footnote-label" class="hash-link" aria-label="Direct link to Footnotes" title="Direct link to Footnotes">​</a></h2>
<ol>
<li id="user-content-fn-1-942f82">
<p><a href="https://www.51cto.com/article/686659.html" target="_blank" rel="noopener noreferrer">-Webkit-Box 在 Safari 中出现的兼容性问题</a> <a href="https://lijunlin2022.github.io/blog/2023/08/15/texts-follow-icon#user-content-fnref-1-942f82" data-footnote-backref="" aria-label="Back to reference 1" class="data-footnote-backref">↩</a></p>
</li>
</ol>
</section>]]></content:encoded>
            <category>css</category>
        </item>
        <item>
            <title><![CDATA[移动端 H5 Tab 如何滚动居中]]></title>
            <link>https://lijunlin2022.github.io/blog/2023/07/30/tab-scroll-to-center</link>
            <guid>https://lijunlin2022.github.io/blog/2023/07/30/tab-scroll-to-center</guid>
            <pubDate>Sun, 30 Jul 2023 00:00:00 GMT</pubDate>
            <description><![CDATA[Tab 是用户界面的一部分，外观是一行或者一列整齐的选项（Tab Item）。当用户点击某个 Item 时，Item 的下方或者右侧会展示新的内容。]]></description>
            <content:encoded><![CDATA[<p>Tab 是用户界面的一部分，外观是一行或者一列整齐的选项（Tab Item）。当用户点击某个 Item 时，Item 的下方或者右侧会展示新的内容。</p>
<p>Tab 在 PC 端和移动端设备上都很常见，不过移动端的 Tab 会比 PC 端更复杂。为什么呢？因为移动端设备屏幕较窄，往往只能展示 4 ~ 7 个 Item。考虑到用户体验，UI 往往要求程序员额外实现一个效果——点击 Item 后，Item 需要滚动到屏幕中央，具体请看下方的拼多多录屏。</p>
<p><img loading="lazy" src="https://lijunlin2022.github.io/assets/images/pdd-bbe07676c502413e147ffb0b5a48f9e0.gif" width="402" height="281" class="img_ev3q"></p>
<p>如果你想实现移动端 Tab 滚动居中，本文或许会对你有所帮助。不过阅读本文前，本文还对读者还有两个小要求。</p>
<ol>
<li>读者需要明白 Tab 点击高亮如何实现。因为本文只会解释 Tab 滚动原理，不会关注 UI 样式。</li>
<li>读者需要熟悉 Vue，React 或者微信小程序。因为本文示例代码不是原生 JS，而是 Vue、React 和微信小程序。</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="tab-滚动的本质">Tab 滚动的本质<a href="https://lijunlin2022.github.io/blog/2023/07/30/tab-scroll-to-center#tab-%E6%BB%9A%E5%8A%A8%E7%9A%84%E6%9C%AC%E8%B4%A8" class="hash-link" aria-label="Direct link to Tab 滚动的本质" title="Direct link to Tab 滚动的本质">​</a></h2>
<p>Tab 滚动，看似是 Item 在滚动，实质是包裹着 Item 的容器在滚动。</p>
<p>下图是 Item 4 从手机屏幕右侧滚动到屏幕左侧的示意图。开始时，包裹 Tab 的容器紧贴手机屏幕左侧，此时 Item 4 位于屏幕右侧。接着容器逐渐往左滚动，Item 4 也往左移动，当 Item 4 恰好位于手机屏幕的中央，手机屏幕左侧到容器左侧的距离就是 distance。</p>
<p><img loading="lazy" src="https://lijunlin2022.github.io/assets/images/scroll-left-c0b4e3e5ef952e43a5dc0832ce6effd3.png" width="875" height="372" class="img_ev3q"></p>
<p>在 HTML 中，我们可以使用 <a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Element/scrollLeft" target="_blank" rel="noopener noreferrer">Element.scrollLeft</a> 来读取和设置元素滚动条到元素左边的位置。因此，只要我们能计算出某个 Item 居中时 distance，就可以让该 Item 居中。那么我们应该如何计算呢？</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="tab-居中时容器应该滚动的距离">Tab 居中时容器应该滚动的距离<a href="https://lijunlin2022.github.io/blog/2023/07/30/tab-scroll-to-center#tab-%E5%B1%85%E4%B8%AD%E6%97%B6%E5%AE%B9%E5%99%A8%E5%BA%94%E8%AF%A5%E6%BB%9A%E5%8A%A8%E7%9A%84%E8%B7%9D%E7%A6%BB" class="hash-link" aria-label="Direct link to Tab 居中时容器应该滚动的距离" title="Direct link to Tab 居中时容器应该滚动的距离">​</a></h2>
<p>下图是 Item 4 在手机屏幕居中时的示意图，屏幕中央有一条线，它把 Item 4 分为左右等宽的两部分，同时也把手机屏幕分为左右等宽的两部分。Item 4 一半的宽度就是 <code>halfItemWidth</code>，而手机屏幕一半的宽度就是 <code>halfScreenWidth</code>。</p>
<p>我们把 Item 4 左侧到容器左侧的距离称为 <code>itemOffsetLeft</code>，手机屏幕到容器左侧的距离称为 <code>distance</code>。</p>
<p><img loading="lazy" src="https://lijunlin2022.github.io/assets/images/calculate-scroll-left-3664016f8945708fdc0b59f9fe16d043.png" width="645" height="541" class="img_ev3q"></p>
<p>观察示意图的几何关系，不难看出这四个值满足如下等式：</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">distance + halfScreenWidth = itemOffsetLeft + halfItemWidth</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>稍加推导，就可以得到计算 distance 的方法。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">distance = itemOffsetLeft + halfItemWidth - halfScreenWidth</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>下面我们来看在实际代码中，<code>itemOffsetLeft</code>，<code>halfItemWidth</code> 和 <code>halfScreenWidth</code> 应该如何获取。</p>
<ul>
<li><code>itemOffsetLeft</code>，你可以将 <a href="https://developer.mozilla.org/zh-CN/docs/Web/API/HTMLElement/offsetLeft" target="_blank" rel="noopener noreferrer">HTMLElement.offsetLeft</a> 作它的值。</li>
<li><code>halfItemWidth</code>，你可以把 <a href="https://developer.mozilla.org/zh-CN/docs/Web/API/HTMLElement/offsetWidth" target="_blank" rel="noopener noreferrer">HTMLElement.offsetWidth</a> 除以 2 后作它的值。也可以调用 <a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Element/getBoundingClientRect" target="_blank" rel="noopener noreferrer">Element.getBoundingClientRect()</a> 获取一个对象 <code>eleRect</code>，<code>eleRect.width / 2</code> 也可以作它的值。</li>
<li><code>halfScreenWidth</code>，你可以先调用 <a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Window/innerWidth" target="_blank" rel="noopener noreferrer">window.innerWidth</a> 获取手机屏幕的完整宽度，再把宽度除以 2 作它的值。</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="react-版-tab-滚动居中">React 版 Tab 滚动居中<a href="https://lijunlin2022.github.io/blog/2023/07/30/tab-scroll-to-center#react-%E7%89%88-tab-%E6%BB%9A%E5%8A%A8%E5%B1%85%E4%B8%AD" class="hash-link" aria-label="Direct link to React 版 Tab 滚动居中" title="Direct link to React 版 Tab 滚动居中">​</a></h2>
<p>现在我们给出一个 React 实现滚动居中的例子：</p>
<p><a href="https://codesandbox.io/s/center-the-scrollable-tab-using-scrollto-22939z" target="_blank" rel="noopener noreferrer">Tab 滚动居中 | codesandbox</a></p>
<div class="language-jsx codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-jsx codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token keyword" style="color:hsl(301, 63%, 40%)">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:hsl(221, 87%, 60%)">tabClick</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token parameter">index</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:hsl(221, 87%, 60%)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token function" style="color:hsl(221, 87%, 60%)">setActiveIndex</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">index</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">const</span><span class="token plain"> tabList </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> tabListRef</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token property-access">current</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">const</span><span class="token plain"> tab </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> tabList</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token property-access">children</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">[</span><span class="token plain">index</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">const</span><span class="token plain"> tabRect </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> tab</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token method function property-access" style="color:hsl(221, 87%, 60%)">getBoundingClientRect</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">const</span><span class="token plain"> scrollLeft </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    tab</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token property-access">offsetLeft</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">+</span><span class="token plain"> tabRect</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token property-access">width</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">/</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">2</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">-</span><span class="token plain"> </span><span class="token dom variable" style="color:hsl(221, 87%, 60%)">window</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token property-access">innerWidth</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">/</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">2</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  tabList</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token property-access">scrollLeft</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> scrollLeft</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>在这个例子中，我们利用 <code>useRef()</code> 生成 <code>tabListRef</code>，再通过 <code>tabListRef.current.children[index]</code> 获取到点击的 Tab 实例。</p>
<p>此外，我们利用 <code>tab.getBoundingClientRect().width</code> 替代了 <code>tab.offsetWidth</code>，二者的值是一致的。</p>
<p>最后，需要由父容器 tabList 直接调用 <code>scrollTo()</code> 方法。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="微信小程序版-tab-滚动居中">微信小程序版 Tab 滚动居中<a href="https://lijunlin2022.github.io/blog/2023/07/30/tab-scroll-to-center#%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E7%89%88-tab-%E6%BB%9A%E5%8A%A8%E5%B1%85%E4%B8%AD" class="hash-link" aria-label="Direct link to 微信小程序版 Tab 滚动居中" title="Direct link to 微信小程序版 Tab 滚动居中">​</a></h2>
<p>现在我们给出微信小程序中实现滚动居中的例子：</p>
<p><a href="https://developers.weixin.qq.com/s/npBjVpmj7XKc" target="_blank" rel="noopener noreferrer">Tab 滚动居中 | 微信小程序</a></p>
<p>微信小程序 <code>scroll-view</code> 组件中，有 <code>scroll-left</code> 这个属性，是指滚动条距离视口左边的距离。如果想实现 Tab 居中，同样可以利用上文我们提到的公式来计算。</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token function" style="color:hsl(221, 87%, 60%)">tabClick</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token parameter">e</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">const</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> </span><span class="token literal-property property" style="color:hsl(5, 74%, 59%)">dataset</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> index </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> offsetLeft </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> e</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token property-access">currentTarget</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">const</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> windowWidth </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> wx</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token method function property-access" style="color:hsl(221, 87%, 60%)">getSystemInfoSync</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">const</span><span class="token plain"> query </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> wx</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token method function property-access" style="color:hsl(221, 87%, 60%)">createSelectorQuery</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  query</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token method function property-access" style="color:hsl(221, 87%, 60%)">select</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token template-string template-punctuation string" style="color:hsl(119, 34%, 47%)">`</span><span class="token template-string string" style="color:hsl(119, 34%, 47%)">#item-</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:hsl(119, 34%, 47%)">${</span><span class="token template-string interpolation">index</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token template-string template-punctuation string" style="color:hsl(119, 34%, 47%)">`</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token method function property-access" style="color:hsl(221, 87%, 60%)">boundingClientRect</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  query</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token method function property-access" style="color:hsl(221, 87%, 60%)">exec</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token parameter">res</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:hsl(221, 87%, 60%)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">const</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> width </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> res</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">[</span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">const</span><span class="token plain"> scrollLeft </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> offsetLeft </span><span class="token operator" style="color:hsl(221, 87%, 60%)">+</span><span class="token plain"> width </span><span class="token operator" style="color:hsl(221, 87%, 60%)">/</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">2</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">-</span><span class="token plain"> windowWidth </span><span class="token operator" style="color:hsl(221, 87%, 60%)">/</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">2</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">this</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token method function property-access" style="color:hsl(221, 87%, 60%)">setData</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token literal-property property" style="color:hsl(5, 74%, 59%)">currentView</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> index</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      scrollLeft</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>由于小程序中的 API 和浏览器中的 API 差异比较大，因此需要我们做一些调整，主要需要注意的点如下：</p>
<ul>
<li>Tab 距离父容器左边的距离 <code>offsetLeft</code> 要从 <code>e.currentTarget</code> 中获取。</li>
<li>视口的宽度需要从 <code>wx.getSystemInfoSync()</code> 中获取。</li>
<li>Tab 自身的宽度，需要使用 <code>wx.createSelectorQuery()</code> 选取到目标元素后，从 <code>exec()</code> 的执行结果中获取。</li>
</ul>
<p>不过殊途同归，微信小程序 Tab 的滚动居中，和 React Tab 的滚动居中，最终都可以用同样的原理实现。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="vue2-版-tab-滚动居中">Vue2 版 Tab 滚动居中<a href="https://lijunlin2022.github.io/blog/2023/07/30/tab-scroll-to-center#vue2-%E7%89%88-tab-%E6%BB%9A%E5%8A%A8%E5%B1%85%E4%B8%AD" class="hash-link" aria-label="Direct link to Vue2 版 Tab 滚动居中" title="Direct link to Vue2 版 Tab 滚动居中">​</a></h2>
<p><a href="https://codesandbox.io/s/vue-tab-scroll-to-center-qxw4vc" target="_blank" rel="noopener noreferrer">Tab 滚动居中 | Vue2</a></p>]]></content:encoded>
            <category>react</category>
            <category>miniprogram</category>
        </item>
    </channel>
</rss>