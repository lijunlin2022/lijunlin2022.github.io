"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([["4921"],{92849:function(e,n,r){r.r(n),r.d(n,{default:()=>D});var s=r("85893"),t=r("50065"),i=r("95895");let a=r.p+"static/image/asp1.9057e18c.png",c=r.p+"static/image/asp2.2ae5e202.png",d=r.p+"static/image/asp3.965cef75.png",p=r.p+"static/image/asp4.ed7cb2d3.png",l=r.p+"static/image/asp5.f42dec99.png",o=r.p+"static/image/asp6.5f2c7264.png",h=r.p+"static/image/asp7.9e098716.png",x=r.p+"static/image/asp8.be0e4c47.png",m=r.p+"static/image/asp9.8a6e221b.png",j=r.p+"static/image/asp10.6b44a875.png",u=r.p+"static/image/asp11.bb7b1d56.png",b=r.p+"static/image/asp12.1752fdc6.png",g=r.p+"static/image/asp13.ecf71a72.png";function f(e){let n=Object.assign({h2:"h2",a:"a",p:"p",img:"img",code:"code",pre:"pre"},(0,t.ah)(),e.components);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(n.h2,{id:"修改-iis-配置将错误信息发送到浏览器",children:[(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#修改-iis-配置将错误信息发送到浏览器",children:"#"}),"修改 IIS 配置，将错误信息发送到浏览器"]}),"\n",(0,s.jsx)(i.Z,{defaultLocale:"zh-CN"}),"\n",(0,s.jsx)(n.p,{children:"此步骤非必要，但可以方便调试，故放在第一步"}),"\n",(0,s.jsx)(n.p,{children:"直接看图："}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:a})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:c})}),"\n",(0,s.jsxs)(n.h2,{id:"创建数据库",children:[(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#创建数据库",children:"#"}),"创建数据库"]}),"\n",(0,s.jsx)(n.p,{children:"首先创建数据库，打开你的 Access"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:d})}),"\n",(0,s.jsx)(n.p,{children:"然后选择保存类型、保存位置。这里选择 mdb 的原因，是因为我的电脑 accdb 类型会出错。"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:p})}),"\n",(0,s.jsx)(n.p,{children:"然后创建表并保存："}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:l})}),"\n",(0,s.jsx)(n.p,{children:"之后关闭数据库。"}),"\n",(0,s.jsxs)(n.h2,{id:"编写asp文件连接数据库",children:[(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#编写asp文件连接数据库",children:"#"}),"编写asp文件连接数据库"]}),"\n",(0,s.jsxs)(n.p,{children:["我继续用 test.asp 文件做演示，在 asp 中拷贝下面的代码：(一个 ",(0,s.jsx)(n.code,{children:"'"})," 是 asp 中注释的写法)"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{meta:"",children:'<%\r\n  set conn = Server.CreateObject("ADODB.Connection")\r\n  conn.Provider = "Microsoft.Jet.OLEDB.4.0"\r\n\r\n  \' 填写你创建的数据库绝对路径\r\n  conn.Open("f:\\Website\\Database1.mdb")\r\n\r\n  set rs = Server.CreateObject("ADODB.recordset")\r\n  rs.Open "select * from score", conn\r\n\r\n  do until rs.EOF\r\n    for each x in rs.fields\r\n      response.Write(x)\r\n    next\r\n    response.Write("<br>")\r\n    rs.MoveNext\r\n  loop\r\n%>\n'})}),"\n",(0,s.jsxs)(n.p,{children:["在浏览器中输入你自己 test.asp 的路径，我输入的是：",(0,s.jsx)(n.a,{href:"http://localhost:8080/test.asp",target:"_blank",rel:"noopener noreferrer",children:"http://localhost:8080/test.asp"})]}),"\n",(0,s.jsx)(n.p,{children:"应该可以看到：（对比之后看到正是数据库中的内容，证明数据库已经连接成功）"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:o})}),"\n",(0,s.jsx)(n.p,{children:"如果报错，可能是需要你修改IIS的配置，启用32位的配置，如下图："}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.img,{src:h}),"\r\n",(0,s.jsx)(n.img,{src:x})]}),"\n",(0,s.jsxs)(n.h2,{id:"解释-asp-连接数据库的代码",children:[(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#解释-asp-连接数据库的代码",children:"#"}),"解释 asp 连接数据库的代码"]}),"\n",(0,s.jsx)(n.p,{children:"asp 中写代码默认使用的语言是 VBScript，它的具体语法我不是很熟，我只把各个部分的含义解释一下。如下图"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:m})}),"\n",(0,s.jsxs)(n.h2,{id:"表格展示数据库中的内容",children:[(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#表格展示数据库中的内容",children:"#"}),"表格展示数据库中的内容"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{meta:"",children:'<!DOCTYPE html>\r\n<html>\r\n<head>\r\n    <title></title>\r\n    <meta charset="utf-8">\r\n</head>\r\n<body>\r\n  <table width="100%" border="1">\r\n  <%\r\n    set conn = Server.CreateObject("ADODB.Connection")\r\n    conn.Provider = "Microsoft.Jet.OLEDB.4.0"\r\n\r\n    \' 填写你创建的数据库绝对路径\r\n    conn.Open("f:\\Website\\Database1.mdb")\r\n\r\n    set rs = Server.CreateObject("ADODB.recordset")\r\n    rs.Open "select * from score", conn\r\n\r\n    do until rs.EOF\r\n    response.Write("<tr>")\r\n      for each x in rs.fields\r\n        response.Write("<td>")\r\n        response.Write(x)\r\n        response.Write("</td>")\r\n      next\r\n      rs.MoveNext\r\n    response.Write("</tr>")\r\n    loop\r\n  %>\r\n  </table>\r\n<body>\r\n</html>\n'})}),"\n",(0,s.jsx)(n.p,{children:"效果如下："}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:j})}),"\n",(0,s.jsxs)(n.h2,{id:"极限更新添加数据到数据库",children:[(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#极限更新添加数据到数据库",children:"#"}),"极限更新，添加数据到数据库："]}),"\n",(0,s.jsx)(n.p,{children:"首先是 test.asp 文件的内容："}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{meta:"",children:'<!DOCTYPE html>\r\n<html>\r\n<head>\r\n    <title></title>\r\n    <meta charset="utf-8">\r\n</head>\r\n<body>\r\n\r\n  <form method="post" action="table.asp">\r\n    请输入学生姓名:<input name="stu_name" type="text">  <br>\r\n    请输入学生班级:<input name="stu_class" type="text"> <br>\r\n    请输入学生成绩:<input name="stu_score" type="text">  <br>\r\n    <input type="submit" value="提交">\r\n  </form>\r\n  \r\n  <table width="100%" border="1">\r\n  <%\r\n    set conn = Server.CreateObject("ADODB.Connection")\r\n    conn.Provider = "Microsoft.Jet.OLEDB.4.0"\r\n\r\n    \' 填写你创建的数据库绝对路径\r\n    conn.Open("f:\\Website\\Database1.mdb")\r\n\r\n    set rs = Server.CreateObject("ADODB.recordset")\r\n    rs.Open "select * from score", conn\r\n\r\n    do until rs.EOF\r\n    response.Write("<tr>")\r\n      for each x in rs.fields\r\n        response.Write("<td>")\r\n        response.Write(x)\r\n        response.Write("</td>")\r\n      next\r\n      rs.MoveNext\r\n    response.Write("</tr>")\r\n    loop\r\n\r\n    conn.Close()\r\n  %>\r\n  </table>\r\n<body>\r\n</html>\n'})}),"\n",(0,s.jsx)(n.p,{children:"然后是 table.asp 的内容："}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{meta:"",children:'<!DOCTYPE html>\r\n<html>\r\n<head>\r\n    <title></title>\r\n    <meta charset="utf-8">\r\n</head>\r\n<body>\r\n<%\r\n    set conn = Server.CreateObject("ADODB.Connection")\r\n    conn.Provider = "Microsoft.Jet.OLEDB.4.0"\r\n\r\n    \' 填写你创建的数据库绝对路径\r\n    conn.Open("f:\\Website\\Database1.mdb")\r\n\r\n    \' sql插入数据表的例子如下：insert into score(stu_name, stu_class, stu_score) values(\'Mike\', \'class1\', \'100\')\r\n    sql = "insert into score(stu_name, stu_class, stu_score) values"\r\n    sql = sql & "(\' " &Request.Form("stu_name")& "\', "\r\n    sql = sql & " \' " &Request.Form("stu_class")& "\', "\r\n    sql = sql & " \' " &Request.Form("stu_score")& " \')"\r\n\r\n    conn.Execute sql, recaffected\r\n\r\n    conn.Close()\r\n%>\r\n\r\n<a href="test.asp">Go back to the previous page</a>\r\n</body>\r\n</html>\n'})}),"\n",(0,s.jsx)(n.p,{children:"效果如下："}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:u})}),"\n",(0,s.jsx)(n.p,{children:"首先是 test.asp 界面："}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:b})}),"\n",(0,s.jsx)(n.p,{children:"点击提交之后会跳转到 table.asp 界面："}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:g})}),"\n",(0,s.jsx)(n.p,{children:"然后点击链接返回 test.asp 界面，相当于刷新（临时写的，其实可以不那么麻烦），可以看到新记录已经插入到数据库了。"})]})}function O(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:n}=Object.assign({},(0,t.ah)(),e.components);return n?(0,s.jsx)(n,Object.assign({},e,{children:(0,s.jsx)(f,e)})):f(e)}let D=O;O.__RSPRESS_PAGE_META={},O.__RSPRESS_PAGE_META["docs%2Fbit-life%2Fasp.md"]={toc:[{id:"修改-iis-配置将错误信息发送到浏览器",text:"修改 IIS 配置，将错误信息发送到浏览器",depth:2},{id:"创建数据库",text:"创建数据库",depth:2},{id:"编写asp文件连接数据库",text:"编写asp文件连接数据库",depth:2},{id:"解释-asp-连接数据库的代码",text:"解释 asp 连接数据库的代码",depth:2},{id:"表格展示数据库中的内容",text:"表格展示数据库中的内容",depth:2},{id:"极限更新添加数据到数据库",text:"极限更新，添加数据到数据库：",depth:2}],title:"",frontmatter:{}}},95895:function(e,n,r){r.d(n,{Z:function(){return d}});var s=r(85893),t=r(67294),i=r(45687);r(6175);let a={"zh-CN":e=>`预计阅读时间: ${e.minutes>=1?`${Math.ceil(e.minutes)} 分钟`:"小于 1 分钟"}`,"en-US":e=>`Estimated reading time: ${e.minutes>=1?`${Math.ceil(e.minutes)} minutes`:"less than 1 minute"}`};function c(e,n,r){let s=Object.keys(a).includes(n)?n:r;return a[s](e)}let d=e=>{let{defaultLocale:n="en-US"}=e,r=(0,i.Vi)().page.readingTimeData,a=(0,i.Jr)(),d=(0,i.e7)(),[p,l]=(0,t.useState)(c(r,a,n));return(0,t.useEffect)(()=>{l(c(r,a,n))},[a,r]),(0,s.jsx)("span",{"data-dark":String(d),className:"rp-reading-time",children:p})}}}]);