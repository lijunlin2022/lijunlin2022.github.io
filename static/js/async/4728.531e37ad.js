"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([["4728"],{3135:function(r,e,n){n.r(e),n.d(e,{default:()=>i});var d=n("5893"),a=n("65");let s=n.p+"static/image/snake4.c388ebc9.jpg",o=n.p+"static/image/snake3.9f7d9542.jpg",x=n.p+"static/image/snake2.082d3688.jpg";function c(r){let e=Object.assign({p:"p",h2:"h2",a:"a",pre:"pre",code:"code",img:"img"},(0,a.ah)(),r.components);return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(e.p,{children:"上一篇我们了解到，蛇身体的每一个点的坐标被存储在结构体中。这篇我们使用图片来演示蛇是如何移动，以及当蛇的长度增长时，又是如何实现增加的。本篇算是整个汇编贪吃蛇的重中之重"}),"\n",(0,d.jsxs)(e.h2,{id:"存储蛇的结构体",children:["存储蛇的结构体",(0,d.jsx)(e.a,{className:"header-anchor","aria-hidden":"true",href:"#存储蛇的结构体",children:"#"})]}),"\n",(0,d.jsx)(e.p,{children:"在上一篇文章中我们已经知道，蛇的位置是由结构体来存储的："}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-c",children:"struct SnakePos {\r\n	int x;\r\n	int y;\r\n} globalSnakeArr[100];\n"})}),"\n",(0,d.jsxs)(e.p,{children:["其中，",(0,d.jsx)(e.code,{children:"globalSnakeArr[i].x"})," 和 ",(0,d.jsx)(e.code,{children:"globalSnakeArr[i].y"})," 记录了一个蛇的节点，在地图 ",(0,d.jsx)(e.code,{children:"globalMapArr"})," 的 x 坐标位置和 y 坐标位置"]}),"\n",(0,d.jsx)(e.p,{children:"需要注意的是，游戏中的 x 和 y 坐标系如下所示："}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{children:"O —————> y\r\n|\r\n|\r\nV\r\nx\n"})}),"\n",(0,d.jsxs)(e.h2,{id:"蛇的移动",children:["蛇的移动",(0,d.jsx)(e.a,{className:"header-anchor","aria-hidden":"true",href:"#蛇的移动",children:"#"})]}),"\n",(0,d.jsx)(e.p,{children:"我们现在假设一条蛇的长度为 5，蛇头朝上，如果你想要将这条蛇整体往上移动一格，你应该怎么办？"}),"\n",(0,d.jsx)(e.p,{children:"我们的做法是如下图所示："}),"\n",(0,d.jsx)(e.p,{children:(0,d.jsx)("img",{src:x,alt:""})}),"\n",(0,d.jsx)(e.p,{children:"现在我们来看蛇头左转和右转的情况，（贪吃蛇不能掉头）"}),"\n",(0,d.jsx)(e.p,{children:(0,d.jsx)("img",{src:o,alt:""})}),"\n",(0,d.jsxs)(e.h2,{id:"蛇的生长",children:["蛇的生长",(0,d.jsx)(e.a,{className:"header-anchor","aria-hidden":"true",href:"#蛇的生长",children:"#"})]}),"\n",(0,d.jsx)(e.p,{children:"蛇的生长和蛇的移动有所不同，如下图所示"}),"\n",(0,d.jsx)(e.p,{children:(0,d.jsx)("img",{src:s,alt:""})}),"\n",(0,d.jsxs)(e.p,{children:["蛇增加一段长度，可以看作将原来的 ",(0,d.jsx)(e.code,{children:"globalSnakeArr"})," 全部向后挪动一个位置之后，再在蛇头的位置标上坐标"]}),"\n",(0,d.jsxs)(e.h2,{id:"实际代码",children:["实际代码",(0,d.jsx)(e.a,{className:"header-anchor","aria-hidden":"true",href:"#实际代码",children:"#"})]}),"\n",(0,d.jsx)(e.p,{children:"这是蛇的移动代码："}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-c",children:"void moveSnake() {\r\n	int i;\r\n	__asm {\r\n        // 单纯的移动，给蛇的长度 - 2，获得要开始挪动的下标\r\n        // 比如长度为 5 的蛇\r\n        // 它应该从下标为 3 处开始往后挪动\r\n		mov eax, dword ptr ds : [globalSnakeLen]\r\n		sub eax, 2\r\n		mov dword ptr ds : [i] , eax\r\n		jmp snake_cmp\r\n\r\n	snake_dec :\r\n		mov eax, dword ptr ds : [i]\r\n		dec eax\r\n		mov dword ptr ds : [i] , eax\r\n\r\n	snake_cmp :\r\n		mov eax, dword ptr ds : [i]\r\n		cmp eax, 0\r\n		jl snake_end\r\n\r\n		lea eax, dword ptr ds : [globalSnakeArr]\r\n		mov ecx, dword ptr ds : [i]\r\n		imul ecx, ecx, 8\r\n		add eax, ecx\r\n		mov ecx, dword ptr ds : [eax]		// x\r\n		mov edx, dword ptr ds : [eax + 4]	// y\r\n\r\n		// 放到 i + 1 的下标中\r\n		add eax, 8\r\n		mov dword ptr ds : [eax] , ecx\r\n		mov dword ptr ds : [eax + 4] , edx\r\n		jmp snake_dec\r\n\r\n	snake_end :\r\n\r\n		// 确定蛇头位置\r\n		mov eax, dword ptr ds : [globalMovementDirection]\r\n		cmp eax, 1\r\n		je move_up\r\n		cmp eax, 2\r\n		je move_down\r\n		cmp eax, 3\r\n		je move_left\r\n		cmp eax, 4\r\n		je move_right\r\n\r\n		// 向上移动\r\n	move_up :\r\n		lea eax, dword ptr ds : [globalSnakeArr]\r\n		mov ecx, dword ptr ds : [eax]\r\n		mov edx, dword ptr ds : [eax + 4]\r\n		dec ecx\r\n		mov dword ptr ds : [eax] , ecx\r\n		mov dword ptr ds : [eax + 4] , edx\r\n		jmp 	fun_end\r\n		// 向下移动\r\n	move_down :\r\n		lea eax, dword ptr ds : [globalSnakeArr]\r\n		mov ecx, dword ptr ds : [eax]\r\n		mov edx, dword ptr ds : [eax + 4]\r\n		inc ecx\r\n		mov dword ptr ds : [eax] , ecx\r\n		mov dword ptr ds : [eax + 4] , edx\r\n		jmp 	fun_end\r\n		// 向左移动\r\n	move_left :\r\n		lea eax, dword ptr ds : [globalSnakeArr]\r\n		mov ecx, dword ptr ds : [eax]\r\n		mov edx, dword ptr ds : [eax + 4]\r\n		dec edx\r\n		mov dword ptr ds : [eax] , ecx\r\n		mov dword ptr ds : [eax + 4] , edx\r\n		jmp 	fun_end\r\n		// 向右移动\r\n	move_right :\r\n		lea eax, dword ptr ds : [globalSnakeArr]\r\n		mov ecx, dword ptr ds : [eax]\r\n		mov edx, dword ptr ds : [eax + 4]\r\n		inc edx\r\n		mov dword ptr ds : [eax] , ecx\r\n		mov dword ptr ds : [eax + 4] , edx\r\n		jmp 	fun_end\r\n\r\n	fun_end :\r\n		nop\r\n	}\r\n}\n"})}),"\n",(0,d.jsx)(e.p,{children:"这是蛇长度增加的代码："}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-c",children:"void addSnakeLen() {\r\n	__asm {\r\n		mov eax, dword ptr ds : [globalSnakeLen]\r\n		inc eax\r\n		mov dword ptr ds : [globalSnakeLen] , eax\r\n	}\r\n}\n"})})]})}function t(){let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:e}=Object.assign({},(0,a.ah)(),r.components);return e?(0,d.jsx)(e,{...r,children:(0,d.jsx)(c,{...r})}):c(r)}let i=t;t.__RSPRESS_PAGE_META={},t.__RSPRESS_PAGE_META["docs%2Fbit-life%2Fsnake%2Fmovement-and-growth.md"]={toc:[{text:"存储蛇的结构体",id:"存储蛇的结构体",depth:2},{text:"蛇的移动",id:"蛇的移动",depth:2},{text:"蛇的生长",id:"蛇的生长",depth:2},{text:"实际代码",id:"实际代码",depth:2}],title:"",frontmatter:{}}}}]);