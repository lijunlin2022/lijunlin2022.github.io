"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([["4156"],{5120:function(e,r,i){i.r(r),i.d(r,{default:()=>j});var n=i("5893"),s=i("65");let h=i.p+"static/image/pdd.08f99e3f.gif",d=i.p+"static/image/12306.b6815799.gif",t=i.p+"static/image/principle-2.cf4c64e3.png",c=i.p+"static/image/principle-1.6c0a7611.png",l=i.p+"static/image/variable-height-swiper.24b5b6d8.gif",a=i.p+"static/image/keep.838f6bfa.gif";function p(e){let r=Object.assign({h1:"h1",a:"a",p:"p",img:"img",h2:"h2",code:"code",pre:"pre",h3:"h3",ul:"ul",li:"li",strong:"strong"},(0,s.ah)(),e.components);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(r.h1,{id:"h5小程序高度变化的轮播图如何实现",children:["H5、小程序高度变化的轮播图如何实现？",(0,n.jsx)(r.a,{className:"header-anchor","aria-hidden":"true",href:"#h5小程序高度变化的轮播图如何实现",children:"#"})]}),"\n",(0,n.jsx)(r.p,{children:"高度固定的轮播图，你肯定经常看到、并知道怎么实现，但高度变化的轮播图呢？"}),"\n",(0,n.jsx)(r.p,{children:"下面是 Keep 的课程轮播，可以看到 9 号的视频数量是少于 10 号和 11 号的，所以 9 号的视频列表的高度比 10、11 号低。当播放到 9 号课程时，下方的主题课程模块会往上移动，填充 9 号视频列表下方的空白。"}),"\n",(0,n.jsx)(r.p,{children:(0,n.jsx)("img",{src:a,alt:""})}),"\n",(0,n.jsx)(r.p,{children:"如果你也想实现高度变化的轮播，看完这篇文章，你一定有所收获。我会先解释高度变化的原理，然后说明关键实现，最后再给出原生 H5 和小程序的示例代码。代码效果如下："}),"\n",(0,n.jsx)(r.p,{children:(0,n.jsx)("img",{src:l,alt:""})}),"\n",(0,n.jsxs)(r.h2,{id:"高度变化的原理",children:["高度变化的原理",(0,n.jsx)(r.a,{className:"header-anchor","aria-hidden":"true",href:"#高度变化的原理",children:"#"})]}),"\n",(0,n.jsx)(r.p,{children:"如果我们使用 flex 布局实现轮播图 Swiper，那么轮播图的整体高度，将会是最高一项的高度。"}),"\n",(0,n.jsx)(r.p,{children:"如下图，虚线框代表 Swiper，Swiper 的每项都是 List。如果播放到某个 List，这个 List 就是红色。可以看到，只要轮播图播放到较矮项，就会在较矮项底部留下大量空白。"}),"\n",(0,n.jsx)(r.p,{children:(0,n.jsx)("img",{src:c,alt:""})}),"\n",(0,n.jsx)(r.p,{children:"要想实现高度变化、且不留下空白的轮播图，原理很简单。我们只需要在轮播切换时，先获取即将播放的 List 高度，再把它的高度设置给 Swiper。"}),"\n",(0,n.jsxs)(r.p,{children:["如下图，播放到某个 List，Swiper 的高度就变为这个 List 的高度。我们还可以给 Swiper 设置 ",(0,n.jsx)(r.code,{children:"overflow: hidden;"}),"，把找出 Swiper 范围的元素都给隐藏掉。"]}),"\n",(0,n.jsx)(r.p,{children:(0,n.jsx)("img",{src:t,alt:""})}),"\n",(0,n.jsxs)(r.h2,{id:"关键代码实现",children:["关键代码实现",(0,n.jsx)(r.a,{className:"header-anchor","aria-hidden":"true",href:"#关键代码实现",children:"#"})]}),"\n",(0,n.jsx)(r.p,{children:"聊完原理，我们来看代码，代码非常简单粗暴。"}),"\n",(0,n.jsx)(r.p,{children:"我们为每个 List 都设置了一个 id，利用 id 获取 List 的高度再设置到 Swiper 元素的 style 上。"}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-js",children:"function updateSwiperHeight (currentIndex) {\r\n  const height = document.querySelector(`#item-box-${currentIndex}`).offsetHeight\r\n  swiper.style.height = height + 'px'\r\n  swiper.style.overflow = 'hidden'\r\n}\n"})}),"\n",(0,n.jsxs)(r.h2,{id:"代码示例",children:["代码示例",(0,n.jsx)(r.a,{className:"header-anchor","aria-hidden":"true",href:"#代码示例",children:"#"})]}),"\n",(0,n.jsx)(r.p,{children:"现在来看 H5 和小程序的代码示例，为了突出重点，我并没有实现左右滑动，而是用点击切换近似替代："}),"\n",(0,n.jsxs)(r.h3,{id:"h5",children:["H5",(0,n.jsx)(r.a,{className:"header-anchor","aria-hidden":"true",href:"#h5",children:"#"})]}),"\n",(0,n.jsx)(r.p,{children:(0,n.jsx)(r.a,{href:"https://codepen.io/lijunlin2022/pen/qBLxNzQ",target:"_blank",rel:"noopener noreferrer",children:"高度变化的轮播图 | codepen"})}),"\n",(0,n.jsxs)(r.h3,{id:"小程序",children:["小程序",(0,n.jsx)(r.a,{className:"header-anchor","aria-hidden":"true",href:"#小程序",children:"#"})]}),"\n",(0,n.jsx)(r.p,{children:(0,n.jsx)(r.a,{href:"https://developers.weixin.qq.com/s/ct5irIm37eOg",target:"_blank",rel:"noopener noreferrer",children:"高度变化的轮播图 | 小程序"})}),"\n",(0,n.jsx)(r.p,{children:":::info"}),"\n",(0,n.jsxs)(r.ul,{children:["\n",(0,n.jsx)(r.li,{children:"小程序有原生的 swiper 组件，我们可以给 swiper 直接增加一个 style，在 style 中改变 swiper 的高度。"}),"\n",(0,n.jsxs)(r.li,{children:["小程序没有 ",(0,n.jsx)(r.code,{children:"querySelector()"}),"，可以用 ",(0,n.jsx)(r.code,{children:"createSelectorQuery()"})," 替代。\r\n:::"]}),"\n"]}),"\n",(0,n.jsxs)(r.h2,{id:"额外提醒",children:["额外提醒",(0,n.jsx)(r.a,{className:"header-anchor","aria-hidden":"true",href:"#额外提醒",children:"#"})]}),"\n",(0,n.jsx)(r.p,{children:"高度变化的轮播图非常少见，你需要仔细斟酌什么时候用它。"}),"\n",(0,n.jsx)(r.p,{children:"如果你不需要左右滑动，那么选择 Tab + 卡片更适合。比如 12306 的选项卡，高度就是不等的："}),"\n",(0,n.jsx)(r.p,{children:(0,n.jsx)("img",{src:d,alt:""})}),"\n",(0,n.jsxs)(r.p,{children:["如果轮播每一项轮播都是长列表，且随着用户上拉屏幕，列表加载的数据还会变多。",(0,n.jsx)(r.strong,{children:"这种轮播通常还是固定高度（100vh）的轮播"}),"。"]}),"\n",(0,n.jsxs)(r.p,{children:["它在拼多多、淘宝、京东上很常见。你需要注意，",(0,n.jsx)(r.strong,{children:"这种轮播每一项需要自带滚动条，否则处理列表滚动条会变得非常麻烦"}),"。因为这种轮播往往要求记住用户在每个列表滚动的位置，如果轮播共用滚动条，左右切换会有一个很明显的闪烁。"]}),"\n",(0,n.jsx)(r.p,{children:(0,n.jsx)("img",{src:h,alt:""})}),"\n",(0,n.jsxs)(r.h2,{id:"总结",children:["总结",(0,n.jsx)(r.a,{className:"header-anchor","aria-hidden":"true",href:"#总结",children:"#"})]}),"\n",(0,n.jsx)(r.p,{children:"本文我们介绍了高度变化的轮播图实现原理——先获取对应轮播项的高度，再改变轮播图的整体高度。之后我们给出了 H5 和小程序的代码示例。"})]})}function x(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:r}=Object.assign({},(0,s.ah)(),e.components);return r?(0,n.jsx)(r,{...e,children:(0,n.jsx)(p,{...e})}):p(e)}let j=x;x.__RSPRESS_PAGE_META={},x.__RSPRESS_PAGE_META["blog%2F2024-02-16-variable-height-swiper%2Findex.md"]={toc:[{text:"高度变化的原理",id:"高度变化的原理",depth:2},{text:"关键代码实现",id:"关键代码实现",depth:2},{text:"代码示例",id:"代码示例",depth:2},{text:"H5",id:"h5",depth:3},{text:"小程序",id:"小程序",depth:3},{text:"额外提醒",id:"额外提醒",depth:2},{text:"总结",id:"总结",depth:2}],title:"H5、小程序高度变化的轮播图如何实现？",frontmatter:{tags:["H5","小程序"]}}}}]);