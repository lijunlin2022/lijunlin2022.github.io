"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([["3144"],{9952:function(n,e,r){r.r(e),r.d(e,{default:()=>i});var A=r("5893"),s=r("65");function h(n){let e=Object.assign({h1:"h1",a:"a",h2:"h2",p:"p",strong:"strong",pre:"pre",code:"code",table:"table",thead:"thead",tr:"tr",th:"th",tbody:"tbody",td:"td",ul:"ul",li:"li",img:"img"},(0,s.ah)(),n.components);return(0,A.jsxs)(A.Fragment,{children:[(0,A.jsxs)(e.h1,{id:"使用缓冲区对象绘制多个点",children:["使用缓冲区对象绘制多个点",(0,A.jsx)(e.a,{className:"header-anchor","aria-hidden":"true",href:"#使用缓冲区对象绘制多个点",children:"#"})]}),"\n",(0,A.jsxs)(e.h2,{id:"什么是缓冲区对象",children:["什么是缓冲区对象",(0,A.jsx)(e.a,{className:"header-anchor","aria-hidden":"true",href:"#什么是缓冲区对象",children:"#"})]}),"\n",(0,A.jsxs)(e.p,{children:["缓冲区对象是 WebGL 系统中的一块",(0,A.jsx)(e.strong,{children:"内存区域"}),"，可以一次性向缓冲区对象内",(0,A.jsx)(e.strong,{children:"填充大量的顶点数据"}),"，然后将这些数据保存其中，给顶点着色器使用。"]}),"\n",(0,A.jsx)(e.pre,{children:(0,A.jsx)(e.code,{className:"language-mermaid",children:"flowchart TB;\r\nA[创建顶点数据] --\x3e B[创建缓冲区对象] --\x3e C[绑定缓冲区对象] --\x3e D[将数据写入缓冲区对象] --\x3e E[将缓冲区对象分配给一个 attribute 变量] --\x3e F[开启 attribute 变量] --\x3e G[绘图]\n"})}),"\n",(0,A.jsx)(e.p,{children:"创建顶点数据："}),"\n",(0,A.jsx)(e.pre,{children:(0,A.jsx)(e.code,{className:"language-js",children:"const points = new Float32Array([\r\n  -0.5, -0.5,\r\n  0.5, -0.5,\r\n  0.0, 0.5\r\n])\n"})}),"\n",(0,A.jsxs)(e.h2,{id:"类型化数组",children:["类型化数组",(0,A.jsx)(e.a,{className:"header-anchor","aria-hidden":"true",href:"#类型化数组",children:"#"})]}),"\n",(0,A.jsxs)(e.p,{children:["在 WebGL 中，需要处理大量的",(0,A.jsx)(e.strong,{children:"相同类型的数据"}),"，所以引入类型化数组，这样程序就可以与预知到数组中的数据类型，提高性能。"]}),"\n",(0,A.jsxs)(e.table,{children:["\n",(0,A.jsxs)(e.thead,{children:["\n",(0,A.jsxs)(e.tr,{children:["\n",(0,A.jsx)(e.th,{children:"类型"}),"\n",(0,A.jsx)(e.th,{children:"说明"}),"\n"]}),"\n"]}),"\n",(0,A.jsxs)(e.tbody,{children:["\n",(0,A.jsxs)(e.tr,{children:["\n",(0,A.jsx)(e.td,{children:"Int32Array"}),"\n",(0,A.jsx)(e.td,{children:"32 位整型"}),"\n"]}),"\n",(0,A.jsxs)(e.tr,{children:["\n",(0,A.jsx)(e.td,{children:"UInt32Array"}),"\n",(0,A.jsx)(e.td,{children:"32 位无符号整型"}),"\n"]}),"\n",(0,A.jsxs)(e.tr,{children:["\n",(0,A.jsx)(e.td,{children:"Float32Array"}),"\n",(0,A.jsx)(e.td,{children:"单精度 32 位浮点型"}),"\n"]}),"\n",(0,A.jsxs)(e.tr,{children:["\n",(0,A.jsx)(e.td,{children:"Float64Array"}),"\n",(0,A.jsx)(e.td,{children:"双精度 64 位浮点型"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,A.jsxs)(e.h2,{id:"创建缓冲区对象",children:["创建缓冲区对象",(0,A.jsx)(e.a,{className:"header-anchor","aria-hidden":"true",href:"#创建缓冲区对象",children:"#"})]}),"\n",(0,A.jsx)(e.pre,{children:(0,A.jsx)(e.code,{className:"language-js",children:"const buffer = gl.createBuffer()\n"})}),"\n",(0,A.jsxs)(e.h2,{id:"绑定缓冲区对象",children:["绑定缓冲区对象",(0,A.jsx)(e.a,{className:"header-anchor","aria-hidden":"true",href:"#绑定缓冲区对象",children:"#"})]}),"\n",(0,A.jsx)(e.pre,{children:(0,A.jsx)(e.code,{className:"language-js",children:"gl.bindBuffer(target, buffer)\n"})}),"\n",(0,A.jsxs)(e.ul,{children:["\n",(0,A.jsxs)(e.li,{children:["target，可以是如下两种","\n",(0,A.jsxs)(e.ul,{children:["\n",(0,A.jsxs)(e.li,{children:["gl.ARRAY_BUFFER，表示缓冲区存储的是",(0,A.jsx)(e.strong,{children:"顶点的数据"})]}),"\n",(0,A.jsxs)(e.li,{children:["gl.ELEMENT_ARRAY_BUFFER，表示缓冲区存储的是",(0,A.jsx)(e.strong,{children:"顶点的索引值"})]}),"\n"]}),"\n"]}),"\n",(0,A.jsx)(e.li,{children:"buffer，已经创建好的缓冲区对象"}),"\n"]}),"\n",(0,A.jsxs)(e.h2,{id:"将数据写入缓冲区对象",children:["将数据写入缓冲区对象",(0,A.jsx)(e.a,{className:"header-anchor","aria-hidden":"true",href:"#将数据写入缓冲区对象",children:"#"})]}),"\n",(0,A.jsx)(e.pre,{children:(0,A.jsx)(e.code,{className:"language-js",children:"gl.bufferData(target, data, type)\n"})}),"\n",(0,A.jsxs)(e.ul,{children:["\n",(0,A.jsxs)(e.li,{children:["target，类型同 ",(0,A.jsx)(e.code,{children:"gl.bindBuffer"})," 中的 target"]}),"\n",(0,A.jsx)(e.li,{children:"data，写入缓冲区的顶点数据"}),"\n",(0,A.jsxs)(e.li,{children:["type，表示如何使用缓冲区对象中的数据，分为以下几类","\n",(0,A.jsxs)(e.ul,{children:["\n",(0,A.jsx)(e.li,{children:"gl.STATIC_DRAW，写入一次，多次绘制"}),"\n",(0,A.jsx)(e.li,{children:"gl.STREAM_DRAW，写入一次，绘制若干次"}),"\n",(0,A.jsx)(e.li,{children:"gl.DYNAMIC_DRAW，写入多次，绘制多次"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,A.jsxs)(e.h2,{id:"将缓冲区对象分配给一个-attribute-变量",children:["将缓冲区对象分配给一个 attribute 变量",(0,A.jsx)(e.a,{className:"header-anchor","aria-hidden":"true",href:"#将缓冲区对象分配给一个-attribute-变量",children:"#"})]}),"\n",(0,A.jsx)(e.pre,{children:(0,A.jsx)(e.code,{className:"language-js",children:"gl.vertexAttribPointer(location, size, type, normalized, stride, offset)\n"})}),"\n",(0,A.jsxs)(e.ul,{children:["\n",(0,A.jsx)(e.li,{children:"location，attribute 变量的存储地址"}),"\n",(0,A.jsx)(e.li,{children:"size，没绘制一个顶点需要几个数据"}),"\n",(0,A.jsxs)(e.li,{children:["type，指定数据格式","\n",(0,A.jsxs)(e.ul,{children:["\n",(0,A.jsx)(e.li,{children:"gl.FLOAT，浮点型"}),"\n",(0,A.jsx)(e.li,{children:"gl.UNSIGNED_BYTE，无符号字节"}),"\n",(0,A.jsx)(e.li,{children:"gl.SHORT，短整型"}),"\n",(0,A.jsx)(e.li,{children:"gl.UNSIGNED_SHORT，无符号短整型"}),"\n",(0,A.jsx)(e.li,{children:"gl.INT，整型"}),"\n",(0,A.jsx)(e.li,{children:"gl.UNSIGNED_INT，无符号整型"}),"\n"]}),"\n"]}),"\n",(0,A.jsx)(e.li,{children:"normalized，表示是否将数据归一化到 [0, 1] [-1, 1] 这个区间"}),"\n",(0,A.jsx)(e.li,{children:"stride，两个相邻顶点之间的字节数"}),"\n",(0,A.jsx)(e.li,{children:"offset，数据偏移量"}),"\n"]}),"\n",(0,A.jsxs)(e.h2,{id:"开启-attribute-变量",children:["开启 attribute 变量",(0,A.jsx)(e.a,{className:"header-anchor","aria-hidden":"true",href:"#开启-attribute-变量",children:"#"})]}),"\n",(0,A.jsx)(e.pre,{children:(0,A.jsx)(e.code,{className:"language-js",children:"gl.enableVertexAttribArray(location)\n"})}),"\n",(0,A.jsxs)(e.p,{children:["有个对应的关闭 attribute 的方法 ",(0,A.jsx)(e.code,{children:"gl.disableVertexAttribArray(aPosition)"}),"。"]}),"\n",(0,A.jsx)(e.pre,{children:(0,A.jsx)(e.code,{className:"language-js",children:"const canvas = document.getElementById('canvas')\r\nconst gl = canvas.getContext('webgl')\r\n\r\nconst VERTEX_SHADER_SOURCE = `\r\n  attribute vec4 aPosition;\r\n  void main() {\r\n    gl_Position = aPosition;\r\n    gl_PointSize = 10.0;\r\n  }\r\n`\r\n\r\nconst FRAGMENT_SHADER_SOURCE = `\r\n  void main() {\r\n    gl_FragColor = vec4(1.0, 0.0, 0.0, 1.0);\r\n  }\r\n`\r\n\r\n// 创建着色器\r\nconst program = initShader(gl, VERTEX_SHADER_SOURCE, FRAGMENT_SHADER_SOURCE)\r\nconst aPosition = gl.getAttribLocation(program, 'aPosition')\r\n\r\nconst points = new Float32Array([\r\n  -0.5, -0.5,\r\n  0.5, -0.5,\r\n  0.0, 0.5\r\n])\r\n\r\nconst buffer = gl.createBuffer()\r\ngl.bindBuffer(gl.ARRAY_BUFFER, buffer)\r\ngl.bufferData(gl.ARRAY_BUFFER, points, gl.STATIC_DRAW)\r\ngl.vertexAttribPointer(aPosition, 2, gl.FLOAT, false, 0, 0)\r\ngl.enableVertexAttribArray(aPosition)\r\ngl.drawArrays(gl.POINTS, 0, 3)\n"})}),"\n",(0,A.jsx)(e.p,{children:"效果如下："}),"\n",(0,A.jsx)(e.p,{children:(0,A.jsx)("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAZAAAAGQCAIAAAAP3aGbAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAEXRFWHRTb2Z0d2FyZQBTbmlwYXN0ZV0Xzt0AAAXHSURBVHic7dqxbuJQEEDRNVhQx///jU6JwGDSr7RklWXjXHROCc0UT1cDmuF0Ot3v93Vdl2W5XC7DMAzDsN/vf8E/mKZpnuetp+DVjPf7/Xq9ns/n2+12OBy2ngfgj8br9Xo6ncZxtFUBP9xuWZZ1XYdh2HoSgE/slmU5Ho9bjwHwuZ3dCqgQLCBj5792oMKGBWTsth4A4G8JFpAhWECGYAEZggVkCBaQIVhAhmABGYIFZAgWkCFYQIZgARmCBWQIFpAhWECGYAEZggVkCBaQIVhAhmABGYIFZAgWkCFYQIZgARmCBWQIFpAhWECGYAEZggVkCBaQIVhAhmABGYIFZAgWkCFYQIZgARmCBWQIFpAhWECGYAEZggVkCBaQIVhAhmABGYIFZAgWkCFYQIZgARmCBWQIFpAhWECGYAEZggVkCBaQIVhAhmABGYIFZAgWkCFYQIZgARmCBWQIFpAhWECGYAEZggVkCBaQIVhAhmABGYIFZAgWkCFYQIZgARmCBWQIFpAhWECGYAEZggVkCBaQIVhAhmABGYIFZAgWkCFYQIZgARmCBWQIFpAxbj0AL+Jtmh588j7P3zsOr8mGBWQIFpAhWECGYAEZggVkCBaQIVhAhmABGYIFZLh05zl+v2WfJtftPJ0NC8gQLCBDsIAMwQIyBAvIECwgQ7CADMECMgQLyBAsIEOwgAzBAjIEC8gQLCBDsIAMwQIyBAvIECwgQ7CADMECMgQLyBAsIEOwgAzBAjIEC8gQLCBDsIAMwQIyBAvIECwgQ7CADMECMgQLyBAsIEOwgAzBAjIEC8gQLCBDsIAMwQIyBAvIECwgQ7CADMECMgQLyBAsIEOwgAzBAjIEC8gQLCBDsIAMwQIyBAvIECwgQ7CADMECMgQLyBAsIEOwgAzBAjIEC8gQLCBDsIAMwQIyBAvIECwgQ7CADMECMgQLyBAsIEOwgAzBAjIEC8gQLCBDsIAMwQIyBAvIECwgQ7CADMECMgQLyBAsIEOwgAzBAjIEC8gQLCBDsIAMwQIyBAvIECwgQ7CADMECMgQLAODZhnmet56BFzRNk6fF0/lJCGQIFpAhWECGYAEZggVkCBaQIVhAhmABGYIFZAgWkCFYQIZgARmCBWQIFpAhWECGYAEZggVkCBaQIVhAhmABGYIFZAgWkCFYQIZgARmCBWQIFpAhWECGYAEZggVkCBaQIVhAhmABGYIFZAgWkCFYQIZgARmCBWQIFpAhWECGYAEZggVkCBaQIVhAhmABGYIFZAgWkCFYQIZgARmCBWQIFpAhWECGYAEZggVkCBaQIVhAhmABGYIFZAgWkCFYQIZgARmCBWQIFpAhWECGYAEZggVkCBaQIVhAhmABGYIFZAgWkCFYQIZgARmCBWQIFpAhWECGYAEZggVkCBaQIVhAhmABGYIFZAgWkCFYQIZgARmCBWQIFpAhWECGYAEZggVkCBaQIVhAhmABGYIFZAgWkDFuPcCP9jZND759n+dvm4RX4l19mQ0LyBAsIEOwgAzBAjIEC8gQLCBDsIAMwQIyBAvIcOn+iJtj/gfv6stsWECGYAEZggVkCBaQIVhAhmABGYIFZAgWkCFYQIZgARmCBWQIFpAhWECGYAEZggVkCBaQIVhAhmABGYIFZAgWkCFYQIZgARmCBWQIFpAhWECGYAEZggVkCBaQIVhAhmABGYIFZAgWkCFYQIZgARmCBWQIFpAhWECGYAEZggVkCBaQIVhAhmABGYIFZAgWkCFYQIZgARmCBWQIFpAhWECGYAEZggVkCBaQIVhAhmABGYIFZAgWkCFYQIZgARmCBWQIFpAhWECGYAEZggVkCBaQIVhAhmABGYIFZAgWkCFYQIZgARmCBWQIFpAhWECGYAEZggVkCBaQIVhAhmABGYIFZAgWkCFYQIZgARmCBWQIFpAhWECGYAEZggVkCBaQIVhAhmABGYIFZAgWkCFYQIZgARkfm3tKG+qYP6kAAAAASUVORK5CYII=",alt:""})})]})}function t(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:e}=Object.assign({},(0,s.ah)(),n.components);return e?(0,A.jsx)(e,{...n,children:(0,A.jsx)(h,{...n})}):h(n)}let i=t;t.__RSPRESS_PAGE_META={},t.__RSPRESS_PAGE_META["docs%2Fwebgl%2F05-buffer.md"]={toc:[{text:"什么是缓冲区对象",id:"什么是缓冲区对象",depth:2},{text:"类型化数组",id:"类型化数组",depth:2},{text:"创建缓冲区对象",id:"创建缓冲区对象",depth:2},{text:"绑定缓冲区对象",id:"绑定缓冲区对象",depth:2},{text:"将数据写入缓冲区对象",id:"将数据写入缓冲区对象",depth:2},{text:"将缓冲区对象分配给一个 attribute 变量",id:"将缓冲区对象分配给一个-attribute-变量",depth:2},{text:"开启 attribute 变量",id:"开启-attribute-变量",depth:2}],title:"使用缓冲区对象绘制多个点",frontmatter:{}}}}]);