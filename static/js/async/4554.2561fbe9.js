"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([["4554"],{91728:function(n,e,t){t.r(e),t.d(e,{default:()=>g});var i=t("85893"),r=t("50065"),l=t("95895");let A=t.p+"static/image/multi-buffer-principle.f39234f3.png";function a(n){let e=Object.assign({h1:"h1",a:"a",p:"p",img:"img",pre:"pre",code:"code",ul:"ul",li:"li"},(0,r.ah)(),n.components);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(e.h1,{id:"多缓冲区和数据偏移",children:[(0,i.jsx)(e.a,{className:"header-anchor","aria-hidden":"true",href:"#多缓冲区和数据偏移",children:"#"}),"多缓冲区和数据偏移"]}),"\n",(0,i.jsx)(l.Z,{defaultLocale:"zh-CN"}),"\n",(0,i.jsx)(e.p,{children:"上一节介绍了如何利用缓冲区绘制多个点，这节介绍如何创建多缓冲区。"}),"\n",(0,i.jsx)(e.p,{children:"比如同样要画三个点，三个点的位置不一样，大小也不一样，我们可以这样写："}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:"data:image/png;base64,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"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-js",meta:"",children:"...\r\nconst VERTEX_SHADER_SOURCE = `\r\n  attribute vec4 aPosition;\r\n  attribute float aPointSize;\r\n  void main() {\r\n    gl_Position = aPosition;\r\n    gl_PointSize = aPointSize;\r\n  }\r\n`\r\n...\r\nconst program = initShader(gl, VERTEX_SHADER_SOURCE, FRAGMENT_SHADER_SOURCE)\r\nconst aPosition = gl.getAttribLocation(program, 'aPosition')\r\nconst aPointSize = gl.getAttribLocation(program, 'aPointSize')\r\n\r\n// highlight-start\r\nconst points = new Float32Array([\r\n  -0.5, -0.5,\r\n  0.5, -0.5,\r\n  0.0, 0.5\r\n])\r\n\r\nconst buffer = gl.createBuffer()\r\ngl.bindBuffer(gl.ARRAY_BUFFER, buffer)\r\ngl.bufferData(gl.ARRAY_BUFFER, points, gl.STATIC_DRAW)\r\ngl.vertexAttribPointer(aPosition, 2, gl.FLOAT, false, 0, 0)\r\ngl.enableVertexAttribArray(aPosition)\r\n// highlight-end\r\n\r\n// highlight-start\r\nconst size = new Float32Array([\r\n  10.0,\r\n  20.0,\r\n  30.0\r\n])\r\n\r\nconst sizeBuffer = gl.createBuffer()\r\ngl.bindBuffer(gl.ARRAY_BUFFER, sizeBuffer)\r\ngl.bufferData(gl.ARRAY_BUFFER, size, gl.STATIC_DRAW)\r\ngl.vertexAttribPointer(aPointSize, 1, gl.FLOAT, false, 0, 0)\r\ngl.enableVertexAttribArray(aPointSize)\r\n// highlight-end\r\n\r\ngl.drawArrays(gl.POINTS, 0, 3)\n"})}),"\n",(0,i.jsx)(e.p,{children:"不难看出，两段代码的相似程度很高，有什么办法可以降低代码重复度吗？"}),"\n",(0,i.jsx)(e.p,{children:"这时候就需要用到代码偏移，代码如下："}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-js",meta:"",children:"...\r\nconst points = new Float32Array([\r\n  -0.5, -0.5, 10.0,\r\n  0.5, -0.5, 20.0,\r\n  0.0, 0.5, 30.0\r\n])\r\n\r\nconst buffer = gl.createBuffer()\r\ngl.bindBuffer(gl.ARRAY_BUFFER, buffer)\r\ngl.bufferData(gl.ARRAY_BUFFER, points, gl.STATIC_DRAW)\r\n\r\nconst BYTES = points.BYTES_PER_ELEMENT\r\n// highlight-next-line\r\ngl.vertexAttribPointer(aPosition, 2, gl.FLOAT, false, BYTES * 3, 0)\r\ngl.enableVertexAttribArray(aPosition)\r\n// highlight-next-line\r\ngl.vertexAttribPointer(aPointSize, 1, gl.FLOAT, false, BYTES * 3, BYTES * 2)\r\ngl.enableVertexAttribArray(aPointSize)\r\n\r\ngl.drawArrays(gl.POINTS, 0, 3)\n"})}),"\n",(0,i.jsxs)(e.p,{children:["我们可以复习一下 ",(0,i.jsx)(e.code,{children:"vertexAttribPointer"})," 的使用方法："]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-js",meta:"",children:"gl.vertexAttribPointer(location, size, type, normalized, stride, offset)\n"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"location，attribute 变量的存储地址"}),"\n",(0,i.jsx)(e.li,{children:"size，没绘制一个顶点需要几个数据"}),"\n",(0,i.jsxs)(e.li,{children:["type，指定数据格式","\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"gl.FLOAT，浮点型"}),"\n",(0,i.jsx)(e.li,{children:"gl.UNSIGNED_BYTE，无符号字节"}),"\n",(0,i.jsx)(e.li,{children:"gl.SHORT，短整型"}),"\n",(0,i.jsx)(e.li,{children:"gl.UNSIGNED_SHORT，无符号短整型"}),"\n",(0,i.jsx)(e.li,{children:"gl.INT，整型"}),"\n",(0,i.jsx)(e.li,{children:"gl.UNSIGNED_INT，无符号整型"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.li,{children:"normalized，表示是否将数据归一化到 [0, 1] [-1, 1] 这个区间"}),"\n",(0,i.jsx)(e.li,{children:"stride，两个相邻顶点之间的字节数"}),"\n",(0,i.jsx)(e.li,{children:"offset，数据偏移量"}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:A})})]})}function o(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:e}=Object.assign({},(0,r.ah)(),n.components);return e?(0,i.jsx)(e,Object.assign({},n,{children:(0,i.jsx)(a,n)})):a(n)}let g=o;o.__RSPRESS_PAGE_META={},o.__RSPRESS_PAGE_META["docs%2Fwebgl%2F06-multi-buffer.md"]={toc:[],title:"多缓冲区和数据偏移",frontmatter:{}}},95895:function(n,e,t){t.d(e,{Z:function(){return o}});var i=t(85893),r=t(67294),l=t(45687);t(6175);let A={"zh-CN":n=>`预计阅读时间: ${n.minutes>=1?`${Math.ceil(n.minutes)} 分钟`:"小于 1 分钟"}`,"en-US":n=>`Estimated reading time: ${n.minutes>=1?`${Math.ceil(n.minutes)} minutes`:"less than 1 minute"}`};function a(n,e,t){let i=Object.keys(A).includes(e)?e:t;return A[i](n)}let o=n=>{let{defaultLocale:e="en-US"}=n,t=(0,l.Vi)().page.readingTimeData,A=(0,l.Jr)(),o=(0,l.e7)(),[g,s]=(0,r.useState)(a(t,A,e));return(0,r.useEffect)(()=>{s(a(t,A,e))},[A,t]),(0,i.jsx)("span",{"data-dark":String(o),className:"rp-reading-time",children:g})}}}]);