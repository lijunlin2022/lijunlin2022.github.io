"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[6773],{95548:(n,r,t)=>{t.r(r),t.d(r,{assets:()=>c,contentTitle:()=>s,default:()=>d,frontMatter:()=>i,metadata:()=>o,toc:()=>l});var e=t(85893),a=t(11151);const i={},s="\u77e9\u9635\u5b9e\u73b0\u5e73\u79fb\u3001\u65cb\u8f6c\u3001\u7f29\u653e",o={id:"webgl/animation-matrix",title:"\u77e9\u9635\u5b9e\u73b0\u5e73\u79fb\u3001\u65cb\u8f6c\u3001\u7f29\u653e",description:"\u5e73\u79fb\u77e9\u9635",source:"@site/docs/14-webgl/09-animation-matrix.md",sourceDirName:"14-webgl",slug:"/webgl/animation-matrix",permalink:"/docs/webgl/animation-matrix",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:9,frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"\u7740\u8272\u5668\u5b9e\u73b0\u56fe\u5f62\u52a8\u753b",permalink:"/docs/webgl/animation"},next:{title:"\u7247\u5143\u7740\u8272\u5668\u52a8\u753b",permalink:"/docs/webgl/fragment-shader-animation/"}},c={},l=[{value:"\u5e73\u79fb\u77e9\u9635",id:"\u5e73\u79fb\u77e9\u9635",level:2},{value:"\u7f29\u653e\u77e9\u9635",id:"\u7f29\u653e\u77e9\u9635",level:2},{value:"\u65cb\u8f6c\u77e9\u9635",id:"\u65cb\u8f6c\u77e9\u9635",level:2},{value:"\u590d\u5408\u53d8\u5316",id:"\u590d\u5408\u53d8\u5316",level:2}];function x(n){const r={code:"code",h1:"h1",h2:"h2",header:"header",img:"img",p:"p",pre:"pre",...(0,a.a)(),...n.components};return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(r.header,{children:(0,e.jsx)(r.h1,{id:"\u77e9\u9635\u5b9e\u73b0\u5e73\u79fb\u65cb\u8f6c\u7f29\u653e",children:"\u77e9\u9635\u5b9e\u73b0\u5e73\u79fb\u3001\u65cb\u8f6c\u3001\u7f29\u653e"})}),"\n",(0,e.jsx)(r.h2,{id:"\u5e73\u79fb\u77e9\u9635",children:"\u5e73\u79fb\u77e9\u9635"}),"\n",(0,e.jsx)(r.pre,{children:(0,e.jsx)(r.code,{children:"1, 0, 0, 0,\r\n0, 1, 0, 0,\r\n0, 0, 1, 0,\r\nx1, y1, z1, 1,\n"})}),"\n",(0,e.jsx)(r.p,{children:(0,e.jsx)(r.img,{src:t(77518).Z+"",width:"389",height:"388"})}),"\n",(0,e.jsx)(r.pre,{children:(0,e.jsx)(r.code,{className:"language-js",children:"// ... \u7701\u7565\r\nconst VERTEX_SHADER_SOURCE = `\r\n  attribute vec4 aPosition;\r\n  uniform mat4 mat;\r\n  void main() {\r\n    gl_Position = mat * aPosition;\r\n  }\r\n`\r\n// ... \u7701\u7565\r\nconst mat = gl.getUniformLocation(program, 'mat')\r\n\r\nfunction getTranslateMatrix(x = 0, y = 0, z = 0) {\r\n  return new Float32Array([\r\n    1.0, 0.0, 0.0, 0.0,\r\n    0.0, 1.0, 0.0, 0.0,\r\n    0.0, 0.0, 1.0, 0.0,\r\n    x, y, z, 1\r\n  ])\r\n}\r\n// ... \u7701\u7565\r\nlet x = 1\r\n\r\nfunction animation() {\r\n  x += 0.02\r\n  if (x > 1) {\r\n    x = -1\r\n  }\r\n  const matrix = getTranslateMatrix(x, x)\r\n  gl.uniformMatrix4fv(mat, false, matrix)\r\n  gl.drawArrays(gl.TRIANGLES, 0, 3)\r\n  requestAnimationFrame(animation)\r\n}\r\n\r\nanimation()\n"})}),"\n",(0,e.jsx)(r.h2,{id:"\u7f29\u653e\u77e9\u9635",children:"\u7f29\u653e\u77e9\u9635"}),"\n",(0,e.jsx)(r.pre,{children:(0,e.jsx)(r.code,{children:"tx, 0, 0, 0,\r\n0, ty, 0, 0,\r\n0, 0, 0, tz,\r\n0, 0, 0, 1,\n"})}),"\n",(0,e.jsx)(r.p,{children:(0,e.jsx)(r.img,{src:t(16222).Z+"",width:"389",height:"387"})}),"\n",(0,e.jsx)(r.pre,{children:(0,e.jsx)(r.code,{className:"language-js",children:"// ... \u7701\u7565\r\nfunction getScaleMatrix(x = 1, y = 1, z = 1) {\r\n  return new Float32Array([\r\n    x, 0.0, 0.0, 0.0,\r\n    0.0, y, 0.0, 0.0,\r\n    0.0, 0.0, z, 0.0,\r\n    0.0, 0.0, 0.0, 1.0\r\n  ])\r\n}\r\n// ... \u7701\u7565\r\nlet x = 1\r\n\r\nfunction animation() {\r\n  x += 0.01\r\n  if (x > 1.5) {\r\n    x = 1\r\n  }\r\n  const matrix = getScaleMatrix(x, x)\r\n  gl.uniformMatrix4fv(mat, false, matrix)\r\n  gl.drawArrays(gl.TRIANGLES, 0, 3)\r\n  requestAnimationFrame(animation)\r\n}\r\n\r\nanimation()\n"})}),"\n",(0,e.jsx)(r.h2,{id:"\u65cb\u8f6c\u77e9\u9635",children:"\u65cb\u8f6c\u77e9\u9635"}),"\n",(0,e.jsx)(r.pre,{children:(0,e.jsx)(r.code,{children:"cos\u03b2, sin\u03b2, 0.0, 0.0,\r\n-sin\u03b2, cos\u03b2, 0.0, 0.0,\r\n0.0, 0.0, 1.0, 0.0,\r\n0.0, 0.0, 0.0, 1.0,\n"})}),"\n",(0,e.jsx)(r.p,{children:(0,e.jsx)(r.img,{src:t(99601).Z+"",width:"389",height:"389"})}),"\n",(0,e.jsx)(r.pre,{children:(0,e.jsx)(r.code,{className:"language-js",children:"// ... \u7701\u7565\r\nfunction getRotateMatrix(deg) {\r\n  return new Float32Array([\r\n    Math.cos(deg), Math.sin(deg), 0.0, 0.0,\r\n    -Math.sin(deg), Math.cos(deg), 0.0, 0.0,\r\n    0.0, 0.0, 1.0, 0.0,\r\n    0.0, 0.0, 0.0, 1.0\r\n  ])\r\n}\r\n// ... \u7701\u7565\r\nlet x = 1\r\n\r\nfunction animation() {\r\n  x += 0.02\r\n  const matrix = getRotateMatrix(x)\r\n  gl.uniformMatrix4fv(mat, false, matrix)\r\n  gl.drawArrays(gl.TRIANGLES, 0, 3)\r\n  requestAnimationFrame(animation)\r\n}\r\n\r\nanimation()\n"})}),"\n",(0,e.jsx)(r.h2,{id:"\u590d\u5408\u53d8\u5316",children:"\u590d\u5408\u53d8\u5316"}),"\n",(0,e.jsx)(r.p,{children:"\u5982\u679c\u540c\u65f6\u5b58\u5728\u5e73\u79fb\u3001\u65cb\u8f6c\u3001\u7f29\u653e\u7684\u52a8\u753b\uff0c\u90a3\u4e48\u53ef\u4ee5\u4e09\u4e2a\u77e9\u9635\u76f8\u4e58\u3002"}),"\n",(0,e.jsx)(r.p,{children:(0,e.jsx)(r.img,{src:t(4299).Z+"",width:"389",height:"389"})}),"\n",(0,e.jsx)(r.pre,{children:(0,e.jsx)(r.code,{className:"language-js",children:"// ... \u7701\u7565\r\nconst VERTEX_SHADER_SOURCE = `\r\n  attribute vec4 aPosition;\r\n  uniform mat4 translateMatrix;\r\n  unifrom mat4 rotateMatrix;\r\n  uniform mat4 scaleMatrix;\r\n\r\n  void main() {\r\n    gl_Position = translateMatrix * rotateMatrix * scaleMatrix * aPosition;\r\n  }\r\n`\r\n// ... \u7701\u7565\n"})}),"\n",(0,e.jsx)(r.p,{children:"\u4e0d\u8fc7\u8fd9\u6837\u5c31\u9700\u8981\u8d4b\u503c\u4e09\u4e2a\u53d8\u91cf\uff0c\u6bd4\u8f83\u590d\u6742\uff0c\u6211\u4eec\u53ef\u4ee5\u5c01\u88c5\u4e00\u4e2a\u77e9\u9635\u4e58\u6cd5\u7684\u51fd\u6570\uff1a"}),"\n",(0,e.jsx)(r.pre,{children:(0,e.jsx)(r.code,{className:"language-js",children:"// ... \u7701\u7565\r\nfunction mixMatrix(A, B) {\r\n  const result = new Float32Array(16)\r\n  for (let i = 0; i < 4; i++) {\r\n    result[i] = A[i] * B[0] + A[i + 4] * B[1] + A[i + 8] * B[2] + A[i + 12] * B[3]\r\n    result[i + 4] = A[i] * B[4] + A[i + 4] * B[5] + A[i + 8] * B[6] + A[i + 12] * B[7]\r\n    result[i + 8] = A[i] * B[8] + A[i + 4] * B[9] + A[i + 8] * B[10] + A[i + 12] * B[11]\r\n    result[i + 12] = [i] * B[12] + A[i + 4] * B[13] + A[i + 8] * B[14] + A[i + 12] * B[15]\r\n  }\r\n  return result\r\n}\r\n// ... \u7701\u7565\r\nlet deg = 0\r\nlet translateX = -1\r\nlet scaleX = 0.1\r\n\r\nfunction animation() {\r\n  deg += 0.01\r\n  translateX += 0.01\r\n  scaleX += 0.01\r\n\r\n  if (translateX > 1) {\r\n    translateX = -1\r\n  }\r\n  if (scaleX > 1.5) {\r\n    scaleX = 0.1\r\n  }\r\n\r\n  const translateMatrix = getTranslateMatrix(translateX)\r\n  const scaleMatrix = getScaleMatrix(scaleX)\r\n  const rotateMatrix = getRotateMatrix(deg)\r\n\r\n  const matrix = mixMatrix(mixMatrix(translateMatrix, scaleMatrix), rotateMatrix)\r\n  gl.uniformMatrix4fv(mat, false, matrix)\r\n  gl.drawArrays(gl.TRIANGLES, 0, 3)\r\n  requestAnimationFrame(animation)\r\n}\r\n\r\nanimation()\n"})})]})}function d(n={}){const{wrapper:r}={...(0,a.a)(),...n.components};return r?(0,e.jsx)(r,{...n,children:(0,e.jsx)(x,{...n})}):x(n)}},4299:(n,r,t)=>{t.d(r,{Z:()=>e});const e=t.p+"assets/images/mix-matrix-e30babc7d8b0bc1e3ce31b0b63076e83.gif"},99601:(n,r,t)=>{t.d(r,{Z:()=>e});const e=t.p+"assets/images/rotate-matrix-86bd7d4edca85dc8c41a049f1cc57c64.gif"},16222:(n,r,t)=>{t.d(r,{Z:()=>e});const e=t.p+"assets/images/scale-matrix-0b133a860d0582a359593df2cf96c44b.gif"},77518:(n,r,t)=>{t.d(r,{Z:()=>e});const e=t.p+"assets/images/translate-matrix-e5bacad144fe98691f29be20c3d84b8e.gif"},11151:(n,r,t)=>{t.d(r,{Z:()=>o,a:()=>s});var e=t(67294);const a={},i=e.createContext(a);function s(n){const r=e.useContext(i);return e.useMemo((function(){return"function"==typeof n?n(r):{...r,...n}}),[r,n])}function o(n){let r;return r=n.disableParentContext?"function"==typeof n.components?n.components(a):n.components||a:s(n.components),e.createElement(i.Provider,{value:r},n.children)}}}]);