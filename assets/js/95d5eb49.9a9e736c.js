"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[6961],{10955:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>s,default:()=>v,frontMatter:()=>o,metadata:()=>a,toc:()=>d});var i=t(85893),r=t(11151);const o={},s="Webview \u5411 Native \u53d1\u9001\u6d88\u606f",a={id:"objective-c/webview-send-msg",title:"Webview \u5411 Native \u53d1\u9001\u6d88\u606f",description:"",source:"@site/docs/15-objective-c/04-webview-send-msg.md",sourceDirName:"15-objective-c",slug:"/objective-c/webview-send-msg",permalink:"/docs/objective-c/webview-send-msg",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:4,frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Native \u5411 Webview \u53d1\u9001\u6d88\u606f",permalink:"/docs/objective-c/native-send-msg"},next:{title:"\u767b\u5f55\u6ce8\u518c",permalink:"/docs/\u4e2a\u4eba\u5f00\u53d1/\u767b\u5f55\u6ce8\u518c/"}},c={},d=[];function l(e){const n={code:"code",h1:"h1",header:"header",pre:"pre",...(0,r.a)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"webview-\u5411-native-\u53d1\u9001\u6d88\u606f",children:"Webview \u5411 Native \u53d1\u9001\u6d88\u606f"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-objc",metastring:'title="ViewController.h"',children:"@interface ViewController : UIViewController<WKScriptMessageHandler>;\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-objc",metastring:'title="ViewController.m"',children:'- (void)createWebview {\r\n    printf("Create WebView\\n");\r\n    WKWebViewConfiguration *webviewConfig = [[WKWebViewConfiguration alloc] init];\r\n    [webviewConfig.userContentController addScriptMessageHandler:self name:@"JSBridge"];\r\n    \r\n    CGRect positionInfo = CGRectMake(10, 200, 300, 400);\r\n    self._webview = [[WKWebView alloc] initWithFrame:positionInfo configuration:webviewConfig];\r\n    self._webview.layer.borderWidth = 1;\r\n    self._webview.layer.borderColor = [UIColor blackColor].CGColor;\r\n    [self.view addSubview:self._webview];\r\n}\r\n\r\n- (void)userContentController:(WKUserContentController *)userContentController didReceiveScriptMessage:(WKScriptMessage *)message {\r\n    if ([message.name isEqualToString:@"JSBridge"]) {\r\n        NSString *body = message.body;\r\n        printf("\u539f\u751f\u5c42\u63a5\u6536\u5230\u6d88\u606f:%s\\n", [body UTF8String]);\r\n    }\r\n}\n'})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-html",metastring:'title="pageFrame.html"',children:"<body>\r\n  <div>\u6211\u662f\u672c\u5730\u7684 HTML</div>\r\n  <div id=\"native-msg\"></div>\r\n  <button id=\"send-to-native\">\u7ed9 native \u53d1\u9001\u6d88\u606f</button>\r\n  <script>\r\n    window.receiveNativeMessage = function (msg) {\r\n      const nativeMsg = document.getElementById('native-msg')\r\n      nativeMsg.innerHTML = msg\r\n    }\r\n      \r\n    const sendMsgEl = document.getElementById('send-to-native')\r\n    sendMsgEl.onclick = function (msg) {\r\n      window.webkit.messageHandlers.JSBridge.postMessage('\u6211\u662f\u6765\u81ea Webview \u7684\u6d88\u606f')\r\n    }\r\n  <\/script>\r\n</body>\n"})})]})}function v(e={}){const{wrapper:n}={...(0,r.a)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(l,{...e})}):l(e)}},11151:(e,n,t)=>{t.d(n,{Z:()=>a,a:()=>s});var i=t(67294);const r={},o=i.createContext(r);function s(e){const n=i.useContext(o);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:s(e.components),i.createElement(o.Provider,{value:n},e.children)}}}]);