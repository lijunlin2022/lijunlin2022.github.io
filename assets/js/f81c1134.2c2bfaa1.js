"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[4031],{4108:n=>{n.exports=JSON.parse('{"archive":{"blogPosts":[{"id":"/2024/10/29/inject-version","metadata":{"permalink":"/blog/2024/10/29/inject-version","source":"@site/blog/2024-10-29-inject-version/index.md","title":"\u5bf9\u6bd4\u9759\u6001\u66ff\u6362\u548c\u52a8\u6001\u63d2\u5165\u6807\u7b7e\uff0cVite \u6253\u5305 H5 \u6ce8\u5165\u7248\u672c\u53f7\u54ea\u79cd\u65b9\u5f0f\u66f4\u4f18\u96c5\uff1f","description":"\u65e5\u5e38\u7ef4\u62a4 H5 \u65f6\uff0c\u4f60\u53ef\u80fd\u6709\u4e00\u4e2a\u8bc9\u6c42\uff0c\u5728 H5 \u53d1\u5e03\u65f6\u5e26\u4e0a\u7248\u672c\u53f7\u3002\u8fd9\u6837\u53d1\u73b0\u62a5\u9519\u65f6\uff0c\u7248\u672c\u53f7\u53ef\u4ee5\u8f85\u52a9\u4f60\u6392\u67e5\u9519\u8bef\uff1b\u4e0a\u7ebf\u4f18\u5316\u63aa\u65bd\u65f6\uff0c\u7248\u672c\u53f7\u53ef\u4ee5\u8f85\u52a9\u4f60\u89c2\u6d4b\u6027\u80fd\u2026\u2026","date":"2024-10-29T00:00:00.000Z","tags":[],"readingTime":6.11,"hasTruncateMarker":false,"authors":[],"frontMatter":{},"unlisted":false,"nextItem":{"title":"\u4eff\u62fc\u591a\u591a\u9886\u7ea2\u5305\u3001\u91d1\u989d\u6570\u5b57\u79fb\u52a8\u5982\u4f55\u5b9e\u73b0\uff1f","permalink":"/blog/2024/10/27/scroll-number"}},"content":"\u65e5\u5e38\u7ef4\u62a4 H5 \u65f6\uff0c\u4f60\u53ef\u80fd\u6709\u4e00\u4e2a\u8bc9\u6c42\uff0c\u5728 H5 \u53d1\u5e03\u65f6\u5e26\u4e0a\u7248\u672c\u53f7\u3002\u8fd9\u6837\u53d1\u73b0\u62a5\u9519\u65f6\uff0c\u7248\u672c\u53f7\u53ef\u4ee5\u8f85\u52a9\u4f60\u6392\u67e5\u9519\u8bef\uff1b\u4e0a\u7ebf\u4f18\u5316\u63aa\u65bd\u65f6\uff0c\u7248\u672c\u53f7\u53ef\u4ee5\u8f85\u52a9\u4f60\u89c2\u6d4b\u6027\u80fd\u2026\u2026\\r\\n\\r\\n\u672c\u6587\u6211\u4f1a\u544a\u8bc9\u4f60 Vite \u5728 H5 \u6ce8\u5165\u7248\u672c\u53f7\u7684\u4e24\u79cd\u65b9\u5f0f\uff0c\u5e76\u5bf9\u6bd4\u5b83\u4eec\u7684\u4f18\u52a3\u3002\\r\\n\\r\\n\u62f3\u6253 H5\uff0c\u811a\u8e22\u5c0f\u7a0b\u5e8f\u3002\u6211\u662f\u300c\u5c0f\u9716\u5bb6\u7684\u6df7\u6c5f\u9f99\u300d\uff0c\u5173\u6ce8\u6211\uff0c\u5e26\u4f60\u4e86\u89e3\u66f4\u591a\u5b9e\u7528\u7684 H5\u3001\u5c0f\u7a0b\u5e8f\u6b66\u5b66\u3002\\r\\n\\r\\n## \u9759\u6001\u66ff\u6362\u548c\u52a8\u6001\u63d2\u5165\u6807\u7b7e\\r\\n\\r\\n- \u9759\u6001\u66ff\u6362\uff0c\u5229\u7528 Vite \u7684 .env \u6587\u4ef6\u548c `import.meta.env` \u5bf9\u8c61\uff0c\u6253\u5305\u65f6\u76f4\u63a5\u66ff\u6362 js \u4ee3\u7801\u3001Vue \u6a21\u677f\u4e2d\u7684\u53d8\u91cf\\r\\n- \u52a8\u6001\u63d2\u5165\u6807\u7b7e\uff0c\u5229\u7528 Vite \u63d2\u4ef6\u548c `tansformIndexHtml` \u94a9\u5b50\uff0c\u6253\u5305\u65f6\u5f80 HTML \u91cc\u63d2\u5165\u6807\u7b7e\\r\\n\\r\\n\u4e3a\u4e86\u65b9\u4fbf\u7406\u89e3\uff0c\u4e0b\u9762\u6f14\u793a\u8fd9\u4e24\u79cd\u65b9\u6cd5\u3002\u9996\u5148\u7528 Vite \u65b0\u5efa\u4e00\u4e2a Demo\uff0c\u51fa\u4e8e\u4e60\u60ef\u6211\u8fd9\u91cc\u76f4\u63a5\u9009\u62e9\u4e86 React\uff0c\u4f60\u4e5f\u53ef\u4ee5\u9009\u62e9 Vue\u3002\\r\\n\\r\\n![](./img/vite-demo.png)\\r\\n\\r\\n## \u9759\u6001\u66ff\u6362\u7684\u6d41\u7a0b\\r\\n\\r\\n\u9759\u6001\u66ff\u6362\u4e3b\u8981\u5206\u4e3a\u4e09\u4e2a\u6b65\u9aa4\uff1a\\r\\n\\r\\n1. \u5728 .env \u6587\u4ef6\u5199\u5165\u53d8\u91cf\\r\\n2. \u5728 js \u4ee3\u7801\u4e2d\u66ff\u6362\u53d8\u91cf\\r\\n3. \u4e0a\u62a5\u7248\u672c\u53f7\u7ed9\u76d1\u63a7 SDK\\r\\n\\r\\n### \u5728 .env \u6587\u4ef6\u5199\u5165\u53d8\u91cf\\r\\n\\r\\n\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c**\u53ea\u6709\u4ee5 VITE_ \u4e3a\u524d\u7f00\u7684\u53d8\u91cf\u624d\u4f1a\u66b4\u9732\u7ed9\u7ecf\u8fc7 vite \u5904\u7406\u7684\u4ee3\u7801**\u3002\u4f60\u53ef\u4ee5\u628a\u7248\u672c\u53f7\u547d\u540d\u4e3a `Vite_H5_VERSION`\u3002\\r\\n\\r\\n```\\r\\nVITE_H5_VERSION=0.0.1\\r\\n```\\r\\n\\r\\n### \u5728 js \u4ee3\u7801\u4e2d\u66ff\u6362\u53d8\u91cf\\r\\n\\r\\n\u4f60\u53ef\u4ee5\u5728 vite \u9700\u8981\u5904\u7406\u7684\u4ee3\u7801\u4e2d\uff0c\u76f4\u63a5\u4f7f\u7528 `import.meta.env.VITE_H5_VERSION`\u3002\u6bd4\u5982\u5728 main.jsx \u4e2d\u76f4\u63a5\u6253\u5370\u5b83\u3002\\r\\n\\r\\n\u8fd9\u6837\u7f16\u8bd1\u540e\uff0c`import.meta.env.VITE_H5_VERSION` \u4f1a\u88ab\u81ea\u52a8\u66ff\u6362\u3002\u5982\u4e0b\u56fe\u6240\u793a\uff0c\u7b2c\u4e09\u4e2a\u6587\u4ef6\u662f\u7f16\u8bd1\u540e\u7684 js\uff0c\u53ef\u4ee5\u770b\u5230\u53d8\u91cf\u5df2\u7ecf\u88ab\u66ff\u6362\u4e3a\u7248\u672c\u53f7\u3002\\r\\n\\r\\n![](./img/vite-h5-version.png)\\r\\n\\r\\n### \u4e0a\u62a5\u7248\u672c\u53f7\u7ed9\u76d1\u63a7 SDK\\r\\n\\r\\n\u73b0\u5728\uff0c\u4f60\u8981\u505a\u7684\u5c31\u662f\u628a\u7248\u672c\u53f7\u4e0a\u4f20\u5230\u76d1\u63a7\u5e73\u53f0\u3002\u6211\u4eec\u4ee5\u963f\u91cc\u4e91\u7684 ARMS npm \u5305\u4e3a\u4f8b\u5b50\uff1a\\r\\n\\r\\n```js\\r\\nconst BrowserLogger = require(\'alife-logger\')\\r\\n\\r\\nconst __bl = BrowserLogger.singleton({\\r\\n pid: \'xxx\',\\r\\n // ARMS \u914d\u7f6e\u5e94\u7528\u7248\u672c\u53f7\\r\\n release: import.meta.env.VITE_H5_VERSION,\\r\\n // ... \u7701\u7565\\r\\n});\\r\\n```\\r\\n\\r\\n## \u52a8\u6001\u63d2\u5165\u6807\u7b7e\u7684\u6d41\u7a0b\\r\\n\\r\\n\u52a8\u6001\u63d2\u5165\u6807\u7b7e\u4e5f\u4e3b\u8981\u5206\u4e3a\u4e09\u4e2a\u6b65\u9aa4\uff1a\\r\\n\\r\\n1. \u4ece\u547d\u4ee4\u884c\u8bfb\u53d6\u7248\u672c\u53f7\\r\\n2. \u63d2\u5165\u7248\u672c\u53f7\u5230 HTML\\r\\n3. \u4e0a\u62a5\u7248\u672c\u53f7\u7ed9\u76d1\u63a7 SDK\\r\\n\\r\\n### \u4ece\u547d\u4ee4\u884c\u8bfb\u53d6\u7248\u672c\u53f7\\r\\n\\r\\nWindows\u3001Linux \u548c Mac \u7cfb\u7edf\uff0c\u5728\u547d\u4ee4\u884c\u8bbe\u7f6e\u4e34\u65f6\u73af\u5883\u53d8\u91cf\u7684\u5199\u6cd5\u4e0d\u540c\uff0c\u4f60\u53ef\u4ee5\u5728\u5b89\u88c5 cross-env \u8fd9\u4e2a\u5f00\u53d1\u4f9d\u8d56\u3002\u5b83\u53ef\u4ee5\u8ba9\u4f60\u5728\u4e0d\u540c\u7cfb\u7edf\u4f7f\u7528\u76f8\u540c\u65b9\u5f0f\u6ce8\u5165\u73af\u5883\u53d8\u91cf\uff08\u6bd4\u5982\u7248\u672c\u53f7\uff09\u3002\\r\\n\\r\\n![](./img/cross-env.png)\\r\\n\\r\\n\u5b89\u88c5\u4f9d\u8d56\u540e\uff0c\u4f60\u53ef\u4ee5\u8fd0\u884c\u5982\u4e0b\u547d\u4ee4\u3002\u5b83\u7684\u4f5c\u7528\u662f\u5f80 process-env \u91cc\u6ce8\u5165\u53d8\u91cf H5_VERSION\uff0c\u5e76\u6267\u884c\u6253\u5305\u3002\\r\\n\\r\\n```bash\\r\\nnpx cross-env H5_VERSION=0.0.1 npm run build\\r\\n```\\r\\n\\r\\n\u4f60\u53ef\u4ee5\u76f4\u63a5\u5728 vite.config.js \u4e2d\u6253\u5370\u8bfb\u53d6\u5230\u7684\u7248\u672c\u53f7\uff1a\\r\\n\\r\\n```js\\r\\nimport { defineConfig } from \'vite\'\\r\\nimport react from \'@vitejs/plugin-react\'\\r\\n\\r\\nconsole.log(\'H5_VERSION is \', process.env.H5_VERSION)\\r\\n\\r\\n// https://vite.dev/config/\\r\\nexport default defineConfig({\\r\\n  plugins: [react()],\\r\\n})\\r\\n```\\r\\n\\r\\n\u53ef\u4ee5\u770b\u5230\uff0c\u5f53\u8fd0\u884c build \u547d\u4ee4\u65f6\uff0c\u5728 vite.config.js \u5185\u90e8\u5df2\u7ecf\u8bfb\u53d6\u5230\u4e86 H5_VERSION\u3002\\r\\n\\r\\n![](./img/build.png)\\r\\n\\r\\n\u4e0b\u9762\uff0c\u4f60\u9700\u8981\u628a\u7248\u672c\u53f7\u63d2\u5165\u5230 HTML \u4e2d\u3002\\r\\n\\r\\n### \u63d2\u5165\u7248\u672c\u53f7\u5230 HTML\\r\\n\\r\\n\u4f60\u53ef\u4ee5\u4f7f\u7528\u4e00\u4e2a vite \u5b98\u65b9\u63d2\u4ef6\u94a9\u5b50\u51fd\u6570 [transformIndexHtml](https://vitejs.cn/vite3-cn/guide/api-plugin.html#transformindexhtml) \u7f16\u5199\u4e00\u4e2a\u63d2\u4ef6\uff0c\u5b83\u53ef\u4ee5\u66ff\u6362 HTML \u7684\u5185\u5bb9\uff0c\u4e5f\u53ef\u4ee5\u63d2\u5165 js \u811a\u672c\u3002\\r\\n\\r\\n\u63d2\u4ef6\u4ee3\u7801\u5982\u4e0b\uff0ctransformIndexHtml \u51fd\u6570\u8fd4\u56de\u4e86\u4e00\u4e2a\u5bf9\u8c61\uff0c\u5bf9\u8c61\u5305\u62ec html \u548c tag \u4e24\u4e2a\u5c5e\u6027\u3002\u4e0d\u96be\u770b\u51fa\uff0c\u8fd9\u4e2a\u5bf9\u8c61\u7684\u610f\u601d\u5c31\u662f\uff0c\u5728 head \u6807\u7b7e\u9760\u524d\u7684\u4f4d\u7f6e\u63d2\u5165\u4e00\u4e2a script \u6807\u7b7e\uff0c\u6807\u7b7e\u5185\u5bb9\u662f `window.$H5_VERSION=\\"0.0.1\\"`\u3002\\r\\n\\r\\n```js\\r\\nimport { defineConfig } from \'vite\'\\r\\nimport react from \'@vitejs/plugin-react\'\\r\\n\\r\\nfunction injectVersion () {\\r\\n  return {\\r\\n    name: \'inject-version\',\\r\\n    transformIndexHtml(html) {\\r\\n      return {\\r\\n        html,\\r\\n        tags: [\\r\\n          {\\r\\n            injectTo: \'head-prepend\',\\r\\n            tag: \'script\',\\r\\n            children: `window.$H5_VERSION = \\"${process.env.H5_VERSION}\\"`\\r\\n          }\\r\\n        ]\\r\\n      }\\r\\n    }\\r\\n  }\\r\\n}\\r\\n\\r\\nexport default defineConfig({\\r\\n  plugins: [react(), injectVersion()],\\r\\n})\\r\\n```\\r\\n\\r\\n\u4f60\u53ef\u4ee5\u518d\u6b21\u542f\u52a8\u6253\u5305\uff0c\u5c31\u80fd\u770b\u5230 dist \u7684\u4ea7\u7269\u4e2d\u5df2\u7ecf\u6709\u4e86\u63d2\u5165\u7248\u672c\u53f7\u7684\u811a\u672c\u3002\\r\\n\\r\\n![](./img/dist.png)\\r\\n\\r\\n### \u4e0a\u62a5\u7248\u672c\u53f7\u7ed9\u76d1\u63a7 SDK\\r\\n\\r\\n\u56e0\u4e3a\u7248\u672c\u53f7\u811a\u672c\u5728 head \u6807\u7b7e\u6700\u9876\u5c42\uff0c\u4f1a\u6700\u65e9\u6267\u884c\uff0c\u6240\u4ee5\u4f60\u4e4b\u540e\u5728 HTML\u3001React \u4e2d\u90fd\u53ef\u4ee5\u7528 `window.$H5_VERSION` \u83b7\u53d6\u7248\u672c\u53f7\u3002\\r\\n\\r\\n\u73b0\u5728\uff0c\u4f60\u8981\u505a\u7684\u5c31\u662f\u628a\u7248\u672c\u53f7\u4e0a\u4f20\u5230\u76d1\u63a7\u5e73\u53f0\u3002\\r\\n\\r\\n\u4ee5\u963f\u91cc\u4e91\u7684\u9519\u8bef\u76d1\u63a7 ARMS \u4e3a\u4f8b\uff0c\u4f60\u53ef\u4ee5\u5728\u5b83\u521d\u59cb\u5316 SDK \u65f6\u7ed9 release \u53d6\u503c `window.$H5_VERSION`\u3002\\r\\n\\r\\n```html\\r\\n<!DOCTYPE html>\\r\\n<html>\\r\\n  \x3c!-- ... \u7701\u7565 --\x3e\\r\\n  <body>\\r\\n    <script>\\r\\n      !(function (c, b, d, a) {\\r\\n        c[a] || (c[a] = {})\\r\\n        c[a].config = {\\r\\n          pid: \'xxx\',\\r\\n          // ARMS \u914d\u7f6e\u5e94\u7528\u7248\u672c\u53f7\\r\\n          release: window.$H5_VERSION,\\r\\n          // ... \u7701\u7565\\r\\n        }\\r\\n        // ... \u7701\u7565\\r\\n      })(window, document, \'xxx.js\', \'__bl\')\\r\\n    <\/script>\\r\\n    \x3c!-- ...\u7701\u7565 --\x3e\\r\\n  </body>\\r\\n</html>\\r\\n```\\r\\n\\r\\n## \u603b\u7ed3\\r\\n\\r\\n|  | \u9759\u6001\u66ff\u6362 | \u52a8\u6001\u63d2\u5165\u6807\u7b7e |\\r\\n| -- | -- | -- |\\r\\n| **\u8bfb\u5165\u53d8\u91cf\u65b9\u5f0f** | \u4ece .env \u6587\u4ef6\u8bfb\u5165 | \u4ece\u547d\u4ee4\u884c\u8bfb\u53d6 |\\r\\n| **\u66ff\u6362\u53d8\u91cf\u65b9\u5f0f** | \u5229\u7528 vite \u66ff\u6362 | \u5229\u7528\u63d2\u5165\u6807\u7b7e\u66ff\u6362 |\\r\\n| **\u4f7f\u7528\u53d8\u91cf\u7684\u5730\u65b9** | vite \u5904\u7406\u540e\u7684 js \u6587\u4ef6 | html\u3001js \u5747\u53ef |\\r\\n\\r\\n\u603b\u7ed3\u6765\u770b\uff0c\u52a8\u6001\u63d2\u5165\u6807\u7b7e\uff0c\u53ef\u4ee5\u5728 HTML \u91cc\u4f7f\u7528\u53d8\u91cf\uff0c\u5bf9 cdn \u5f15\u5165\u7684 js\u3001npm \u5305\u5f15\u5165\u7684 js \u4f7f\u7528\u90fd\u5f88\u53cb\u597d\uff0c\u6211\u8ba4\u4e3a\u8fd9\u662f\u4e00\u79cd\u66f4\u4f18\u96c5\u7684\u65b9\u5f0f\u3002\\r\\n\\r\\n\u62f3\u6253 H5\uff0c\u811a\u8e22\u5c0f\u7a0b\u5e8f\u3002\u6211\u662f\u300c\u5c0f\u9716\u5bb6\u7684\u6df7\u6c5f\u9f99\u300d\uff0c\u5173\u6ce8\u6211\uff0c\u5e26\u4f60\u4e86\u89e3\u66f4\u591a\u5b9e\u7528\u7684 H5\u3001\u5c0f\u7a0b\u5e8f\u6b66\u5b66\u3002"},{"id":"/2024/10/27/scroll-number","metadata":{"permalink":"/blog/2024/10/27/scroll-number","source":"@site/blog/2024-10-27-scroll-number/index.mdx","title":"\u4eff\u62fc\u591a\u591a\u9886\u7ea2\u5305\u3001\u91d1\u989d\u6570\u5b57\u79fb\u52a8\u5982\u4f55\u5b9e\u73b0\uff1f","description":"\u62fc\u591a\u591a\u73b0\u91d1\u5927\u8f6c\u76d8\u9886\u53d6\u7ea2\u5305\u540e\uff0c\u5c0f\u6570\u90e8\u5206\u6709\u4e00\u4e2a\u6570\u5b57\u79fb\u52a8\u7684\u6548\u679c\uff0c\u8fd9\u4e2a\u6548\u679c\u600e\u4e48\u505a\u5462\uff1f","date":"2024-10-27T00:00:00.000Z","tags":[],"readingTime":5.565,"hasTruncateMarker":false,"authors":[],"frontMatter":{},"unlisted":false,"prevItem":{"title":"\u5bf9\u6bd4\u9759\u6001\u66ff\u6362\u548c\u52a8\u6001\u63d2\u5165\u6807\u7b7e\uff0cVite \u6253\u5305 H5 \u6ce8\u5165\u7248\u672c\u53f7\u54ea\u79cd\u65b9\u5f0f\u66f4\u4f18\u96c5\uff1f","permalink":"/blog/2024/10/29/inject-version"},"nextItem":{"title":"\u4ece\u5546\u54c1\u6d77\u62a5\u8bf4\u8d77\uff0ccanvas \u6587\u672c\u5982\u4f55\u5b9e\u73b0\u6ea2\u51fa\u622a\u65ad\u3001\u6ea2\u51fa\u663e\u793a\u7701\u7565\u53f7\u548c\u81ea\u52a8\u6362\u884c\uff1f","permalink":"/blog/2024/07/15/canvas-fill-text"}},"content":"\u62fc\u591a\u591a\u73b0\u91d1\u5927\u8f6c\u76d8\u9886\u53d6\u7ea2\u5305\u540e\uff0c\u5c0f\u6570\u90e8\u5206\u6709\u4e00\u4e2a\u6570\u5b57\u79fb\u52a8\u7684\u6548\u679c\uff0c\u8fd9\u4e2a\u6548\u679c\u600e\u4e48\u505a\u5462\uff1f\\r\\n\\r\\n![](./img/pdd.gif)\\r\\n\\r\\n\u672c\u6587\u6211\u4f1a\u544a\u8bc9\u4f60\u6570\u5b57\u79fb\u52a8\u7684\u539f\u7406\uff0c\u5e76\u7528 React \u5b9e\u73b0\u4e00\u4e2a Demo\uff0c\u6548\u679c\u5982\u4e0b\uff1a\\r\\n\\r\\n![](./img/scroll-number.gif)\\r\\n\\r\\n\u62f3\u6253 H5\uff0c\u811a\u8e22\u5c0f\u7a0b\u5e8f\u3002\u6211\u662f\u300c\u5c0f\u9716\u5bb6\u7684\u6df7\u6c5f\u9f99\u300d\uff0c\u5173\u6ce8\u6211\uff0c\u5e26\u4f60\u4e86\u89e3\u66f4\u591a\u5b9e\u7528\u7684 H5\u3001\u5c0f\u7a0b\u5e8f\u6b66\u5b66\u3002\\r\\n\\r\\n## \u6eda\u52a8\u539f\u7406\\r\\n\\r\\n\u4e0d\u96be\u60f3\u5230\uff0c\u6570\u5b57\u79fb\u52a8\uff0c\u5b9e\u8d28\u662f\u4e00\u4e32\u6570\u5b57\u5217\u8868\uff0c\u5728\u5bb9\u5668\u5185\u90e8\u5411\u4e0a\u79fb\u52a8\u3002\u4e0b\u56fe\u5c31\u5c55\u793a\u4e86\u6570\u5b57\u4ece 0 \u53d8\u4e3a 2\uff0c\u53c8\u4ece 2 \u53d8\u4e3a 4 \u7684\u8fc7\u7a0b\uff1a\\r\\n\\r\\n![](./img/up.png)\\r\\n\\r\\n\u4f46\u662f\uff0c\u91d1\u989d\u6570\u5b57\u6bd4\u8f83\u7279\u6b8a\uff0c\u5b83\u662f\u53ef\u4ee5\u8fdb\u4f4d\u7684\u3002\u4e3e\u4f8b\u6765\u8bf4\uff0c39.5 \u53d8\u4e3a 39.9 \u65f6\uff0c\u5c0f\u6570\u90e8\u5206\u7531 5 \u5230 9 \u9700\u8981\u5411\u4e0a\u79fb\u52a8\uff1b39.9 \u53d8\u4e3a 40.2 \u65f6\uff0c\u5c0f\u6570\u90e8\u5206\u7531 9 \u53d8\u5230 2 \u65f6\u4e5f\u9700\u8981\u5411\u4e0a\u79fb\u52a8\u3002\\r\\n\\r\\n\u4e3a\u4e86\u505a\u5230\u8fd9\u4e2a\u6548\u679c\uff0c\u6211\u4eec\u9700\u8981\u6bcf\u6b21\u6eda\u52a8\u7ed3\u675f\u4e4b\u540e\uff0c\u91cd\u65b0\u8bbe\u7f6e\u4e00\u6574\u4e32\u6570\u5b57\u3002\\r\\n\\r\\n\u540c\u6837\u662f\u4ece 0 \u53d8\u4e3a 2\uff0c\u53c8\u4ece 2 \u53d8\u4e3a 4\u3002\u4e0b\u56fe\u4e0d\u540c\u7684\u662f\uff0c\u6570\u5b57\u53d8\u4e3a 2 \u65f6\uff0c\u5b83\u4e0b\u65b9\u7684\u6570\u5b57\u53d8\u4e3a\u4e86 3\u30014\u30015\u30016\u30017\u30018\u30019\u30010\u30011\uff1b\u6570\u5b57\u53d8\u4e3a 4 \u65f6\uff0c\u5b83\u4e0b\u65b9\u7684\u6570\u5b57\u53d8\u4e3a\u4e86 5\u30016\u30017\u30018\u30019\u30010\u30011\u30012\u30013\u3002\\r\\n\\r\\n![](./img/loop.png)\\r\\n\\r\\n## \u5173\u952e\u5e03\u5c40\\r\\n\\r\\n\u4e86\u89e3\u539f\u7406\u540e\uff0c\u6211\u4eec\u5f00\u59cb\u5199\u5143\u7d20\u5e03\u5c40\u3002\u5173\u952e\u5e03\u5c40\u6709 2 \u4e2a\u5143\u7d20\uff1a\\r\\n\\r\\n- \u9009\u62e9\u6846\uff0c\u5b83\u53ef\u4ee5\u786e\u8ba4\u4e0b\u4e00\u4e2a\u5c06\u8981\u53d8\u6210\u7684\u6570\u5b57\uff0c\u6211\u4eec\u7528\u5b83\u6765\u6a21\u62df\u9886\u53d6\u7ea2\u5305\u4e4b\u540e\u3001\u91d1\u989d\u53d8\u5316\u7684\u60c5\u51b5\u3002\\r\\n- \u6570\u5b57\u76d2\u5b50\uff0c\u5b83\u5305\u62ec\u4e09\u90e8\u5206\uff0c\u5e26 overflow: hidden \u7684\u5916\u5c42\u76d2\u5b50\uff0c\u5305\u88f9\u6570\u5b57\u5e76\u5411\u4e0a\u6eda\u52a8\u7684\u5185\u5c42\u76d2\u5b50\uff0c\u4ee5\u53ca\u4e00\u4e2a\u4e2a\u6570\u5b57\u3002\\r\\n\\r\\n<details>\\r\\n<summary>\u70b9\u51fb\u67e5\u770b\u4ee3\u7801</summary>\\r\\n\\r\\n```jsx\\r\\nconst App = function () {\\r\\n  const [options] = useState([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])\\r\\n  const [nums, setNums] = useState([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])\\r\\n\\r\\n  return (\\r\\n    <main>\\r\\n      <div className=\\"select-box\\">\\r\\n        <span>\u6539\u53d8\u6570\u5b57\uff1a</span>\\r\\n        <select>\\r\\n          {\\r\\n            options.map(v => (\\r\\n              <option key={v}>{v}</option>\\r\\n            ))\\r\\n          }\\r\\n        </select>\\r\\n      </div>\\r\\n      <div className=\\"num-box\\">\\r\\n        <div>\\r\\n          {\\r\\n            nums.map(v => (\\r\\n              <div className=\\"num\\" key={v}>{v}</div>\\r\\n            ))\\r\\n          }\\r\\n        </div>\\r\\n      </div>\\r\\n    </main>\\r\\n  )\\r\\n};\\r\\n```\\r\\n</details>\\r\\n\\r\\n## \u5173\u952e\u903b\u8f91\\r\\n\\r\\n\u6570\u5b57\u79fb\u52a8\u7684\u5173\u952e\u903b\u8f91\u6709 3 \u4e2a\uff1a\\r\\n\\r\\n- \u91cd\u7f6e\u6570\u5b57\u6570\u7ec4\\r\\n- \u8ba1\u7b97\u79fb\u52a8\u8ddd\u79bb\\r\\n- \u5f00\u542f\u5173\u95ed\u52a8\u753b\\r\\n\\r\\n### \u91cd\u7f6e\u6570\u5b57\u6570\u7ec4\\r\\n\\r\\n\u4f60\u4e4b\u524d\u5df2\u7ecf\u77e5\u9053\uff0c\u5982\u679c\u6570\u7ec4\u9996\u4f4d\u662f 2\uff0c\u5b83\u4e0b\u9762\u7684\u6570\u5b57\u5c31\u662f 3\u30014\u30015\u30016\u30017\u30018\u30019\u30010\u30011\u3002\u8981\u83b7\u53d6\u5b8c\u6574\u7684\u6570\u7ec4\uff0c\u6211\u4eec\u53ef\u4ee5\u5206\u4e3a\u4e24\u4e2a\u6b65\u9aa4\uff1a\\r\\n\\r\\n- \u9996\u5148\uff0c\u6570\u7ec4\u9996\u4f4d\u80cc\u540e\u7684\u6570\u5b57\u4f9d\u6b21\u52a0 1\uff0c\u8fd9\u6837\u6570\u5b57\u5c31\u53d8\u4e3a\u4e86 3\u30014\u30015\u30016\u30017\u30018\u30019\u300110\u300111\uff1b\\r\\n- \u7136\u540e\uff0c\u6240\u6709\u5927\u4e8e 9 \u7684\u6570\u5b57\u90fd\u51cf\u53bb 10\uff0c\u8fd9\u6837\u6570\u5b57\u5c31\u53d8\u4e3a\u4e86 3\u30014\u30015\u30016\u30017\u30018\u30019\u30010\u30011\u3002\\r\\n\\r\\n<details>\\r\\n<summary>\u70b9\u51fb\u67e5\u770b\u4ee3\u7801</summary>\\r\\n\\r\\n```js\\r\\nconst getNewNums = (next) => {\\r\\n  const newNums = []\\r\\n  for (let i = next; i < next + 10; i++) {\\r\\n    const item = i > 9 ? (i - 10) : i\\r\\n    newNums.push(item)\\r\\n  }\\r\\n  return newNums\\r\\n}\\r\\n```\\r\\n</details>\\r\\n\\r\\n### \u8ba1\u7b97\u79fb\u52a8\u8ddd\u79bb\\r\\n\\r\\n\u4f60\u53ef\u4ee5\u7528 current \u8868\u793a\u5f53\u524d\u7684\u6570\u5b57\uff0cnext \u8868\u793a\u9700\u8981\u53d8\u6210\u7684\u6570\u5b57\u3002\u8ba1\u7b97\u79fb\u52a8\u8ddd\u79bb\u65f6\uff0c\u9700\u8981\u5206\u4e24\u79cd\u60c5\u51b5\u8003\u8651\uff1a\\r\\n\\r\\n- next \u5927\u4e8e current \u65f6\uff0c\u53ea\u9700\u8981\u79fb\u52a8 `next - current` \u4e2a\u6570\u5b57\u5373\u53ef\uff1b \\r\\n- next \u5c0f\u4e8e current \u65f6\uff0c\u9700\u8981\u5148\u79fb\u52a8 `10 - next` \u4e2a\u6570\u5b57\uff0c\u518d\u79fb\u52a8 current \u4e2a\u6570\u5b57\u5373\u53ef\u3002\\r\\n\\r\\n<details>\\r\\n<summary>\u70b9\u51fb\u67e5\u770b\u4ee3\u7801</summary>\\r\\n\\r\\n```js\\r\\nconst calculateDistance = (current, next) => {\\r\\n  const height = 40\\r\\n  let diff = next - current\\r\\n  if (next < current) {\\r\\n    diff = 10 - current + next\\r\\n  }\\r\\n  return -(diff * height)\\r\\n}\\r\\n```\\r\\n</details>\\r\\n\\r\\n### \u5f00\u542f\u5173\u95ed\u52a8\u753b\\r\\n\\r\\n\u4e0d\u96be\u60f3\u5230\uff0c\u6211\u4eec\u6570\u5b57\u79fb\u52a8\u7684\u52a8\u753b\u662f\u4f7f\u7528 translateY \u548c transition \u5b9e\u73b0\u3002\u5f53\u6570\u5b57\u79fb\u52a8\u65f6\uff0c\u6211\u4eec\u628a translateY \u8bbe\u7f6e\u4e3a calculateDistance \u7684\u7ed3\u679c\uff1b\u5f53\u79fb\u52a8\u7ed3\u675f\u3001\u91cd\u7f6e\u6570\u7ec4\u65f6\uff0c\u6211\u4eec\u9700\u8981\u628a translateY \u8bbe\u7f6e\u4e3a 0\u3002\\r\\n\\r\\n\u6574\u4e2a\u8fc7\u7a0b\u4e2d\uff0c\u5982\u679c\u6211\u4eec\u4e00\u76f4\u5f00\u542f\u52a8\u753b\uff0c\u6548\u679c\u4f1a\u662f\u6570\u5b57\u5148\u5411\u4e0a\u79fb\u52a8\uff0c\u518d\u5411\u4e0b\u79fb\u52a8\uff0c\u8fd9\u5e76\u4e0d\u7b26\u5408\u9884\u671f\u3002\\r\\n\\r\\n![](./img/back.gif)\\r\\n\\r\\n\u56e0\u6b64\uff0c\u6211\u4eec\u9700\u8981\u5728\u6570\u5b57\u5f00\u59cb\u79fb\u52a8\u65f6\u5f00\u542f\u52a8\u753b\uff0c\u6570\u5b57\u7ed3\u675f\u79fb\u52a8\u540e\u3001\u91cd\u7f6e\u6570\u7ec4\u524d\u5173\u95ed\u52a8\u753b\u3002\\r\\n\\r\\n<details>\\r\\n<summary>\u70b9\u51fb\u67e5\u770b\u4ee3\u7801</summary>\\r\\n\\r\\n```jsx\\r\\nconst App = function () {\\r\\n  // ... \u7701\u7565\\r\\n  const numBoxRef = useRef()\\r\\n\\r\\n  const onChange = (e) => {\\r\\n    // \u5f00\u542f\u52a8\u753b\\r\\n    numBoxRef.current.style.transition = `all 1s`\\r\\n    // ... \u7701\u7565\\r\\n  }\\r\\n\\r\\n  const onTransitionEnd = () => {\\r\\n    // \u5173\u95ed\u52a8\u753b\\r\\n    numBoxRef.current.style.transition = \'\'\\r\\n    // ... \u7701\u7565\\r\\n  }\\r\\n\\r\\n  return (\\r\\n    <main>{/* ... \u7701\u7565 */}</main>\\r\\n  )\\r\\n};\\r\\n```\\r\\n</details>\\r\\n\\r\\n## \u5b8c\u6574\u4ee3\u7801\\r\\n\\r\\n- codesandbox: https://codesandbox.io/p/sandbox/basic-scroll-number-4k65c7\\r\\n- \u7801\u4e0a\u6398\u91d1\uff1ahttps://code.juejin.cn/pen/7430439231253643273\\r\\n\\r\\n## \u603b\u7ed3\\r\\n\\r\\n\u672c\u6587\u4ecb\u7ecd\u4e86\u7c7b\u4f3c\u62fc\u591a\u591a\u7684\u91d1\u989d\u6570\u5b57\u6eda\u52a8\u5982\u4f55\u5b9e\u73b0\uff0c\u5176\u4e2d\u6709\u4e09\u4e2a\u5173\u952e\u70b9\uff0c\u5206\u522b\u662f\u91cd\u7f6e\u6570\u5b57\u6570\u7ec4\u3001\u8ba1\u7b97\u79fb\u52a8\u8ddd\u79bb\u548c\u5f00\u542f\u5173\u95ed\u52a8\u753b\u3002\\r\\n\\r\\n\u62f3\u6253 H5\uff0c\u811a\u8e22\u5c0f\u7a0b\u5e8f\u3002\u6211\u662f\u300c\u5c0f\u9716\u5bb6\u7684\u6df7\u6c5f\u9f99\u300d\uff0c\u5173\u6ce8\u6211\uff0c\u5e26\u4f60\u4e86\u89e3\u66f4\u591a\u5b9e\u7528\u7684 H5\u3001\u5c0f\u7a0b\u5e8f\u6b66\u5b66\u3002"},{"id":"/2024/07/15/canvas-fill-text","metadata":{"permalink":"/blog/2024/07/15/canvas-fill-text","source":"@site/blog/2024-07-15-canvas-fill-text/index.md","title":"\u4ece\u5546\u54c1\u6d77\u62a5\u8bf4\u8d77\uff0ccanvas \u6587\u672c\u5982\u4f55\u5b9e\u73b0\u6ea2\u51fa\u622a\u65ad\u3001\u6ea2\u51fa\u663e\u793a\u7701\u7565\u53f7\u548c\u81ea\u52a8\u6362\u884c\uff1f","description":"\u51e0\u4e4e\u6240\u6709\u7535\u5546 App \u90fd\u6709\u5206\u4eab\u5546\u54c1\u529f\u80fd\uff0c\u529f\u80fd\u5305\u62ec\u5206\u4eab H5\u3001\u5c0f\u7a0b\u5e8f\u3001\u670b\u53cb\u5708\uff0c\u8fd8\u6709\u4e00\u4e9b App \u80fd\u751f\u6210\u6d77\u62a5\u3002\u4f8b\u5982\u76d2\u9a6c\u3001\u5f97\u7269\u548c\u552f\u54c1\u4f1a\uff1a","date":"2024-07-15T00:00:00.000Z","tags":[],"readingTime":6.63,"hasTruncateMarker":false,"authors":[],"frontMatter":{},"unlisted":false,"prevItem":{"title":"\u4eff\u62fc\u591a\u591a\u9886\u7ea2\u5305\u3001\u91d1\u989d\u6570\u5b57\u79fb\u52a8\u5982\u4f55\u5b9e\u73b0\uff1f","permalink":"/blog/2024/10/27/scroll-number"},"nextItem":{"title":"\u4ece\u62fc\u591a\u591a\u5206\u4eab\u5546\u54c1\u8bf4\u8d77\uff0ccanvas \u7ed8\u56fe\u5982\u4f55\u5b9e\u73b0 contain \u548c cover \u6548\u679c\uff1f","permalink":"/blog/2024/07/11/canvas-image"}},"content":"\u51e0\u4e4e\u6240\u6709\u7535\u5546 App \u90fd\u6709\u5206\u4eab\u5546\u54c1\u529f\u80fd\uff0c\u529f\u80fd\u5305\u62ec\u5206\u4eab H5\u3001\u5c0f\u7a0b\u5e8f\u3001\u670b\u53cb\u5708\uff0c\u8fd8\u6709\u4e00\u4e9b App \u80fd\u751f\u6210\u6d77\u62a5\u3002\u4f8b\u5982\u76d2\u9a6c\u3001\u5f97\u7269\u548c\u552f\u54c1\u4f1a\uff1a\\r\\n\\r\\n![](./img/example.png)\\r\\n\\r\\n\u73b0\u5728\u6211\u4eec\u6709\u4e00\u4ef6\u65b0\u6b3e\u7206\u6b3e T \u6064\uff0c\u9700\u8981\u751f\u6210\u5e26\u5546\u54c1\u540d\u7684\u6d77\u62a5\uff0c\u4f60\u4f1a\u600e\u4e48\u505a\u5462\uff1f\\r\\n\\r\\n\u524d\u7aef\u540c\u5b66\u4e00\u822c\u4f1a\u7528 canvas \u7ed8\u5236\u6d77\u62a5\u56fe\u7247\u3001\u6587\u5b57\uff0c\u4f46 canvas \u5904\u7406\u6587\u672c\u7684\u80fd\u529b\u975e\u5e38\u5f31\uff0c\u6ca1\u6709\u539f\u751f API \u76f4\u63a5\u5b9e\u73b0\u6ea2\u51fa\u622a\u65ad\u3001\u6ea2\u51fa\u663e\u793a\u7701\u7565\u53f7\u548c\u81ea\u52a8\u6362\u884c\u3002\\r\\n\\r\\n![](./img/product.png)\\r\\n\\r\\n\u672c\u6587\u6211\u4f1a\u5148\u4ecb\u7ecd canvas \u539f\u751f\u5904\u7406\u6587\u672c\u7684 API\uff0c\u7136\u540e\u7ed9\u51fa\u51fd\u6570 `fillTruncateText`\uff0c`fillEllipsisText` \u548c `fillWrapText`\uff0c\u5206\u522b\u5b9e\u73b0 canvas \u6587\u672c\u6ea2\u51fa\u622a\u65ad\u3001\u6ea2\u51fa\u663e\u793a\u7701\u7565\u53f7\u548c\u81ea\u52a8\u6362\u884c\u3002\\r\\n\\r\\n\u62f3\u6253 H5\uff0c\u811a\u8e22\u5c0f\u7a0b\u5e8f\u3002\u6211\u662f\u300c\u5c0f\u9716\u5bb6\u7684\u6df7\u6c5f\u9f99\u300d\uff0c\u5173\u6ce8\u6211\uff0c\u5e26\u4f60\u4e86\u89e3\u66f4\u591a\u5b9e\u7528\u7684 H5\u3001\u5c0f\u7a0b\u5e8f\u6b66\u5b66\u3002\\r\\n\\r\\n## fillText\\r\\n\\r\\ncanvas \u586b\u5145\u6587\u5b57\u7684 API \u4e3a [fillText](https://developer.mozilla.org/zh-CN/docs/Web/API/CanvasRenderingContext2D/fillText)\uff0c\u5b83\u6709 4 \u4e2a\u53c2\u6570\uff1a\\r\\n\\r\\n> - text\uff0c\u9700\u8981\u6e32\u67d3\u7684\u6587\u672c\u5b57\u7b26\u4e32\u3002\\r\\n> - x\uff0c\u586b\u5145\u6587\u672c\u7684 x \u5750\u6807\uff0c\u5355\u4f4d\u4e3a\u50cf\u7d20\u3002\\r\\n> - y\uff0c\u586b\u5145\u6587\u672c\u57fa\u7ebf\u7684 y \u5750\u6807\uff0c\u5355\u4f4d\u4e3a\u50cf\u7d20\u3002\\r\\n> - maxWidth\uff0c\u586b\u5145\u6587\u672c\u7684\u6700\u5927\u5bbd\u5ea6\uff0c\u5982\u679c\u672a\u6307\u5b9a\uff0c\u5219\u6587\u672c\u5bbd\u5ea6\u6ca1\u6709\u9650\u5236\u3002\\r\\n\\r\\n\u5176\u4e2d\uff0cmaxWidth \u57fa\u672c\u6ca1\u5565\u7528\u5904\uff0c\u8bbe\u7f6e\u5b83\u65e2\u4e0d\u80fd\u5b9e\u73b0\u6ea2\u51fa\u622a\u65ad\uff0c\u4e5f\u4e0d\u80fd\u5b9e\u73b0\u6ea2\u51fa\u663e\u793a\u7701\u7565\u53f7\u3002\u5b83\u4f1a\u538b\u7f29\u6587\u5b57\uff0c\u5728\u6307\u5b9a maxWidth \u663e\u793a\u6587\u672c\u3002\\r\\n\\r\\n\u4e3e\u4f8b\u5982\u4e0b\uff0c\u7b2c\u4e00\u884c\u6587\u672c\u672a\u6307\u5b9a maxWidth\uff0c\u7b2c\u4e8c\u884c\u6587\u672c\u6307\u5b9a\u4e86 maxWidth\uff1a\\r\\n\\r\\n```js\\r\\nconst canvas = document.getElementById(\\"canvas\\")\\r\\nconst ctx = canvas.getContext(\'2d\')\\r\\n\\r\\nctx.font = \'16px Arial\'\\r\\nctx.fillStyle = \'#222426\'\\r\\nconst text = \'2024 Trump \u5ddd\u666e\u7279\u6717\u666e\u65b0\u6b3e T \u6064\u5468\u8fb9\'\\r\\nctx.fillText(text, 0, 20)\\r\\nctx.fillText(text, 0, 120, 200)\\r\\n```\\r\\n\\r\\n![](./img/set-maxWidth.jpg)\\r\\n\\r\\n\u53ef\u4ee5\u770b\u5230 maxWidth \u96be\u582a\u5927\u7528\u3002\\r\\n\\r\\n\u65e2\u7136\u539f\u751f\u7684 fillText \u4f5c\u7528\u6709\u9650\uff0c\u6211\u4eec\u4fbf\u9700\u8981\u81ea\u5df1\u7f16\u5199\u4e00\u4e9b\u51fd\u6570\uff0c\u5b9e\u73b0\u6587\u672c\u6ea2\u51fa\u622a\u65ad\u3001\u6ea2\u51fa\u663e\u793a\u7701\u7565\u53f7\u548c\u81ea\u52a8\u6362\u884c\u3002\\r\\n\\r\\n## fillTruncateText\\r\\n\\r\\n\u6211\u4eec\u5148\u770b\u6ea2\u51fa\u622a\u65ad\u3002\\r\\n\\r\\n\u8981\u5b9e\u73b0\u6ea2\u51fa\u622a\u65ad\u529f\u80fd\uff0c\u6211\u4eec\u9700\u8981\u7528\u5230 canvas \u7684\u4e00\u4e2a API [measureText](https://developer.mozilla.org/zh-CN/docs/Web/API/CanvasRenderingContext2D/measureText)\uff0c\u5b83\u53ef\u4ee5\u6d4b\u91cf\u6587\u672c\u5e76\u8fd4\u56de\u4e00\u4e2a\u5bf9\u8c61\uff08\u5bf9\u8c61\u4e2d\u5305\u542b\u4e86\u6587\u672c\u5bbd\u5ea6\uff09\u3002\\r\\n\\r\\n\u6211\u4eec\u53ef\u4ee5\u7528 `measureText` \u6d4b\u91cf\u8981\u586b\u5145\u7684\u6587\u672c\uff0c\u5982\u679c\u6587\u672c\u5bbd\u5ea6\u5c0f\u4e8e\u7b49\u4e8e maxWidth\uff0c\u4fbf\u6b63\u5e38\u7528 fillText \u586b\u5145\u6587\u672c\uff1b\u5982\u679c\u6587\u672c\u5bbd\u5ea6\u5927\u4e8e maxWidth\uff0c\u6211\u4eec\u4fbf\u4ece\u6587\u672c\u540e\u65b9\u4e00\u70b9\u4e00\u70b9\u5f80\u524d\u7f29\u77ed\u6587\u672c\uff0c\u76f4\u5230\u6587\u672c\u5bbd\u5ea6\u5c0f\u4e8e\u7b49\u4e8e maxWidth\u3002\\r\\n\\r\\n\u6309\u6b64\u601d\u8def\u5b9e\u73b0\u7684 `fillTruncateText` \u51fd\u6570\u5982\u4e0b\uff1a\\r\\n\\r\\n```js\\r\\nfunction fillTruncateText ({\\r\\n  ctx,\\r\\n  text,\\r\\n  x,\\r\\n  y,\\r\\n  maxWidth,\\r\\n  font,\\r\\n  fillStyle\\r\\n}) {\\r\\n  ctx.font = font\\r\\n  ctx.fillStyle = fillStyle\\r\\n  const textWidth = ctx.measureText(text).width\\r\\n  if (textWidth <= maxWidth) {\\r\\n    ctx.fillText(text, x, y)\\r\\n    return\\r\\n  }\\r\\n  let len = text.length\\r\\n  let sliceText = text\\r\\n  let width = textWidth\\r\\n  while (width > maxWidth && len > 0) {\\r\\n    len -= 1\\r\\n    sliceText = text.slice(0, len)\\r\\n    width = ctx.measureText(sliceText).width\\r\\n  }\\r\\n  ctx.fillText(sliceText, x, y)\\r\\n}\\r\\n```\\r\\n\\r\\n## fillEllipsisText\\r\\n\\r\\n\u518d\u770b\u6ea2\u51fa\u663e\u793a\u7701\u7565\u53f7\u3002\\r\\n\\r\\n\u6ea2\u51fa\u663e\u793a\u7701\u7565\u53f7\u7684\u601d\u8def\u548c\u622a\u65ad\u57fa\u672c\u4e00\u81f4\uff0c\u5982\u679c\u6587\u672c\u5bbd\u5ea6\u5c0f\u4e8e\u7b49\u4e8e maxWidth\uff0c\u4fbf\u6b63\u5e38\u7528 fillText \u586b\u5145\u6587\u672c\uff1b\u5982\u679c\u6587\u672c\u5bbd\u5ea6\u5927\u4e8e maxWidth\uff0c\u6211\u4eec\u4fbf\u4ece\u6587\u672c\u540e\u65b9\u4e00\u70b9\u4e00\u70b9\u5f80\u524d\u7f29\u77ed\u6587\u672c\uff0c\u76f4\u5230`\u6587\u672c\u5bbd\u5ea6 + \u7701\u7565\u53f7\u5bbd\u5ea6 <= maxWidth`\u3002\\r\\n\\r\\n\u6309\u6b64\u601d\u8def\u5b9e\u73b0\u7684 `fillEllipsisText` \u5982\u4e0b\uff1a\\r\\n\\r\\n```js\\r\\nfunction fillEllipsisText ({\\r\\n  ctx,\\r\\n  text,\\r\\n  x, \\r\\n  y,\\r\\n  maxWidth,\\r\\n  font,\\r\\n  fillStyle\\r\\n}) {\\r\\n  ctx.font = font\\r\\n  ctx.fillStyle = fillStyle\\r\\n  const ellipsis = \'...\'\\r\\n  const ellipsisWidth = ctx.measureText(ellipsis).width\\r\\n  const textWidth = ctx.measureText(text).width\\r\\n  if (ellipsisWidth + textWidth <= maxWidth) {\\r\\n    ctx.fillText(text, x, y)\\r\\n    return\\r\\n  }\\r\\n  let len = text.length\\r\\n  let sliceText = text\\r\\n  let width = textWidth\\r\\n  while (width + ellipsisWidth > maxWidth && len > 0) {\\r\\n    len -= 1\\r\\n    sliceText = text.slice(0, len)\\r\\n    width = ctx.measureText(sliceText).width\\r\\n  }\\r\\n  ctx.fillText(`${sliceText}${ellipsis}`, x, y)\\r\\n}\\r\\n```\\r\\n\\r\\n## fillWrapText\\r\\n\\r\\n\u6700\u540e\u770b\u6587\u672c\u81ea\u52a8\u6362\u884c\u3002\\r\\n\\r\\n\u548c\u6ea2\u51fa\u622a\u65ad\u3001\u6ea2\u51fa\u663e\u793a\u7701\u7565\u53f7\u4ece\u540e\u5f80\u524d\u7f29\u77ed\u6587\u672c\u7684\u601d\u8def\u4e0d\u540c\uff0c\u6587\u672c\u81ea\u52a8\u6362\u884c\u7684\u601d\u8def\u662f\u4ece\u524d\u5f80\u540e\u6162\u6162\u589e\u52a0\u6587\u672c\uff0c\u5982\u679c\u6587\u672c\u5bbd\u5ea6\u8d85\u8fc7 maxWidth\uff0c\u5219\u5f00\u59cb\u586b\u5145\u4e0b\u4e00\u884c\u6587\u672c\u3002\\r\\n\\r\\n\u5177\u4f53\u6765\u8bf4\uff1a\\r\\n\\r\\n- \u521d\u59cb\u65f6\uff0c\u6587\u672c\u81ea\u52a8\u6362\u884c\u4f1a\u5148\u628a\u6587\u672c\u62c6\u5206\u4e3a\u4e00\u4e2a\u6570\u7ec4 arrText\uff0c\u7136\u540e\u4ece\u4e0b\u6807 0 \u5f00\u59cb\uff0c\u9010\u4e2a\u53d6\u51fa\u6570\u7ec4\u4e2d\u7684\u6587\u5b57\uff0c\u6162\u6162\u62fc\u63a5\u65b0\u7684\u5b57\u7b26\u4e32\u3002\u5982\u679c\u5230\u4e0b\u6807 i \u65f6\u5b57\u7b26\u4e32\u7684\u5bbd\u5ea6\u5df2\u7ecf\u5927\u4e8e maxWidth\uff0c\u5219\u5148\u7ed8\u5236 i \u4ee5\u524d\u7684\u5b57\u7b26\u3002\\r\\n- \u7136\u540e\u53e6\u8d77\u4e00\u884c\uff0c\u8fd9\u4e00\u884c\u7684\u521d\u59cb\u5b57\u7b26\u4e3a `arrText[i]`\uff0c\u57fa\u7ebf y \u7684\u5750\u6807\u5219\u4e3a `y + lineHeight`\u3002\u6b64\u540e\u53c8\u5f00\u59cb\u9010\u4e2a\u4ece\u6570\u7ec4\u4e2d\u53d6\u51fa\u6587\u672c\u3002\u76f4\u5230\u53d1\u73b0\u8fd9\u4e00\u884c\u5bbd\u5ea6\u53c8\u5927\u4e8e\u4e86 maxWidth\u3002\\r\\n- \u53e6\u8d77\u4e00\u884c\uff0c\u5982\u6b64\u5faa\u73af\uff0c\u76f4\u5230\u6570\u7ec4 arrText \u4e2d\u7684\u5b57\u7b26\u5df2\u7ecf\u5168\u90e8\u7528\u5149\u3002\\r\\n\\r\\n\u6309\u6b64\u601d\u8def\u5b9e\u73b0\u7684 `fillWrapText` \u4ee3\u7801\u5982\u4e0b\uff1a\\r\\n\\r\\n```js\\r\\nfunction fillWrapText ({\\r\\n  ctx,\\r\\n  text,\\r\\n  x,\\r\\n  y,\\r\\n  maxWidth,\\r\\n  lineHeight,\\r\\n  font,\\r\\n  fillStyle\\r\\n}) {\\r\\n  ctx.font = font\\r\\n  ctx.fillStyle = fillStyle\\r\\n  const arrText = text.split(\'\')\\r\\n  let line = \'\'\\r\\n\\r\\n  for (let i = 0; i < arrText.length; i++) {\\r\\n    let testLine = line + arrText[i]\\r\\n    let testWidth = ctx.measureText(testLine).width\\r\\n    if (testWidth > maxWidth) {\\r\\n      ctx.fillText(line, x, y)\\r\\n      line = arrText[i]\\r\\n      y += lineHeight\\r\\n    } else {\\r\\n      line = testLine\\r\\n    }\\r\\n  }\\r\\n  ctx.fillText(line, x, y)\\r\\n}\\r\\n```\\r\\n\\r\\n## \u793a\u4f8b\u4ee3\u7801\\r\\n\\r\\n\u5149\u9760\u6587\u7ae0\u6bd4\u8f83\u67af\u71e5\uff0c\u6211\u7ed9\u4e09\u4e2a\u5de5\u5177\u5199\u4e86\u793a\u4f8b\uff0c\u4f60\u53ef\u4ee5\u5728 codepen \u6216\u8005\u7801\u4e0a\u6398\u91d1\u4e0a\u67e5\u770b\uff1a\\r\\n\\r\\n- codepen: https://codepen.io/lijunlin2022/pen/xxoxVaK\\r\\n- \u7801\u4e0a\u6398\u91d1: https://code.juejin.cn/pen/7391408282185531419\\r\\n\\r\\n## \u603b\u7ed3\\r\\n\\r\\n\u672c\u6587\u6211\u4f1a\u5148\u4ecb\u7ecd canvas \u539f\u751f\u5904\u7406\u6587\u672c\u7684 API\uff0c\u7136\u540e\u7ed9\u51fa\u51fd\u6570 `fillTruncateText`\uff0c`fillEllipsisText` \u548c `fillWrapText`\uff0c\u5206\u522b\u5b9e\u73b0 canvas \u6587\u672c\u6ea2\u51fa\u622a\u65ad\u3001\u6ea2\u51fa\u663e\u793a\u7701\u7565\u53f7\u548c\u81ea\u52a8\u6362\u884c\u3002\\r\\n\\r\\n\u62f3\u6253 H5\uff0c\u811a\u8e22\u5c0f\u7a0b\u5e8f\u3002\u6211\u662f\u300c\u5c0f\u9716\u5bb6\u7684\u6df7\u6c5f\u9f99\u300d\uff0c\u5173\u6ce8\u6211\uff0c\u5e26\u4f60\u4e86\u89e3\u66f4\u591a\u5b9e\u7528\u7684 H5\u3001\u5c0f\u7a0b\u5e8f\u6b66\u5b66\u3002\\r\\n\\r\\n## \u53c2\u8003\u6587\u7ae0\\r\\n\\r\\n- [canvas\u6587\u672c\u7ed8\u5236\u81ea\u52a8\u6362\u884c\u3001\u5b57\u95f4\u8ddd\u3001\u7ad6\u6392\u7b49\u5b9e\u73b0 | \u5f20\u946b\u65ed](https://www.zhangxinxu.com/wordpress/2018/02/canvas-text-break-line-letter-spacing-vertical/)"},{"id":"/2024/07/11/canvas-image","metadata":{"permalink":"/blog/2024/07/11/canvas-image","source":"@site/blog/2024-07-11-canvas-image/index.md","title":"\u4ece\u62fc\u591a\u591a\u5206\u4eab\u5546\u54c1\u8bf4\u8d77\uff0ccanvas \u7ed8\u56fe\u5982\u4f55\u5b9e\u73b0 contain \u548c cover \u6548\u679c\uff1f","description":"\u6211\u4eec\u5076\u5c14\u4f1a\u5728\u4e00\u4e9b H5\u3001\u5c0f\u7a0b\u5e8f\u4e2d\uff0c\u770b\u5230\u5206\u4eab\u5546\u54c1\u7684\u529f\u80fd\u3002\u6bd4\u5982\u62fc\u591a\u591a\u5c0f\u7a0b\u5e8f\u4e2d\uff0c\u7528\u6237\u53ef\u4ee5\u628a\u5546\u54c1\u5206\u4eab\u7ed9\u81ea\u5df1\u7684\u597d\u53cb\u3002\u5206\u4eab\u56fe\u4e3b\u8981\u7531 2 \u5f20\u56fe\u7247\u7ec4\u6210\uff0c\u4e00\u5f20\u5546\u54c1\u56fe\uff0c\u4e00\u5f20\u80cc\u666f\u56fe\u3002","date":"2024-07-11T00:00:00.000Z","tags":[],"readingTime":8.75,"hasTruncateMarker":false,"authors":[],"frontMatter":{},"unlisted":false,"prevItem":{"title":"\u4ece\u5546\u54c1\u6d77\u62a5\u8bf4\u8d77\uff0ccanvas \u6587\u672c\u5982\u4f55\u5b9e\u73b0\u6ea2\u51fa\u622a\u65ad\u3001\u6ea2\u51fa\u663e\u793a\u7701\u7565\u53f7\u548c\u81ea\u52a8\u6362\u884c\uff1f","permalink":"/blog/2024/07/15/canvas-fill-text"},"nextItem":{"title":"\u4eff\u4eca\u65e5\u5934\u6761\uff0cH5 \u5faa\u73af\u64ad\u653e\u7684\u901a\u77e5\u680f\u5982\u4f55\u5b9e\u73b0\uff1f","permalink":"/blog/2024/05/26/loop-notice"}},"content":"\u6211\u4eec\u5076\u5c14\u4f1a\u5728\u4e00\u4e9b H5\u3001\u5c0f\u7a0b\u5e8f\u4e2d\uff0c\u770b\u5230\u5206\u4eab\u5546\u54c1\u7684\u529f\u80fd\u3002\u6bd4\u5982\u62fc\u591a\u591a\u5c0f\u7a0b\u5e8f\u4e2d\uff0c\u7528\u6237\u53ef\u4ee5\u628a\u5546\u54c1\u5206\u4eab\u7ed9\u81ea\u5df1\u7684\u597d\u53cb\u3002\u5206\u4eab\u56fe\u4e3b\u8981\u7531 2 \u5f20\u56fe\u7247\u7ec4\u6210\uff0c\u4e00\u5f20\u5546\u54c1\u56fe\uff0c\u4e00\u5f20\u80cc\u666f\u56fe\u3002\\r\\n\\r\\n![](./img/pdd.jpg)\\r\\n\\r\\n\u5546\u54c1\u56fe\u901a\u5e38\u7531\u5546\u5bb6\u81ea\u5df1\u914d\u7f6e\uff0c\u5c3a\u5bf8\u4f1a\u53d8\u52a8\uff0c\u4e00\u822c\u662f contain \u6548\u679c\uff1b\u80cc\u666f\u56fe\u901a\u5e38\u7531 UI \u63d0\u4f9b\uff0c\u5c3a\u5bf8\u56fa\u5b9a\uff0c\u4e00\u822c\u662f cover \u6548\u679c\u3002\\r\\n\\r\\n![](./img/contain-and-cover.png)\\r\\n\\r\\n\u5982\u679c\u4f7f\u7528 css\uff0c\u6211\u4eec\u53ef\u4ee5\u7ed9 `background-size` \u8bbe\u7f6e `contain` \u548c `cover`\uff0c\u53ef\u60dc\u8fd9\u7c7b\u5206\u4eab\u56fe\u57fa\u672c\u7531 canvas \u7ed8\u5236\u800c\u6210\u3002canvas \u53ea\u63d0\u4f9b\u4e86 [drawImage()](https://developer.mozilla.org/zh-CN/docs/Web/API/CanvasRenderingContext2D/drawImage) \u7ed8\u5236\u56fe\u7247\uff0c\u65e0\u6cd5\u7cbe\u51c6\u5b9e\u73b0 `contain` \u548c `cover` \u6548\u679c\uff0c\u4e8e\u662f\u6211\u5b9e\u73b0\u4e86 `drawContainImage` \u548c `drawCoverImage` \u4e24\u4e2a\u5de5\u5177\u51fd\u6570\u3002\\r\\n\\r\\n\u672c\u6587\u6211\u4f1a\u5148\u5206\u6790 contain \u6548\u679c\u7684`\u56fe\u7247\u5bbd\u9ad8\u6bd4`\u548c`\u5bb9\u5668\u5bbd\u9ad8\u6bd4`\uff0c\u5e76\u7ed9\u51fa drawContainImage \u5de5\u5177\u51fd\u6570\uff1b\u518d\u5206\u6790 cover \u6548\u679c\u7684`\u56fe\u7247\u5bbd\u9ad8\u6bd4`\u548c`\u5bb9\u5668\u5bbd\u9ad8\u6bd4`\uff0c\u5e76\u7ed9\u51fa drawCoverImage \u5de5\u5177\u51fd\u6570\uff1b\u6700\u540e\u6211\u4f1a\u7528\u4e24\u4e2a\u5de5\u5177\u51fd\u6570\uff0c\u7ed8\u5236\u5982\u4e0b\u5206\u4eab\u56fe\uff1a\\r\\n\\r\\n![](./img/product.png)\\r\\n\\r\\n\u62f3\u6253 H5\uff0c\u811a\u8e22\u5c0f\u7a0b\u5e8f\u3002\u6211\u662f\u300c\u5c0f\u9716\u5bb6\u7684\u6df7\u6c5f\u9f99\u300d\uff0c\u5173\u6ce8\u6211\uff0c\u5e26\u4f60\u4e86\u89e3\u66f4\u591a\u5b9e\u7528\u7684 H5\u3001\u5c0f\u7a0b\u5e8f\u6b66\u5b66\u3002\\r\\n\\r\\n## contain \u6548\u679c\\r\\n\\r\\n\u5148\u6765\u770b contain \u6548\u679c\u3002contain \u6548\u679c\u662f\u300c\u7f29\u653e\u56fe\u7247\u4ee5**\u5b8c\u5168\u88c5\u5165**\u5bb9\u5668\u300d\uff0c\u5b83\u4f1a\u6709\u4e24\u79cd\u60c5\u51b5\uff1a\\r\\n\\r\\n- \u56fe\u7247\u5bbd\u9ad8\u6bd4 < \u5bb9\u5668\u5bbd\u9ad8\u6bd4\uff0c\u7f29\u653e\u540e\u56fe\u7247\u5bbd\u5ea6 < \u5bb9\u5668\u5bbd\u5ea6\uff0c\u56fe\u7247\u9ad8\u5ea6 = \u5bb9\u5668\u9ad8\u5ea6\u3002\\r\\n- \u56fe\u7247\u5bbd\u9ad8\u6bd4 > \u5bb9\u5668\u5bbd\u9ad8\u6bd4\uff0c\u7f29\u653e\u540e\u56fe\u7247\u5bbd\u5ea6 = \u5bb9\u5668\u5bbd\u5ea6\uff0c\u56fe\u7247\u9ad8\u5ea6 < \u5bb9\u5668\u9ad8\u5ea6\u3002\\r\\n\\r\\n![](./img/canvas-contain.png)\\r\\n\\r\\n\u4e0d\u96be\u770b\u51fa\uff0ccontain \u6548\u679c\u4e0b\uff0c\u56fe\u7247\u603b\u662f\u5b8c\u6574\u5c55\u793a\u7684\uff0c\u56e0\u6b64\u6211\u4eec\u4e0d\u5fc5\u8003\u8651\u88c1\u526a\u56fe\u7247\u3002[drawImage](https://developer.mozilla.org/zh-CN/docs/Web/API/CanvasRenderingContext2D/drawImage) \u7684 9 \u4e2a\u53c2\u6570\u4e2d\uff0c\u6211\u4eec\u53ea\u9700\u8981\u8003\u8651 5 \u4e2a\u53c2\u6570\uff1a\\r\\n\\r\\n> - `image`\uff0c\u753b\u5e03\u56fe\u50cf\u6e90\u3002\\r\\n> - `dx`\uff0cimage \u7684\u5de6\u4e0a\u89d2\u5728\u76ee\u6807\u753b\u5e03\u4e0a X \u8f74\u5750\u6807\u3002\\r\\n> - `dy`\uff0cimage \u7684\u5de6\u4e0a\u89d2\u5728\u76ee\u6807\u753b\u5e03\u4e0a Y \u8f74\u5750\u6807\u3002\\r\\n> - `dw`\uff0cimage \u5728\u76ee\u6807\u753b\u5e03\u4e0a\u7ed8\u5236\u7684\u5bbd\u5ea6\u3002\\r\\n> - `dh`\uff0cimage \u5728\u76ee\u6807\u753b\u5e03\u4e0a\u7ed8\u5236\u7684\u9ad8\u5ea6\u3002\\r\\n\\r\\n### \u56fe\u7247\u5bbd\u9ad8\u6bd4 < \u5bb9\u5668\u5bbd\u9ad8\u6bd4\\r\\n\\r\\n\u56fe\u7247\u5bbd\u9ad8\u6bd4 < \u5bb9\u5668\u5bbd\u9ad8\u6bd4\u65f6\uff0cdy\uff0cdw \u548c dh \u53ef\u4ee5\u76f4\u89c2\u770b\u51fa\u6765\uff0c\u800c dx \u8fd8\u9700\u8981\u5355\u72ec\u8ba1\u7b97\u3002\u5982\u4e0b\u56fe\u6240\u793a\uff1a\\r\\n\\r\\n![](./img/canvas-contain-imgRatio-le-canvasRatio.png)\\r\\n\\r\\n- dx \u662f image \u7684\u5de6\u4e0a\u89d2\u5728\u76ee\u6807\u753b\u5e03\u4e0a X \u8f74\u5750\u6807\uff0c`dx = (width - dw) / 2`\uff1b\\r\\n- dy \u662f image \u7684\u5de6\u4e0a\u89d2\u5728\u76ee\u6807\u753b\u5e03\u4e0a Y \u8f74\u5750\u6807\uff0c`dy = 0`\uff1b\\r\\n- dw \u662f image \u5728\u76ee\u6807\u753b\u5e03\u4e0a\u7ed8\u5236\u7684\u5bbd\u5ea6\uff0c`dw = imgRatio * width`\uff1b\\r\\n- dh \u662f image \u5728\u76ee\u6807\u753b\u5e03\u4e0a\u7ed8\u5236\u7684\u9ad8\u5ea6\uff0c`dh = height`\u3002\\r\\n\\r\\n### \u56fe\u7247\u5bbd\u9ad8\u6bd4 > \u5bb9\u5668\u5bbd\u9ad8\u6bd4\\r\\n\\r\\n\u56fe\u7247\u5bbd\u9ad8\u6bd4 > \u5bb9\u5668\u5bbd\u9ad8\u6bd4\u65f6\uff0cdx\uff0cdw \u548c dh \u53ef\u4ee5\u76f4\u89c2\u770b\u51fa\u6765\uff0c\u800c dy \u8fd8\u9700\u8981\u5355\u72ec\u8ba1\u7b97\u3002\u5982\u4e0b\u56fe\u6240\u793a\uff1a\\r\\n\\r\\n![](./img/canvas-contain-imgRatio-ge-canvasRatio.png)\\r\\n\\r\\n- dx \u662f image \u7684\u5de6\u4e0a\u89d2\u5728\u76ee\u6807\u753b\u5e03\u4e0a X \u8f74\u5750\u6807\uff0c`dx = 0`\uff1b\\r\\n- dy \u662f image \u7684\u5de6\u4e0a\u89d2\u5728\u76ee\u6807\u753b\u5e03\u4e0a Y \u8f74\u5750\u6807\uff0c`dy = (height - dh) / 2`\uff1b\\r\\n- dw \u662f image \u5728\u76ee\u6807\u753b\u5e03\u4e0a\u7ed8\u5236\u7684\u5bbd\u5ea6\uff0c`dw = width`\uff1b\\r\\n- dh \u662f image \u5728\u76ee\u6807\u753b\u5e03\u4e0a\u7ed8\u5236\u7684\u9ad8\u5ea6\uff0c`dh = dw / imgRatio`\u3002\\r\\n\\r\\n### drawContainImage \u4ee3\u7801\\r\\n\\r\\n\u4e0b\u9762\u662f drawContainImage \u7684\u4ee3\u7801\uff0c\u56e0\u4e3a contain \u6548\u679c\u4e00\u822c\u4f1a\u7559\u6709\u7a7a\u767d\uff0c\u6240\u4ee5\u6211\u589e\u52a0\u4e86\u4e00\u4e2a fillStyle \u53c2\u6570\uff0c\u7528\u6765\u8bbe\u7f6e\u7a7a\u767d\u90e8\u5206\u7684\u989c\u8272\u3002\\r\\n\\r\\n```js\\r\\nfunction drawContainImage({\\r\\n  ctx, img, x, y, width, height, fillStyle\\r\\n}) {\\r\\n  if (fillStyle) {\\r\\n    ctx.fillStyle = fillStyle\\r\\n    ctx.fillRect(x, y, width, height)\\r\\n  }\\r\\n  const boxRatio = width / height\\r\\n  const imgRatio = img.width / img.height\\r\\n\\r\\n  let dx = 0, dy = 0, dw = 0, dh = 0\\r\\n  if (imgRatio <= boxRatio) {\\r\\n    dw = imgRatio * width\\r\\n    dh = height\\r\\n    dx = (width - dw) / 2\\r\\n    dy = 0\\r\\n  } else {\\r\\n    dw = width\\r\\n    dh = dw / imgRatio\\r\\n    dx = 0\\r\\n    dy = (height - dh) / 2\\r\\n  }\\r\\n  ctx.drawImage(img, x + dx, y + dy, dw, dh)\\r\\n}\\r\\n```\\r\\n\\r\\n## cover \u6548\u679c\\r\\n\\r\\n\u518d\u770b cover \u6548\u679c\uff0ccover \u6548\u679c\u662f\u300c\u7f29\u653e\u56fe\u7247\u4ee5**\u5b8c\u5168\u8986\u76d6**\u5bb9\u5668\u300d\u3002\u5982\u4e0b\u793a\u610f\u56fe\u6240\u793a\uff0c\u7f29\u653e\u540e\u56fe\u7247\uff08\u7ea2\u8272\u90e8\u5206\uff09\u6bd4\u5bb9\u5668\uff08\u7eff\u8272\u90e8\u5206\uff09\u5927\u3002\u5b83\u4f1a\u6709\u4e24\u79cd\u60c5\u51b5\uff1a\\r\\n\\r\\n- \u56fe\u7247\u5bbd\u9ad8\u6bd4 > \u5bb9\u5668\u5bbd\u9ad8\u6bd4\uff0c\u7f29\u653e\u540e\u56fe\u7247\u5bbd\u5ea6 = \u5bb9\u5668\u5bbd\u5ea6\uff0c\u56fe\u7247\u9ad8\u5ea6 > \u5bb9\u5668\u9ad8\u5ea6\u3002\\r\\n- \u56fe\u7247\u5bbd\u9ad8\u6bd4 < \u5bb9\u5668\u5bbd\u9ad8\u6bd4\uff0c\u7f29\u653e\u540e\u56fe\u7247\u5bbd\u5ea6 < \u5bb9\u5668\u5bbd\u5ea6\uff0c\u56fe\u7247\u9ad8\u5ea6 = \u5bb9\u5668\u9ad8\u5ea6\u3002\\r\\n\\r\\n![](./img/canvas-cover.png)\\r\\n\\r\\n\u4e0d\u96be\u770b\u51fa\uff0ccontain \u6548\u679c\u4e0b\uff0c\u56fe\u7247\u603b\u662f\u9700\u8981\u88c1\u526a\u56fe\u7247\uff0c\u6240\u4ee5 [drawImage](https://developer.mozilla.org/zh-CN/docs/Web/API/CanvasRenderingContext2D/drawImage) \u7684 9 \u4e2a\u53c2\u6570\u6211\u4eec\u90fd\u9700\u8981\u4f7f\u7528\uff1a\\r\\n\\r\\n> - `image`\uff0c\u753b\u5e03\u56fe\u50cf\u6e90\u3002\\r\\n> - `sx`\uff0cimage \u7684\u77e9\u5f62\uff08\u88c1\u526a\uff09\u9009\u62e9\u6846\u7684\u5de6\u4e0a\u89d2 X \u8f74\u5750\u6807\u3002\\r\\n> - `sy`\uff0cimage \u7684\u77e9\u5f62\uff08\u88c1\u526a\uff09\u9009\u62e9\u6846\u7684\u5de6\u4e0a\u89d2 Y \u8f74\u5750\u6807\u3002\\r\\n> - `sw`\uff0cimage \u7684\u77e9\u5f62\uff08\u88c1\u526a\uff09\u9009\u62e9\u6846\u7684\u5bbd\u5ea6\u3002\\r\\n> - `sh`\uff0cimage\u7684\u77e9\u5f62\uff08\u88c1\u526a\uff09\u9009\u62e9\u6846\u7684\u9ad8\u5ea6\u3002\\r\\n> - `dx`\uff0cimage \u7684\u5de6\u4e0a\u89d2\u5728\u76ee\u6807\u753b\u5e03\u4e0a X \u8f74\u5750\u6807\u3002\\r\\n> - `dy`\uff0cimage \u7684\u5de6\u4e0a\u89d2\u5728\u76ee\u6807\u753b\u5e03\u4e0a Y \u8f74\u5750\u6807\u3002\\r\\n> - `dw`\uff0cimage \u5728\u76ee\u6807\u753b\u5e03\u4e0a\u7ed8\u5236\u7684\u5bbd\u5ea6\u3002\\r\\n> - `dh`\uff0cimage \u5728\u76ee\u6807\u753b\u5e03\u4e0a\u7ed8\u5236\u7684\u9ad8\u5ea6\u3002\\r\\n\\r\\n\u5e78\u8fd0\u7684\u662f\uff0ccontain \u6548\u679c\u4e0b\uff0cdx, dy, dw \u548c dh \u7684\u53d6\u503c\u90fd\u662f\u56fa\u5b9a\u7684\uff0c\u6240\u4ee5\u6211\u4eec\u9700\u8981\u7740\u91cd\u8003\u8651\u7684\u53ea\u6709 sx, sy, sw \u548c sh \u8fd9 4 \u4e2a\u53c2\u6570\u3002\\r\\n\\r\\n### \u56fe\u7247\u5bbd\u9ad8\u6bd4 > \u5bb9\u5668\u5bbd\u9ad8\u6bd4\\r\\n\\r\\n\u56fe\u7247\u5bbd\u9ad8\u6bd4 > \u5bb9\u5668\u5bbd\u9ad8\u6bd4\u65f6\uff0csy\uff0csw \u548c sh \u53ef\u4ee5\u76f4\u89c2\u770b\u51fa\u6765\uff0c\u800c sx \u8fd8\u9700\u8981\u5355\u72ec\u8ba1\u7b97\u3002\u5982\u4e0b\u56fe\u6240\u793a\uff1a\\r\\n\\r\\n![](./img/canvas-cover-imgRatio-ge-canvasRatio.png)\\r\\n\\r\\n- sx \u662f image \u88c1\u526a\u9009\u62e9\u6846\uff08\u7eff\u8272\u90e8\u5206\uff09\u7684\u5de6\u4e0a\u89d2 X \u8f74\u5750\u6807\uff0c`sx = (img.width - sw) / 2`\uff1b\\r\\n- sy \u662f image \u88c1\u526a\u9009\u62e9\u6846\uff08\u7eff\u8272\u90e8\u5206\uff09\u7684\u5de6\u4e0a\u89d2 Y \u8f74\u5750\u6807\uff0c`sy = 0`\uff1b\\r\\n- sw \u662f image \u88c1\u526a\u9009\u62e9\u6846\uff08\u7eff\u8272\u90e8\u5206\uff09\u7684\u5bbd\u5ea6\uff0c`sw = sh * boxRatio`\uff1b\\r\\n- sh \u662f image \u88c1\u526a\u9009\u62e9\u6846\uff08\u7eff\u8272\u90e8\u5206\uff09\u7684\u9ad8\u5ea6\uff0c`sh = img.height`\u3002\\r\\n\\r\\n### \u56fe\u7247\u5bbd\u9ad8\u6bd4 < \u5bb9\u5668\u5bbd\u9ad8\u6bd4\\r\\n\\r\\n\u56fe\u7247\u5bbd\u9ad8\u6bd4 < \u5bb9\u5668\u5bbd\u9ad8\u6bd4\u65f6\uff0csx, sw \u548c sh \u53ef\u4ee5\u76f4\u89c2\u770b\u51fa\u6765\uff0c\u800c sy \u8fd8\u9700\u8981\u5355\u72ec\u8ba1\u7b97\u3002\u5982\u4e0b\u56fe\u6240\u793a\uff1a\\r\\n\\r\\n![](./img/canvas-cover-imgRatio-le-canvasRatio.png)\\r\\n\\r\\n- sx \u662f image \u88c1\u526a\u9009\u62e9\u6846\uff08\u7eff\u8272\u90e8\u5206\uff09\u7684\u5de6\u4e0a\u89d2 X \u8f74\u5750\u6807\uff0c`sx = 0`\uff1b\\r\\n- sy \u662f image \u88c1\u526a\u9009\u62e9\u6846\uff08\u7eff\u8272\u90e8\u5206\uff09\u7684\u5de6\u4e0a\u89d2 Y \u8f74\u5750\u6807\uff0c`sy = (img.height - sh) / 2`\uff1b\\r\\n- sw \u662f image \u88c1\u526a\u9009\u62e9\u6846\uff08\u7eff\u8272\u90e8\u5206\uff09\u7684\u5bbd\u5ea6\uff0c`sw = img.width`\uff1b\\r\\n- sh \u662f image \u88c1\u526a\u9009\u62e9\u6846\uff08\u7eff\u8272\u90e8\u5206\uff09\u7684\u9ad8\u5ea6\uff0c`sh = sw / boxRatio`\u3002\\r\\n\\r\\n### drawCoverImage \u4ee3\u7801\\r\\n\\r\\n\u4e0b\u9762\u662f drawCoverImage \u7684\u4ee3\u7801\uff0c\u56e0\u4e3a cover \u6548\u679c\u4e0d\u4f1a\u7559\u7a7a\u767d\uff0c\u6240\u4ee5\u4e0d\u9700\u8981 fillStyle \u53c2\u6570\u3002\\r\\n\\r\\n```js\\r\\nfunction drawCoverImage({\\r\\n  ctx, img, x, y, width, height\\r\\n}) {\\r\\n  const boxRatio = width / height\\r\\n  const imgRatio = img.width / img.height\\r\\n\\r\\n  let sx = 0, sy = 0, sw = 0, sh = 0\\r\\n  if (imgRatio <= boxRatio) {\\r\\n    sw = img.width\\r\\n    sh = sw / boxRatio\\r\\n    sx = 0\\r\\n    sy = (img.height - sh) / 2\\r\\n  } else {\\r\\n    sh = img.height\\r\\n    sw = sh * boxRatio\\r\\n    sx = (img.width - sw) / 2\\r\\n    sy = 0\\r\\n  }\\r\\n\\r\\n  ctx.drawImage(img, sx, sy, sw, sh, x, y, width, height)\\r\\n}\\r\\n```\\r\\n\\r\\n## \u5b8c\u6574\u4ee3\u7801\\r\\n\\r\\n\u5b8c\u6574\u4ee3\u7801\u53ef\u4ee5\u5728\u7801\u4e0a\u6398\u91d1\u4e0a\u67e5\u770b\uff1ahttps://code.juejin.cn/pen/7388885726391992371\\r\\n\\r\\n## \u603b\u7ed3\\r\\n\\r\\n\u672c\u6587\u6211\u5206\u6790\u4e86 contain \u6548\u679c\u3001cover \u6548\u679c\u7684`\u56fe\u7247\u5bbd\u9ad8\u6bd4`\u548c`\u5bb9\u5668\u5bbd\u9ad8\u6bd4`\u5173\u7cfb\uff0c\u5e76\u7ed9\u51fa drawContainImage \u548c drawCoverImage \u5de5\u5177\u51fd\u6570\uff0c\u6700\u540e\u7528\u4e24\u4e2a\u5de5\u5177\u51fd\u6570\uff0c\u7ed8\u5236\u4e86\u4e00\u4e2a\u5546\u54c1\u5206\u4eab\u56fe\u3002\\r\\n\\r\\n\u62f3\u6253 H5\uff0c\u811a\u8e22\u5c0f\u7a0b\u5e8f\u3002\u6211\u662f\u300c\u5c0f\u9716\u5bb6\u7684\u6df7\u6c5f\u9f99\u300d\uff0c\u5173\u6ce8\u6211\uff0c\u5e26\u4f60\u4e86\u89e3\u66f4\u591a\u5b9e\u7528\u7684 H5\u3001\u5c0f\u7a0b\u5e8f\u6b66\u5b66\u3002\\r\\n\\r\\n## \u53c2\u8003\u6587\u7ae0\\r\\n\\r\\n- [canvas drawImage \u7ed8\u56fe\u5b9e\u73b0 contain \u548c cover \u7684\u6548\u679c](https://www.cnblogs.com/AIonTheRoad/p/14063041.html)\\r\\n- [\u5728\u5bb9\u5668\u5185\u663e\u793a\u56fe\u7247\u7684\u4e94\u79cd\u65b9\u6848\uff1acontain\u3001cover\u3001fill\u3001none\u3001scale-down](https://developer.aliyun.com/article/916087)"},{"id":"/2024/05/26/loop-notice","metadata":{"permalink":"/blog/2024/05/26/loop-notice","source":"@site/blog/2024-05-26-loop-notice/index.md","title":"\u4eff\u4eca\u65e5\u5934\u6761\uff0cH5 \u5faa\u73af\u64ad\u653e\u7684\u901a\u77e5\u680f\u5982\u4f55\u5b9e\u73b0\uff1f","description":"\u6211\u4eec\u5728\u5404\u5927 App \u6d3b\u52a8\u9875\u9762\uff0c\u7ecf\u5e38\u4f1a\u770b\u5230\u5faa\u73af\u64ad\u653e\u7684\u901a\u77e5\u680f\u3002\u6bd4\u5982\u6625\u8282\u671f\u95f4\uff0c\u6211\u5c31\u5728\u4eca\u65e5\u5934\u6761 App \u4e2d\u770b\u5230\u4e86\u5982\u4e0b\u901a\u77e5\uff1a\u300c\u6625\u8282\u671f\u95f4\uff0c\u90e8\u5206\u5546\u54c1\u53d7\u7269\u6d41\u5f71\u54cd\u5ef6\u8fdf\u53d1\u8d27\uff0c\u8bf7\u8010\u5fc3\u7b49\u5f85\uff0c\u795d\u4f60\u65b0\u6625\u5feb\u4e50\uff01\u300d\u3002","date":"2024-05-26T00:00:00.000Z","tags":[],"readingTime":5.085,"hasTruncateMarker":false,"authors":[],"frontMatter":{},"unlisted":false,"prevItem":{"title":"\u4ece\u62fc\u591a\u591a\u5206\u4eab\u5546\u54c1\u8bf4\u8d77\uff0ccanvas \u7ed8\u56fe\u5982\u4f55\u5b9e\u73b0 contain \u548c cover \u6548\u679c\uff1f","permalink":"/blog/2024/07/11/canvas-image"},"nextItem":{"title":"\u4eff\u5fae\u4fe1\u8bfb\u4e66\uff0cH5 \u7ffb\u8f6c\u5361\u7247\u5982\u4f55\u5b9e\u73b0\uff1f","permalink":"/blog/2024/05/17/reversible-card"}},"content":"\u6211\u4eec\u5728\u5404\u5927 App \u6d3b\u52a8\u9875\u9762\uff0c\u7ecf\u5e38\u4f1a\u770b\u5230\u5faa\u73af\u64ad\u653e\u7684\u901a\u77e5\u680f\u3002\u6bd4\u5982\u6625\u8282\u671f\u95f4\uff0c\u6211\u5c31\u5728\u4eca\u65e5\u5934\u6761 App \u4e2d\u770b\u5230\u4e86\u5982\u4e0b\u901a\u77e5\uff1a\u300c\u6625\u8282\u671f\u95f4\uff0c\u90e8\u5206\u5546\u54c1\u53d7\u7269\u6d41\u5f71\u54cd\u5ef6\u8fdf\u53d1\u8d27\uff0c\u8bf7\u8010\u5fc3\u7b49\u5f85\uff0c\u795d\u4f60\u65b0\u6625\u5feb\u4e50\uff01\u300d\u3002\\r\\n\\r\\n![](./img/toutiao.gif)\\r\\n\\r\\n\u90a3\u4e48\uff0c\u8fd9\u79cd\u5faa\u73af\u64ad\u653e\u7684\u901a\u77e5\u680f\u5982\u4f55\u5b9e\u73b0\u5462\uff1f\u672c\u6587\u6211\u4f1a\u5148\u4ecb\u7ecd\u5b83\u7684\u5e03\u5c40\u3001\u518d\u4ecb\u7ecd\u5b83\u7684\u903b\u8f91\uff0c\u5e76\u7ed9\u51fa\u5b8c\u6574\u7684\u4ee3\u7801\u3002\u6700\u7ec8\u6211\u5b9e\u73b0\u7684\u6548\u679c\u5982\u4e0b\uff1a\\r\\n\\r\\n![](./img/loop-notice.gif)\\r\\n\\r\\n\u62f3\u6253 H5\uff0c\u811a\u8e22\u5c0f\u7a0b\u5e8f\u3002\u6211\u662f\u300c\u5c0f\u9716\u5bb6\u7684\u6df7\u6c5f\u9f99\u300d\uff0c\u5173\u6ce8\u6211\uff0c\u5e26\u4f60\u4e86\u89e3\u66f4\u591a\u5b9e\u7528\u7684 H5\u3001\u5c0f\u7a0b\u5e8f\u6b66\u5b66\u3002\\r\\n\\r\\n## \u5e03\u5c40\u4ee3\u7801\\r\\n\\r\\n\u6211\u4eec\u5148\u770b\u5e03\u5c40\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff0c\u5faa\u73af\u64ad\u653e\u7684\u5e03\u5c40\u4e0d\u662f\u666e\u901a\u7684\u5de6\u4e2d\u53f3\u5e03\u5c40\u3002\u53ef\u4ee5\u770b\u5230\uff0c\u5f53\u6587\u5b57\u5411\u5de6\u79fb\u52a8\u65f6\uff0c\u5de6\u8fb9\u7684\u901a\u77e5 Icon \u548c\u53f3\u8fb9\u7684\u7559\u767d\u4f1a\u628a\u6587\u5b57\u6321\u4f4f\u4e00\u90e8\u5206\u3002\\r\\n\\r\\n![](./img/block-out.png)\\r\\n\\r\\n\u4e3a\u4e86\u5b9e\u73b0\u8fd9\u6837\u7684\u6548\u679c\uff0c\u6211\u4eec\u7ed9\u5bb9\u5668 box \u8bbe\u7f6e\u4e00\u4e2a\u76f8\u5bf9\u5b9a\u4f4d\uff0c\u5e76\u628a box \u4e2d\u7684 HTML \u4ee3\u7801\u5206\u4e3a\u4e09\u90e8\u5206\uff1a\\r\\n\\r\\n- \u7b2c\u4e00\u90e8\u5206\u662f content\uff0c\u5b83\u5305\u88f9\u7740\u9700\u8981\u5faa\u73af\u64ad\u653e\u7684\u6587\u5b57\uff1b\\r\\n- \u7b2c\u4e8c\u90e8\u5206\u662f left\uff0c\u5b83\u662f\u5de6\u8fb9\u7684\u901a\u77e5 Icon\uff0c\u6211\u4eec\u7ed9\u5b83\u8bbe\u7f6e\u7edd\u5bf9\u5b9a\u4f4d\u548c `left: 0;`\uff1b\\r\\n- \u7b2c\u4e09\u90e8\u5206\u662f right\uff0c\u5b83\u662f\u53f3\u8fb9\u7684\u7559\u767d\uff0c\u6211\u4eec\u7ed9\u5b83\u8bbe\u7f6e\u7edd\u5bf9\u5b9a\u4f4d\u548c `right: 0;`\u3002\\r\\n\\r\\n```html\\r\\n<div class=\\"box\\">\\r\\n  <div class=\\"content\\">\\r\\n    \x3c!-- ... \u7701\u7565 --\x3e\\r\\n  </div>\\r\\n  <div class=\\"left\\">\ud83d\udd14</div>\\r\\n  <div class=\\"right\\"></div>\\r\\n</div>\\r\\n```\\r\\n\\r\\n```css\\r\\n.box {\\r\\n  position: relative;\\r\\n  overflow: hidden;\\r\\n  /* ... \u7701\u7565 */\\r\\n}\\r\\n.left {\\r\\n  position: absolute;\\r\\n  left: 0;\\r\\n  /* ... \u7701\u7565 */\\r\\n}\\r\\n.right {\\r\\n  position: absolute;\\r\\n  right: 0;\\r\\n  /* ... \u7701\u7565 */\\r\\n}\\r\\n```\\r\\n\\r\\n\u73b0\u5728\u6211\u4eec\u6765\u770b\u5305\u88f9\u6587\u5b57\u7684 content\u3002content \u5185\u90e8\u5305\u88f9\u4e86\u4e09\u6bb5\u4e00\u6a21\u4e00\u6837\u7684\u6587\u5b57 notice\uff0c\u6bcf\u6bb5 notice \u4e4b\u95f4\u8fd8\u6709\u4e00\u4e2a space \u5143\u7d20\u4f5c\u4e3a\u95f4\u8ddd\u3002\\r\\n\\r\\n```html\\r\\n\x3c!-- ... \u7701\u7565 --\x3e\\r\\n<div id=\\"content\\">\\r\\n  <div class=\\"notice\\">\u6625\u8282\u671f\u95f4\uff0c\u90e8\u5206\u5546\u54c1...</div>\\r\\n  <div class=\\"space\\"></div>\\r\\n  <div class=\\"notice\\">\u6625\u8282\u671f\u95f4\uff0c\u90e8\u5206\u5546\u54c1...</div>\\r\\n  <div class=\\"space\\"></div>\\r\\n  <div class=\\"notice\\">\u6625\u8282\u671f\u95f4\uff0c\u90e8\u5206\u5546\u54c1...</div>\\r\\n</div>\\r\\n\x3c!-- ... \u7701\u7565 --\x3e\\r\\n```\\r\\n\\r\\n\u4e3a\u4ec0\u4e48\u8981\u653e\u7f6e\u4e09\u6bb5\u4e00\u6a21\u4e00\u6837\u7684\u6587\u5b57\u5462\uff1f\u8fd9\u548c\u5faa\u73af\u64ad\u653e\u7684\u903b\u8f91\u6709\u5173\u3002\\r\\n\\r\\n## \u903b\u8f91\u4ee3\u7801\\r\\n\\r\\n\u6211\u4eec\u5e76\u6ca1\u6709\u5b9e\u73b0\u771f\u6b63\u7684\u5faa\u73af\u64ad\u653e\uff0c\u800c\u662f\u6b3a\u9a97\u4e86\u7528\u6237\u7684\u89c6\u89c9\u3002\u5982\u4e0b\u56fe\u6240\u793a\uff1a\\r\\n\\r\\n- \u64ad\u653e\u901a\u77e5\u65f6\uff0ccontent \u4ece 0 \u5f00\u59cb\u5411\u5de6\u79fb\u52a8\u3002\\r\\n- \u5411\u5de6\u79fb\u52a8 `2 * noticeWidth + spaceWidth` \u65f6\uff0c\u7ee7\u7eed\u5411\u5de6\u79fb\u52a8\u4fbf\u4f1a\u9732\u9985\u3002\u56e0\u4e3a\u7b2c 3 \u6bb5\u6587\u5b57\u540e\u4e0d\u4f1a\u6709\u7b2c 4 \u6bb5\u6587\u5b57\u3002\\r\\n  \\r\\n  \u5982\u679c\u6211\u4eec\u628a content \u5411\u5de6\u79fb\u52a8\u7684\u8ddd\u79bb\u5f3a\u884c\u4ece `2 * noticeWidth + spaceWidth` \u6539\u4e3a `noticeWidth`\uff0c\u4e0d\u96be\u770b\u51fa\uff0c\u7528\u6237\u5728 box \u53ef\u89c6\u533a\u57df\u5185\u770b\u5230\u7684\u60c5\u51b5\u57fa\u672c\u4e00\u81f4\u7684\u3002\\r\\n\\r\\n  \u7136\u540e content \u7ee7\u7eed\u5411\u5de6\u79fb\u52a8\uff0c\u5411\u5de6\u79fb\u52a8\u7684\u8ddd\u79bb\u5927\u4e8e\u7b49\u4e8e `2 * noticeWidth + spaceWidth` \u65f6\uff0c\u5c31\u628a\u8ddd\u79bb\u91cd\u65b0\u8bbe\u4e3a `noticeWidth`\u3002\u5faa\u73af\u5f80\u590d\uff0c\u5c31\u80fd\u6b3a\u9a97\u7528\u6237\u89c6\u89c9\uff0c\u8ba9\u7528\u6237\u8ba4\u4e3a content \u80fd\u65e0\u4f11\u65e0\u6b62\u5411\u5de6\u79fb\u52a8\u3002\\r\\n\\r\\n![](./img/no-overflow-with-comment.png)\\r\\n\\r\\n\u6b3a\u9a97\u89c6\u89c9\u7684\u4ee3\u7801\u5982\u4e0b\uff1a\\r\\n\\r\\n- \u6211\u4eec\u901a\u8fc7\u4fee\u6539 translateX\uff0c\u8ba9 content \u4e0d\u65ad\u5730\u5411\u5de6\u79fb\u52a8\uff0c\u6bcf\u6b21\u5411\u5de6\u79fb\u52a8 1.5px\uff1b\\r\\n- \u5f53 `translateX >= noticeWidth * 2 + spaceWidth` \u65f6\uff0c\u6211\u4eec\u53c8\u4f1a\u628a translateX \u5f3a\u5236\u8bbe\u4e3a `noticeWidth`\uff1b\\r\\n- \u4e3a\u4e86\u4fdd\u8bc1\u79fb\u52a8\u52a8\u753b\u66f4\u4e1d\u6ed1\uff0c\u6211\u4eec\u5e76\u6ca1\u6709\u91c7\u7528 setInterval\uff0c\u800c\u662f\u4f7f\u7528 requestAnimationFrame\u3002\\r\\n\\r\\n```js\\r\\nconst content = document.getElementById(\\"content\\");\\r\\nconst notice = document.getElementsByClassName(\\"notice\\");\\r\\nconst space = document.getElementsByClassName(\\"space\\");\\r\\nconst noticeWidth = notice[0].offsetWidth;\\r\\nconst spaceWidth = space[0].offsetWidth;\\r\\n\\r\\nlet translateX = 0;\\r\\nfunction move() {\\r\\n  translateX += 1.5;\\r\\n  if (translateX >= noticeWidth * 2 + spaceWidth) {\\r\\n    translateX = noticeWidth;\\r\\n  }\\r\\n  content.style.transform = `translateX(${-translateX}px)`;\\r\\n  requestAnimationFrame(move);\\r\\n}\\r\\n\\r\\nmove();\\r\\n```\\r\\n\\r\\n## \u5b8c\u6574\u4ee3\u7801\\r\\n\\r\\n\u5b8c\u6574\u4ee3\u7801\u5982\u4e0b\uff0c\u4f60\u53ef\u4ee5\u5728 codepen \u6216\u8005\u7801\u4e0a\u6398\u91d1\u4e0a\u67e5\u770b\u3002\\r\\n\\r\\n- codepen: [https://codepen.io/lijunlin2022/pen/rNgMrwg](https://codepen.io/lijunlin2022/pen/rNgMrwg)\\r\\n- \u7801\u4e0a\u6398\u91d1: [https://code.juejin.cn/pen/7373131233506623538](https://code.juejin.cn/pen/7373131233506623538)\\r\\n\\r\\n## \u603b\u7ed3\\r\\n\\r\\n\u672c\u6587\u6211\u4ecb\u7ecd\u4e86\u5982\u4f55\u7528 H5 \u5b9e\u73b0\u5faa\u73af\u64ad\u653e\u7684\u901a\u77e5\u680f\uff1a\\r\\n\\r\\n- \u5e03\u5c40\u65b9\u9762\uff0c\u6211\u4eec\u9700\u8981\u7528\u7edd\u5bf9\u5b9a\u4f4d\u7684\u901a\u77e5 Icon\u3001\u7559\u767d\u6321\u4f4f\u5faa\u73af\u6587\u5b57\u7684\u5de6\u4fa7\u548c\u53f3\u4fa7\uff1b\u6b64\u5916\uff0c\u5faa\u73af\u64ad\u653e\u7684\u6587\u5b57\u6211\u4eec\u989d\u5916\u590d\u5236 2 \u4efd\u3002\\r\\n- \u903b\u8f91\u65b9\u9762\uff0c\u901a\u77e5\u680f\u5411\u5de6\u79fb\u52a8 `2 * noticeWidth + spaceWidth` \u540e\uff0c\u6211\u4eec\u9700\u8981\u5f3a\u5236\u628a\u901a\u77e5\u680f\u5411\u5de6\u79fb\u52a8\u7684\u8ddd\u79bb\u4ece `2 * noticeWidth + spaceWidth` \u53d8\u4e3a `noticeWidth`\uff0c\u4ee5\u6b64\u6765\u6b3a\u9a97\u7528\u6237\u89c6\u89c9\u3002\\r\\n  \\r\\n\u62f3\u6253 H5\uff0c\u811a\u8e22\u5c0f\u7a0b\u5e8f\u3002\u6211\u662f\u300c\u5c0f\u9716\u5bb6\u7684\u6df7\u6c5f\u9f99\u300d\uff0c\u5173\u6ce8\u6211\uff0c\u5e26\u4f60\u4e86\u89e3\u66f4\u591a\u5b9e\u7528\u7684 H5\u3001\u5c0f\u7a0b\u5e8f\u6b66\u5b66\u3002"},{"id":"/2024/05/17/reversible-card","metadata":{"permalink":"/blog/2024/05/17/reversible-card","source":"@site/blog/2024-05-17-reversible-card/index.md","title":"\u4eff\u5fae\u4fe1\u8bfb\u4e66\uff0cH5 \u7ffb\u8f6c\u5361\u7247\u5982\u4f55\u5b9e\u73b0\uff1f","description":"\u6211\u6700\u8fd1\u5237\u5fae\u4fe1\u8bfb\u4e66\u65f6\uff0c\u7559\u610f\u5230\u5b83\u7684\u63a8\u8350\u5361\u7247\u4f1a\u7ffb\u8f6c\uff0c\u8fd9\u4e2a\u6548\u679c\u8be5\u600e\u4e48\u505a\u5462\uff1f","date":"2024-05-17T00:00:00.000Z","tags":[],"readingTime":2.995,"hasTruncateMarker":false,"authors":[],"frontMatter":{},"unlisted":false,"prevItem":{"title":"\u4eff\u4eca\u65e5\u5934\u6761\uff0cH5 \u5faa\u73af\u64ad\u653e\u7684\u901a\u77e5\u680f\u5982\u4f55\u5b9e\u73b0\uff1f","permalink":"/blog/2024/05/26/loop-notice"},"nextItem":{"title":"\u4eff\u7269\u7f8e\u8d85\u5e02\uff0cH5 \u5217\u8868\u6eda\u52a8\u56de\u5f39\u6548\u679c\u5982\u4f55\u5b9e\u73b0\uff1f","permalink":"/blog/2024/05/07/springback"}},"content":"\u6211\u6700\u8fd1\u5237\u5fae\u4fe1\u8bfb\u4e66\u65f6\uff0c\u7559\u610f\u5230\u5b83\u7684\u63a8\u8350\u5361\u7247\u4f1a\u7ffb\u8f6c\uff0c\u8fd9\u4e2a\u6548\u679c\u8be5\u600e\u4e48\u505a\u5462\uff1f\\r\\n\\r\\n![](./img/wx.gif)\\r\\n\\r\\n\u672c\u6587\u6211\u4f1a\u5148\u4ecb\u7ecd\u7ffb\u8f6c\u5361\u7247\u7684\u5e03\u5c40\u3001\u52a8\u753b\uff0c\u518d\u5e76\u7ed9\u51fa\u5b8c\u6574\u4ee3\u7801\uff0c\u6700\u540e\u505a\u4e00\u4e2a\u603b\u7ed3\u3002\u6700\u7ec8\u6548\u679c\u5982\u4e0b\uff1a\\r\\n\\r\\n![](./img/card.gif)\\r\\n\\r\\n\u62f3\u6253 H5\uff0c\u811a\u8e22\u5c0f\u7a0b\u5e8f\u3002\u6211\u662f\u300c\u5c0f\u9716\u5bb6\u7684\u6df7\u6c5f\u9f99\u300d\uff0c\u5173\u6ce8\u6211\uff0c\u5e26\u4f60\u4e86\u89e3\u66f4\u591a\u5b9e\u7528\u7684 H5\u3001\u5c0f\u7a0b\u5e8f\u6b66\u5b66\u3002\\r\\n\\r\\n## \u5e03\u5c40\u4ee3\u7801\\r\\n\\r\\n\u6211\u4eec\u5148\u770b\u5e03\u5c40\uff0c\u5b9e\u73b0\u7ffb\u8f6c\u5361\u7247\u9700\u8981\u8981\u628a\u4e24\u4e2a\u5143\u7d20\u80cc\u9760\u80cc\u8d34\u5728\u4e00\u8d77\uff0c\u5c31\u50cf\u6c49\u5821\u5305\u7684\u9762\u997c\u4e2d\u95f4\u4e0d\u5939\u852c\u83dc\u3001\u8089\u997c\u4e00\u6837\u3002\\r\\n\\r\\n\u4ee3\u7801\u5982\u4e0b\uff0c\u6709\u4e00\u4e2a\u76d2\u5b50 box \u91cc\u9762\u88c5\u7740\u4e24\u4e2a\u5143\u7d20 front \u7684 back\uff0cfront \u7528\u6765\u505a\u5361\u7247\u7684\u6b63\u9762\uff0cback \u7528\u6765\u505a\u5361\u7247\u7684\u80cc\u9762\u3002\\r\\n\\r\\n```html\\r\\n<style>\\r\\n  .box {\\r\\n    position: relative;\\r\\n    /* ... \u7701\u7565 */\\r\\n  }\\r\\n  #front, #back {\\r\\n    position: absolute;\\r\\n    top: 0;\\r\\n    bottom: 0;\\r\\n    left: 0;\\r\\n    right: 0;\\r\\n    backface-visibility: hidden;\\r\\n    /* ... \u7701\u7565 */\\r\\n  }\\r\\n  #back {\\r\\n    transform: rotateY(-180deg);\\r\\n    /* ... \u7701\u7565 */\\r\\n  }\\r\\n</style>\\r\\n<div class=\\"box\\">\\r\\n  <div id=\\"front\\"></div>\\r\\n  <div id=\\"back\\"></div>\\r\\n</div>\\r\\n<div id=\\"btn\\">\u7ffb\u8f6c</div>\\r\\n```\\r\\n\\r\\nbox \u662f\u76f8\u5bf9\u5b9a\u4f4d\uff0c\u800c front\uff0cback \u5219\u662f\u7edd\u5bf9\u5b9a\u4f4d\uff0c\u8fd9\u610f\u5473\u7740 front \u548c back \u662f\u91cd\u53e0\u7684\u3002\\r\\n\\r\\n\u6211\u4eec\u8ba9 back \u7ed5\u7740 Y \u8f74\u9006\u65f6\u9488\u65cb\u8f6c\u4e86 180 \u5ea6 \u2014\u2014 `rotateY(-180deg)`\uff0c\u5e76\u7ed9 front \u548c back \u90fd\u8bbe\u7f6e\u4e86\u80cc\u9762\u4e0d\u53ef\u89c1\u5c5e\u6027 \u2014\u2014 `backface-visibility: hidden;` \u5c5e\u6027\uff0c\u4fbf\u5b9e\u73b0\u4e86\u5361\u7247\u7684\u80cc\u9760\u80cc\u6548\u679c\u3002\\r\\n\\r\\n## \u903b\u8f91\u4ee3\u7801\\r\\n\\r\\n\u5f53\u70b9\u51fb\u6309\u94ae\u65cb\u8f6c\u65f6\uff0c\u6211\u4eec\u6bcf\u6b21\u90fd\u8ba9 front \u548c back \u65cb\u8f6c 180 \u5ea6\u3002\\r\\n\\r\\n```js\\r\\nconst front = document.getElementById(\'front\')\\r\\nconst back = document.getElementById(\'back\')\\r\\nconst btn = document.getElementById(\'btn\')\\r\\nlet frontRotateY = 0\\r\\nlet backRotateY = 180\\r\\n\\r\\nbtn.addEventListener(\'click\', function () {\\r\\n  frontRotateY -= 180\\r\\n  backRotateY -= 180\\r\\n  front.style.transform = `rotateY(${frontRotateY}deg)`\\r\\n  back.style.transform = `rotateY(${backRotateY}deg)`\\r\\n})\\r\\n```\\r\\n\\r\\n\u6b64\u5916\uff0c\u6211\u4eec\u8fd8\u9700\u8981\u7ed9 front \u548c end \u6dfb\u52a0\u8fc7\u6e21\u6548\u679c\uff1a\\r\\n\\r\\n```css\\r\\n#front, #back {\\r\\n  /* ... \u7701\u7565 */\\r\\n  transition: 0.5s;\\r\\n}\\r\\n```\\r\\n\\r\\n\u8fd9\u6837\u5f53\u5361\u7247\u6bcf\u6b21\u65cb\u8f6c\u65f6\uff0c\u90fd\u80fd\u591f\u6709\u76f8\u5173\u52a8\u753b\u3002\\r\\n\\r\\n## \u5b8c\u6574\u4ee3\u7801\\r\\n\\r\\n\u5b8c\u6574\u4ee3\u7801\u5982\u4e0b\uff0c\u4f60\u53ef\u4ee5\u5728 codepen \u6216\u8005\u7801\u4e0a\u6398\u91d1\u4e0a\u67e5\u770b\u3002\\r\\n\\r\\ncodepen: https://codepen.io/lijunlin2022/pen/yLrJMZL\\r\\n\\r\\n\u7801\u4e0a\u6398\u91d1: https://code.juejin.cn/pen/7370534206583898150\\r\\n\\r\\n## \u603b\u7ed3\\r\\n\\r\\n\u672c\u6587\u9996\u5148\u4ecb\u7ecd\u4e86\u7ffb\u8f6c\u5361\u7247\u7684\u5e03\u5c40\uff1a\u4e24\u4e2a\u5143\u7d20 front\u3001back \u5148\u901a\u8fc7\u7edd\u5bf9\u5b9a\u4f4d\u91cd\u53e0\uff0c\u518d\u8ba9 back \u7ed5 Y \u8f74\u65cb\u8f6c 180 \u5ea6\uff0c\u5b9e\u73b0 front \u548c back \u80cc\u5bf9\u80cc\u7684\u6548\u679c\uff1b\\r\\n\\r\\n\u7136\u540e\u4ecb\u7ecd\u4e86\u7ffb\u8f6c\u5361\u7247\u7684\u52a8\u753b\uff1a\u6bcf\u6b21\u9700\u8981\u65cb\u8f6c\u65f6\uff0c\u90fd\u8ba9 front \u548c back \u7ed5\u7740 Y \u8f74\u65cb\u8f6c 180 \u5ea6\u3002\\r\\n\\r\\n\u6700\u7ec8\u5b9e\u73b0\u4e86\u7c7b\u4f3c\u5fae\u4fe1\u8bfb\u4e66\u63a8\u8350\u5361\u7247\u7684\u7ffb\u8f6c\u6548\u679c\u3002\\r\\n\\r\\n\u62f3\u6253 H5\uff0c\u811a\u8e22\u5c0f\u7a0b\u5e8f\u3002\u6211\u662f\u300c\u5c0f\u9716\u5bb6\u7684\u6df7\u6c5f\u9f99\u300d\uff0c\u5173\u6ce8\u6211\uff0c\u5e26\u4f60\u4e86\u89e3\u66f4\u591a\u5b9e\u7528\u7684 H5\u3001\u5c0f\u7a0b\u5e8f\u6b66\u5b66\u3002"},{"id":"/2024/05/07/springback","metadata":{"permalink":"/blog/2024/05/07/springback","source":"@site/blog/2024-05-07-springback/index.md","title":"\u4eff\u7269\u7f8e\u8d85\u5e02\uff0cH5 \u5217\u8868\u6eda\u52a8\u56de\u5f39\u6548\u679c\u5982\u4f55\u5b9e\u73b0\uff1f","description":"\u6700\u8fd1\u6709\u670b\u53cb\u95ee\u6211\uff0c\u591a\u70b9 App\uff08\u7269\u7f8e\u8d85\u5e02\u7684 App\uff09\u5546\u54c1\u5217\u8868\u7684\u4e0a\u62c9\u56de\u5f39\u6548\u679c\uff0c\u7528 H5 \u600e\u4e48\u5b9e\u73b0\uff1f\u4ed6\u77e5\u9053 iOS \u7684 H5 \u539f\u751f\u6eda\u52a8\u6709\u56de\u5f39\u6548\u679c\uff0cAndroid \u7684 H5 \u6ca1\u6709\uff0c\u5e0c\u671b Android \u80fd\u548c iOS \u8868\u73b0\u4e00\u81f4\u3002","date":"2024-05-07T00:00:00.000Z","tags":[],"readingTime":7.33,"hasTruncateMarker":false,"authors":[],"frontMatter":{},"unlisted":false,"prevItem":{"title":"\u4eff\u5fae\u4fe1\u8bfb\u4e66\uff0cH5 \u7ffb\u8f6c\u5361\u7247\u5982\u4f55\u5b9e\u73b0\uff1f","permalink":"/blog/2024/05/17/reversible-card"},"nextItem":{"title":"\u4eff\u62fc\u591a\u591a\u73b0\u91d1\u5927\u8f6c\u76d8\uff0cH5 \u62bd\u5956\u8f6c\u76d8\u5982\u4f55\u5b9e\u73b0\uff1f","permalink":"/blog/2024/04/17/lottery-turntable"}},"content":"\u6700\u8fd1\u6709\u670b\u53cb\u95ee\u6211\uff0c\u591a\u70b9 App\uff08\u7269\u7f8e\u8d85\u5e02\u7684 App\uff09\u5546\u54c1\u5217\u8868\u7684\u4e0a\u62c9\u56de\u5f39\u6548\u679c\uff0c\u7528 H5 \u600e\u4e48\u5b9e\u73b0\uff1f\u4ed6\u77e5\u9053 iOS \u7684 H5 \u539f\u751f\u6eda\u52a8\u6709\u56de\u5f39\u6548\u679c\uff0cAndroid \u7684 H5 \u6ca1\u6709\uff0c\u5e0c\u671b Android \u80fd\u548c iOS \u8868\u73b0\u4e00\u81f4\u3002\\r\\n\\r\\n![](./img/duodian.gif)\\r\\n\\r\\n\u601d\u7d22\u8fc7\u540e\uff0c\u6211\u53d1\u73b0\u8fd9\u5df2\u7ecf\u4e0d\u662f\u666e\u901a\u7684\u539f\u751f\u6eda\u52a8\u4e86\uff0c\u5fc5\u987b\u8981\u51fa\u91cd\u62f3\uff0c\u5f97\u7528 CSS \u7684 translate \u6a21\u62df\u4e00\u5957\u6eda\u52a8\u3002\\r\\n\\r\\n\u6211\u5b9e\u73b0\u4e86\u4e0b\u62c9/\u4e0a\u62c9\u6eda\u52a8\u56de\u5f39\uff0c\u6548\u679c\u5982\u4e0b\uff1a\\r\\n\\r\\n![](./img/springback.gif)\\r\\n\\r\\n\u672c\u6587\u6211\u4f1a\u5148\u4ecb\u7ecd\u57fa\u7840\u7684 translate \u6a21\u62df\u6eda\u52a8\uff0c\u518d\u9010\u6b65\u5b8c\u5584\u4ee3\u7801\uff0c\u6700\u540e\u505a\u4e00\u4e2a\u603b\u7ed3\u3001\u5e76\u63a8\u8350\u4e00\u4e2a\u5de5\u5177\u5e93\u3002\\r\\n\\r\\n\u62f3\u6253 H5\uff0c\u811a\u8e22\u5c0f\u7a0b\u5e8f\u3002\u6211\u662f\u300c\u5c0f\u9716\u5bb6\u7684\u6df7\u6c5f\u9f99\u300d\uff0c\u5173\u6ce8\u6211\uff0c\u5e26\u4f60\u4e86\u89e3\u66f4\u591a\u5b9e\u7528\u7684 H5\u3001\u5c0f\u7a0b\u5e8f\u6b66\u5b66\u3002\\r\\n\\r\\n## \u57fa\u7840\u4ee3\u7801\\r\\n\\r\\n\u6211\u4eec\u4e0d\u51c6\u5907\u7528\u539f\u751f\u6eda\u52a8\uff0c\u90a3\u4e48\u5c31\u9700\u8981\u7ed9\u80fd\u6eda\u52a8\u7684\u5bb9\u5668\u6dfb\u52a0 `overflow: hidden;`\uff0c\u57fa\u7840\u5e03\u5c40\u4ee3\u7801\u5982\u4e0b\uff1a\\r\\n\\r\\n\u5916\u5c42\u7684 box \u662f\u5bb9\u5668\uff0c\u5b83\u88ab\u8bbe\u7f6e\u4e86 `overflow: hidden`\u3002\u5185\u5c42\u7684 content \u662f\u9700\u8981\u6eda\u52a8\u7684\u5185\u5bb9\uff0c\u5305\u88f9\u7740\u4e09\u90e8\u5206\uff1a\u4e0b\u62c9\u63d0\u793a\uff08pulldown \u2193\uff09\u3001\u5217\u8868\u548c\u4e0a\u62c9\u63d0\u793a\uff08pullup \u2191\uff09\u3002\\r\\n\\r\\n```html\\r\\n<style>\\r\\n  #box {\\r\\n    height: 100vh;\\r\\n    overflow: hidden;\\r\\n  }\\r\\n</style>\\r\\n<div id=\\"box\\">\\r\\n  <div id=\\"content\\">\\r\\n    <div class=\\"tip\\">pulldown \u2193</div>\\r\\n    <ul>\\r\\n      <li class=\\"item\\">0</li>\\r\\n      <li class=\\"item\\">1</li>\\r\\n      \x3c!-- ...\u7701\u7565 --\x3e\\r\\n      <li class=\\"item\\">19</li>\\r\\n    </ul>\\r\\n    <div class=\\"tip\\">pullup \u2191</div>\\r\\n  </div>\\r\\n</div>\\r\\n```\\r\\n\\r\\n\u57fa\u7840\u903b\u8f91\u4ee3\u7801\u5982\u4e0b\uff1a\\r\\n\\r\\n- \u6211\u4eec\u5728\u7528\u6237\u624b\u6307\u521a\u89e6\u6478\u5c4f\u5e55\u65f6\uff08touchstart\uff09\uff0c\u8bb0\u4f4f\u4e86\u624b\u6307\u7684\u5f00\u59cb\u4f4d\u7f6e startY\uff1b\\r\\n- \u7528\u6237\u624b\u6307\u79fb\u52a8\u65f6\uff08touchmove\uff09\uff0c\u6211\u4eec\u7528\u624b\u6307\u5f53\u524d\u7684\u4f4d\u7f6e\uff08currentY\uff09\uff0c\u51cf\u53bb\u624b\u6307\u5f00\u59cb\u7684\u4f4d\u7f6e\uff0c\u5f97\u5230\u624b\u6307\u79fb\u52a8\u7684\u8ddd\u79bb\uff08diffY\uff09\uff0c\u5e76\u5b9e\u65f6\u8d4b\u503c\u7ed9 content \u7684 translateY\uff0c\u8fd9\u6837\u5c31\u5b9e\u73b0\u624b\u6307\u4e0a\u6ed1/\u4e0b\u6ed1\u591a\u5c11\u8ddd\u79bb\uff0ccontent \u5c31\u4e0a\u6ed1/\u4e0b\u6ed1\u591a\u5c11\u8ddd\u79bb\uff1b\\r\\n- \u7528\u6237\u505c\u6b62\u89e6\u6478\u5c4f\u5e55\u65f6\uff08touchend\uff09\uff0c\u6211\u4eec\u8bb0\u4f4f content \u73b0\u5728\u79fb\u52a8\u7684\u4f4d\u7f6e\uff08lastY\uff09\u3002\u7528\u6237\u4e0b\u6b21\u6eda\u52a8 content \u65f6\u4f1a\u5728 lastY \u7684\u57fa\u7840\u4e0a\u7ee7\u7eed\u6eda\u52a8\u3002\\r\\n\\r\\n```js\\r\\nconst content = document.getElementById(\'content\')\\r\\n\\r\\nlet startY = 0, lastY = 0, diffY = 0\\r\\n\\r\\ncontent.addEventListener(\'touchstart\', (e) => {\\r\\n  startY = e.touches[0].clientY\\r\\n})\\r\\n\\r\\ncontent.addEventListener(\'touchmove\', (e) => {\\r\\n  const currentY = e.touches[0].clientY\\r\\n  diffY = Math.floor(currentY - startY)\\r\\n\\r\\n  content.style.transform = `translateY(${lastY + diffY}px)`\\r\\n})\\r\\n\\r\\ncontent.addEventListener(\'touchend\', (e) => {\\r\\n  lastY = lastY + diffY\\r\\n  content.style.transform = `translateY(${lastY}px)`\\r\\n})\\r\\n```\\r\\n\\r\\n\u6548\u679c\u5982\u4e0b\uff1a\\r\\n\\r\\n![](./img/basic.gif)\\r\\n\\r\\n\u53ef\u4ee5\u770b\u5230\uff0c\u57fa\u7840\u4ee3\u7801\u6709\u4e2a\u5f88\u660e\u663e\u7684\u7f3a\u9677\u3002content \u5f88\u5bb9\u6613\u88ab\u5b8c\u5168\u79fb\u52a8\u5230 box \u5916\uff0cbox \u5185\u90e8\u4fbf\u53ea\u80fd\u770b\u5230\u4e00\u7247\u7a7a\u767d\u3002\\r\\n\\r\\n## \u8bbe\u7f6e\u4e0b\u62c9/\u4e0a\u62c9\u7684\u6700\u7ec8\u503c\\r\\n\\r\\n\u4e3a\u4e86\u89e3\u51b3 content \u53ef\u4ee5\u79fb\u52a8\u5230 box \u4e4b\u5916\u7684\u7f3a\u9677\uff0c\u6211\u4eec\u53ef\u4ee5\u5728\u7528\u6237\u624b\u6307\u79bb\u5f00\u5c4f\u5e55\u65f6\uff0c\u5bf9 content \u7684\u6700\u7ec8\u503c\u505a\u4e00\u4e2a\u5224\u65ad\u3002\\r\\n\\r\\n\u6539\u52a8\u4ee3\u7801\u5982\u4e0b\uff1a\\r\\n\\r\\n- \u6211\u4eec\u8ba1\u7b97\u4e86 content \u80fd\u4e0a\u62c9\u7684\u6700\u5927\u8ddd\u79bb\uff08maxTranslateY\uff09\uff0c\u5b83\u662f content \u81ea\u8eab\u7684\u9ad8\u5ea6\u51cf\u53bb box \u7684\u9ad8\u5ea6\u3002\uff08\u5982\u679c content \u7684\u9ad8\u5ea6\u5c0f\u4e8e\u7b49\u4e8e box \u7684\u9ad8\u5ea6\uff0c\u6839\u672c\u65e0\u6cd5\u4e0a\u62c9\u6eda\u52a8\uff09\u3002\\r\\n\\r\\n- \u7528\u6237\u4e0b\u62c9\u65f6\uff08diffY > 0\uff09\uff0c\u5982\u679c\u6700\u7ec8 content \u7684\u4f4d\u7f6e\uff08lastY + diffY\uff09\u4e0d\u662f\u8d1f\u6570\uff0c\u8bf4\u660e content \u9876\u90e8\u5df2\u7ecf\u79bb\u5f00\u4e86 box \u7684\u4e0a\u8fb9\u754c\u3002\\r\\n\\r\\n  ![](./img/content-leave-box-top.png)\\r\\n\\r\\n  \u7528\u6237\u653e\u624b\u65f6\uff0c\u6211\u4eec\u9700\u8981\u8ba9 content \u9876\u90e8\u91cd\u65b0\u8d34\u7740 box \u7684\u4e0a\u8fb9\u754c\uff0c\u4e8e\u662f\u8bbe\u7f6e lastY = 0\uff0c\u5e76\u8bbe\u7f6e\u4e86 content \u7684 translateY \u4e3a 0px\u3002\\r\\n\\r\\n- \u7528\u6237\u4e0a\u62c9\u65f6\uff08diffY < 0 \u65f6\uff09\uff0c\u5982\u679c content \u7684\u4f4d\u7f6e\uff08lastY + diffY\uff09 \u8d85\u8fc7\u4e86\u4e0a\u62c9\u7684\u6700\u5927\u8ddd\u79bb\uff08lastY + diffY < -maxTranslateY\uff09\uff0c\u8bf4\u660e content \u7684\u5e95\u90e8\u5df2\u7ecf\u79bb\u5f00\u4e86 box \u7684\u4e0b\u8fb9\u754c\u3002\\r\\n  \\r\\n  ![](./img/content-leave-box-bottom.png)\\r\\n\\r\\n  \u7528\u6237\u653e\u624b\u65f6\uff0c\u6211\u4eec\u9700\u8981\u8ba9 content \u5e95\u90e8\u91cd\u65b0\u8d34\u7740 box \u7684\u4e0b\u8fb9\u754c\uff0c\u4e8e\u662f\u8bbe\u7f6e lastY = -maxTranslateY\uff0c\u5e76\u8bbe\u7f6e\u4e86 content \u7684 translateY \u4e3a `${-maxTranslateY}px`\u3002\\r\\n\\r\\n```js\\r\\nconst box = document.getElementById(\'box\')\\r\\nconst content = document.getElementById(\'content\')\\r\\nlet startY = 0, lastY = 0, diffY = 0\\r\\n\\r\\nconst maxTranslateY = content.clientHeight - box.clientHeight\\r\\n\\r\\n// ... \u7701\u7565\\r\\ncontent.addEventListener(\'touchend\', (e) => {\\r\\n  if (diffY > 0) {\\r\\n    if (lastY + diffY > 0) {\\r\\n      lastY = 0\\r\\n      content.style.transform = \'translateY(0px)\'\\r\\n      content.style.transition = \'all .3s ease-out\'\\r\\n      return\\r\\n    }\\r\\n  }\\r\\n\\r\\n  if (diffY < 0) {\\r\\n    if (lastY + diffY < -maxTranslateY) {\\r\\n      lastY = -maxTranslateY\\r\\n      content.style.transform = `translateY(${-maxTranslateY}px)`\\r\\n      content.style.transition = \'all .3s ease-out\'\\r\\n      return\\r\\n    }\\r\\n  }\\r\\n\\r\\n  lastY = lastY + diffY\\r\\n  content.style.transform = `translateY(${lastY}px)`\\r\\n  content.style.transition = \'all .3s ease-out\'\\r\\n})\\r\\n```\\r\\n\\r\\n\u6548\u679c\u5982\u4e0b\uff1a\\r\\n\\r\\n![](./img/basic-limit.gif)\\r\\n\\r\\n## \u8bbe\u7f6e\u4e0b\u62c9/\u4e0a\u62c9\u7684\u9650\u5236\\r\\n\\r\\n\u867d\u7136\u73b0\u5728\u6211\u4eec\u4e0b\u62c9\u3001\u4e0a\u62c9 content \u65f6\uff0c\u6700\u7ec8 content \u80af\u5b9a\u4e0d\u4f1a\u518d\u8d85\u51fa box \u8fb9\u754c\u3002\u4f46\u8fd9\u6837\u7684\u6548\u679c\u5e76\u4e0d\u7f8e\u89c2\uff0c\u4e00\u822c\u6765\u8bf4\uff0c\u4e0b\u62c9\u3001\u4e0a\u62c9\u7684\u8ddd\u79bb\u90fd\u4f1a\u6709\u4e00\u4e2a\u9650\u5236\uff0c\u73b0\u5728\u6211\u4eec\u5c31\u6765\u6dfb\u52a0\u8fd9\u4e2a\u9650\u5236\u3002\\r\\n\\r\\n\u6539\u52a8\u4ee3\u7801\u5982\u4e0b\uff1a\\r\\n\\r\\n- \u6211\u4eec\u9996\u5148\u5b9a\u4e49\u4e86\u4e0b\u62c9\u548c\u4e0a\u62c9\u7684\u9650\u5236\u8ddd\u79bb buffer\uff0c\u8fd9\u4e2a\u503c\u53ef\u4ee5\u6309\u7167\u4e2a\u4eba\u559c\u597d\u5b9a\uff0c\u6211\u8fd9\u91cc\u628a\u5b83\u5b9a\u4f4d 10vh \uff08window.innerHeight / 10\uff09\u53ea\u662f\u89c9\u5f97\u8fd9\u4e2a\u8ddd\u79bb\u6bd4\u8f83\u7f8e\u89c2\u3002\\r\\n\\r\\n- \u7528\u6237\u4e0b\u62c9\u65f6\uff08diffY > 0\uff09\uff0ccontent \u7684\u9876\u90e8\u6700\u591a\u53ea\u80fd\u79bb\u5f00 box \u7684\u9876\u90e8 buffer \u5927\u5c0f\u7684\u8ddd\u79bb\uff0c\u4e5f\u5c31\u662f lastY \u6700\u5927\u4e3a buffer\uff0cdiffY \u7684\u503c\u5c31\u53d8\u4e3a\u4e86 buffer - lastY\u3002\\r\\n\\r\\n- \u7528\u6237\u4e0a\u62c9\u65f6\uff08diffY < 0\uff09\uff0ccontent \u7684\u4f4d\u7f6e\u6700\u591a\u4e3a -(maxTranslateY + buffer)\uff0cdiffY \u7684\u503c\u5c31\u53d8\u4e86 -(maxTranslateY + buffer) - lastY\u3002\\r\\n\\r\\n```js\\r\\n// ...\u7701\u7565\\r\\nconst buffer = Math.floor(window.innerHeight / 10)\\r\\n// ...\u7701\u7565\\r\\ncontent.addEventListener(\'touchmove\', (e) => {\\r\\n  const currentY = e.touches[0].clientY\\r\\n  diffY = Math.floor(currentY - startY)\\r\\n\\r\\n  if (diffY > 0) {\\r\\n    if (lastY + diffY > buffer) {\\r\\n      diffY = buffer - lastY\\r\\n    }\\r\\n  }\\r\\n\\r\\n  if (diffY < 0) {\\r\\n    if (lastY + diffY < -(maxTranslateY + buffer)) {\\r\\n      diffY = -(maxTranslateY + buffer) - lastY\\r\\n    }\\r\\n  }\\r\\n\\r\\n  content.style.transform = `translateY(${lastY + diffY}px)`\\r\\n  content.style.transition = \'\'\\r\\n})\\r\\n// ... \u7701\u7565\\r\\n```\\r\\n\\r\\n\u6709\u4e86\u9650\u5236\u540e\uff0c\u6548\u679c\u7f8e\u89c2\u591a\u4e86\uff1a\\r\\n\\r\\n![](./img/springback.gif)\\r\\n\\r\\n## \u5b8c\u6574\u4ee3\u7801\\r\\n\\r\\n\u5b8c\u6574\u4ee3\u7801\u5982\u4e0b\uff0c\u4f60\u53ef\u4ee5\u5728 codepen \u6216\u8005\u7801\u4e0a\u6398\u91d1\u4e0a\u67e5\u770b\u3002**\u9700\u8981\u6ce8\u610f\uff0c\u4ee3\u7801\u53ea\u8003\u8651\u4e86\u79fb\u52a8\u7aef\u573a\u666f\uff0c\u5982\u679c\u4f60\u662f\u7535\u8111\u8bbf\u95ee\uff0c\u9700\u8981 F12 \u6253\u5f00\u624b\u673a\u6a21\u62df\u5668\u67e5\u770b\u3002**\\r\\n\\r\\n- codepen: [https://codepen.io/lijunlin2022/pen/KKYYOdg](https://codepen.io/lijunlin2022/pen/KKYYOdg)\\r\\n\\r\\n- \u7801\u4e0a\u6398\u91d1\uff1a[https://code.juejin.cn/pen/7368096483704307738](https://code.juejin.cn/pen/7368096483704307738)\\r\\n\\r\\n## \u603b\u7ed3\u4e0e\u63a8\u8350\\r\\n\\r\\n\u672c\u6587\u6211\u4ecb\u7ecd\u4e86\u5982\u4f55\u7528 css \u7684 translate \u6a21\u62df\u6eda\u52a8\uff0c\u5728\u57fa\u7840\u4ee3\u7801\u4e0a\uff0c\u6211\u8bbe\u7f6e\u4e86\u4e0b\u62c9/\u4e0a\u62c9\u7684\u6700\u7ec8\u503c\uff0c\u4e0b\u62c9/\u4e0a\u62c9\u7684\u9650\u5236\uff0c\u5f97\u5230\u4e86\u4e00\u4e2a\u53ef\u4ee5\u56de\u5f39\u7684\u6eda\u52a8\u5217\u8868\u3002\\r\\n\\r\\n\u4e0d\u8fc7\uff0c\u81ea\u5df1\u7528 css \u7684 translate \u6a21\u62df\u6eda\u52a8\u65f6\uff0c\u8003\u8651\u5404\u79cd\u8ddd\u79bb\u5b9e\u5728\u7e41\u7410\u3002\u5982\u679c\u6709\u670b\u53cb\u60f3\u5728\u751f\u4ea7\u73af\u5883\u4f7f\u7528\uff0c\u63a8\u8350 [better-scroll](https://better-scroll.github.io/docs/zh-CN/guide/) \u8fd9\u4e2a\u63d2\u4ef6\uff0c\u5b83\u548c\u672c\u6587\u539f\u7406\u7c7b\u4f3c\uff0c\u4e5f\u662f\u5229\u7528 translate \u6a21\u62df\u4e86\u4e00\u5957\u6eda\u52a8\u3002\\r\\n\\r\\n\u62f3\u6253 H5\uff0c\u811a\u8e22\u5c0f\u7a0b\u5e8f\u3002\u6211\u662f\u300c\u5c0f\u9716\u5bb6\u7684\u6df7\u6c5f\u9f99\u300d\uff0c\u5173\u6ce8\u6211\uff0c\u5e26\u4f60\u4e86\u89e3\u66f4\u591a\u5b9e\u7528\u7684 H5\u3001\u5c0f\u7a0b\u5e8f\u6b66\u5b66\u3002"},{"id":"/2024/04/17/lottery-turntable","metadata":{"permalink":"/blog/2024/04/17/lottery-turntable","source":"@site/blog/2024-04-17-lottery-turntable/index.md","title":"\u4eff\u62fc\u591a\u591a\u73b0\u91d1\u5927\u8f6c\u76d8\uff0cH5 \u62bd\u5956\u8f6c\u76d8\u5982\u4f55\u5b9e\u73b0\uff1f","description":"\u7535\u5546\u5e94\u7528\u4e2d\u6211\u4eec\u5e38\u5e38\u770b\u5230\u62bd\u5956\u8f6c\u76d8\u6d3b\u52a8\uff0c\u6bd4\u5982\u62fc\u591a\u591a\u7684\u300c\u62bd\u5956\u5927\u8f6c\u76d8\u300d\uff1a\u70b9\u51fb\u4e2d\u592e\u7684\u62bd\u5956\u6309\u94ae\uff0c\u8f6c\u76d8\u5f00\u59cb\u65cb\u8f6c\uff0c\u4e00\u6bb5\u65f6\u95f4\u540e\u6307\u9488\u505c\u6b62\u5728\u5956\u54c1\u4e0a\u3002","date":"2024-04-17T00:00:00.000Z","tags":[{"inline":true,"label":"H5","permalink":"/blog/tags/h-5"}],"readingTime":11.615,"hasTruncateMarker":false,"authors":[],"frontMatter":{"tags":["H5"]},"unlisted":false,"prevItem":{"title":"\u4eff\u7269\u7f8e\u8d85\u5e02\uff0cH5 \u5217\u8868\u6eda\u52a8\u56de\u5f39\u6548\u679c\u5982\u4f55\u5b9e\u73b0\uff1f","permalink":"/blog/2024/05/07/springback"},"nextItem":{"title":"\u5bf9\u6bd4\u5c0f\u7ea2\u4e66\u4e0e\u7535\u5546\u4e09\u5de8\u5934\u7684\u7011\u5e03\u6d41\uff0cH5 \u7011\u5e03\u6d41\u5b9e\u73b0\u65b9\u6848\u5e94\u8be5\u5982\u4f55\u9009\u62e9\uff1f","permalink":"/blog/2024/04/08/waterfall-flow"}},"content":"\u7535\u5546\u5e94\u7528\u4e2d\u6211\u4eec\u5e38\u5e38\u770b\u5230\u62bd\u5956\u8f6c\u76d8\u6d3b\u52a8\uff0c\u6bd4\u5982\u62fc\u591a\u591a\u7684\u300c\u62bd\u5956\u5927\u8f6c\u76d8\u300d\uff1a\u70b9\u51fb\u4e2d\u592e\u7684\u62bd\u5956\u6309\u94ae\uff0c\u8f6c\u76d8\u5f00\u59cb\u65cb\u8f6c\uff0c\u4e00\u6bb5\u65f6\u95f4\u540e\u6307\u9488\u505c\u6b62\u5728\u5956\u54c1\u4e0a\u3002\\r\\n\\r\\n![](./img/pdd.gif)\\r\\n\\r\\n\u8fd9\u4e2a\u6548\u679c\u5982\u679c\u7528 H5 \u5e94\u8be5\u600e\u4e48\u5b9e\u73b0\u5462\uff1f\\r\\n\\r\\n\u672c\u6587\u6211\u4f1a\u5148\u8bf4\u660e\u5982\u4f55\u5b9e\u73b0\u8f6c\u76d8\u5e03\u5c40\uff0c\u518d\u4ecb\u7ecd\u5982\u4f55\u8ba9\u8f6c\u76d8\u65cb\u8f6c\uff0c\u63a5\u7740\u89e3\u91ca\u5982\u4f55\u63a7\u5236\u4e2d\u5956\u6982\u7387\uff0c\u6700\u540e\u7ed9\u51fa\u5b8c\u6574\u7684\u4ee3\u7801\uff0c\u5e76\u505a\u4e00\u4e2a\u603b\u7ed3\u3002\u6700\u7ec8\u6548\u679c\u5982\u4e0b\uff1a\\r\\n\\r\\n![](./img/lottery-turntable.gif)\\r\\n\\r\\n\u62f3\u6253 H5\uff0c\u811a\u8e22\u5c0f\u7a0b\u5e8f\u3002\u6211\u662f\u300c\u5c0f\u9716\u5bb6\u7684\u6df7\u6c5f\u9f99\u300d\uff0c\u5173\u6ce8\u6211\uff0c\u5e26\u4f60\u4e86\u89e3\u66f4\u591a\u5b9e\u7528\u7684 H5\u3001\u5c0f\u7a0b\u5e8f\u6b66\u5b66\u3002\\r\\n\\r\\n## CSS \u65cb\u8f6c\u76f8\u5173\u7684\u8bed\u6cd5\\r\\n\\r\\n\u5b9e\u73b0\u8f6c\u76d8\u5e03\u5c40\u4e4b\u524d\uff0c\u6211\u4eec\u5148\u6765\u590d\u4e60 CSS \u4e0e\u65cb\u8f6c\u6709\u5173\u7684\u8bed\u6cd5\u3002\\r\\n\\r\\n- `transform` \u7684 `rotate()` \u51fd\u6570\u53ef\u4ee5\u63a7\u5236\u65cb\u8f6c\u89d2\u5ea6\u3002\u6bd4\u5982 `transform: rotate(60deg);` \u662f\u987a\u65f6\u9488\u65cb\u8f6c 60 \u5ea6\uff0c`transform: rotate(-60deg);` \u662f\u9006\u65f6\u9488\u65cb\u8f6c 60 \u5ea6\u3002\\r\\n- `transform-origin` \u53ef\u4ee5\u63a7\u5236\u65cb\u8f6c\u4e2d\u5fc3\u3002\u6bd4\u5982 `transform-origin: right bottom;` \u662f\u4ee5\u5143\u7d20\u53f3\u4e0b\u89d2\u4e3a\u65cb\u8f6c\u4e2d\u5fc3\u3002\\r\\n\\r\\n\u4e3e\u4e2a\u4f8b\u5b50\uff0c\u4e0b\u9762\u4ee3\u7801\u4e2d item0 \u548c item1 \u4e24\u4e2a\u77e9\u5f62\u4ee5\u81ea\u5df1\u7684\u53f3\u4e0b\u89d2\u4e3a\u4e2d\u5fc3\uff0c\u9006\u65f6\u9488\u65cb\u8f6c\u4e86 0 \u5ea6\u548c 60 \u5ea6\u3002\\r\\n\\r\\n```html\\r\\n<style>\\r\\n  .item0 {\\r\\n    ...\\r\\n    transform-origin: right bottom;\\r\\n    transform: rotate(-0deg);\\r\\n  }\\r\\n  .item1 {\\r\\n    ...\\r\\n    transform-origin: right bottom;\\r\\n    transform: rotate(-60deg);\\r\\n  }\\r\\n</style>\\r\\n<div id=\\"box\\">\\r\\n  <div class=\\"item0\\"></div>\\r\\n  <div class=\\"item1\\"></div>\\r\\n</div>\\r\\n```\\r\\n\\r\\n![](./img/2-rect.png)\\r\\n\\r\\n## \u8f6c\u76d8\u7684\u5e03\u5c40\\r\\n\\r\\n### \u6709\u95ee\u9898\u7684\u601d\u8def\\r\\n\\r\\n\u590d\u4e60\u5b8c\u8bed\u6cd5\uff0c\u4f60\u53ef\u80fd\u4f1a\u60f3 6 \u4e2a\u77e9\u5f62\u56f4\u7740\u81ea\u5df1\u53f3\u4e0b\u89d2\u65cb\u8f6c\uff0c\u4f3c\u4e4e\u80fd\u5b9e\u73b0\u8f6c\u76d8\u5e03\u5c40\u3002\\r\\n\\r\\n\u4ee3\u7801\u5982\u4e0b\uff0c\u5176\u4e2d `--i` \u548c `--clr` \u662f CSS \u7684\u53d8\u91cf\uff0c\u65b9\u4fbf\u6211\u4eec\u8ba1\u7b97\u89d2\u5ea6\u3001\u83b7\u53d6\u989c\u8272\u3002\\r\\n\\r\\n```html\\r\\n<style>\\r\\n  ...\\r\\n  .item {\\r\\n    ...\\r\\n    background-color: var(--clr);\\r\\n    transform-origin: right bottom;\\r\\n    transform: rotate(calc(60deg * var(--i)));\\r\\n  }\\r\\n</style>\\r\\n<div id=\\"box\\">\\r\\n  <div class=\\"item\\" style=\\"--i:0;--clr:#ff7875;\\"></div>\\r\\n  <div class=\\"item\\" style=\\"--i:-1;--clr:#ff9c6e;\\"></div>\\r\\n  <div class=\\"item\\" style=\\"--i:-2;--clr:#ffc069;\\"></div>\\r\\n  <div class=\\"item\\" style=\\"--i:-3;--clr:#d3f261;\\"></div>\\r\\n  <div class=\\"item\\" style=\\"--i:-4;--clr:#95de64;\\"></div>\\r\\n  <div class=\\"item\\" style=\\"--i:-5;--clr:#5cdbd3;\\"></div>\\r\\n</div>\\r\\n```\\r\\n\\r\\n\u4f46\u8fd9\u79cd\u601d\u8def\u662f\u6709\u95ee\u9898\u7684\uff0c\u5982\u56fe\u6240\u793a\uff0c6 \u4e2a\u77e9\u5f62\u4f9d\u6b21\u9006\u65f6\u9488\u65cb\u8f6c\uff0c\u4f1a\u5bfc\u81f4\u7b2c 5 \u4e2a\u77e9\u5f62\u8986\u76d6\u5728\u7b2c 0 \u4e2a\u77e9\u5f62\u4e0a\uff0c\u65e0\u6cd5\u5b9e\u73b0\u8f6c\u76d8\u5e03\u5c40\u3002\\r\\n\\r\\n![](./img/6-rect.png)\\r\\n\\r\\n### \u6b63\u786e\u7684\u601d\u8def\\r\\n\\r\\n6 \u4e2a\u77e9\u5f62\u4f9d\u6b21\u9006\u65f6\u9488\u65cb\u8f6c\u7684\u601d\u8def\u867d\u7136\u6709\u95ee\u9898\uff0c\u4f46\u4e5f\u80fd\u7ed9\u6211\u4eec\u4e00\u4e9b\u542f\u53d1\u3002\\r\\n\\r\\n\u6211\u4eec\u628a 6 \u4e2a\u77e9\u5f62\u62c6\u6210\u5de6\u3001\u53f3\u4e24\u90e8\u5206\uff1a\\r\\n\\r\\n- \u5de6\u8fb9\u662f 3 \u4e2a\u77e9\u5f62\uff0c\u4ee5\u77e9\u5f62\u53f3\u4e0b\u89d2\u4e3a\u4e2d\u5fc3\u9006\u65f6\u9488\u65cb\u8f6c 0 \u5ea6\u300160 \u5ea6\u548c 120 \u5ea6\uff0c\u518d\u52a0\u4e0a `overflow: hidden;` \u5c31\u5f97\u5230\u5de6\u534a\u5706\u3002\\r\\n- \u53f3\u8fb9\u662f 3 \u4e2a\u77e9\u5f62\uff0c\u4ee5\u77e9\u5f62\u5de6\u4e0b\u89d2\u4e3a\u4e2d\u5fc3\u987a\u65f6\u9488\u65cb\u8f6c 0 \u5ea6\u300160 \u5ea6\u548c 120 \u5ea6\uff0c\u518d\u52a0\u4e0a `overflow: hidden;` \u5c31\u5f97\u5230\u53f3\u534a\u5706\u3002\\r\\n- \u62fc\u63a5\u5de6\u53f3\u4e24\u4e2a\u534a\u5706\uff0c\u5c31\u5f97\u5230\u4e00\u4e2a\u5b8c\u6574\u7684\u8f6c\u76d8\u3002\\r\\n\\r\\n![](./img/rect-to-circle.png)\\r\\n\\r\\n\u5173\u952e\u4ee3\u7801\u5982\u4e0b\uff1a\\r\\n\\r\\n```html\\r\\n<style>\\r\\n  .left .item {\\r\\n    ...\\r\\n    background-color: var(--clr);\\r\\n    transform-origin: right bottom;\\r\\n    transform: rotate(calc(60deg * var(--i)));\\r\\n  }\\r\\n  .right .item {\\r\\n    ...\\r\\n    background-color: var(--clr);\\r\\n    transform-origin: left bottom;\\r\\n    transform: rotate(calc(60deg * var(--i)));\\r\\n  }\\r\\n</style>\\r\\n<div id=\\"box\\">\\r\\n  <div class=\\"left\\">\\r\\n    <div class=\\"item\\" style=\\"--i:0;--clr:#ff7875;\\"></div>\\r\\n    <div class=\\"item\\" style=\\"--i:-1;--clr:#ff9c6e;\\"></div>\\r\\n    <div class=\\"item\\" style=\\"--i:-2;--clr:#ffc069;\\"></div>\\r\\n  </div>\\r\\n  <div class=\\"right\\">\\r\\n    <div class=\\"item\\" style=\\"--i:0;--clr:#d3f261;\\"></div>\\r\\n    <div class=\\"item\\" style=\\"--i:1;--clr:#95de64;\\"></div>\\r\\n    <div class=\\"item\\" style=\\"--i:2;--clr:#5cdbd3;\\"></div>\\r\\n  </div>\\r\\n</div>\\r\\n```\\r\\n\\r\\n## \u8f6c\u76d8\u7684\u65cb\u8f6c\\r\\n\\r\\n\u6211\u4eec\u5df2\u77e5\u6653\u8f6c\u76d8\u7684\u5e03\u5c40\u5982\u4f55\u5b9e\u73b0\uff0c\u81f3\u4e8e\u4e2d\u592e\u6309\u94ae\u548c\u5956\u54c1\u90fd\u53ef\u4ee5\u7528\u7edd\u5bf9\u5b9a\u4f4d\u5b9e\u73b0\uff0c\u8fd9\u91cc\u6211\u5c31\u4e0d\u518d\u8be6\u7ec6\u8bf4\u660e\u3002\u4e00\u8d77\u6765\u770b\u770b\u5982\u4f55\u63a7\u5236\u8f6c\u76d8\u7684\u65cb\u8f6c\u3002\\r\\n\\r\\n### \u65cb\u8f6c\u7684\u539f\u7406\\r\\n\\r\\n\u63a7\u5236\u8f6c\u76d8\u65cb\u8f6c\u5f88\u7b80\u5355\uff0c\u6211\u4eec\u53ea\u65cb\u8f6c\u5916\u5c42\u7684\u5bb9\u5668 box \u5373\u53ef\u3002\u5982\u4e0b\u56fe\u6240\u793a\uff0c\u5728 Chrome \u5143\u7d20\u63a7\u5236\u53f0\u4e2d\uff0c\u6211\u4eec\u9010\u6e10\u589e\u52a0 `transform: rotate(0deg)` \u7684\u53d6\u503c\uff0c\u5c31\u5b9e\u73b0\u4e86\u8f6c\u76d8\u7684\u987a\u65f6\u9488\u65cb\u8f6c\u3002\\r\\n\\r\\n![](./img/rotate.gif)\\r\\n\\r\\n\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u5f53\u5bb9\u5668 box \u65cb\u8f6c\u65f6\uff0c\u4f1a\u5e26\u52a8\u7740\u4e2d\u592e\u6309\u94ae btn \u4e00\u8d77\u65cb\u8f6c\u3002\u4e3a\u4e86\u5b9e\u73b0 box \u65cb\u8f6c\u800c btn \u4fdd\u6301\u4e0d\u53d8\u7684\u6548\u679c\uff0cbox \u987a\u65f6\u9488\u65cb\u8f6c\u591a\u5c11\u5ea6\uff0c\u6211\u4eec\u5c31\u9700\u8981\u8ba9\u4e2d\u592e\u6309\u94ae\u9006\u65f6\u9488\u65cb\u8f6c\u591a\u5c11\u5ea6\u3002\u56e0\u6b64\u540e\u7eed\u65cb\u8f6c\u7684 js \u4ee3\u7801\u4e2d\uff0c\u6211\u4eec\u4f1a\u6709\u5982\u4e0b\u4ee3\u7801\uff1a\\r\\n\\r\\n```js\\r\\nbox.style.transform = `rotate(${begin}deg)`\\r\\n// translate(-50%, -50%) \u662f\u4e3a\u4e86\u8ba9\u7edd\u5bf9\u5b9a\u4f4d\u7684\u4e2d\u592e\u6309\u94ae\u5c45\u4e2d\\r\\nbtn.style.transform = `translate(-50%, -50%) rotate(${-begin}deg)`\\r\\n```\\r\\n\\r\\n### \u57fa\u7840\u4ee3\u7801\\r\\n\\r\\n\u73b0\u5728\u6211\u7ed9\u51fa\u57fa\u7840\u7684\u65cb\u8f6c\u4ee3\u7801\uff1a\\r\\n\\r\\n```js\\r\\nconst box = document.getElementById(\'box\'),\\r\\n  btn = document.getElementById(\'btn\')\\r\\n\\r\\nbtn.addEventListener(\'click\', () => {\\r\\n  const randomIndex = parseInt(Math.random() * 6)\\r\\n  run(randomIndex * 60 + 30)\\r\\n})\\r\\n\\r\\nlet timer = null\\r\\nfunction run(angle) {\\r\\n  let begin = 0\\r\\n  let base = 1800\\r\\n  timer = setInterval(function () {\\r\\n    const finalAngle = base + angle\\r\\n    if (begin >= finalAngle) {\\r\\n      clearInterval(timer)\\r\\n    }\\r\\n    box.style.transform = `rotate(${begin}deg)`\\r\\n    btn.style.transform = `translate(-50%, -50%) rotate(${-begin}deg)`\\r\\n    begin += 30\\r\\n  }, 16)\\r\\n}\\r\\n```\\r\\n\\r\\n\u4ee3\u7801\u4e3b\u8981\u5206\u4e3a 2 \u90e8\u5206\uff0c\u7b2c 1 \u90e8\u5206\u7ed1\u5b9a btn \u70b9\u51fb\u4e8b\u4ef6\uff0c\u7b2c 2 \u90e8\u5206\u63a7\u5236 box \u548c btn \u7684\u65cb\u8f6c\u3002\\r\\n\\r\\n\u6211\u4eec\u5148\u770b\u7b2c 1 \u90e8\u5206\uff0c\u8fd9\u90e8\u5206\u6211\u4eec\u4f1a\u5148\u83b7\u53d6\u4e00\u4e2a 0 ~ 5 \u7684\u968f\u673a\u4e0b\u6807 randomIndex\uff0c\u5229\u7528 randomIndex * 60 \u6765\u8ba1\u7b97\u65cb\u8f6c\u7684\u89d2\u5ea6\uff08\u4e00\u4e2a\u5956\u54c1\u6247\u5f62\u533a\u57df\u662f 60 \u5ea6\uff09\u3002\u4e4b\u6240\u4ee5\u8981\u518d\u52a0\u4e0a 30 \u5ea6\uff0c\u662f\u56e0\u4e3a\u6211\u4eec\u5e0c\u671b\u65cb\u8f6c\u7ed3\u675f\u4e4b\u540e\uff0c\u6307\u9488\u6307\u5411\u4e2d\u5956\u533a\u57df\u7684\u4e2d\u8f74\u7ebf\u3002\\r\\n\\r\\n\u518d\u770b\u7b2c 2 \u90e8\u5206\uff0c\u6211\u4eec\u8bbe\u7f6e\u4e86 1800 \u5ea6\u7684\u57fa\u7840\u89d2\u5ea6 base\uff08\u56e0\u4e3a 1800 = 360 * 5\uff0c\u4e5f\u5c31\u662f\u81f3\u5c11\u8981\u65cb\u8f6c 5 \u5708\u540e\u624d\u4f1a\u505c\u6b62\uff09\u3002\u53c8\u8bbe\u7f6e\u4e86\u4e00\u4e2a\u8ba1\u65f6\u5668\uff0c\u6bcf\u8fc7 16 \u79d2\u5c31\u65cb\u8f6c 30 \u5ea6\uff0c\u76f4\u5230\u8d85\u8fc7\u76ee\u6807\u5ea6\u6570\u540e\u624d\u505c\u6b62\u65cb\u8f6c\u3002\\r\\n\\r\\n\u4ee3\u7801\u7684\u6548\u679c\u5982\u4e0b\uff1a\\r\\n\\r\\n![](./img/base-rotate.gif)\\r\\n\\r\\n### \u6539\u5584\u4f53\u9a8c\\r\\n\\r\\n\u57fa\u7840\u65cb\u8f6c\u4ee3\u7801\u867d\u7136\u5b9e\u73b0\u4e86\u6548\u679c\uff0c\u4f46\u4f53\u9a8c\u8fd8\u6709\u5f85\u6539\u5584\u3002\u4e3b\u8981\u6709\u4e24\u70b9\u9700\u8981\u4f18\u5316\u3002\\r\\n\\r\\n#### \u65cb\u8f6c\u65f6\uff0c\u6309\u94ae\u4e0d\u80fd\u88ab\u518d\u6b21\u70b9\u51fb\\r\\n\\r\\n\u5f00\u59cb\u65cb\u8f6c\u65f6\uff0c\u6b64\u65f6\u6309\u94ae\u5e94\u8be5\u4e0d\u80fd\u88ab\u518d\u6b21\u70b9\u51fb\u3002\u53ea\u6709\u65cb\u8f6c\u7ed3\u675f\u540e\uff0c\u6309\u94ae\u624d\u80fd\u88ab\u518d\u6b21\u70b9\u51fb\uff0c\u56e0\u6b64\u6211\u4eec\u9700\u8981\u589e\u52a0\u4e00\u4e2a\u70b9\u51fb\u9501 clickLock\u3002\u5173\u952e\u4ee3\u7801\u5982\u4e0b\uff1a\\r\\n\\r\\n```js\\r\\n...\\r\\nlet clickLock = false\\r\\n\\r\\nbtn.addEventListener(\'click\', () => {\\r\\n  if (clickLock) {\\r\\n    return\\r\\n  }\\r\\n  ...\\r\\n})\\r\\n\\r\\nlet timer = null\\r\\nfunction run(angle) {\\r\\n  ...\\r\\n  clickLock = true\\r\\n  timer = setInterval(function () {\\r\\n    ...\\r\\n    if (begin >= finalAngle) {\\r\\n      clickLock = false\\r\\n      clearInterval(timer)\\r\\n    }\\r\\n    ...\\r\\n  }, 10)\\r\\n}\\r\\n```\\r\\n\\r\\n\u5f00\u59cb\u65f6 clickLock \u4e3a false\uff0c\u8f6c\u76d8\u65cb\u8f6c\u65f6 clickLock \u4f1a\u88ab\u7f6e\u4e3a true\uff0c\u505c\u6b62\u65cb\u8f6c\u65f6 clickLock \u4f1a\u88ab\u7f6e\u4e3a false\u3002\u8fd9\u6837\u8f6c\u76d8\u65cb\u8f6c\u671f\u95f4\uff0c\u5982\u679c\u7528\u6237\u7ee7\u7eed\u70b9\u51fb\u6309\u94ae\uff0c\u70b9\u51fb\u4e8b\u4ef6\u4f1a\u88ab\u62e6\u622a\u3001\u4e0d\u518d\u89e6\u53d1\u65cb\u8f6c\u51fd\u6570 run\u3002\\r\\n\\r\\n#### \u65cb\u8f6c\u65f6\uff0c\u901f\u5ea6\u9700\u8981\u8d8a\u6765\u8d8a\u6162\\r\\n\\r\\n\u57fa\u7840\u4ee3\u7801\u5b9e\u73b0\u7684\u8f6c\u76d8\uff0c\u8f6c\u76d8\u65cb\u8f6c\u7684\u901f\u5ea6\u662f\u6052\u5b9a\u7684\u3002\u5f53\u65cb\u8f6c\u7ed3\u675f\u65f6\uff0c\u8f6c\u76d8\u4f1a\u77ac\u95f4\u505c\u6b62\uff0c\u8fd9\u4f1a\u8ba9\u7528\u6237\u611f\u89c9\u5f88\u7a81\u5140\u3002\u6b63\u5e38\u6765\u8bf4\uff0c\u8f6c\u76d8\u7684\u65cb\u8f6c\u901f\u5ea6\u5e94\u8be5\u8d8a\u6765\u8d8a\u6162\u3002\\r\\n\\r\\n\u65cb\u8f6c\u901f\u5ea6\u8d8a\u6765\u8d8a\u6162\uff0c\u53ef\u4ee5\u7528\u65cb\u8f6c\u7684\u89d2\u5ea6\u8d8a\u6765\u8d8a\u5c0f\u7b80\u4ecb\u5b9e\u73b0\uff0c\u8d8a\u6765\u8d8a\u5c0f\u7684\u65cb\u8f6c\u89d2\u5ea6\u53ef\u4ee5\u7528\u4e0b\u9762\u7684\u516c\u5f0f\u8ba1\u7b97\uff1a\\r\\n\\r\\n```\\r\\nstep = (final - current) * ratio\\r\\n```\\r\\n\\r\\n- current \u662f\u5df2\u7ecf\u65cb\u8f6c\u7684\u89d2\u5ea6\u3002\\r\\n- step \u662f\u5728 current \u57fa\u7840\u4e0a\uff0c\u4e0b\u4e00\u6b21\u8f6c\u52a8\u9700\u8981\u589e\u52a0\u7684\u89d2\u5ea6\u3002\\r\\n- ratio \u662f\u4e00\u4e2a\u6bd4\u4f8b\u3002\\r\\n\\r\\n\u4ece\u516c\u5f0f\u4e2d\u53ef\u4ee5\u770b\u51fa\uff0c\u968f\u7740 current \u8d8a\u6765\u8d8a\u5927\uff0cstep \u4f1a\u8d8a\u6765\u8d8a\u5c0f\uff0c\u4e5f\u5c31\u662f\u4e0b\u4e00\u6b21\u8f6c\u52a8\u7684\u89d2\u5ea6\u4f1a\u8d8a\u6765\u8d8a\u5c0f\u3002\\r\\n\\r\\n\u6211\u4eec\u628a\u516c\u5f0f\u5199\u6210\u4ee3\u7801\uff0c\u5047\u8bbe\u6bcf 16ms \u9700\u8981\u65cb\u8f6c\u4e00\u5b9a\u89d2\u5ea6\uff0c\u6700\u7ec8\u8981\u65cb\u8f6c 1800 \u5ea6\uff1a\\r\\n\\r\\n```js\\r\\nlet current = 0\\r\\nconst final = 1800\\r\\nconst ratio = 0.5\\r\\nlet timer = setInterval(function () {\\r\\n  if (current >= final) {\\r\\n    clearInterval(timer)\\r\\n  }\\r\\n  const step = (final - current) * ratio\\r\\n  console.log(step)\\r\\n  current +=  Math.ceil(step)\\r\\n}, 16)\\r\\n```\\r\\n\\r\\n\u6b64\u6bb5\u4ee3\u7801\u7684\u6253\u5370\u7684 step \u5982\u4e0b\uff0c\u4e0d\u96be\u770b\u51fa step \u53d8\u5f97\u8d8a\u6765\u8d8a\u5c0f\u4e86\u3002\\r\\n\\r\\n![](./img/fast-to-slow.png)\\r\\n\\r\\n\u4e0a\u8ff0\u4ee3\u7801\u53ef\u4ee5\u5e94\u7528\u5230\u57fa\u7840\u4ee3\u7801\u4e2d\uff0c\u4ece\u800c\u8ba9\u8f6c\u76d8\u7684\u65cb\u8f6c\u901f\u5ea6\u8d8a\u6765\u8d8a\u6162\u3002\\r\\n\\r\\n## \u4e2d\u5956\u7684\u6982\u7387\\r\\n\\r\\n\u4e4b\u524d\u65cb\u8f6c\u89d2\u5ea6\uff0c\u6211\u4eec\u662f\u5148\u83b7\u53d6\u4e86 0 ~ 5 \u4e4b\u95f4\u7684\u4e00\u4e2a\u968f\u673a\u4e0b\u6807\uff08\u6b64\u4e0b\u6807\u5c31\u662f\u5956\u54c1\u7684\u4e0b\u6807\uff09\uff0c\u7136\u540e\u8ba1\u7b97\u4e86\u65cb\u8f6c\u89d2\u5ea6\u3002\u8fd9\u65f6\u6bcf\u4e2a\u5956\u54c1\u7684\u4e2d\u5956\u6982\u7387\u90fd\u662f 20%\u3002\\r\\n\\r\\n\u4f46\u62bd\u5956\u4e00\u822c\u90fd\u9700\u8981\u63a7\u5236\u4e2d\u5956\u7684\u6982\u7387\uff0c\u8fd9\u4e2a\u8be5\u600e\u4e48\u5b9e\u73b0\u5462\uff1f\\r\\n\\r\\n\u5728\u62bd\u5956\u8f6c\u76d8\u4e2d\uff0c\u6211\u4eec\u53ef\u4ee5\u5229\u7528\u6743\u91cd\u7684\u65b9\u5f0f\u63a7\u5236\u62bd\u5956\u6982\u7387\u3002\\r\\n\\r\\n\u5047\u8bbe\u6211\u4eec\u6709 6 \u4e2a\u5956\u9879\uff0c\u9700\u8981\u63a7\u5236\u5956\u54c1 0 ~ \u5956\u54c1 4 \u7684\u4e2d\u5956\u6982\u7387\u90fd\u662f 1%\uff0c\u800c\u5956\u54c1 5 \u7684\u4e2d\u5956\u6982\u7387\u662f 95%\uff0c\u6211\u4eec\u5e94\u8be5\u5982\u4f55\u505a\u5462\uff1f\\r\\n\\r\\n\u63a7\u5236\u4e2d\u5956\u6982\u7387\u7684\u4ee3\u7801\u5982\u4e0b\u6240\u793a\uff1a\\r\\n\\r\\n```js\\r\\nfunction getRandomIndex() {\\r\\n  const weights = [0, 1, 2, 3, 4, 100]\\r\\n  const random = Math.floor(Math.random() * 100)\\r\\n  const newWeights = weights.concat(random)\\r\\n                      .sort((a, b) => a - b)\\r\\n  const randomIndex = newWeights.indexOf(random)\\r\\n  return randomIndex\\r\\n}\\r\\n```\\r\\n\\r\\n\u6211\u4eec\u5148\u7ed9\u51fa\u4e86\u4e00\u4e2a weights \u6570\u7ec4\uff0c\u53c8\u83b7\u53d6\u4e86\u4e00\u4e2a 100 \u4ee5\u5185\u7684\u968f\u673a\u6570 random\uff0c\u5e76\u5bf9 random \u5411\u4e0b\u53d6\u6574\\r\\n\\r\\n- random \u4e3a 0 \u7684\u6982\u7387\u662f 1%\uff0c\u56e0\u4e3a\u5c0f\u4e8e 1 \u7684\u6570\u90fd\u88ab\u5411\u4e0b\u53d6\u6574\u4e3a 0\uff1b\\r\\n- random \u4e3a 1 \u7684\u6982\u7387\u662f 1%\uff0c\u56e0\u4e3a\u5927\u4e8e 1 \u5c0f\u4e8e 2 \u7684\u6570\u90fd\u88ab\u5411\u4e0b\u53d6\u6574\u4e3a 1\uff1b\\r\\n- random \u4e3a 2 \u7684\u6982\u7387\u662f 1%\uff0c\u56e0\u4e3a\u5927\u4e8e 2 \u5c0f\u4e8e 3 \u7684\u6570\u90fd\u88ab\u5411\u4e0b\u53d6\u6574\u4e3a 2\uff1b\\r\\n- random \u4e3a 3 \u7684\u6982\u7387\u662f 1%\uff0c\u56e0\u4e3a\u5927\u4e8e 3 \u5c0f\u4e8e 4 \u7684\u6570\u90fd\u88ab\u5411\u4e0b\u53d6\u6574\u4e3a 3\uff1b\\r\\n- random \u4e3a 4 \u7684\u6982\u7387\u662f 1%\uff0c\u56e0\u4e3a\u5927\u4e8e 4 \u5c0f\u4e8e 5 \u7684\u6570\u90fd\u88ab\u5411\u4e0b\u53d6\u6574\u4e3a 4\uff1b\\r\\n- random \u5927\u4e8e 5 \u5c0f\u4e8e 100 \u7684\u6982\u7387\u5219\u662f 95%\u3002\\r\\n\\r\\n\u6211\u4eec\u628a random \u63d2\u5165\u5230 weights \u6570\u7ec4\u4e2d\uff0c\u518d\u4ece\u5c0f\u5230\u5927\u6392\u5e8f\uff0c\u6b64\u65f6 random \u5bf9\u5e94\u7684\u4e0b\u6807\u5c31\u662f\u5956\u54c1\u4e0b\u6807\u3002\\r\\n\\r\\n## \u5b8c\u6574\u4ee3\u7801\\r\\n\\r\\n[turntable | codepen](https://codepen.io/lijunlin2022/pen/YzMdvEL)\\r\\n\\r\\n## \u603b\u7ed3\\r\\n\\r\\n\u672c\u6587\u8bf4\u660e\u4e86 H5 \u5982\u4f55\u5b9e\u73b0\u62bd\u5956\u8f6c\u76d8\uff1a\\r\\n\\r\\n- \u8f6c\u76d8\u7684\u5e03\u5c40\uff1a\u5e03\u5c40\u65f6\u8981\u5c06\u8f6c\u76d8\u62c6\u5206\u4e3a\u5de6\u3001\u53f3\u4e24\u90e8\u5206\uff0c\u6700\u540e\u5408\u5e76\u4e3a\u4e00\u4e2a\u8f6c\u76d8\u3002\\r\\n- \u8f6c\u76d8\u7684\u65cb\u8f6c\uff1a\u6539\u53d8\u8f6c\u76d8\u5bb9\u5668\u7684\u65cb\u8f6c\u89d2\u5ea6\uff0c\u53ef\u4ee5\u5b9e\u73b0\u8f6c\u76d8\u7684\u65cb\u8f6c\u3002\u52a0\u8f7d\u9501\uff0c\u65cb\u8f6c\u901f\u5ea6\u8d8a\u53d8\u8d8a\u6162\u53ef\u4ee5\u6539\u5584\u8f6c\u76d8\u7684\u4f7f\u7528\u4f53\u9a8c\u3002\\r\\n- \u4e2d\u5956\u7684\u6982\u7387\uff1a\u6743\u91cd\u6570\u7ec4\u53ef\u4ee5\u63a7\u5236\u4e2d\u5956\u6982\u7387\u3002\\r\\n\\r\\n\u62f3\u6253 H5\uff0c\u811a\u8e22\u5c0f\u7a0b\u5e8f\u3002\u6211\u662f\u300c\u5c0f\u9716\u5bb6\u7684\u6df7\u6c5f\u9f99\u300d\uff0c\u5173\u6ce8\u6211\uff0c\u5e26\u4f60\u4e86\u89e3\u66f4\u591a\u5b9e\u7528\u7684 H5\u3001\u5c0f\u7a0b\u5e8f\u6b66\u5b66\u3002"},{"id":"/2024/04/08/waterfall-flow","metadata":{"permalink":"/blog/2024/04/08/waterfall-flow","source":"@site/blog/2024-04-08-waterfall-flow/index.md","title":"\u5bf9\u6bd4\u5c0f\u7ea2\u4e66\u4e0e\u7535\u5546\u4e09\u5de8\u5934\u7684\u7011\u5e03\u6d41\uff0cH5 \u7011\u5e03\u6d41\u5b9e\u73b0\u65b9\u6848\u5e94\u8be5\u5982\u4f55\u9009\u62e9\uff1f","description":"\u7011\u5e03\u6d41\u5e03\u5c40\uff0c\u6211\u4eec\u65e2\u80fd\u5728\u5c0f\u7ea2\u4e66\u8fd9\u7c7b\u56fe\u6587\u7f51\u7ad9\u770b\u5230\uff0c\u4e5f\u80fd\u5728\u62fc\u591a\u591a\u3001\u4eac\u4e1c\u548c\u6dd8\u5b9d\u8fd9\u7c7b\u7535\u5546\u7f51\u7ad9\u770b\u5230\u3002\u5c0f\u7ea2\u4e66\u7684\u7011\u5e03\u6d41\uff0c\u662f\u5229\u7528\u7edd\u5bf9\u5b9a\u4f4d\u8ba1\u7b97\u9ad8\u5ea6\u5b9e\u73b0\u3002\u800c\u7535\u5546\u4e09\u5de8\u5934\u7684\u7011\u5e03\u6d41\uff0c\u5219\u662f\u5229\u7528 Flex \u5e03\u5c40\u5b9e\u73b0\u3002","date":"2024-04-08T00:00:00.000Z","tags":[],"readingTime":13.18,"hasTruncateMarker":false,"authors":[],"frontMatter":{},"unlisted":false,"prevItem":{"title":"\u4eff\u62fc\u591a\u591a\u73b0\u91d1\u5927\u8f6c\u76d8\uff0cH5 \u62bd\u5956\u8f6c\u76d8\u5982\u4f55\u5b9e\u73b0\uff1f","permalink":"/blog/2024/04/17/lottery-turntable"},"nextItem":{"title":"\u4eff\u767e\u4ebf\u8865\u8d34\uff0cH5 \u4e2d\u56fe\u7247\u5148\u6a21\u7cca\u540e\u6e05\u6670\u7684\u6548\u679c\u5982\u4f55\u5b9e\u73b0\uff1f","permalink":"/blog/2024/03/23/ten-billion-subsidy-load-img"}},"content":"\u7011\u5e03\u6d41\u5e03\u5c40\uff0c\u6211\u4eec\u65e2\u80fd\u5728\u5c0f\u7ea2\u4e66\u8fd9\u7c7b\u56fe\u6587\u7f51\u7ad9\u770b\u5230\uff0c\u4e5f\u80fd\u5728\u62fc\u591a\u591a\u3001\u4eac\u4e1c\u548c\u6dd8\u5b9d\u8fd9\u7c7b\u7535\u5546\u7f51\u7ad9\u770b\u5230\u3002\u5c0f\u7ea2\u4e66\u7684\u7011\u5e03\u6d41\uff0c\u662f\u5229\u7528\u7edd\u5bf9\u5b9a\u4f4d\u8ba1\u7b97\u9ad8\u5ea6\u5b9e\u73b0\u3002\u800c\u7535\u5546\u4e09\u5de8\u5934\u7684\u7011\u5e03\u6d41\uff0c\u5219\u662f\u5229\u7528 Flex \u5e03\u5c40\u5b9e\u73b0\u3002\\r\\n\\r\\n\u90a3\u4e48\uff0c\u540c\u6837\u662f\u7011\u5e03\u6d41\uff0c\u4e24\u79cd\u5b9e\u73b0\u65b9\u5f0f\u7684\u4f18\u70b9\u3001\u7f3a\u70b9\u662f\u4ec0\u4e48\u5462\uff1f\u5982\u679c\u60f3\u7528 H5 \u5b9e\u73b0\u7011\u5e03\u6d41\uff0c\u5e94\u8be5\u7528\u54ea\u4e00\u79cd\u65b9\u6848\u5462\uff1f\\r\\n\\r\\n![](./img/xiaohongshu.png)\\r\\n\\r\\n![](./img/pdd-jd-taobao.png)\\r\\n\\r\\n\u672c\u6587\u4e2d\uff0c\u6211\u4f1a\u9996\u5148\u4ecb\u7ecd\u7011\u5e03\u6d41\u662f\u4ec0\u4e48\uff0c\u63a5\u7740\u6211\u4f1a\u4ecb\u7ecd\u5c0f\u7ea2\u4e66\u7011\u5e03\u6d41\u5b9e\u73b0\u65b9\u5f0f\uff0c\u5e76\u7ed9\u51fa\u793a\u4f8b\u4ee3\u7801\uff1b\u7136\u540e\uff0c\u6211\u4f1a\u7ed9\u51fa\u7535\u5546\u4e09\u5de8\u5934\u7011\u5e03\u6d41\u5b9e\u73b0\u65b9\u5f0f\uff0c\u5e76\u7ed9\u51fa\u793a\u4f8b\u4ee3\u7801\uff1b\u6700\u540e\uff0c\u6211\u4f1a\u505a\u4e00\u4e2a\u4e24\u79cd\u65b9\u6848\u7684\u5bf9\u6bd4\u603b\u7ed3\u3002\\r\\n\\r\\n\u62f3\u6253 H5\uff0c\u811a\u8e22\u5c0f\u7a0b\u5e8f\u3002\u6211\u662f\u300c\u5c0f\u9716\u5bb6\u7684\u6df7\u6c5f\u9f99\u300d\uff0c\u5173\u6ce8\u6211\uff0c\u5e26\u4f60\u4e86\u89e3\u66f4\u591a\u5b9e\u7528\u7684 H5\u3001\u5c0f\u7a0b\u5e8f\u6b66\u5b66\u3002\\r\\n\\r\\n## \u7011\u5e03\u6d41\u662f\u4ec0\u4e48\\r\\n\\r\\n\u7011\u5e03\u6d41\u662f\u4e00\u79cd\u5bbd\u5ea6\u76f8\u540c\uff0c\u9ad8\u5ea6\u4e0d\u540c\u7684\u5361\u7247\u5e03\u5c40\u65b9\u5f0f\u3002\\r\\n\\r\\n\u5982\u4e0b\u56fe\u6240\u793a\uff0c\u4f20\u7edf\u5e03\u5c40\u4e2d\u5bbd\u5ea6\u76f8\u540c\u3001\u9ad8\u5ea6\u4e0d\u540c\u7684\u5361\u7247\u6392\u5217\u5728\u4e00\u8d77\u65f6\uff0c\u4f1a\u51fa\u73b0\u5927\u91cf\u7a7a\u767d\u3002\u8fd9\u6837\u65e2\u6d6a\u8d39\u4e86\u7a7a\u95f4\u3001\u53c8\u4e0d\u7f8e\u89c2\u3002\\r\\n\\r\\n![](./img/traditional-layout.png)\\r\\n\\r\\n\u800c\u7011\u5e03\u6d41\u5e03\u5c40\uff0c\u5219\u53ef\u4ee5\u6709\u6548\u5229\u7528\u7a7a\u767d\u7684\u7a7a\u95f4\uff0c\u5b9e\u73b0\u7f8e\u89c2\u7684\u6548\u679c\u3002\\r\\n\\r\\n![](./img/waterfall-layout.png)\\r\\n\\r\\n\u5728\u5f00\u59cb\u4ecb\u7ecd\u7011\u5e03\u6d41\u5982\u4f55\u5b9e\u73b0\u4e4b\u524d\uff0c\u6211\u4eec\u5148\u7ed9\u51fa\u4e00\u4e2a\u5de5\u5177\u51fd\u6570\uff0c\u8fd9\u4e2a\u5de5\u5177\u51fd\u6570\u53ef\u4ee5\u751f\u6210\u957f\u5ea6\u4e3a len \u7684\u56fe\u7247\u6570\u7ec4\uff0c\u4e14\u6bcf\u5f20\u56fe\u7247\u90fd\u662f svg\uff0c\u5bbd\u5ea6\u8303\u56f4\u5728 300px \u5230 400px\uff0c\u9ad8\u5ea6\u5728 250px \u5230 500px\u3002\u6211\u4eec\u4f1a\u4f7f\u7528\u6570\u7ec4\u4e2d\u7684\u56fe\u7247\u5b9e\u73b0\u7011\u5e03\u6d41\u5e03\u5c40\u3002\\r\\n\\r\\n```js\\r\\n// \u968f\u673a\u751f\u6210\u5bbd\u5ea6\u5728 300~400\uff0c\u9ad8\u5ea6\u5728 250~500 \u7684\u56fe\u7247\\r\\nfunction getItems(len) {\\r\\n  const items = []\\r\\n  for (let i = 0; i < len; i++) {\\r\\n    const width = Math.floor(Math.random() * (400 - 300 + 1) + 300)\\r\\n    const height = Math.floor(Math.random() * (500 - 250 + 1) + 250)\\r\\n    let url = `\\r\\n      data:image/svg+xml;charset=utf-8,\\r\\n      <svg\\r\\n        xmlns=\\"http://www.w3.org/2000/svg\\"\\r\\n        width=\\"${width}\\"\\r\\n        height=\\"${height}\\"\\r\\n        viewBox=\\"0 0 ${width} ${height}\\"\\r\\n      >\\r\\n        <text\\r\\n          x=\\"50%\\"\\r\\n          y=\\"50%\\"\\r\\n          dominant-baseline=\\"middle\\"\\r\\n          text-anchor=\\"middle\\"\\r\\n          font-size=\\"20\\"\\r\\n          fill=\\"black\\"\\r\\n        >\\r\\n          ${width} * ${height}\\r\\n        </text>\\r\\n      </svg>\\r\\n    `\\r\\n    url = url.replace(/[\\\\r\\\\n]+/g, \'\').replace(/\\\\s+/g, \' \').trim()\\r\\n    items.push({ width, height, url })\\r\\n  }\\r\\n  return items\\r\\n}\\r\\n```\\r\\n\\r\\n![](./img/getItems.png)\\r\\n\\r\\n## \u5c0f\u7ea2\u4e66\u7684\u7011\u5e03\u6d41\\r\\n\\r\\n### \u539f\u7406\\r\\n\\r\\n\u5047\u5982\u5c0f\u7ea2\u4e66\u9700\u8981\u5b9e\u73b0\u5de6\u3001\u4e2d\u3001\u53f3\u4e09\u5217\u7684\u7011\u5e03\u6d41\uff0c\u5b83\u4f1a\u5148\u627e\u9ad8\u5ea6\u6700\u4f4e\u7684\u5217\u653e\u7f6e\u56fe\u7247\uff0c\u5982\u679c\u76f8\u540c\u9ad8\u5ea6\u7684\u5217\uff0c\u5219\u6309\u7167\u4ece\u5de6\u5230\u53f3\u7684\u987a\u5e8f\u653e\u7f6e\u3002\\r\\n\\r\\n\u5982\u4e0b\u56fe\u6240\u793a\uff0c\u521d\u59cb\u65f6\u6bcf\u4e00\u5217\u521d\u59cb\u9ad8\u5ea6\u90fd\u4e3a 0\uff0c\u6240\u4ee5\u56fe\u7247\u5e94\u8be5\u5148\u653e\u6700\u5de6\u4fa7\u7684\u5217\u3002\\r\\n\\r\\n![](./img/left-to-right-0.png)\\r\\n\\r\\n\u653e\u5b8c\u7b2c 0 \u5f20\u56fe\u7247\u540e\uff0c\u6b64\u65f6\u4e2d\u3001\u53f3\u4e24\u5217\u9ad8\u5ea6\u4e3a 0\uff0c\u6240\u4ee5\u7b2c 1 \u5f20\u56fe\u653e\u5728\u4e2d\u5217\u3002\\r\\n\\r\\n![](./img/left-to-right-1.png)\\r\\n\\r\\n\u653e\u5b8c\u7b2c 1 \u5f20\u56fe\u7247\u540e\uff0c\u6b64\u65f6\u53f3\u5217\u9ad8\u5ea6\u4e3a 0\uff0c\u662f\u6700\u4f4e\u7684\u5217\uff0c\u6240\u4ee5\u7b2c 2 \u5f20\u56fe\u653e\u5728\u53f3\u5217\u3002\\r\\n\\r\\n![](./img/left-to-right-2.png)\\r\\n\\r\\n\u653e\u5b8c\u7b2c 2 \u5f20\u56fe\u7247\u540e\uff0c\u6b64\u65f6\u53f3\u5217\u9ad8\u5ea6\u6700\u4f4e\uff0c\u6240\u4ee5\u7b2c 3 \u5f20\u56fe\u653e\u5728\u53f3\u5217\u3002\\r\\n\\r\\n![](./img/left-to-right-3.png)\\r\\n\\r\\n\u653e\u5b8c\u7b2c 3 \u5f20\u56fe\u7247\u540e\uff0c\u6b64\u65f6\u4e2d\u3001\u53f3\u4e24\u5217\u9ad8\u5ea6\u76f8\u540c\uff0c\u6240\u4ee5\u7b2c 4 \u5f20\u56fe\u653e\u5728\u4e2d\u5217\u3002\\r\\n\\r\\n![](./img/left-to-right-4.png)\\r\\n\\r\\n\u653e\u5b8c\u7b2c 4 \u5f20\u56fe\u7247\u540e\uff0c\u6b64\u65f6\u53f3\u5217\u9ad8\u5ea6\u6700\u4f4e\uff0c\u6240\u4ee5\u7b2c 5 \u5f20\u56fe\u7247\u653e\u5728\u53f3\u5217\u3002\\r\\n\\r\\n![](./img/left-to-right-5.png)\\r\\n\\r\\n\u6211\u4eec\u53ef\u4ee5\u6253\u5f00\u5c0f\u7ea2\u4e66\u7f51\u9875\u7248\u7684\u63a7\u5236\u53f0\uff0c\u5728\u63a7\u5236\u53f0\u53ef\u4ee5\u68c0\u67e5\u5143\u7d20\uff0c\u53ef\u4ee5\u770b\u5230\u5b83\u7684\u5e03\u5c40\u5b8c\u5168\u7b26\u5408\u8fd9\u4e2a\u89c4\u5f8b\u3002\\r\\n\\r\\n![](./img/xiaohongshu.gif)\\r\\n\\r\\n### \u5173\u952e\u4ee3\u7801\u89e3\u91ca\\r\\n\\r\\n\u8bf4\u5b8c\u539f\u7406\uff0c\u6211\u4eec\u73b0\u5728\u6765\u770b\u4e0b\u5173\u952e\u4ee3\u7801\uff0c\u4ee3\u7801\u6574\u4f53\u601d\u8def\uff0c\u53ef\u4ee5\u7406\u89e3\u4e3a\u5148\u63d2\u5165\u56fe\u7247\uff0c\u518d\u8bbe\u7f6e\u56fe\u7247\u4f4d\u7f6e\u3002\\r\\n\\r\\n#### \u63d2\u5165\u56fe\u7247\\r\\n\\r\\n\u5148\u770b\u57fa\u7840\u5e03\u5c40\uff0c\u5e03\u5c40\u975e\u5e38\u7b80\u5355\uff0c\u5c31\u662f\u4e00\u4e2a\u5b9a\u4f4d\u4e3a relative \u7684\u76d2\u5b50\u5143\u7d20\u3002\u4e4b\u540e\u6211\u4eec\u4f1a\u5728\u76d2\u5b50\u4e2d\u5143\u7d20\u4e2d\u4e00\u5f20\u5f20\u63d2\u5165\u56fe\u7247\uff0c\u6bcf\u4e00\u4e2a\u56fe\u7247\u7684\u5b9a\u4f4d\u90fd\u662f absolute\u3002\\r\\n\\r\\n```html\\r\\n<style>\\r\\n  ...\\r\\n  #box {\\r\\n    position: relative;\\r\\n  }\\r\\n  #box img {\\r\\n    position: absolute;\\r\\n    object-fit: cover;\\r\\n    background-color: #eee;\\r\\n  }\\r\\n  ...\\r\\n</style>\\r\\n...\\r\\n<div id=\\"box\\"></div>\\r\\n```\\r\\n\\r\\n\u63d2\u5165\u56fe\u7247\u7684 JavaScript \u4ee3\u7801\u5982\u4e0b\uff0c\u5165\u53c2 items \u53ef\u4ee5\u524d\u6587\u63d0\u5230\u7684\u5de5\u5177\u51fd\u6570 `getItems()` \u751f\u6210\u3002\u81f3\u4e8e imgWidth \u5219\u662f\u6bcf\u4e00\u5217\u7684\u5bbd\u5ea6\uff0c\u6211\u4eec\u53ef\u4ee5\u81ea\u884c\u6307\u5b9a\u3002\\r\\n\\r\\n\u6211\u4eec\u5728 `getItems()` \u4e2d\u751f\u6210\u4e86\u5bbd\u9ad8\u4e0d\u4e00\u7684\u56fe\u7247\uff0c\u5f53\u56fe\u7247\u5b9e\u9645\u663e\u793a\u5728\u5c4f\u5e55\u4e0a\u65f6\uff0c\u5b83\u4eec\u7684\u5bbd\u5ea6\u90fd\u4f1a\u7f29\u5199\u4e3a imgWidth\uff0c\u56e0\u6b64\u6211\u4eec\u4e5f\u8981\u5c06\u5b83\u4eec\u7684\u9ad8\u5ea6\u7b49\u6bd4\u4f8b\u7f29\u653e\u3002\\r\\n\\r\\n\u6211\u4eec\u7684\u505a\u6cd5\u5c31\u662f\u8ba1\u7b97\u51fa imgWidth \u4e0e\u6bcf\u4e00\u5f20\u56fe\u7247 width \u7684\u6bd4\u4f8b ratio\uff0c\u7136\u540e\u7528\u6bcf\u4e00\u5f20\u56fe\u7247\u7684 height * ratio \u83b7\u5f97\u7b49\u6bd4\u4f8b\u7f29\u653e\u7684\u9ad8\u5ea6\u3002 \\r\\n\\r\\n```js\\r\\n// \u52a0\u5165\u56fe\u7247\u5143\u7d20\\r\\nfunction createImgs(items, imgWidth) {\\r\\n  for (let i = 0; i < items.length; i++) {\\r\\n    const { url, width: w, height: h } = items[i]\\r\\n    const img = document.createElement(\'img\')\\r\\n    const ratio = imgWidth / w\\r\\n    const imgHeight = Math.floor(h * ratio)\\r\\n\\r\\n    img.width = imgWidth\\r\\n    img.height = imgHeight\\r\\n    img.src = url\\r\\n\\r\\n    box.appendChild(img)\\r\\n  }\\r\\n}\\r\\n```\\r\\n\\r\\n#### \u8bbe\u7f6e\u56fe\u7247\u4f4d\u7f6e\\r\\n\\r\\n\u8bbe\u7f6e\u56fe\u7247\u4f4d\u7f6e\u4e4b\u524d\uff0c\u6211\u4eec\u9700\u8981\u77e5\u9053\u7011\u5e03\u6d41\u88ab\u5206\u4e3a\u51e0\u5217\uff0c\u4ee5\u53ca\u6bcf\u4e00\u5217\u7684\u95f4\u9699\u3002\\r\\n\\r\\n\u5982\u4e0b\u56fe\u6240\u793a\uff0c\u7011\u5e03\u6d41\u7684\u5217\u6570 `colNumber = Math.floor(boxWidth / imgWidth)`\uff0c\u95f4\u9699\u7684\u5217\u6570\u5219\u662f `colNumber - 1`\u3002\\r\\n\\r\\n![](./img/column-info.png)\\r\\n\\r\\n```js\\r\\n// \u8ba1\u7b97\u4f1a\u6709\u591a\u5c11\u5217\uff0c\u4ee5\u53ca\u6bcf\u5217\u7684\u95f4\u9699\\r\\nfunction getColumnInfo(imgWidth) {\\r\\n  const boxWidth = box.clientWidth\\r\\n  const colNumber = Math.floor(boxWidth / imgWidth) // \u5217\u7684\u6570\u91cf\\r\\n\\r\\n  const spaceNumber = colNumber - 1\\r\\n  const leftSpace = boxWidth - colNumber * imgWidth\\r\\n  const colSpace = parseFloat((leftSpace / spaceNumber).toFixed(2), 10)\\r\\n\\r\\n  return {\\r\\n    colSpace,\\r\\n    colNumber\\r\\n  }\\r\\n}\\r\\n```\\r\\n\\r\\n\u63a5\u4e0b\u6765\uff0c\u6211\u4eec\u9700\u8981\u8bbe\u7f6e\u6bcf\u4e00\u5f20\u56fe\u7247\u7684\u4f4d\u7f6e\u3002\u56e0\u4e3a\u56fe\u7247\u5b9a\u4f4d\u662f absolute\uff0c\u6240\u4ee5\u5982\u679c\u8981\u8bbe\u7f6e\u4f4d\u7f6e\uff0c\u6211\u4eec\u9700\u8981\u77e5\u9053\u6bcf\u4e00\u5f20\u56fe\u7247\u5230\u9876\u90e8\u7684\u8ddd\u79bb top\uff0c\u4ee5\u53ca\u5230\u5de6\u4fa7\u7684\u8ddd\u79bb left\u3002\\r\\n\\r\\n`setPosition()` \u51fd\u6570\u6709\u56db\u4e2a\u5165\u53c2\uff1a\\r\\n\\r\\n- `items` \u4ee3\u8868\u56fe\u7247\u6570\u7ec4\uff0c\u4e5f\u5c31\u662f\u4e4b\u524d\u63d0\u5230\u7684\u5de5\u5177\u51fd\u6570 `getItems()` \u7684\u7ed3\u679c\u3002\\r\\n- `colNumber` \u4ee3\u8868\u7011\u5e03\u6d41\u6709\u51e0\u5217\uff0c\u4e4b\u524d `getColumnsInfo()` \u7ed3\u679c\u4e2d\u5305\u542b\u8fd9\u4e2a\u7ed3\u679c\u3002\\r\\n- `colSpace` \u4ee3\u8868\u7011\u5e03\u6d41\u5217\u4e0e\u5217\u4e4b\u95f4\u7684\u95f4\u9699\uff0c\u4e4b\u524d\u7684 `getColumnsInfo()` \u7ed3\u679c\u4e2d\u4e5f\u5305\u542b\u8fd9\u4e2a\u7ed3\u679c\u3002\\r\\n- `rolSpace` \u4ee3\u8868\u7011\u5e03\u6d41\u884c\u4e0e\u884c\u4e4b\u95f4\u7684\u95f4\u9699\uff0c\u8fd9\u4e2a\u95f4\u9699\u6211\u4eec\u53ef\u4ee5\u81ea\u884c\u8bbe\u7f6e\uff0c\u6211\u4eec\u4e5f\u8bbe\u7f6e `rolSpace` \u7b49\u4e8e `colSpace`\u3002\\r\\n\\r\\n\u6211\u4eec\u5728\u7011\u5e03\u6d41\u539f\u7406\u4e00\u8282\u5df2\u7ecf\u77e5\u9053\uff0c\u8bbe\u7f6e\u7011\u5e03\u6d41\u56fe\u7247\u65f6\uff0c\u8981\u627e\u5230\u7011\u5e03\u6d41\u9ad8\u5ea6\u6700\u4f4e\u7684\u5217\u653e\u7f6e\u56fe\u7247\uff0c\u5982\u679c\u76f8\u540c\u9ad8\u5ea6\u7684\u5217\uff0c\u5219\u6309\u7167\u4ece\u5de6\u5230\u53f3\u7684\u987a\u5e8f\u653e\u7f6e\u3002\u4e3a\u6b64\uff0c\u5728 `setPosition()` \u51fd\u6570\u4e2d\uff0c\u6211\u4eec\u8bbe\u7f6e\u4e86\u4e00\u4e2a\u957f\u5ea6\u4e3a colNumber \u7684\u6570\u7ec4\uff0c\u6570\u7ec4\u4fdd\u7559\u4e86\u4e00\u884c\u7011\u5e03\u6d41\u56fe\u7247\u7684 top \u7684\u6570\u7ec4\u3002\\r\\n\\r\\n\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u6211\u4eec\u8fd9\u91cc\u7528 `Math.min.apply(null, nextTops)` \u627e\u51fa\u6700\u4f4e top \u7684\u4e0b\u6807\u3002\\r\\n\\r\\n\u6bcf\u6446\u653e\u4e00\u4e2a\u56fe\u7247\uff0cnextTops \u90fd\u4f1a\u66f4\u65b0\u5bf9\u5e94\u4e0b\u6807\u7684 top \u503c\u3002\u4e0b\u4e00\u884c\u56fe\u7247\u7684 top \u503c\uff0c\u5c31\u662f\u672c\u884c\u56fe\u7247\u7684 top + \u672c\u884c\u56fe\u7247\u7684\u9ad8\u5ea6 + \u884c\u4e4b\u95f4\u7684\u95f4\u9699\u3002\u81f3\u4e8e left \u503c\uff0c\u5219\u662f\uff08\u56fe\u7247\u672c\u8eab\u7684\u5bbd\u5ea6 + \u5217\u4e4b\u95f4\u7684\u95f4\u9699\uff09* \u4e0b\u6807\u3002\\r\\n\\r\\n```js\\r\\n// \u8bbe\u7f6e\u6bcf\u5f20\u56fe\u7247\u7684\u4f4d\u7f6e\\r\\nfunction setPosition(items, colNumber, colSpace, rowSpace) {\\r\\n  // \u6570\u7ec4\u957f\u5ea6\u4e3a\u5217\u6570\uff0c\u6bcf\u4e00\u9879\u4ee3\u8868\u4e0b\u4e00\u884c\u7684\u56fe\u7247\u7684 top \u503c\\r\\n  const nextTops = new Array(colNumber).fill(0)\\r\\n\\r\\n  for (let i = 0; i < items.length; i++) {\\r\\n    const img = box.children[i]\\r\\n    const top = Math.min.apply(null, nextTops)\\r\\n    img.style.top = top + \'px\'\\r\\n    const index = nextTops.indexOf(top)\\r\\n    nextTops[index] = nextTops[index] + img.height + rowSpace\\r\\n    const left = index * colSpace + index * img.width\\r\\n    img.style.left = left + \'px\'\\r\\n  }\\r\\n\\r\\n  const max = Math.max.apply(null, nextTops)\\r\\n  box.style.height = max + \'px\'\\r\\n}\\r\\n```\\r\\n\\r\\n#### \u91cd\u65b0\u8bbe\u7f6e\u4f4d\u7f6e\\r\\n\\r\\n\u6211\u4eec\u53ef\u4ee5\u628a\u8bbe\u7f6e\u4f4d\u7f6e\u7684\u51fd\u6570\u5c01\u88c5\u4e3a `init()` \u51fd\u6570\uff0c\u5e76\u7ed9\u9875\u9762\u5bbd\u9ad8\u53d8\u5316\u7684\u4e8b\u4ef6\u7ed1\u5b9a\u4e0a `init()` \u51fd\u6570\uff0c\u8fd9\u6837\u5c31\u80fd\u5b9e\u73b0\u5f53\u7a97\u53e3\u53d8\u5316\u65f6\uff0c\u7011\u5e03\u6d41\u4e5f\u91cd\u65b0\u6539\u53d8\u7684\u6548\u679c\u3002\\r\\n\\r\\n\u6211\u4eec\u5b9e\u73b0\u7684\u7011\u5e03\u6d41\u6548\u679c\u5982\u4e0b\uff1a\\r\\n\\r\\n![](./img/waterfall-absolute.gif)\\r\\n\\r\\n### \u5b8c\u6574\u4ee3\u7801\\r\\n\\r\\n[absolute-waterfall | codepen](https://codepen.io/lijunlin2022/pen/ZEZjrza)\\r\\n\\r\\n## \u7535\u5546\u4e09\u5de8\u5934\u7684\u7011\u5e03\u6d41\\r\\n\\r\\n### \u539f\u7406\\r\\n\\r\\n\u7535\u5546\u4e09\u5de8\u5934\u4e2d\uff0c\u6211\u4eec\u4ee5\u4eac\u4e1c\u9996\u9875\u4e3a\u4f8b\u3002\u6211\u4eec\u4e5f\u662f\u9700\u8981\u627e\u5230\u7011\u5e03\u6d41\u4e2d\u9ad8\u5ea6\u6700\u4f4e\u7684\u4e00\u4f8b\uff0c\u7136\u540e\u628a\u56fe\u7247\u653e\u7f6e\u5230\u8fd9\u4e00\u5217\u4e2d\u3002\u4e0d\u540c\u7684\u662f\uff0c\u5c0f\u7ea2\u4e66\u7684\u7edd\u5bf9\u5b9a\u4f4d\u5e03\u5c40\u4e2d\uff0c\u7011\u5e03\u6d41\u7684\u5217\u53ea\u662f\u4e00\u4e2a\u6982\u5ff5\uff0c\u5e76\u6ca1\u6709\u5b9e\u9645\u7684 Dom \u5143\u7d20\uff1b\u800c\u4eac\u4e1c\u7684\u7011\u5e03\u6d41\u7684\u5217\uff0c\u5219\u662f\u4e00\u4e2a\u5b9e\u9645\u7684 Dom \u5143\u7d20\u3002\\r\\n\\r\\n\u5f53\u5217\u53d8\u4e3a Dom \u5143\u7d20\u4e4b\u540e\uff0c\u6211\u4eec\u4fbf\u4e0d\u518d\u9700\u8981\u8ba1\u7b97 top \u548c left \u503c\uff0c\u53ea\u9700\u8981\u77e5\u9053\u76ee\u524d\u90a3\u4e00\u5217\u6bd4\u8f83\u4f4e\uff0c\u5c31\u628a\u56fe\u7247\u5143\u7d20\u63d2\u5165\u5230\u54ea\u4e00\u5217\u4e2d\u3002\\r\\n\\r\\n\u6211\u4eec\u53ef\u4ee5\u6253\u5f00\u4eac\u4e1c\u7f51\u7ad9\u7684\u63a7\u5236\u53f0\uff0c\u5e76\u68c0\u67e5\u5b83\u7011\u5e03\u6d41\u7684\u5143\u7d20\uff1a\\r\\n\\r\\n![](./img/jd.gif)\\r\\n\\r\\n### \u5173\u952e\u4ee3\u7801\u89e3\u91ca\\r\\n\\r\\n\u4e4b\u524d\u6211\u4eec\u63d0\u5230\uff0c\u5c0f\u7ea2\u4e66\u7684\u5173\u952e\u4ee3\u7801\u53ef\u4ee5\u8ba4\u4e3a\u662f\u300c\u4e3a\u5148\u63d2\u5165\u56fe\u7247\uff0c\u518d\u8bbe\u7f6e\u56fe\u7247\u4f4d\u7f6e\u300d\u3002\u800c\u4eac\u4e1c\u7684\u5173\u952e\u4ee3\u7801\u5219\u53ef\u4ee5\u7406\u89e3\u4e3a\u300c\u5148\u7b97\u51fa\u56fe\u7247\u8981\u63d2\u5165\u7684\u5217\uff0c\u518d\u63d2\u5165\u56fe\u7247\u300d\u3002\\r\\n\\r\\n\u548c\u5c0f\u7ea2\u4e66\u7684\u5173\u952e\u4ee3\u7801\u7c7b\u4f3c\uff0c\u6211\u4eec\u5148\u662f\u8ba9\u56fe\u7247\u7684\u9ad8\u5ea6\u505a\u4e86\u4e00\u4e2a\u7b49\u6bd4\u4f8b\u7684\u7f29\u653e\u3002\\r\\n\\r\\n\u4e3a\u4e86\u786e\u8ba4\u56fe\u7247\u5e94\u8be5\u63d2\u5165\u5230\u5de6\u53f3\u54ea\u4e00\u5217\u4e2d\uff0c\u6211\u4eec\u5206\u522b\u8bbe\u7f6e\u4e86 leftHeight\u3001rightHeight\u3002\u5982\u679c\u5de6\u5217\u8f83\u4f4e\uff0c\u5c31\u628a\u56fe\u7247\u63d2\u5165\u5230\u5de6\u5217\uff0c\u5e76\u66f4\u65b0\u5de6\u5217\u7684\u9ad8\u5ea6\uff1b\u5982\u679c\u53f3\u5217\u8f83\u4f4e\uff0c\u5c31\u628a\u56fe\u7247\u63d2\u5165\u5230\u53f3\u5217\uff0c\u5e76\u66f4\u65b0\u53f3\u5217\u7684\u9ad8\u5ea6\u3002\u5982\u6b64\u5faa\u73af\u5f80\u590d\uff0c\u5c31\u5b9e\u73b0\u4e86\u53cc\u5217\u7684\u7011\u5e03\u6d41\u3002\\r\\n\\r\\n```js\\r\\nfunction createImgs(items, imgWidth, rowSpace) {\\r\\n  let leftHeight = 0,\\r\\n    rightHeight = 0\\r\\n  for (let i = 0; i < items.length; i++) {\\r\\n    const { width: w, height: h, url } = items[i]\\r\\n    const img = document.createElement(\'img\')\\r\\n    const ratio = imgWidth / w\\r\\n    const imgHeight = Math.floor(h * ratio)\\r\\n    img.width = imgWidth\\r\\n    img.height = imgHeight\\r\\n    img.src = url\\r\\n\\r\\n    if (leftHeight <= rightHeight) {\\r\\n      leftHeight = leftHeight + imgHeight + rowSpace\\r\\n      leftBox.appendChild(img)\\r\\n    } else {\\r\\n      rightHeight = rightHeight + imgHeight + rowSpace\\r\\n      rightBox.appendChild(img)\\r\\n    }\\r\\n  }\\r\\n}\\r\\n```\\r\\n\\r\\n\u53cc\u5217\u7011\u5e03\u6d41\u53ef\u4ee5\u7ed3\u5408\u6211\u4e4b\u524d\u7684\u6587\u7ae0 [H5 \u4e0a\u6ed1\u52a0\u8f7d\uff08\u89e6\u5e95\u52a0\u8f7d\uff09\u5982\u4f55\u5b9e\u73b0](https://juejin.cn/post/7341329626357973029)\uff0c\u5f97\u5230\u5982\u4e0b\u6548\u679c\u3002\\r\\n\\r\\n![](./img/waterfall-flex.gif)\\r\\n\\r\\n### \u5b8c\u6574\u4ee3\u7801\\r\\n\\r\\n[flex-waterfall | codepen](https://codepen.io/lijunlin2022/pen/vYMadxY)\\r\\n\\r\\n## \u5bf9\u6bd4\u603b\u7ed3\\r\\n\\r\\n\u73b0\u5728\u6211\u4eec\u5bf9\u5c0f\u7ea2\u4e66\u7684\u7011\u5e03\u6d41\u548c\u7535\u5546\u4e09\u5de8\u5934\u7684\u7011\u5e03\u6d41\u505a\u4e00\u4e2a\u5bf9\u6bd4\u603b\u7ed3\uff1a\\r\\n\\r\\n|    | \u5c0f\u7ea2\u4e66 | \u62fc\u591a\u591a\u3001\u4eac\u4e1c\u3001\u6dd8\u5b9d |\\r\\n| -- | -- | -- |\\r\\n| \u5b9e\u73b0\u65b9\u5f0f | \u7edd\u5bf9\u5b9a\u4f4d | Flex \u5e03\u5c40 |\\r\\n| \u8ba1\u7b97\u91cf | \u5927 | \u5c0f |\\r\\n| \u590d\u6742\u7a0b\u5ea6 | \u9ad8 | \u4f4e |\\r\\n| \u5217\u6570\u662f\u5426\u53ef\u4ee5\u6539\u53d8 | \u662f | \u5426 |\\r\\n\\r\\n\u5982\u679c\u7011\u5e03\u6d41\u7684\u5217\u6570\u4e0d\u4f1a\u6539\u53d8\uff0c\u90a3\u4e48\u63a8\u8350\u4f7f\u7528 Flex \u5e03\u5c40\uff0c\u5b83\u7684\u8ba1\u7b97\u91cf\u66f4\u5c0f\u3001\u590d\u6742\u7a0b\u5ea6\u66f4\u4f4e\uff1b\u5982\u679c\u7011\u5e03\u6d41\u7684\u5217\u6570\u9700\u8981\u6539\u53d8\uff0c\u90a3\u4e48\u63a8\u8350\u4f7f\u7528\u7edd\u5bf9\u5b9a\u4f4d\u5b9e\u73b0\u3002\\r\\n\\r\\n\u901a\u5e38\u6765\u8bf4\uff0cC \u7aef H5 \u603b\u662f\u4f1a\u4fdd\u7559\u4e24\u5217\uff0c\u7528 Flex \u5e03\u5c40\u66f4\u5408\u9002\u3002\u4f46\u662f\u6709\u90e8\u5206\u4ea7\u54c1\u4f1a\u63a8\u51fa\u5355\u53cc\u5217\u5207\u6362\u7684\u529f\u80fd\uff0c\u6b64\u65f6\u7528\u7edd\u5bf9\u5b9a\u4f4d\u65b9\u5f0f\u4f1a\u66f4\u597d\u3002\\r\\n\\r\\n## \u603b\u7ed3\\r\\n\\r\\n\u672c\u6587\u6211\u4eec\u4ecb\u7ecd\u4e86\u5c0f\u7ea2\u4e66\u548c\u7535\u5546\u4e09\u5de8\u5934\uff08\u62fc\u591a\u591a\u3001\u4eac\u4e1c\u3001\u6dd8\u5b9d\uff09\u7684\u7011\u5e03\u6d41\u5b9e\u73b0\u65b9\u6848\uff0c\u5e76\u7ed9\u51fa\u4e86\u4e24\u79cd\u5b9e\u73b0\u7011\u5e03\u6d41\u7684\u4ee3\u7801\uff0c\u6700\u540e\u6211\u4eec\u505a\u4e86\u4e00\u4e2a\u5bf9\u6bd4\uff0c\u65e0\u8bba\u662f\u5b9e\u73b0\u8ba1\u7b97\u91cf\u8fd8\u662f\u96be\u5ea6\uff0cFlex \u5e03\u5c40\u5747\u6bd4\u8f83\u7b80\u5355\u3002\u4f46\u662f Flex \u5e03\u5c40\u65e0\u6cd5\u5b9e\u73b0\u5217\u6570\u5207\u6362\u7684\u60c5\u51b5\u3002\\r\\n\\r\\n\u62f3\u6253 H5\uff0c\u811a\u8e22\u5c0f\u7a0b\u5e8f\u3002\u6211\u662f\u300c\u5c0f\u9716\u5bb6\u7684\u6df7\u6c5f\u9f99\u300d\uff0c\u5173\u6ce8\u6211\uff0c\u5e26\u4f60\u4e86\u89e3\u66f4\u591a\u5b9e\u7528\u7684 H5\u3001\u5c0f\u7a0b\u5e8f\u6b66\u5b66\u3002"},{"id":"/2024/03/23/ten-billion-subsidy-load-img","metadata":{"permalink":"/blog/2024/03/23/ten-billion-subsidy-load-img","source":"@site/blog/2024-03-23-ten-billion-subsidy-load-img/index.md","title":"\u4eff\u767e\u4ebf\u8865\u8d34\uff0cH5 \u4e2d\u56fe\u7247\u5148\u6a21\u7cca\u540e\u6e05\u6670\u7684\u6548\u679c\u5982\u4f55\u5b9e\u73b0\uff1f","description":"\u901b\u8fc7\u62fc\u591a\u591a\u767e\u4ebf\u8865\u8d34\u7684\u540c\u5b66\uff0c\u53ef\u80fd\u6709\u4e00\u4e2a\u4f53\u4f1a\uff0c\u90a3\u5c31\u662f\u56fe\u7247\u52a0\u8f7d\u975e\u5e38\u5feb\uff0c\u5f88\u591a\u56fe\u7247\u77ac\u95f4\u5c31\u51fa\u73b0\u4e86\uff0c\u8fd9\u662f\u4e3a\u4ec0\u4e48\u5462\uff1f","date":"2024-03-23T00:00:00.000Z","tags":[{"inline":true,"label":"H5","permalink":"/blog/tags/h-5"}],"readingTime":4.96,"hasTruncateMarker":false,"authors":[],"frontMatter":{"tags":["H5"]},"unlisted":false,"prevItem":{"title":"\u5bf9\u6bd4\u5c0f\u7ea2\u4e66\u4e0e\u7535\u5546\u4e09\u5de8\u5934\u7684\u7011\u5e03\u6d41\uff0cH5 \u7011\u5e03\u6d41\u5b9e\u73b0\u65b9\u6848\u5e94\u8be5\u5982\u4f55\u9009\u62e9\uff1f","permalink":"/blog/2024/04/08/waterfall-flow"},"nextItem":{"title":"H5\u3001\u5c0f\u7a0b\u5e8f\u80fd\u7528 webp \u56fe\u7247\u5417\uff1f\u5982\u4f55\u5224\u65ad\u73af\u5883\u662f\u5426\u652f\u6301\uff1f","permalink":"/blog/2024/03/10/is-webp-supported"}},"content":"\u901b\u8fc7\u62fc\u591a\u591a\u767e\u4ebf\u8865\u8d34\u7684\u540c\u5b66\uff0c\u53ef\u80fd\u6709\u4e00\u4e2a\u4f53\u4f1a\uff0c\u90a3\u5c31\u662f\u56fe\u7247\u52a0\u8f7d\u975e\u5e38\u5feb\uff0c\u5f88\u591a\u56fe\u7247\u77ac\u95f4\u5c31\u51fa\u73b0\u4e86\uff0c\u8fd9\u662f\u4e3a\u4ec0\u4e48\u5462\uff1f\\r\\n\\r\\n\u7b54\u6848\u662f\uff1a**\u767e\u4ebf\u8865\u8d34\u5148\u52a0\u8f7d\u4e86\u4e00\u5f20\u6a21\u7cca\u5c0f\u56fe\u3001\u518d\u52a0\u8f7d\u4e86\u4e00\u5f20\u6e05\u6670\u5927\u56fe**\u3002\u7528\u6237\u5f88\u96be\u611f\u77e5\u5230\u6a21\u7cca\u5230\u6e05\u6670\u7684\u8fc7\u7a0b\uff0c\u8bef\u4ee5\u4e3a\u56fe\u7247\u52a0\u8f7d\u5f88\u5feb\u3002\\r\\n\\r\\n\u63a5\u4e0b\u6765\u6211\u4f1a\u5148\u7ed9\u51fa\u8bc1\u636e\u3001\u518d\u5206\u6790\u539f\u7406\u3001\u63d0\u4f9b\u5173\u952e\u4ee3\u7801\uff0c\u4e4b\u540e\u7ed9\u767e\u4ebf\u8865\u8d34\u7684\u65b9\u6cd5\u505a\u6269\u5c55\u3001\u8865\u5145\uff0c\u6700\u540e\u505a\u4e00\u4e2a\u7b80\u5355\u603b\u7ed3\u3002\\r\\n\\r\\n\u5f53\u7136\uff0c\u56fe\u7247\u4f18\u5316\u662f\u6d89\u53ca\u77e5\u8bc6\u5f88\u7410\u788e\u3001\u5e7f\u6cdb\uff0c**\u5148\u6a21\u7cca\u5c0f\u56fe\u540e\u6e05\u6670\u5927\u56fe\u53ea\u662f\u5176\u4e2d\u4e00\u79cd\u624b\u6bb5\uff0c\u767e\u4ebf\u8865\u8d34\u80af\u5b9a\u8fd8\u4f7f\u7528\u4e86\u5176\u4ed6\u6280\u672f\u3002** \u5982\u679c\u670b\u53cb\u4f60\u60f3\u4e86\u89e3\u66f4\u591a\u76f8\u5173\u624b\u6bb5\uff0c\u53ef\u4ee5\u70b9\u8d5e\u5173\u6ce8\u6211\u3002\\r\\n\\r\\n\u62f3\u6253 H5\uff0c\u811a\u8e22\u5c0f\u7a0b\u5e8f\u3002\u6211\u662f\u300c\u5c0f\u9716\u5bb6\u7684\u6df7\u6c5f\u9f99\u300d\uff0c\u5173\u6ce8\u6211\uff0c\u5e26\u4f60\u4e86\u89e3\u66f4\u591a\u5b9e\u7528\u7684 H5\u3001\u5c0f\u7a0b\u5e8f\u6b66\u5b66\u3002\\r\\n\\r\\n## \u8bc1\u636e\\r\\n\\r\\n\u6211\u4eec\u53ef\u4ee5\u6709\u4e09\u4e2a\u8bc1\u636e\uff0c\u53ef\u4ee5\u8bc1\u660e\uff1a\u767e\u4ebf\u8865\u8d34\u662f\u5148\u52a0\u8f7d\u6a21\u7cca\u5c0f\u56fe\uff0c\u518d\u52a0\u8f7d\u6e05\u6670\u5927\u56fe\u3002\\r\\n\\r\\n\u7b2c\u4e00\u4e2a\u8bc1\u636e\uff1a\u6211\u4eec\u53ef\u4ee5\u5728\u63a7\u5236\u53f0\u628a\u7f51\u7edc\u8c03\u6574\u6210 Slow 3G\uff0c\u7136\u540e\u5f3a\u5236\u5237\u65b0\u6d4f\u89c8\u5668\uff0c\u53ef\u4ee5\u770b\u5230\u62fc\u591a\u591a\u7684\u56fe\u7247\uff0c\u5b58\u5728\u4e00\u4e2a\u6a21\u7cca\u5230\u6e05\u6670\u7684\u8fc7\u7a0b\u3002\\r\\n\\r\\n![](./img/Slow-3G.png)\\r\\n\\r\\n![](./img/pdd-load.gif)\\r\\n\\r\\n\u7b2c\u4e8c\u4e2a\u8bc1\u636e\uff1a\u6211\u4eec\u5728\u63a7\u5236\u53f0\u67e5\u770b\u7f51\u7edc\u8bf7\u6c42\uff0c\u53ef\u4ee5\u770b\u5230\u8bf7\u6c42\u4e2d\u6709\u4e00\u5f20\u5c0f\u5546\u54c1\u56fe\u3001\u4e00\u5f20\u5927\u5546\u54c1\u56fe\u3002\\r\\n\\r\\n![](./img/product.png)\\r\\n\\r\\n\u7b2c\u4e09\u4e2a\u8bc1\u636e\uff1a\u6211\u4eec\u5728\u63a7\u5236\u53f0\u627e\u5230\u56fe\u7247\u5143\u7d20\uff0c\u53ef\u4ee5\u770b\u5230\u56fe\u7247\u5143\u7d20\u662f\u4e00\u4e2a a \u6807\u7b7e\u5305\u88f9\u7740\u4e00\u4e2a img \u6807\u7b7e\u3002\u5176\u4e2d a \u6807\u7b7e\u7684 background-image \u662f\u6a21\u7cca\u5c0f\u56fe\u94fe\u63a5\uff0cimg \u6807\u7b7e\u7684 src \u662f\u6e05\u6670\u5927\u56fe\u94fe\u63a5\u3002\\r\\n\\r\\n![](./img/pdd-console.png)\\r\\n\\r\\n## \u539f\u7406\u53ca\u4ee3\u7801\\r\\n\\r\\n\u8981\u60f3\u77e5\u9053\u5148\u6a21\u7cca\u3001\u540e\u6e05\u6670\u7684\u539f\u7406\uff0c\u6211\u4eec\u5f97\u5148\u770b\u4e00\u5f20 img \u6807\u7b7e\u662f\u5982\u4f55\u52a0\u8f7d\u56fe\u7247\u7684\uff0c\u5982\u4e0b\u6240\u793a\uff1a\u5f00\u59cb\u65f6 img \u5360\u636e\u7684\u533a\u57df\u4e3a\u7a7a\u767d\uff0c\u968f\u7740\u56fe\u7247\u7684\u9010\u6b65\u52a0\u8f7d\uff0c\u7a7a\u767d\u90e8\u5206\u88ab\u6162\u6162\u586b\u5145\u3002\\r\\n\\r\\n![](./img/avatar-load.gif)\\r\\n\\r\\n\u51c6\u786e\u5730\u8bf4\uff0c**img \u6807\u7b7e\u5360\u636e\u7684\u533a\u57df\uff0c\u4e0d\u662f\u300c\u7a7a\u767d\u300d\u800c\u662f\u300c\u900f\u660e\u300d**\u3002\u8fd9\u610f\u5473\u7740\uff0c\u6211\u4eec\u53ea\u9700\u8981\u7ed9 img \u6807\u7b7e\u8bbe\u7f6e\u4e00\u5f20\u6a21\u7cca\u5c0f\u56fe\u94fe\u63a5\uff0c\u7ed9 img \u6807\u7b7e\u7684 src \u8bbe\u7f6e\u6e05\u6670\u5927\u56fe\u94fe\u63a5\uff0c\u5f53\u5927\u56fe\u6162\u6162\u52a0\u8f7d\u65f6\uff0c\u6e05\u6670\u56fe\u7247\u4f1a\u4e00\u6b65\u6b65\u906e\u6321\u4f4f\u6a21\u7cca\u56fe\u7247\uff0c\u4ece\u800c\u5b9e\u73b0\u6a21\u7cca\u5230\u6e05\u6670\u7684\u6548\u679c\u3002\\r\\n\\r\\n![](./img/avatar-blur-to-clear.gif)\\r\\n\\r\\n\u5173\u952e\u4ee3\u7801\u5982\u4e0b\uff0c\u975e\u5e38\u7b80\u5355\uff1a\\r\\n\\r\\n```html\\r\\n<div class=\\"box\\">\\r\\n  <a class=\\"small-img\\">\\r\\n    <img\\r\\n      class=\\"large-img\\"\\r\\n      src=\\"\u5927\u56fe\u94fe\u63a5\\"\\r\\n    />\\r\\n  </a>\\r\\n</div>\\r\\n```\\r\\n\\r\\n```css\\r\\n.box {\\r\\n  position: relative;\\r\\n}\\r\\n.small-img {\\r\\n  position: absolute;\\r\\n  background-image: url(\\"\u5c0f\u56fe\u94fe\u63a5\\");\\r\\n  background-size: cover;\\r\\n  background-position: unset;\\r\\n}\\r\\n.large-img {\\r\\n  width: ...;\\r\\n  height: ...;\\r\\n}\\r\\n```\\r\\n\\r\\n\u83b7\u53d6\u5c0f\u56fe\u94fe\u63a5\u4e5f\u5f88\u7b80\u5355\uff0c\u73b0\u5728\u5404\u5927\u4e91\u670d\u52a1\u5546\u57fa\u672c\u90fd\u63d0\u4f9b\u4e86\u65b9\u6cd5\u3002\u6bd4\u5982 [\u963f\u91cc\u4e91](https://help.aliyun.com/zh/oss/user-guide/resize-images-4?spm=a2c4g.11186623.0.0.1acf21edXNFC2F) \u53ea\u9700\u8981\u5728\u56fe\u7247 CDN \u94fe\u63a5\u540e\u9762\u62fc\u63a5\u4e00\u4e9b\u53c2\u6570\uff0c\u5c31\u53ef\u4ee5\u5f97\u5230\u56fe\u7247\u7f29\u653e\u7684\u5c0f\u56fe\u3002\\r\\n\\r\\n- \u7f29\u653e\u524d\uff1ahttps://oss-console-img-demo-cn-hangzhou.oss-cn-hangzhou.aliyuncs.com/example.jpg\\r\\n- \u7f29\u653e\u540e\uff1ahttps://oss-console-img-demo-cn-hangzhou.oss-cn-hangzhou.aliyuncs.com/example.jpg?x-oss-process=image/resize,w_100,m_lfit\\r\\n\\r\\n## \u66f4\u8fdb\u4e00\u6b65\uff0c\u52a0\u6a21\u7cca\u6ee4\u955c\\r\\n\\r\\n\u767e\u4ebf\u8865\u8d34\u7684\u505a\u6cd5\uff0c\u5bf9\u4e8e\u7535\u5546\u6d3b\u52a8 H5 \u5df2\u7ecf\u8db3\u591f\u3002\u4f46\u66f4\u8bb2\u7a76\u6c1b\u56f4\u611f\u7684 H5\uff0c\u4e5f\u8bb8\u4f1a\u89c9\u5f97\u767e\u4ebf\u8865\u8d34\u7684\u6548\u679c\u5f88\u7c97\u7cd9\u3002\u9488\u5bf9\u8fd9\u79cd H5\uff0c\u6211\u4eec\u53ef\u4ee5\u66f4\u8fdb\u4e00\u6b65\uff0c\u7ed9\u5c0f\u56fe\u52a0\u4e0a\u6a21\u7cca\u6ee4\u955c\uff0c\u7b49\u5230\u5927\u56fe\u52a0\u8f7d\u5b8c\u6210\u65f6\u518d\u53bb\u9664\u6a21\u7cca\u6ee4\u955c\uff0c\u5e76\u589e\u52a0 transition \u7684\u8fc7\u6e21\u6548\u679c\uff0c\u5c31\u5f97\u5230\u5982\u4e0b\u6548\u679c\uff1a\\r\\n\\r\\n![](./img/blur-20-to-0.gif)\\r\\n\\r\\n\u5173\u952e\u4ee3\u7801\u4e3a\uff1a\\r\\n\\r\\n```css\\r\\n.small-img {\\r\\n  ...\\r\\n  filter: blur(20px);\\r\\n  transition: all .5s ease-in-out;\\r\\n}\\r\\n.loaded {\\r\\n  filter: blur(0);\\r\\n}\\r\\n```\\r\\n\\r\\n```js\\r\\nconst small = document.querySelector(\'.small-img\')\\r\\nconst large = document.querySelector(\'.large-img\')\\r\\n\\r\\nlarge.onload = function () {\\r\\n  small.classList.add(\'loaded\')\\r\\n}\\r\\n```\\r\\n\\r\\n## \u603b\u7ed3\\r\\n\\r\\n\u672c\u6587\u5206\u6790\u4e86\u767e\u4ebf\u8865\u8d34\u56fe\u7247\u52a0\u8f7d\u975e\u5e38\u5feb\u7684\u4e3b\u8981\u539f\u56e0\uff1a\u5148\u52a0\u8f7d\u6a21\u7cca\u5c0f\u56fe\uff0c\u518d\u52a0\u8f7d\u6e05\u6670\u5927\u56fe\u3002\u5e76\u7ed9\u51fa\u4e86\u5173\u952e\u8bc1\u636e\uff0c\u4ee5\u53ca\u5b9e\u73b0\u539f\u7406\u548c\u4ee3\u7801\u3002\u6700\u540e\u5728\u767e\u4ebf\u8865\u8d34\u65b9\u6cd5\u7684\u57fa\u7840\u4e0a\uff0c\u589e\u52a0\u6a21\u7cca\u6ee4\u955c\uff0c\u5b9e\u73b0\u4e86\u66f4\u6709\u6c1b\u56f4\u611f\u7684\u6548\u679c\u3002\\r\\n\\r\\n\u62f3\u6253 H5\uff0c\u811a\u8e22\u5c0f\u7a0b\u5e8f\u3002\u6211\u662f\u300c\u5c0f\u9716\u5bb6\u7684\u6df7\u6c5f\u9f99\u300d\uff0c\u5173\u6ce8\u6211\uff0c\u5e26\u4f60\u4e86\u89e3\u66f4\u591a\u5b9e\u7528\u7684 H5\u3001\u5c0f\u7a0b\u5e8f\u6b66\u5b66\u3002"},{"id":"/2024/03/10/is-webp-supported","metadata":{"permalink":"/blog/2024/03/10/is-webp-supported","source":"@site/blog/2024-03-10-is-webp-supported/index.md","title":"H5\u3001\u5c0f\u7a0b\u5e8f\u80fd\u7528 webp \u56fe\u7247\u5417\uff1f\u5982\u4f55\u5224\u65ad\u73af\u5883\u662f\u5426\u652f\u6301\uff1f","description":"\u6700\u8fd1\u6211\u5728\u505a H5\u3001\u5c0f\u7a0b\u5e8f\u7684\u6027\u80fd\u4f18\u5316\uff0c\u5176\u4e2d\u4e00\u9879\u4f18\u5316\u662f\u628a H5\u3001\u5c0f\u7a0b\u5e8f\u7684 jpg\u3001png \u56fe\u7247\u8f6c\u6362\u4e3a webp \u56fe\u7247\uff0c\u8fd9\u662f\u56e0\u4e3a\u76f8\u6bd4 jpg\u3001png\uff0cwebp \u4f53\u79ef\u66f4\u5c0f\u3001\u4f20\u8f93\u901f\u5ea6\u66f4\u5feb\u3002","date":"2024-03-10T00:00:00.000Z","tags":[],"readingTime":8.155,"hasTruncateMarker":false,"authors":[],"frontMatter":{},"unlisted":false,"prevItem":{"title":"\u4eff\u767e\u4ebf\u8865\u8d34\uff0cH5 \u4e2d\u56fe\u7247\u5148\u6a21\u7cca\u540e\u6e05\u6670\u7684\u6548\u679c\u5982\u4f55\u5b9e\u73b0\uff1f","permalink":"/blog/2024/03/23/ten-billion-subsidy-load-img"},"nextItem":{"title":"\u767e\u4ebf\u8865\u8d34\u4e3a\u4ec0\u4e48\u7528 H5\uff1fH5 \u672a\u6765\u4f1a\u5982\u4f55\u53d1\u5c55\uff1f","permalink":"/blog/2024/03/03/ten-billion-subsidy"}},"content":"\u6700\u8fd1\u6211\u5728\u505a H5\u3001\u5c0f\u7a0b\u5e8f\u7684\u6027\u80fd\u4f18\u5316\uff0c\u5176\u4e2d\u4e00\u9879\u4f18\u5316\u662f\u628a H5\u3001\u5c0f\u7a0b\u5e8f\u7684 jpg\u3001png \u56fe\u7247\u8f6c\u6362\u4e3a webp \u56fe\u7247\uff0c\u8fd9\u662f\u56e0\u4e3a\u76f8\u6bd4 jpg\u3001png\uff0cwebp \u4f53\u79ef\u66f4\u5c0f\u3001\u4f20\u8f93\u901f\u5ea6\u66f4\u5feb\u3002\\r\\n\\r\\n\u8f6c\u6362\u65b9\u6cd5\u5f88\u7b80\u5355\uff0c\u73b0\u5728\u5404\u5927\u4e91\u670d\u52a1\u5546\u57fa\u672c\u90fd\u63d0\u4f9b\u4e86\u65b9\u6cd5\u3002\u6bd4\u5982 [\u817e\u8baf\u4e91](https://cloud.tencent.com/document/product/436/60453) \u53ea\u9700\u8981\u5728\u56fe\u7247 CDN \u94fe\u63a5\u540e\u9762\u62fc\u63a5\u4e00\u4e9b\u53c2\u6570\uff1a\\r\\n\\r\\n- \u8f6c\u6362\u524d\uff1ahttps://example-1258125638.cos.ap-shanghai.myqcloud.com/sample.png\\r\\n- \u8f6c\u6362\u540e\uff1ahttp://example-1258125638.cos.ap-shanghai.myqcloud.com/sample.png?imageMogr2/format/webp\\r\\n\\r\\n\u4e0d\u8fc7\u6211\u8fd8\u662f\u9047\u5230\u4e86\u4e9b\u5c0f\u9ebb\u70e6\uff0c\u4ece [can I use](https://caniuse.com/?search=webp) \u67e5\u8be2\u53d1\u73b0\uff0c\u76ee\u524d\u8fd8\u6709\u5c11\u90e8\u5206\u6d4f\u89c8\u5668\u4e0d\u652f\u6301 webp\u3002\u6240\u4ee5\u5728 H5\u3001\u5c0f\u7a0b\u5e8f\u4f7f\u7528 webp \u683c\u5f0f\u56fe\u7247\u65f6\uff0c\u6211\u9700\u8981\u505a\u4e00\u4e9b\u517c\u5bb9\u3002\\r\\n\\r\\n![](./img/can-i-use-webp.png)\\r\\n\\r\\n\u4e00\u756a\u7814\u7a76\u540e\uff0c\u6211\u77e5\u9053\u4e86\u5224\u65ad\u73af\u5883\u662f\u5426\u652f\u6301 webp \u7684\u51e0\u79cd\u529e\u6cd5\u3002\u5bf9\u8fd9\u4e9b\u529e\u6cd5\u7684\u4f18\u52a3\uff0c\u6211\u4e5f\u6709\u81ea\u5df1\u7684\u89c2\u70b9\uff0c\u4e8e\u662f\u6211\u4fbf\u6574\u7406\u4e86\u8fd9\u7bc7\u6587\u7ae0\u3002\\r\\n\\r\\n\u62f3\u6253 H5\uff0c\u811a\u8e22\u5c0f\u7a0b\u5e8f\u3002\u6211\u662f\u300c\u5c0f\u9716\u5bb6\u7684\u6df7\u6c5f\u9f99\u300d\uff0c\u5173\u6ce8\u6211\uff0c\u5e26\u4f60\u4e86\u89e3\u66f4\u591a\u5b9e\u7528\u7684 H5\u3001\u5c0f\u7a0b\u5e8f\u6b66\u5b66\u3002\\r\\n\\r\\n## toDataURL(\'image/webp\')\\r\\n\\r\\n### \u4ee3\u7801\\r\\n\\r\\n\u7b2c\u4e00\u79cd H5 \u7684\u5224\u65ad\u65b9\u6cd5\uff0c\u5176\u5b9e\u662f\u5224\u65ad H5 \u80fd\u4e0d\u80fd\u5229\u7528 canvas \u7684 `toDataURL()` API \u5f97\u5230\u4e00\u5f20 webp \u56fe\u7247\u3002\\r\\n\\r\\n```js\\r\\nfunction isWebpSupported() {\\r\\n  try {\\r\\n    return document.createElement(\'canvas\')\\r\\n      .toDataURL(\'image/webp\')\\r\\n      .indexOf(\'data:image/webp\') === 0\\r\\n  } catch (e) {\\r\\n    return false\\r\\n  }\\r\\n}\\r\\n```\\r\\n\\r\\n### \u539f\u7406\\r\\n\\r\\n\u8fd9\u79cd\u65b9\u6cd5\u539f\u7406\u662f\u5565\u5462\uff1f\u6211\u4eec\u53ef\u4ee5\u7ee7\u7eed\u5728 [Can I use](https://caniuse.com/?search=webp) \u67e5\u8be2 `toDataURL(\'image/webp\')` \u7684\u517c\u5bb9\u6027\u3002\\r\\n\\r\\n![](./img/can-i-use-toDataURL.png)\\r\\n\\r\\n\u53ef\u4ee5\u770b\u5230\uff0c**\u517c\u5bb9 `toDataURL(\'image/webp\')` \u7684\u6d4f\u89c8\u5668\u3001\u662f\u517c\u5bb9 webp \u6d4f\u89c8\u5668\u7684\u5b50\u96c6\u3002**\\r\\n\\r\\n![](./img/toDataURL.png)\\r\\n\\r\\n\u6362\u53e5\u8bdd\u8bf4\uff0c\u8fd9\u662f\u4e00\u79cd\u300c\u5b81\u6740\u9519\u4e00\u767e\uff0c\u4e5f\u4e0d\u653e\u8fc7\u4e00\u4e2a\u300d\u7684\u65b9\u6cd5\u3002\u4e3e Safari \u6d4f\u89c8\u5668\u4e3a\u4f8b\u5b50\uff0c\u5b83\u5176\u5b9e\u662f\u53ef\u4ee5\u5c55\u793a webp \u56fe\u7247\u7684\uff0c\u4f46\u5b83\u4f1a\u88ab\u8fd9\u79cd `toDataURL(\'image/webp\')` \u65b9\u6cd5\u8bef\u4f24\u3002\\r\\n\\r\\n![](./img/safari.jpg)\\r\\n\\r\\n### \u4f18\u7f3a\u70b9\\r\\n\\r\\n\u8fd9\u79cd\u65b9\u6cd5\u7684\u4f18\u7f3a\u70b9\u5982\u4e0b:\\r\\n\\r\\n- \u4f18\u70b9\uff1a\u4ee3\u7801\u77ed\u5c0f\uff0c\u4e14\u65b9\u6cd5\u662f\u540c\u6b65\u7684\uff0c\u4e0d\u5f71\u54cd\u9996\u5c4f\u6027\u80fd\u3002\\r\\n- \u7f3a\u70b9\uff1a\u8bef\u4f24\u6027\u592a\u9ad8\uff0ciOS \u7684 Safari \u6d4f\u89c8\u5668\u88ab\u5168\u90e8\u8bef\u4f24\u3002\\r\\n\\r\\n### \u5fae\u4fe1\u5c0f\u7a0b\u5e8f\u80fd\u7528\u5417\\r\\n\\r\\n\u8fd9\u79cd\u5224\u65ad\u65b9\u6cd5\u5fae\u4fe1\u5c0f\u7a0b\u5e8f\u53ef\u4ee5\u4f7f\u7528\u5417\uff1f\u5f88\u9057\u61be\u4e0d\u53ef\u4ee5\u3002\\r\\n\\r\\n\u6211\u4eec\u4e4b\u6240\u4ee5\u7528 `toDataURL(\'image/webp\')` \u5224\u65ad H5 \u80fd\u4e0d\u80fd\u4f7f\u7528 webp\uff0c\u524d\u63d0\u662f\u6211\u4eec\u77e5\u9053 **\u517c\u5bb9 `toDataURL(\'image/webp\')` \u7684\u6d4f\u89c8\u5668\u3001\u662f\u517c\u5bb9 webp \u6d4f\u89c8\u5668\u7684\u5b50\u96c6**\u3002\\r\\n\\r\\n\u4f46\u6211\u5728\u5fae\u4fe1\u5b98\u65b9\u6587\u6863\u4e2d\uff0c\u6ca1\u6709\u770b\u5230\u7c7b\u4f3c canvas \u7684 [toDataURL(\'image/webp\')](https://developers.weixin.qq.com/miniprogram/dev/api/canvas/Canvas.toDataURL.html) \u662f webp \u5b50\u96c6\u7684\u63cf\u8ff0\u3002\u57fa\u4e8e\u6b64\uff0c\u6211\u5224\u65ad\u5fae\u4fe1\u5c0f\u7a0b\u5e8f\u4e0d\u80fd\u7528\u8fd9\u4e2a\u65b9\u6cd5\u3002\\r\\n\\r\\n## \u52a0\u8f7d\u4e00\u5f20 webp \u56fe\u7247\u8bd5\u8bd5\uff0c\u770b\u4f1a\u4e0d\u4f1a\u51fa\u9519\\r\\n\\r\\n### \u4ee3\u7801\\r\\n\\r\\n\u7b2c\u4e8c\u79cd H5 \u7684\u5224\u65ad\u65b9\u6cd5\uff0c\u662f\u76f4\u63a5\u5f02\u6b65\u52a0\u8f7d\u4e00\u5f20 webp \u683c\u5f0f\u7684\u56fe\u7247\u3002\u5982\u679c\u52a0\u8f7d\u6210\u529f\uff0c\u8bc1\u660e\u73af\u5883\u80fd\u652f\u6301 webp\uff1b\u5982\u679c\u52a0\u8f7d\u5931\u8d25\uff0c\u8bc1\u660e\u73af\u5883\u4e0d\u652f\u6301 webp\u3002\\r\\n\\r\\n```js\\r\\nfunction isWebpSupported() {\\r\\n  if (!Image) {\\r\\n    return Promise.resolve(false)\\r\\n  }\\r\\n\\r\\n  return new Promise((resolve) => {\\r\\n    const img = new Image()\\r\\n    img.onload = function () {\\r\\n      resolve((img.width > 0) && (img.height > 0))\\r\\n    }\\r\\n    img.onerror = function () {\\r\\n      resolve(false)\\r\\n    }\\r\\n    img.src = \'data:image/webp;base64,UklGRlIAAABXRUJQVlA4WAoAAAASAAAAAAAAAAAAQU5JTQYAAAD/////AABBTk1GJgAAAAAAAAAAAAAAAAAAAGQAAABWUDhMDQAAAC8AAAAQBxAREYiI/gcA\';\\r\\n  })\\r\\n}\\r\\n```\\r\\n\\r\\n### \u539f\u7406\\r\\n\\r\\n\u8fd9\u79cd\u65b9\u6cd5\u6765\u6e90\u4e8e [Google \u5b98\u65b9\u6587\u6863](https://developers.google.com/speed/webp/faq?hl=zh-cn#in_your_own_javascript)\uff0cwebp \u5176\u5b9e\u652f\u6301\u56db\u4e2a\u529f\u80fd\uff0c\u65e0\u635f\u538b\u7f29\u3001\u6709\u635f\u538b\u7f29\u3001\u900f\u660e\u5ea6\u548c\u52a8\u753b\uff0c\u6bcf\u4e2a\u529f\u80fd\u5bf9\u5e94\u4e86\u4e00\u5f20 webp \u56fe\u7247\uff1a\\r\\n\\r\\n```js\\r\\nfunction checkWebpFeature(feature, callback) {\\r\\n  const kTestImages = {\\r\\n    lossy: \\"UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA\\",\\r\\n    lossless: \\"UklGRhoAAABXRUJQVlA4TA0AAAAvAAAAEAcQERGIiP4HAA==\\",\\r\\n    alpha: \\"UklGRkoAAABXRUJQVlA4WAoAAAAQAAAAAAAAAAAAQUxQSAwAAAARBxAR/Q9ERP8DAABWUDggGAAAABQBAJ0BKgEAAQAAAP4AAA3AAP7mtQAAAA==\\",\\r\\n    animation: \\"UklGRlIAAABXRUJQVlA4WAoAAAASAAAAAAAAAAAAQU5JTQYAAAD/////AABBTk1GJgAAAAAAAAAAAAAAAAAAAGQAAABWUDhMDQAAAC8AAAAQBxAREYiI/gcA\\"\\r\\n  }\\r\\n  const img = new Image()\\r\\n  img.onload = function () {\\r\\n    const result = (img.width > 0) && (img.height > 0)\\r\\n    callback(feature, result)\\r\\n  }\\r\\n  img.onerror = function () {\\r\\n    callback(feature, false)\\r\\n  }\\r\\n  img.src = \\"data:image/webp;base64,\\" + kTestImages[feature]\\r\\n}\\r\\n```\\r\\n\\r\\n\u5982\u679c\u5bf9\u56db\u79cd\u529f\u80fd\u90fd\u8fdb\u884c\u5224\u65ad\u7684\u8bdd\uff0c\u4ee3\u7801\u4f1a\u53d8\u5f97\u5f88\u81c3\u80bf\u3002\u6240\u4ee5\u5b9e\u9645\u5f00\u53d1\u4e2d\uff0c\u57fa\u672c\u53ea\u9009\u62e9\u4e00\u5f20 webp \u7684\u56fe\u7247\u3002\\r\\n\\r\\n\u4ece [Can I use](https://caniuse.com/?search=webp) \u67e5\u8be2\u7ed3\u679c\u6765\u770b\uff0c\u6d4f\u89c8\u5668\u8981\u4e48\u662f\u5148\u652f\u6301 webp \u7684\u6709\u635f\u538b\u7f29\uff0c\u518d\u652f\u6301 webp \u7684\u65e0\u635f\u538b\u7f29\u3001\u900f\u660e\u5ea6\u548c\u52a8\u753b\uff1b\u8981\u4e48\u662f\u6709\u635f\u538b\u7f29\u3001\u65e0\u635f\u538b\u7f29\u3001\u900f\u660e\u5ea6\u548c\u52a8\u753b\u4e00\u8d77\u652f\u6301\u3002\u56e0\u6b64\uff0c\u6211\u4eec\u5f80\u5f80\u9009\u62e9\u4e00\u5f20\u652f\u6301\u52a8\u753b\u7684 webp \u56fe\u7247\uff0c\u7528\u5b83\u53bb\u8bd5\u63a2\u6d4f\u89c8\u5668\u662f\u5426\u652f\u6301 webp \u683c\u5f0f\u3002\\r\\n\\r\\n### \u4f18\u7f3a\u70b9\\r\\n\\r\\n- \u4f18\u70b9\uff1a\u57fa\u672c\u4e0d\u4f1a\u8bef\u4f24\uff1b\\r\\n- \u7f3a\u70b9\uff1a\u5f02\u6b65\u52a0\u8f7d\uff0c\u53ef\u80fd\u65e0\u6cd5\u53ca\u65f6\u8f6c\u6362\u56fe\u7247\u94fe\u63a5\u3001\u5f71\u54cd\u9996\u5c4f\u6027\u80fd\u3002\u5982\u679c H5 \u4e0d\u9009\u62e9 CSR\uff0c\u800c\u9009\u62e9 SSR\uff0c\u5219\u65e0\u6cd5\u4f7f\u7528\u6b64\u65b9\u6cd5\u3002\\r\\n\\r\\n### \u5fae\u4fe1\u5c0f\u7a0b\u5e8f\u80fd\u7528\u5417\\r\\n\\r\\n\u8fd9\u79cd\u65b9\u6cd5\u5c0f\u7a0b\u5e8f\u53ef\u4ee5\u7528\u5417\uff1f\u7406\u8bba\u4e0a\u53ef\u4ee5\uff0c\u4f46\u4e0d\u63a8\u8350\u4f7f\u7528\u3002\\r\\n\\r\\n\u5fae\u4fe1\u5b98\u65b9\u6587\u6863\u4e0a\u867d\u7136\u63d0\u5230\u4e86 [createImage](https://developers.weixin.qq.com/minigame/dev/api/render/image/wx.createImage.html) \u65b9\u6cd5\uff0c\u4f46\u6211\u5b9e\u9645\u6d4b\u8bd5\u53d1\u73b0\uff0c\u8fd9\u4e2a\u65b9\u6cd5\u7adf\u7136\u6ca1\u4e86 (* \uffe3\ufe3f\uffe3)\u3002\\r\\n\\r\\n![](./img/createImage.jpg)\\r\\n\\r\\n\u6211\u4eec\u4f7f\u7528\u6b64\u65b9\u6cd5\uff0c\u5c31\u5fc5\u987b\u5728 wxml \u4e2d\u624b\u52a8\u5199\u4e00\u4e2a `image` \u6807\u7b7e\uff0c\u518d\u7ed9\u5b83\u7ed1\u5b9a `onload` \u548c `onerror` \u4e8b\u4ef6\u3002\u8fd9\u610f\u5473\u7740\uff1a\\r\\n\\r\\n- \u5982\u679c\u6211\u4eec\u628a\u8fd9\u4e2a\u6807\u7b7e\u653e\u5230\u81ea\u5df1\u5c01\u88c5\u7684 WebpImage \u7ec4\u4ef6\u4e2d\uff0cWebpImage \u88ab\u591a\u6b21\u4f7f\u7528\u540e\uff0c\u5c0f\u7a0b\u5e8f\u9875\u9762\u4f1a\u591a\u51fa\u5f88\u591a\u989d\u5916\u7684\u8282\u70b9\u3002\\r\\n- \u5982\u679c\u6211\u4eec\u628a\u8fd9\u4e2a\u6807\u7b7e\u653e\u5230\u9875\u9762\u4e0a\uff08\u6bd4\u5982 index \u9875\u9762\uff09\uff0c\u5c31\u9700\u8981\u7ed9\u6bcf\u4e00\u4e2a\u7528\u6237\u53ef\u80fd\u76f4\u63a5\u8bbf\u95ee\u7684\u9875\u9762\u90fd\u52a0\u4e0a\u8fd9\u4e2a\u6807\u7b7e\u3002\u4e5f\u4f1a\u51fa\u73b0\u5f88\u591a\u989d\u5916\u7684\u8282\u70b9\u3002\\r\\n\\r\\n\u56e0\u6b64\u4e0d\u63a8\u8350\u4f7f\u7528\u3002\\r\\n\\r\\n## \u76f4\u63a5\u5224\u65ad\u7248\u672c\\r\\n\\r\\n### \u4ee3\u7801\\r\\n\\r\\n\u7b2c\u4e09\u79cd\u65b9\u6cd5\uff0c\u5c31\u662f\u76f4\u63a5\u5224\u65ad\u7248\u672c\u53f7\uff0cAndroid \u7248\u672c\u5927\u4e8e 4.2.0\uff0ciOS \u5927\u4e8e 14.0.0 \u65f6\uff0c\u8ba4\u4e3a webp \u53ef\u7528\u3002\\r\\n\\r\\nH5 \u901a\u8fc7 ua \u83b7\u53d6\u7cfb\u7edf\u7248\u672c\u53f7\u7684\u6587\u7ae0\u5f88\u591a\uff0c\u6211\u4eec\u8fd9\u91cc\u7ed9\u51fa\u5c0f\u7a0b\u5e8f\u7684\u4ee3\u7801\u3002\\r\\n\\r\\n```js\\r\\nfunction isWebpSuported() {\\r\\n  try {\\r\\n    const { system, SDKVersion } = wx.getSystemInfoSync()\\r\\n    const [sysName, sysVersion] = (system || \'\').split(\' \')\\r\\n    if (compareVersion(SDKVersion, \'2.9.0\') < 0) {\\r\\n      return false\\r\\n    }\\r\\n\\r\\n    if (\\r\\n      sysName.toUpperCase() === \'ANDROID\' &&\\r\\n      compareVersion(sysVersion, \'4.2.0\') >= 0\\r\\n    ) {\\r\\n      return true\\r\\n    }\\r\\n\\r\\n    if (\\r\\n      sysName.toUpperCase() === \'IOS\' &&\\r\\n      compareVersion(sysVersion, \'14.0.0\') >= 0\\r\\n    ) {\\r\\n      return true\\r\\n    }\\r\\n\\r\\n    return false\\r\\n  } catch (e) {\\r\\n    return false\\r\\n  }\\r\\n}\\r\\n```\\r\\n\\r\\n### \u539f\u7406\\r\\n\\r\\n\u6211\u4eec\u5df2\u7ecf\u901a\u8fc7 [Can I use](https://caniuse.com/?search=webp) \u77e5\u9053\uff1a\\r\\n\\r\\n- Android 4.2.0 \u4ee5\u4e0b\uff0ciOS 14 \u4ee5\u4e0b\u7684\u6d4f\u89c8\u5668\u4e0d\u652f\u6301 webp\u3002\\r\\n\\r\\n\u53c8\u4ece [\u5fae\u4fe1\u5c0f\u7a0b\u5e8f image \u7ec4\u4ef6\u6587\u6863](https://developers.weixin.qq.com/miniprogram/dev/component/image.html#WebView-%E7%89%B9%E6%9C%89%E5%B1%9E%E6%80%A7) \u91cc\u77e5\u9053\uff1a\\r\\n\\r\\n- \u57fa\u7840\u5e93\u7248\u672c >= 2.9.0 \u652f\u6301 webp\u3002\\r\\n\\r\\n\u90a3\u4e48\u5e72\u8106\u628a\u6240\u6709\u6761\u4ef6\u90fd\u505a\u4e00\u4e2a\u7ec4\u5408\uff0c\u5c31\u5f97\u5230\u4e86\u4e0a\u8ff0\u4ee3\u7801\uff0c\u5176\u4e2d `compareVersion()` \u662f [\u5fae\u4fe1\u5b98\u65b9\u6587\u6863](https://developers.weixin.qq.com/ebook?action=get_post_info&volumn=1&lang=zh_CN&book=miniprogram&docid=000288319f40c0eb00860cd135100a) \u4e2d\u6bd4\u8f83\u7248\u672c\u53f7\u7684\u4ee3\u7801\u3002\\r\\n\\r\\n### \u4f18\u7f3a\u70b9\\r\\n\\r\\n- \u4f18\u70b9\uff1a\u540c\u6b65\u5224\u65ad\u3001\u4e0d\u5f71\u54cd\u9996\u5c4f\u6027\u80fd\uff1b\u8bef\u4f24\u8303\u56f4\u5c0f\uff1b\u4e14 CSR \u548c SSR \u53ef\u7528\u3002\\r\\n- \u7f3a\u70b9\uff1a\u65e0\u660e\u663e\u7f3a\u70b9\u3002\\r\\n\\r\\n## \u603b\u7ed3\\r\\n\\r\\n\u672c\u6587\u4ecb\u7ecd\u4e86 H5\u3001\u5c0f\u7a0b\u5e8f\u4f7f\u7528 webp \u683c\u5f0f\u56fe\u7247\u65f6\uff0c\u5224\u65ad\u73af\u5883\u662f\u5426\u652f\u6301\u7684\u65b9\u6cd5\u3002\\r\\n\\r\\n- \u65b9\u6cd5\u4e00\uff1a\u5229\u7528 `toDataURL(\'image/webp\')` \u5224\u65ad\u3002H5 \u652f\u6301\uff0c\u4f46\u662f\u4f1a\u8bef\u4f24\u5927\u90e8\u5206\u6d4f\u89c8\u5668\uff1b\u5c0f\u7a0b\u5e8f\u4e0d\u652f\u6301\u3002\\r\\n- \u65b9\u6cd5\u4e8c\uff1a\u5229\u7528\u4e00\u5f20\u5c0f\u4f53\u79ef\u7684 webp \u56fe\u7247\u8bd5\u63a2\u3002H5 CSR \u65f6\u652f\u6301\uff0c\u4f46\u56e0\u4e3a\u65b9\u6cd5\u662f\u5f02\u6b65\u7684\u3001\u53ef\u80fd\u5f71\u54cd\u9996\u5c4f\u6027\u80fd\uff1bH5 SSR \u65f6\u4e0d\u652f\u6301\uff1b\u5c0f\u7a0b\u5e8f\u652f\u6301\uff0c\u4f46\u5b9e\u73b0\u4e0d\u4f18\u96c5\u3002\\r\\n- \u65b9\u6cd5\u4e09\uff1a**\u5229\u7528\u7248\u672c\u53f7\u5224\u65ad\u3002H5 \u548c\u6d4f\u89c8\u5668\u5747\u652f\u6301\uff0c\u662f\u6700\u4f73\u5b9e\u73b0\u65b9\u6848\u3002**\\r\\n\\r\\n\u62f3\u6253 H5\uff0c\u811a\u8e22\u5c0f\u7a0b\u5e8f\u3002\u6211\u662f\u300c\u5c0f\u9716\u5bb6\u7684\u6df7\u6c5f\u9f99\u300d\uff0c\u5173\u6ce8\u6211\uff0c\u5e26\u4f60\u4e86\u89e3\u66f4\u591a\u5b9e\u7528\u7684 H5\u3001\u5c0f\u7a0b\u5e8f\u6b66\u5b66\u3002"},{"id":"/2024/03/03/ten-billion-subsidy","metadata":{"permalink":"/blog/2024/03/03/ten-billion-subsidy","source":"@site/blog/2024-03-03-ten-billion-subsidy/index.md","title":"\u767e\u4ebf\u8865\u8d34\u4e3a\u4ec0\u4e48\u7528 H5\uff1fH5 \u672a\u6765\u4f1a\u5982\u4f55\u53d1\u5c55\uff1f","description":"23 \u5e74 11 \u6708\u672b\uff0c\u62fc\u591a\u591a\u5e02\u503c\u8d85\u8fc7\u4e86\u963f\u91cc\u3002\u6211\u60f3\u5199\u4e00\u7bc7\u6587\u7ae0\u300a\u767e\u4ebf\u8865\u8d34\u4e3a\u4ec0\u4e48\u7528 H5\u300b\uff0c\u6ca1\u6709\u52a8\u7b14\uff1b24 \u5e74\u65b0\u5e74\uff0c\u6211\u60f3\u5199\u4e00\u7bc7\u300a\u65b0\u7684\u4e00\u5e74\uff0cH5 \u4f1a\u5982\u4f55\u53d1\u5c55\u300b\uff0c\u4e5f\u6ca1\u6709\u52a8\u7b14\u3002","date":"2024-03-03T00:00:00.000Z","tags":[{"inline":true,"label":"H5","permalink":"/blog/tags/h-5"}],"readingTime":14.08,"hasTruncateMarker":false,"authors":[],"frontMatter":{"tags":["H5"]},"unlisted":false,"prevItem":{"title":"H5\u3001\u5c0f\u7a0b\u5e8f\u80fd\u7528 webp \u56fe\u7247\u5417\uff1f\u5982\u4f55\u5224\u65ad\u73af\u5883\u662f\u5426\u652f\u6301\uff1f","permalink":"/blog/2024/03/10/is-webp-supported"},"nextItem":{"title":"H5 \u4e0a\u6ed1\u52a0\u8f7d\uff08\u89e6\u5e95\u52a0\u8f7d\uff09\u5982\u4f55\u5b9e\u73b0\uff1f","permalink":"/blog/2024/03/02/pull-up"}},"content":"23 \u5e74 11 \u6708\u672b\uff0c\u62fc\u591a\u591a\u5e02\u503c\u8d85\u8fc7\u4e86\u963f\u91cc\u3002\u6211\u60f3\u5199\u4e00\u7bc7\u6587\u7ae0\u300a\u767e\u4ebf\u8865\u8d34\u4e3a\u4ec0\u4e48\u7528 H5\u300b\uff0c\u6ca1\u6709\u52a8\u7b14\uff1b24 \u5e74\u65b0\u5e74\uff0c\u6211\u60f3\u5199\u4e00\u7bc7\u300a\u65b0\u7684\u4e00\u5e74\uff0cH5 \u4f1a\u5982\u4f55\u53d1\u5c55\u300b\uff0c\u4e5f\u6ca1\u6709\u52a8\u7b14\u3002\\r\\n\\r\\n\u773c\u770b\u7740\u7075\u611f\u5c31\u8981\u70c2\u5728\u624b\u91cc\uff0c\u6211\u51b3\u5b9a\u628a\u4e24\u7bc7\u6587\u7ae0\u5408\u4e3a\u4e00\u7bc7\uff0c\u4e0e\u5927\u5bb6\u5206\u4eab\u3002\u5f53\u7136\uff0c\u8fd9\u4e9b\u5206\u6790\u9884\u6d4b\u53ea\u662f\u4e2a\u4eba\u89c2\u70b9\uff0c\u5982\u679c\u4f60\u6709\u4e0d\u540c\u7684\u610f\u89c1\uff0c\u6b22\u8fce\u5728\u8bc4\u8bba\u533a\u8ba8\u8bba\u4ea4\u6d41\u3002\\r\\n\\r\\n\u62f3\u6253 H5\uff0c\u811a\u8e22\u5c0f\u7a0b\u5e8f\u3002\u6211\u662f\u300c\u5c0f\u9716\u5bb6\u7684\u6df7\u6c5f\u9f99\u300d\uff0c\u5173\u6ce8\u6211\uff0c\u5e26\u4f60\u4e86\u89e3\u66f4\u591a\u5b9e\u7528\u7684 H5\u3001\u5c0f\u7a0b\u5e8f\u6b66\u5b66\u3002\\r\\n\\r\\n## \u767e\u4ebf\u8865\u8d34\u4e3a\u4ec0\u4e48\u7528 H5\\r\\n\\r\\n\u6211\u4eec\u5728 Android \u624b\u673a\u5f00\u53d1\u8005\u6a21\u5f0f\u4e0b\uff0c\u5f00\u542f\u663e\u793a\u5e03\u5c40\u8fb9\u754c\uff0c\u53ef\u4ee5\u770b\u5230\u300c\u767e\u4ebf\u8865\u8d34\u300d\u662f\u4e00\u4e2a\u5b8c\u6574\u5927\u6846\uff0c\u8bf4\u660e\u300c\u767e\u4ebf\u8865\u8d34\u300d\u5728 App \u5185\u662f H5\uff1b\u62f7\u8d1d\u5206\u4eab\u94fe\u63a5\uff0c\u5728\u6d4f\u89c8\u5668\u6253\u5f00\uff0c\u53ef\u4ee5\u770b\u5230\u8d44\u6e90\u4e2d\u6709 react \u540d\u5b57\u7684 js \u6587\u4ef6\uff0c\u8bf4\u660e\u300c\u767e\u4ebf\u8865\u8d34\u300d\u6280\u672f\u6808\u5927\u6982\u7387\u662f React\u3002\\r\\n\\r\\n![](./img/pdd-stack.png)\\r\\n\\r\\n\u4e0d\u53ea\u662f\u62fc\u591a\u591a\uff0c\u6211\u7279\u5730\u786e\u8ba4\u4e86\uff0c\u4eac\u4e1c\u3001\u6dd8\u5b9d\u7684\u7684\u300c\u767e\u4ebf\u8865\u8d34\u300d\u6280\u672f\u6808\u4e5f\u662f H5\u3002\\r\\n\\r\\n![](./img/pdd-jd-taobao.png)\\r\\n\\r\\n\u90a3\u4e48\uff0c\u4e3a\u4ec0\u4e48\u7535\u5546\u5de8\u5934\u4f1a\u5728\u300c\u767e\u4ebf\u8865\u8d34\u300d\u8fd9\u79cd\u91cd\u8981\u6d3b\u52a8\u4e0a\u9009\u62e9 H5 \u5462\uff1f\u7528 H5 \u6709\u4ec0\u4e48\u597d\u5904\u5462\uff1f\\r\\n\\r\\n### H5 \u6280\u672f\u5df2\u7ecf\u6210\u719f\\r\\n\\r\\n\u7b2c\u4e00\u4e2a\u539f\u56e0\uff0c\u4e5f\u662f\u6700\u57fa\u7840\u7684\u539f\u56e0\uff0c\u5c31\u662f H5 \u6280\u672f\u5df2\u7ecf\u6210\u719f\uff0c\u80fd\u591f\u5b8c\u6574\u5730\u5b9e\u73b0\u529f\u80fd\u3002\u5177\u4f53\u6765\u8bf4\uff1a\\r\\n\\r\\n#### \u6d4f\u89c8\u5668\u517c\u5bb9\u6027\u4e0d\u65ad\u63d0\u9ad8\\r\\n\\r\\n\u81ea 2008 \u5e74 HTML5 \u8349\u6848\u53d1\u5e03\u4ee5\u6765\uff0c\u622a\u6b62 2014 \u5e74\uff0cHTML5 \u5df2\u6709 18 \u5e74\u5386\u53f2\u300218 \u5e74\u95f4\uff0c\u4e3b\u6d41\u6d4f\u89c8\u5668\u5bf9 HTML5\u3001CSS3 \u548c JavaScript \u7684\u6807\u51c6\u8bed\u6cd5\u517c\u5bb9\u6027\u4e00\u76f4\u6301\u7eed\u6539\u8fdb\uff0c22 \u5e74\u5fae\u8f6f\u66f4\u662f\u4eb2\u624b\u76d6\u4e0a\u4e86 IE \u68fa\u6750\u677f\u3002\u867d\u7136 Safari\uff08iOS \u6d4f\u89c8\u5668\uff09\u7684\u517c\u5bb9\u6027\u4ecd\u7136\u5907\u53d7\u8bdf\u75c5\uff0c\u4f46\u603b\u4f53\u6765\u8bf4\u517c\u5bb9\u6210\u672c\u5df2\u7ecf\u53d8\u5f97\u53ef\u4ee5\u63a5\u53d7\u3002\\r\\n\\r\\n#### \u4e3b\u6d41\u6846\u67b6\u5df2\u7ecf\u6210\u719f\\r\\n\\r\\n\u524d\u7aef\u6700\u4e3b\u6d41\u7684\u4e24\u5927\u6846\u67b6 Vue \u548c React \u5df2\u7ecf\u6210\u719f\u3002\u5b83\u4eec\u7684\u6210\u719f\u4f53\u73b0\u5728\u591a\u4e2a\u65b9\u9762\uff1a\\r\\n\\r\\n- \u4ece\u65f6\u95f4\u7684\u89d2\u5ea6\u770b\uff0c\u622a\u6b62 2024 \u5e74\uff0cReact \u5df2\u7ecf\u53d1\u5e03\u4e86 11 \u5e74\uff0c\u800c Vue \u5df2\u7ecf\u53d1\u5e03\u4e86 10 \u5e74\u3002\u7ecf\u8fc7\u591a\u5e74\u7684\u53d1\u5c55\uff0c\u524d\u7aef\u5f00\u53d1\u8005\u5df2\u7ecf\u975e\u5e38\u719f\u6089 React \u548c Vue\uff0c\u80fd\u719f\u7ec3\u5730\u5e94\u7528\u5b83\u4eec\u8fdb\u884c\u5f00\u53d1\u3002\\r\\n- \u4ece\u8bed\u6cd5\u7684\u89d2\u5ea6\u770b\uff0c\u81ea React16.8 \u53d1\u5e03 Hooks\uff0c\u4ee5\u53ca Vue3 \u53d1\u5e03 Composition API \u4ee5\u6765\uff0c\u4e24\u5927\u6846\u67b6\u8bed\u6cd5\u57fa\u672c\u7a33\u5b9a\uff0c\u4e0d\u518d\u6709\u5927\u7684\u53d8\u5316\u3002\u524d\u7aef\u5f00\u53d1\u8005\u53ef\u4ee5\u66f4\u52a0\u4e13\u6ce8\u4e8e\u4e1a\u52a1\u903b\u8f91\uff0c\u65e0\u9700\u8fc7\u591a\u62c5\u5fc3\u6846\u67b6\u8bed\u6cd5\u7684\u53d8\u52a8\u3002\\r\\n- \u4ece\u672a\u6765\u53d1\u5c55\u65b9\u5411\u770b\uff0cReact \u76ee\u524d\u81f4\u529b\u4e8e\u63a8\u5e7f React Server Component [^1]\uff1bVue \u5219\u5728\u5c1d\u8bd5\u7740\u65e0 VDom \u7684 Vapor \u65b9\u5411\uff0c\u5e76\u8ba1\u5212\u5229\u7528 Rust \u91cd\u5199 Vite [^2]\u3002\u8fd9\u8868\u660e\u65e7\u9886\u57df\u4e0d\u518d\u6709\u5927\u7684\u98a0\u8986\uff0c\u4e24\u5927\u6846\u67b6\u5df2\u7ecf\u6b63\u5bfb\u6c42\u65b0\u7684\u53d1\u5c55\u9886\u57df\u3002\\r\\n\\r\\n#### \u6df7\u5408\u5f00\u53d1\u5df2\u7ecf\u6210\u719f\\r\\n\\r\\n\u6df7\u5408\u5f00\u53d1\u662f\u6307\u5c06\u539f\u751f\u5f00\u53d1\uff08Android \u548c iOS\uff09\u548c Web \u5f00\u53d1\u7ed3\u5408\u8d77\u6765\u7684\u4e00\u79cd\u6280\u672f\u3002\u7b80\u800c\u8a00\u4e4b\uff0c\u5b83\u5c06 H5 \u5d4c\u5165\u5230\u79fb\u52a8\u5e94\u7528\u5185\u90e8\u8fd0\u884c\u3002\u8fd1\u4e9b\u5e74\uff0c\u4e1a\u754c\u5bf9\u6df7\u5408\u5f00\u53d1\u7684\u4f18\u52bf\u548c\u7f3a\u9677\u5df2\u7ecf\u6709\u6e05\u6670\u7684\u8ba4\u8bc6\uff0c\u5e76\u9488\u5bf9\u5176\u7f3a\u9677\u8fdb\u884c\u4e86\u76f8\u5e94\u7684\u4f18\u5316\u3002\u5177\u4f53\u6765\u8bf4\uff1a\\r\\n\\r\\n- \u6df7\u5408\u5f00\u53d1\u7684\u4f18\u52bf\u5305\u62ec\u5f00\u53d1\u901f\u5ea6\u5feb\u3001\u4e00\u5957\u4ee3\u7801\u9002\u914d Android \u548c iOS\uff0c\u4ee5\u53ca\u5b9e\u73b0\u4ee3\u7801\u7684\u70ed\u66f4\u65b0\u3002\u8fd9\u610f\u5473\u7740\u7a0b\u5e8f\u5458\u80fd\u66f4\u5feb\u5730\u7f16\u5199\u8de8\u5e73\u53f0\u5e94\u7528\uff0c\u53ca\u65f6\u66f4\u65b0\u5e94\u7528\u3001\u4fee\u590d\u7f3a\u9677\uff1b\\r\\n- \u6df7\u5408\u5f00\u53d1\u7684\u7f3a\u9677\u5219\u662f\u6027\u80fd\u8f83\u5dee\u3001\u52a0\u8f7d\u53d7\u9650\u4e8e\u7f51\u7edc\u3002\u9488\u5bf9\u8fd9\u4e2a\u7f3a\u9677\uff0c\u5404\u5927 App\u3001\u4ee5\u53ca\u4e91\u670d\u52a1\u5546\u5982\u963f\u91cc\u4e91 [^3] \u548c\u817e\u8baf\u4e91 [^4] \u90fd\u63a8\u51fa\u4e86\u81ea\u5df1\u7684\u79bb\u7ebf\u5305\u65b9\u6848\u3002\u79bb\u7ebf\u5305\u65b9\u6848\u53ef\u4ee5\u5c06\u7f51\u9875\u7684\u9759\u6001\u8d44\u6e90\uff08\u5982 HTML\u3001CSS\u3001JS\u3001\u56fe\u7247\u7b49\uff09\u7f13\u5b58\u5230\u672c\u5730\uff0c\u7528\u6237\u8bbf\u95ee H5 \u9875\u9762\u65f6\uff0c\u53ef\u4ee5\u76f4\u63a5\u8bfb\u53d6\u672c\u5730\u7684\u79bb\u7ebf\u8d44\u6e90\uff0c\u4ece\u800c\u63d0\u5347\u9875\u9762\u7684\u52a0\u8f7d\u901f\u5ea6\u3002\u53ef\u4ee5\u8bf4\uff0c\u63a5\u5165\u79bb\u7ebf\u5305\u540e\uff0cH5 \u4e0d\u518d\u6709\u81f4\u547d\u7f3a\u9677\u3002\\r\\n\\r\\n#### \u524d\u7aef\u57fa\u5efa\u5de5\u5177\u5df2\u7ecf\u6210\u719f\\r\\n\\r\\n\u8fd1\u4e9b\u5e74\u6765\uff0c\u4e1a\u754c\u6700\u706b\u7684\u6280\u672f\u8bdd\u9898\u4e4b\u4e00\uff0c\u5c31\u662f\u7528 Rust \u66ff\u4ee3\u524d\u7aef\u57fa\u5efa\uff0c\u5305\u62ec\uff1a\u7528 Rust \u66ff\u4ee3 Webpack \u7684 Rspack\uff1b\u7528 Rust \u66ff\u4ee3 Babel \u7684 SWC\uff1b\u7528 Rust \u66ff\u4ee3 Eslint \u7684 OxcLint \u7b49\u7b49\u3002\\r\\n\\r\\n\u524d\u7aef\u5f00\u53d1\u8005\u5bf9\u57fa\u5efa\u5de5\u5177\u62b1\u6028\uff0c\u5df2\u7ecf\u4ece\u300c\u8fd9\u5de5\u5177\u80fd\u4e0d\u80fd\u7528\u300d\uff0c\u8f6c\u53d8\u4e3a\u300c\u8fd9\u5de5\u5177\u597d\u4e0d\u597d\u7528\u300d\u3002\u8fd9\u79cd\u300c\u751c\u871c\u7684\u70e6\u607c\u300d\uff0c\u53ea\u6709\u57fa\u5efa\u5de5\u5177\u6210\u719f\u540e\u624d\u4f1a\u51fa\u73b0\u3002\\r\\n\\r\\n**\u7efc\u4e0a\u6240\u8ff0\uff0c\u6d4f\u89c8\u5668\u7684\u517c\u5bb9\u6027\u63d0\u5347\u3001\u4e3b\u6d41\u6846\u67b6\u7684\u6210\u719f\u3001\u6df7\u5408\u5f00\u53d1\u7684\u53d1\u5c55\u548c\u524d\u7aef\u57fa\u5efa\u5de5\u5177\u7684\u5b8c\u5584\uff0c\u4f7f H5 \u5b8c\u5168\u6709\u80fd\u529b\u627f\u8f7d\u300c\u767e\u4ebf\u8865\u8d34\u300d\u4e1a\u52a1\u3002**\\r\\n\\r\\n### H5 \u5f00\u53d1\u6210\u672c\u4f4e\\r\\n\\r\\n\u524d\u6587\u6211\u4eec\u5df2\u7ecf\u4e86\u89e3\u5230\uff0c\u6210\u719f\u7684\u6280\u672f\u8ba9 H5 \u53ef\u4ee5\u5b9e\u73b0\u300c\u767e\u4ebf\u8865\u8d34\u300d\u7684\u529f\u80fd\u3002\u73b0\u5728\u6211\u4eec\u4ecb\u7ecd\u53e6\u4e00\u4e2a\u539f\u56e0\u2014\u2014H5 \u5f00\u53d1\u6210\u672c\u4f4e\u3002\\r\\n\\r\\n#### \u300c\u767e\u4ebf\u8865\u8d34\u300d\u9700\u8981\u591a\u4e2a H5\\r\\n\\r\\n\u300c\u767e\u4ebf\u8865\u8d34\u300d\u7684\u65b9\u5f0f\uff0c\u662f\u4e00\u4e2a\u5e38\u4f4f\u7684 H5\uff0c\u642d\u914d\u4e0a\u591a\u4e2a\u6d41\u52a8\u7684 H5\u3002\uff08\u300c\u5e38\u4f4f\u300d\u548c\u300c\u6d41\u52a8\u300d\u662f\u6211\u501f\u9274\u300c\u5e38\u4f4f\u4eba\u53e3\u300d\u548c\u300c\u6d41\u52a8\u4eba\u53e3\u300d\u9020\u7684\u8bcd\uff09\\r\\n\\r\\n- \u5e38\u4f4f H5 \u94fe\u63a5\u4fdd\u6301\u4e0d\u53d8\u3002\u7ad9\u5916\u6295\u653e\u7684\u94fe\u63a5\u57fa\u672c\u90fd\u662f\u5e38\u4f4f H5 \u7684\uff0c\u7ad9\u5185\u9996\u9875\u5165\u53e3\u94fe\u63a5\u4e5f\u662f\u5e38\u4f4f H5 \u7684\uff0c\u8fd9\u6837\u65b9\u4fbf\u7528\u6237\u4e8c\u6b21\u8bbf\u95ee\u3002\\r\\n- \u6d41\u52a8 H5 \u94fe\u63a5\u4f4d\u4e8e\u5e38\u4f4f H5 \u7684\u4e0d\u540c\u4f4d\u7f6e\uff0c\u6bd4\u5982\u5934\u56fe\u3001\u4fa7\u8fb9\u680f\u7b49\u3002\u65f6\u95f4\u4e0d\u540c\u3001\u7528\u6237\u4e0d\u540c\u3001\u7b97\u6cd5\u4e0d\u540c\uff0c\u6d41\u52a8 H5 \u7684\u94fe\u63a5\u90fd\u4f1a\u4e0d\u540c\uff0c\u6d41\u52a8 H5 \u53ef\u4ee5\u533a\u5206\u7528\u6237\uff0c\u65b9\u4fbf\u5206\u53d1\u6d41\u91cf\u3002\\r\\n  \\r\\n  \u5177\u4f53\u6765\u770b\uff0c\u62fc\u591a\u591a\u81f3\u5c11\u6709\u4e09\u4e2a\u6d41\u91cf\u7684\u5206\u53d1\u70b9\uff0c\u7b2c\u4e00\u4e2a\u662f\u53ef\u70b9\u51fb\u7684\u5934\u56fe\uff0c\u7b2c\u4e8c\u4e2a\u662f\u5217\u8868\u4e0a\u65b9\u7684\u6d3b\u52a8\u6a21\u5757\uff0c\u7b2c\u4e09\u4e2a\u662f\u53f3\u4fa7\u6d6e\u52a8\u7684\u4fa7\u8fb9\u680f\uff0c\u4e09\u8005\u53ef\u4ee5\u6295\u653e\u4e0d\u540c\u7684\u94fe\u63a5\u3002\u6700\u8fd1\u5c31\u5206\u522b\u6295\u653e 3.8 \u5973\u795e\u8282\u94fe\u63a5\u3001\u65b0\u4eba\u94fe\u63a5\u548c\u54c1\u724c\u94fe\u63a5\uff1a\\r\\n\\r\\n![](./img/pdd-activity.png)\\r\\n\\r\\n#### \u300c\u767e\u4ebf\u8865\u8d34\u300d\u9700\u8981\u53ca\u65f6\u66f4\u65b0\\r\\n\\r\\n\u4e0d\u96be\u60f3\u5230\uff0c\u6bcf\u5230\u4e00\u4e2a\u8282\u65e5\u3001\u6bcf\u6362\u4e00\u4e2a\u54c1\u724c\uff0c\u300c\u767e\u4ebf\u8865\u8d34\u300d\u5c31\u9700\u8981\u66f4\u65b0\u4e00\u6b21\u3002\\r\\n\\r\\n\u6709\u65f6\u8fd8\u9700\u8981\u4e3a\u4e00\u4e9b\u54c1\u724c\u5b9a\u5236\u5316 H5 \u4ee3\u7801\u3002\u5982\u679c\u4f7f\u7528\u5176\u4ed6\u6280\u672f\u6808\uff0c\u6392\u671f\u8ddf\u8fdb\u901a\u5e38\u4f1a\u6bd4\u8f83\u56f0\u96be\uff0c\u4f46\u662f\u4f7f\u7528 H5 \u5c31\u80fd\u591f\u5feb\u901f\u8fed\u4ee3\u5e76\u4e0a\u7ebf\u3002\\r\\n\\r\\n### H5 \u6295\u653e\u6210\u672c\u4f4e\\r\\n\\r\\n\u6211\u4eec\u5df2\u7ecf\u300c\u767e\u4ebf\u8865\u8d34\u300d\u4f7f\u7528 H5 \u6280\u672f\u6808\u7684\u4e24\u4e2a\u539f\u56e0\uff0c\u73b0\u5728\u6765\u770b\u7b2c\u4e09\u4e2a\u539f\u56e0\u2014\u2014H5 \u9002\u5408\u6295\u653e\u3002\\r\\n\\r\\n\u62fc\u591a\u591a\u7684\u5d1b\u8d77\u8fc7\u7a0b\u4e2d\uff0c\u6295\u653e\u5230\u5176\u4ed6 App \u7684\u94fe\u63a5\u529f\u4e0d\u53ef\u6ca1\u3002\u65e9\u671f\u5b83\u901a\u8fc7\u5fae\u4fe1\u7b49\u793e\u4ea4\u5e73\u53f0\u300c\u780d\u4e00\u5200\u300d\u7684\u6a21\u5f0f\uff0c\u4f4e\u6210\u672c\u5730\u5438\u5f15\u4e86\u5927\u91cf\u7528\u6237\u3002\u5982\u4eca\uff0c\u5b83\u901a\u8fc7\u6295\u653e\u300c\u767e\u4ebf\u8865\u8d34\u300d\u7b56\u7565\u7559\u4f4f\u7528\u6237\u3002\\r\\n\\r\\nH5 \u7684\u72ec\u7279\u4e4b\u5904\uff0c\u5728\u4e8e\u5b83\u80fd\u591f\u7075\u6d3b\u5730\u5728\u591a\u4e2a\u5e73\u53f0\u4e0a\u8fdb\u884c\u6295\u653e\uff0c\u5176\u4ed6\u6280\u672f\u6808\u5f88\u96be\u6709\u8fd9\u6837\u7684\u7075\u6d3b\u6027\u3002\u5373\u4f7f\u662f\u4eca\u5929\uff0c\u6296\u97f3\u3001Bilibili \u548c\u5c0f\u7ea2\u4e66\u7b49\u5176\u4ed6 App \u4e2d\uff0c\u300c\u767e\u4ebf\u8865\u8d34\u300d\u7684 H5 \u94fe\u63a5\u4e5f\u968f\u5904\u53ef\u89c1\u3002\\r\\n\\r\\n![](./img/pdd-advertisement.png)\\r\\n\\r\\n\u62fc\u591a\u591a\u66f4\u662f\u5c06 H5 \u8fd9\u79cd\u7075\u6d3b\u6027\u53d1\u6325\u5230\u6781\u81f4\uff0c\u53ea\u8981\u4f60\u6709\u300c\u767e\u4ebf\u8865\u8d34\u300d\u7684\u94fe\u63a5\uff0c\u4f60\u751a\u81f3\u53ef\u4ee5\u5728\u5fae\u4fe1\u3001\u98de\u4e66\u3001\u652f\u4ed8\u5b9d\u7b49\u5730\u65b9\u76f4\u63a5\u67e5\u770b\u300c\u767e\u4ebf\u8865\u8d34\u300d H5 \u9875\u9762\u3002\\r\\n\\r\\n![](./img/wechat-flybook-alipay.png)\\r\\n\\r\\n**\u7efc\u4e0a\u6240\u8ff0\uff0c\u80fd\u5f00\u53d1\u3001\u80fd\u5feb\u901f\u5f00\u53d1\u3001\u4e14\u5f00\u53d1\u5b8c\u6210\u540e\u80fd\u5927\u91cf\u6295\u653e\uff0c\u662f\u300c\u767e\u4ebf\u8865\u8d34\u300d\u9752\u7750 H5 \u7684\u539f\u56e0\u3002**\\r\\n\\r\\n## H5 \u672a\u6765\u4f1a\u5982\u4f55\u53d1\u5c55\\r\\n\\r\\n\u4e86\u89e3\u300c\u767e\u4ebf\u8865\u8d34\u300d\u9009\u62e9 H5 \u7684\u539f\u56e0\u540e\uff0c\u6211\u4eec\u6765\u770b\u770b\u7535\u5546\u5de8\u5934\u5bf9 H5 \u672a\u6765\u53d1\u5c55\u7684\u5f71\u54cd\u3002\u6211\u8ba4\u4e3a\u6709\u4e09\u4e2a\u5f71\u54cd\uff1a\\r\\n\\r\\n### H5 \u6570\u91cf\u81a8\u80c0\uff0c\u5b9a\u5236\u5316\u8981\u6c42\u82db\u523b\\r\\n\\r\\nC \u7aef\u7528\u6237\u9ecf\u6027\u76f8\u5bf9\u8f83\u4f4e\uff0c\u6362\u4e00\u4e2a App \u7684\u6210\u672c\u5fae\u4e0d\u8db3\u9053\u3002\u8fd1\u5e74 C \u7aef\u5e02\u573a\u589e\u957f\u7f13\u6162\uff0c\u4f01\u4e1a\u91cd\u70b9\u4ece\u83b7\u53d6\u66f4\u591a\u7684\u65b0\u5ba2\u53d8\u6210\u7559\u4f4f\u66f4\u591a\u7684\u8001\u5ba2\uff0c\u5f88\u96be\u5bb9\u5fcd\u7528\u6237\u4e22\u5931\u3002\u56e0\u6b64\u5176\u4ed6\u4f01\u4e1a\u6295\u653e\u6d3b\u52a8 H5 \u65f6\uff0c\u4f01\u4e1a\u5fc5\u987b\u4e5f\u6295\u653e\u6d3b\u52a8 H5\uff0c\u7535\u5546\u6d3b\u52a8 H5 \u5c31\u53d8\u5f97\u8d8a\u6765\u8d8a\u591a\u3002\\r\\n\\r\\n\u8fd9\u4e2a\u81a8\u80c0\u7684\u8d8b\u52bf\u4e0d\u4ec5\u4ec5\u5b58\u5728\u4e8e\u4e92\u8054\u7f51\u5de8\u5934\u7684 App \u4e2d\uff0c\u4e2d\u5c0f\u578b\u5e94\u7528\u4e5f\u4e0d\u4f8b\u5916\uff0c\u751a\u81f3\u50cf 12306\u3001\u4e2d\u56fd\u79fb\u52a8\u3001\u62db\u5546\u94f6\u884c\u8fd9\u79cd\u5de5\u5177\u6027\u6781\u5f3a\u7684\u5e94\u7528\u4e5f\u65e0\u6cd5\u5e78\u514d\u3002\\r\\n\\r\\n![](./img/12306-yidong-zhaoshang.png)\\r\\n\\r\\n\u968f\u7740\u5e02\u573a\u7684\u7ade\u4e89\u52a0\u5267\uff0c\u5b9a\u5236\u5316\u8981\u6c42\u4e5f\u53d8\u5f97\u8d8a\u6765\u8d8a\u82db\u523b\uff0c\u76ee\u7684\u662f\u8ba9\u6d88\u8d39\u8005\u533a\u5206\u5404\u79cd\u6d3b\u52a8\u3002\u7528\u4e92\u8054\u7f51\u9ed1\u8bdd\u6765\u8bf4\uff0c\u5c31\u662f\u300c\u5efa\u7acb\u7528\u6237\u5fc3\u667a\u300d\u3002\u5728\u53ef\u9884\u89c1\u7684\u672a\u6765\uff0c\u5c3d\u7ba1\u7535\u5546\u6d3b\u52a8 H5 \u7ed3\u6784\u57fa\u672c\u76f8\u540c\uff0c\u4f46\u662f\u5b83\u4eec\u7684\u5916\u89c2\u5c06\u53d8\u5f97\u5343\u5dee\u4e07\u522b\u3001\u6781\u5177\u4e2a\u6027\u3002\\r\\n\\r\\n![](./img/fluid.png)\\r\\n\\r\\n### SSR \u6bd4\u4f8b\u589e\u52a0\uff0cCSR \u5360\u636e\u4e3b\u6d41\\r\\n\\r\\n\u5728\u5404\u5bb6 H5 \u6570\u91cf\u81a8\u80c0\u3001\u7ade\u4e89\u6fc0\u70c8\u7684\u60c5\u51b5\u4e0b\uff0c\u4e00\u5b9a\u4f1a\u6709\u4f01\u4e1a\u4e3a\u63d0\u5347 H5 \u7684\u79d2\u5f00\u7387\u63a5\u5165 SSR\uff0c\u56e0\u6b64 SSR \u7684\u6bd4\u4f8b\u4f1a\u589e\u52a0\u3002\\r\\n\\r\\n\u4f46\u6211\u8ba4\u4e3a CSR \u4f9d\u7136\u4f1a\u662f\u4e3b\u6d41\uff0c\u4e3b\u8981\u662f\u56e0\u4e3a\u4e24\u4e2a\u539f\u56e0\uff1a\\r\\n\\r\\n1. SSR \u9700\u8981\u989d\u5916\u7684\u670d\u52a1\u5668\u8d39\u7528\uff0c\u5305\u62ec\u670d\u52a1\u5668\u7684\u7ef4\u62a4\u3001\u6269\u5bb9\u7b49\u3002\u8fd9\u5bf9\u4e8e\u4e2d\u5c0f\u578b\u516c\u53f8\u6765\u8bf4\u662f\u4e00\u4e2a\u8d1f\u62c5\u3002\\r\\n2. SSR \u5bf9\u7a0b\u5e8f\u5458\u6280\u672f\u6c34\u5e73\u8981\u6c42\u6bd4 CSR \u66f4\u9ad8\u3002SSR \u9700\u8981\u7a0b\u5e8f\u5458\u8003\u8651\u66f4\u591a\u7684\u95ee\u9898\uff0c\u4f8b\u5982\u5185\u5b58\u6cc4\u9732\u3002\u4f7f\u7528 CSR \u5728\u7528\u6237\u8bbe\u5907\u4e0a\u53d1\u751f\u5185\u5b58\u6cc4\u9732\uff0c\u5f71\u54cd\u6709\u9650\uff1b\u4f46\u662f\u5982\u679c\u5728\u670d\u52a1\u5668\u4e0a\u53d1\u751f\u5185\u5b58\u6cc4\u9732\uff0c\u5219\u662f\u4f1a\u5360\u7528\u516c\u53f8\u7684\u670d\u52a1\u5668\u5185\u5b58\uff0c\u589e\u52a0\u989d\u5916\u7684\u6210\u672c\u548c\u98ce\u9669\u3002\\r\\n\\r\\n\u56e0\u6b64\uff0c\u6536\u76ca\u4e30\u539a\u3001\u6280\u672f\u96c4\u539a\u7684\u516c\u53f8\u66f4\u613f\u610f\u4f7f\u7528 SSR\u3002\u6ca1\u6709\u91d1\u521a\u94bb\u522b\u63fd\u74f7\u5668\u6d3b\uff0c\u603b\u4e0d\u80fd\u5411\u8001\u677f\u6c47\u62a5\u7ed3\u679c\u65f6\uff0c\u544a\u8bc9\u8001\u677f\u300c\u867d\u7136\u60a8\u4e8f\u94b1\u4e86\uff0c\u4f46\u662f SSR \u771f\u7684\u5f88\u9177\u300d\u3002\\r\\n\\r\\n### Monorepo \u6bd4\u4f8b\u4f1a\u4e0a\u5347\uff0c\u7c7b Shadcn UI \u7ec4\u4ef6\u5e93\u4e5f\u8bb8\u4f1a\u5174\u8d77\\r\\n\\r\\n\u5982\u524d\u6240\u8ff0\uff0cH5 \u7684\u6570\u91cf\u81a8\u80c0\uff0c\u4ee3\u7801\u590d\u7528\u5c31\u4f1a\u88ab\u7740\u91cd\u5173\u6ce8\u3002\u6211\u731c\u6d4b\u66f4\u591a\u4f01\u4e1a\u4f1a\u9009\u62e9 Monorepo \u7ba1\u7406\u65b9\u5f0f\u3002\u6240\u8c13 Monorepo\uff0c\u7b80\u5355\u6765\u8bf4\uff0c\u5c31\u662f\u5c06\u539f\u672c\u5e94\u8be5\u653e\u5230\u591a\u4e2a\u4ed3\u5e93\u7684\u4ee3\u7801\u653e\u5165\u4e00\u4e2a\u4ed3\u5e93\uff0c\u8ba9\u5b83\u4eec\u5171\u4eab\u76f8\u540c\u7684\u7248\u672c\u63a7\u5236\u3002\u8fd9\u6837\u53ef\u4ee5\u964d\u4f4e\u4ee3\u7801\u590d\u7528\u6210\u672c\u3002\\r\\n\\r\\n\u5b9a\u5236\u5316\u8981\u6c42\u82db\u523b\uff0c\u6211\u731c\u6d4b\u793e\u533a\u4e2d\u7c7b\u4f3c Shadcn UI \u7684 H5 \u7ec4\u4ef6\u5e93\u6216\u8bb8\u4f1a\u5174\u8d77\u3002\u73b0\u6709\u7684 H5 \u7ec4\u4ef6\u5e93\u6837\u5f0f\u592a\u5355\u4e00\uff0c\u5373\u4f7f\u662f Shadcn UI\uff0c\u4e5f\u5f88\u96be\u6ee1\u8db3\u56fd\u5185 H5 \u7684\u5b9a\u5236\u5316\u9700\u6c42\u3002\u7136\u800c\uff0cShadcn UI \u7684\u57fa\u672c\u601d\u8def\u2014\u2014\u300c\u628a\u6e90\u7801\u4e0b\u8f7d\u5230\u9879\u76ee\u300d\uff0c\u662f\u89e3\u51b3\u5b9a\u5236\u5316\u7ec4\u4ef6\u96be\u590d\u7528\u7684\u95ee\u9898\u7684\u597d\u601d\u8def\u3002\u56e0\u6b64\uff0c\u6211\u8ba4\u4e3a\u7c7b\u4f3c Shadcn \u7684 H5 \u7ec4\u4ef6\u5e93\u53ef\u80fd\u4f1a\u9010\u6e10\u5174\u8d77\u3002\\r\\n\\r\\n## \u603b\u7ed3\\r\\n\\r\\n\u672c\u6587\u4ecb\u7ecd\u4e86\u6211\u8ba4\u4e3a\u300c\u767e\u4ebf\u8865\u8d34\u300d\u4f1a\u9009\u7528 H5 \u7684\u4e09\u5927\u539f\u56e0\uff1a\\r\\n\\r\\n- H5 \u6280\u672f\u5df2\u7ecf\u6210\u719f\\r\\n- H5 \u5f00\u53d1\u6210\u672c\u4f4e\\r\\n- H5 \u6295\u653e\u6210\u672c\u4f4e\\r\\n\\r\\n\u4ee5\u53ca\u7535\u5546\u5de8\u5934\u5bf9 H5 \u4ea7\u751f\u7684\u4e09\u4e2a\u5f71\u54cd\uff1a\\r\\n\\r\\n- \u6570\u91cf\u81a8\u80c0\uff0c\u5b9a\u5236\u5316\u8981\u6c42\u82db\u523b\\r\\n- SSR \u6bd4\u4f8b\u589e\u52a0\uff0cCSR \u5360\u636e\u4e3b\u6d41\\r\\n- Monorepo \u6bd4\u4f8b\u589e\u52a0\uff0c\u7c7b Shadcn UI \u7ec4\u4ef6\u5e93\u4e5f\u8bb8\u4f1a\u5174\u8d77\\r\\n\\r\\n\u603b\u800c\u8a00\u4e4b\uff0cH5 \u5f00\u53d1\u4f1a\u8d8a\u6765\u8d8a\u4e13\u4e1a\uff0c\u5bf9\u7a0b\u5e8f\u5458\u8981\u6c42\u4f1a\u8d8a\u6765\u8d8a\u9ad8\u3002\u81f3\u4e8e\u8fd9\u79cd\u60c5\u51b5\u662f\u597d\u662f\u574f\uff0c\u4ec1\u8005\u89c1\u4ec1\u667a\u8005\u89c1\u667a\uff0c\u6b22\u8fce\u5927\u5bb6\u5728\u8bc4\u8bba\u533a\u6c9f\u901a\u4ea4\u6d41\u3002\\r\\n\\r\\n\u62f3\u6253 H5\uff0c\u811a\u8e22\u5c0f\u7a0b\u5e8f\u3002\u6211\u662f\u300c\u5c0f\u9716\u5bb6\u7684\u6df7\u6c5f\u9f99\u300d\uff0c\u5173\u6ce8\u6211\uff0c\u5e26\u4f60\u4e86\u89e3\u66f4\u591a\u5b9e\u7528\u7684 H5\u3001\u5c0f\u7a0b\u5e8f\u6b66\u5b66\u3002\\r\\n\\r\\n[^1]: [11 \u5c81\u7684 React \u6b63\u8fce\u6765\u81ea\u5df1\u53e3\u7891\u7684\u62d0\u70b9](https://juejin.cn/post/7340926094614511626)\\r\\n[^2]: [Rust! \u65e0VDom! \u5c24\u96e8\u6eaa\u89e3\u6790 Vue.js 2024 \u65b0\u7279\u6027](https://juejin.cn/post/7342384485696520246)\\r\\n[^3]: [\u79bb\u7ebf\u5305 | \u963f\u91cc\u4e91](https://help.aliyun.com/document_detail/178947.html)\\r\\n[^4]: [\u79bb\u7ebf\u5305 | \u817e\u8baf\u4e91](https://cloud.tencent.com/document/product/1034/64737)"},{"id":"/2024/03/02/pull-up","metadata":{"permalink":"/blog/2024/03/02/pull-up","source":"@site/blog/2024-03-02-pull-up/index.md","title":"H5 \u4e0a\u6ed1\u52a0\u8f7d\uff08\u89e6\u5e95\u52a0\u8f7d\uff09\u5982\u4f55\u5b9e\u73b0\uff1f","description":"\u4e0a\u6ed1\u52a0\u8f7d\uff08\u89e6\u5e95\u52a0\u8f7d\uff09\u662f H5 \u5e38\u89c1\u7684\u529f\u80fd\uff0c\u4eca\u5929\u6211\u4eec\u6765\u770b\u4e0b\u5982\u4f55\u5b9e\u73b0\u3002","date":"2024-03-02T00:00:00.000Z","tags":[{"inline":true,"label":"H5","permalink":"/blog/tags/h-5"}],"readingTime":6.99,"hasTruncateMarker":false,"authors":[],"frontMatter":{"tags":["H5"]},"unlisted":false,"prevItem":{"title":"\u767e\u4ebf\u8865\u8d34\u4e3a\u4ec0\u4e48\u7528 H5\uff1fH5 \u672a\u6765\u4f1a\u5982\u4f55\u53d1\u5c55\uff1f","permalink":"/blog/2024/03/03/ten-billion-subsidy"},"nextItem":{"title":"H5 \u4e0b\u62c9\u5237\u65b0\u5982\u4f55\u5b9e\u73b0\uff1f","permalink":"/blog/2024/02/28/pull-down"}},"content":"\u4e0a\u6ed1\u52a0\u8f7d\uff08\u89e6\u5e95\u52a0\u8f7d\uff09\u662f H5 \u5e38\u89c1\u7684\u529f\u80fd\uff0c\u4eca\u5929\u6211\u4eec\u6765\u770b\u4e0b\u5982\u4f55\u5b9e\u73b0\u3002\\r\\n\\r\\n\u6548\u679c\u5982\u4e0b\uff1a\u5206\u9875\u8bf7\u6c42\u5f00\u59cb\u524d\uff0c\u5217\u8868\u6eda\u52a8\uff0c\u52a0\u8f7d\u52a8\u753b\u51fa\u73b0\u5728\u5c4f\u5e55\u4e2d\uff1b\u5206\u9875\u8bf7\u6c42\u8fc7\u7a0b\u4e2d\uff0c\u52a0\u8f7d\u52a8\u753b\u4e00\u76f4\u65cb\u8f6c\uff1b\u5206\u9875\u8bf7\u6c42\u5b8c\u6210\u540e\uff0c\u5217\u8868\u5e95\u90e8\u63d2\u5165\u4e86\u65b0\u8282\u70b9\uff0c\u52a0\u8f7d\u52a8\u753b\u88ab\u6324\u51fa\u5c4f\u5e55\u3002\\r\\n\\r\\n\u5982\u6b64\u5faa\u73af\u5f80\u590d\uff0c\u76f4\u5230\u5206\u9875\u8bf7\u6c42\u65e0\u6cd5\u8fd4\u56de\u66f4\u591a\u6570\u636e\uff0c\u5217\u8868\u5e95\u90e8\u5c55\u793a\u300c\u6ca1\u6709\u66f4\u591a\u4e86\u300d\u63d0\u793a\uff0c\u52a0\u8f7d\u52a8\u753b\u9690\u85cf\u3002\\r\\n\\r\\n![](./img/pull-up.gif)\\r\\n\\r\\n\u9996\u5148\u6211\u4f1a\u8bb2\u89e3\u4e0a\u6ed1\u52a0\u8f7d\u7684\u539f\u7406\uff0c\u5e76\u7b80\u5355\u8bf4\u660e IntersectionObserver \u7684\u7528\u6cd5\uff1b\u63a5\u7740\u6211\u4f1a\u7ed9\u51fa\u4e0a\u6ed1\u52a0\u8f7d\u7684\u5173\u952e\u5e03\u5c40\u4ee3\u7801\u3001\u903b\u8f91\u4ee3\u7801\uff0c\u63a5\u7740\u6211\u4f1a\u4ecb\u7ecd\u4e0a\u6ed1\u52a0\u8f7d\u9700\u8981\u6ce8\u610f\u7684\u4e09\u4e2a\u95ee\u9898\uff0c\u6700\u540e\u6211\u4f1a\u518d\u505a\u4e2a\u7b80\u5355\u7684\u603b\u7ed3\u3002\\r\\n\\r\\n## \u4e0a\u6ed1\u52a0\u8f7d\u7684\u539f\u7406\\r\\n\\r\\n![](./img/principle.png)\\r\\n\\r\\n\u5982\u56fe\u6240\u793a\uff0c\u84dd\u8272\u77e9\u5f62\u4ee3\u8868\u89c6\u53e3\uff0c\u7eff\u8272\u77e9\u5f62\u4ee3\u8868\u5305\u88f9\u5217\u8868\u548c\u52a8\u753b\u7684\u5bb9\u5668\uff0c\u91d1\u9ec4\u8272\u77e9\u5f62\u4ee3\u8868\u5217\u8868\uff0c\u6a59\u8272\u5219\u4ee3\u8868\u52a0\u8f7d\u52a8\u753b\u3002\\r\\n\\r\\n\u6700\u5f00\u59cb\u65f6\uff0c\u52a0\u8f7d\u52a8\u753b\u5904\u4e8e\u89c6\u53e3\u4e0b\u65b9\uff1b\u5f53\u7528\u6237\u6eda\u52a8\u5217\u8868\u5230\u8fbe\u5e95\u90e8\u65f6\uff0c\u52a0\u8f7d\u52a8\u753b\u5c31\u8fdb\u5165\u4e86\u89c6\u53e3\uff0c\u6b64\u65f6\u53ef\u4ee5\u8bf7\u6c42\u5217\u8868\u4e0b\u4e00\u9875\u6570\u636e\uff0c\u8bf7\u6c42\u6210\u529f\u540e\u65b0\u8282\u70b9\u63d2\u5165\u5230\u5217\u8868\u5e95\u90e8\uff0c\u65b0\u8282\u70b9\u628a\u52a8\u753b\u6324\u51fa\u4e86\u89c6\u53e3\u3002\\r\\n\\r\\n\u4e5f\u5c31\u662f\u8bf4\uff0c\u60f3\u5b9e\u73b0\u52a0\u8f7d\u66f4\u591a\uff0c\u5173\u952e\u5c31\u662f\u76d1\u542c\u52a0\u8f7d\u52a8\u753b\u6709\u6ca1\u6709\u8fdb\u5165\u89c6\u53e3\u5185\u90e8\u3002\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 [IntersectionObserver](https://developer.mozilla.org/zh-CN/docs/Web/API/IntersectionObserver) \u8fd9\u4e2a API \u76d1\u542c\u52a8\u753b\u6709\u6ca1\u6709\u8fdb\u5165\u89c6\u53e3\u3002\\r\\n\\r\\n`IntersectionObserver` \u4f7f\u7528\u65b9\u6cd5\u5982\u4e0b\uff0c\u6211\u4eec\u9996\u5148\u521b\u5efa\u4e86\u4e00\u4e2a\u76d1\u542c\u5668 observer\uff0c\u518d\u7528\u8fd9\u4e2a\u76d1\u542c\u5668\u53bb\u76d1\u89c6\u5143\u7d20 element\u3002\u5f53 [entry.isIntersecting](https://developer.mozilla.org/en-US/docs/Web/API/IntersectionObserverEntry/isIntersecting) \u4e3a true \u65f6\uff0c\u8bf4\u660e element \u5df2\u7ecf\u8fdb\u5165\u89c6\u53e3\u3002\\r\\n\\r\\n```js\\r\\n// \u521b\u5efa\u76d1\u542c\u5668\\r\\nconst observer = new IntersectionObserver(([entry]) => {\\r\\n  if (entry.isIntersecting) {\\r\\n    console.log(\'\u8fdb\u5165\u89c6\u53e3\')\\r\\n  }\\r\\n})\\r\\n// \u5f00\u59cb\u76d1\u542c\\r\\nobserver.observe(element)\\r\\n```\\r\\n\\r\\n## \u4e0a\u6ed1\u52a0\u8f7d\u5173\u952e\u4ee3\u7801\\r\\n\\r\\n\u77e5\u9053\u539f\u7406\u540e\uff0c\u73b0\u5728\u6211\u4eec\u6765\u770b\u5b9e\u73b0\u4e0a\u6ed1\u52a0\u8f7d\u7684\u5173\u952e\u4ee3\u7801\uff0c\u9996\u5148\u662f\u5e03\u5c40\u4ee3\u7801\uff1a\\r\\n\\r\\n### \u5e03\u5c40\u4ee3\u7801\\r\\n\\r\\n\u5e03\u5c40\u4ee3\u7801\u548c\u539f\u7406\u56fe\u76f8\u4e92\u5bf9\u5e94\uff0cbox \u662f\u5305\u88f9\u5217\u8868\u548c\u52a0\u8f7d\u52a8\u753b\u7684\u5bb9\u5668\u3001list \u6709 5 \u4e2a\u5b50\u5143\u7d20\u3001list \u4e0b\u65b9\u5219\u662f\u52a0\u8f7d\u52a8\u753b\u7684\u5bb9\u5668\u3002\\r\\n\\r\\n```html\\r\\n<div class=\\"box\\">\\r\\n  <div id=\\"list\\">\\r\\n    <div class=\\"item\\">0</div>\\r\\n    <div class=\\"item\\">1</div>\\r\\n    <div class=\\"item\\">2</div>\\r\\n    <div class=\\"item\\">3</div>\\r\\n    <div class=\\"item\\">4</div>\\r\\n  </div>\\r\\n  <div class=\\"loader-box\\">\\r\\n    <div id=\\"loader\\"></div>\\r\\n    <div id=\\"nothing\\" class=\\"hidden\\">\u6ca1\u6709\u66f4\u591a\u4e86~</div>\\r\\n  </div>\\r\\n</div>\\r\\n```\\r\\n\\r\\n\u5217\u8868\u5e03\u5c40\u5f88\u57fa\u7840\uff0c\u6211\u4eec\u4e3b\u8981\u770b\u52a8\u753b\u3002loader-box \u4e2d\u7684 loader \u662f\u7eaf CSS \u7684\u52a0\u8f7d\u52a8\u753b\u3002\u6211\u4eec\u5229\u7528 border \u753b\u51fa\u7684\u4e00\u4e2a\u5706\u5f62\u8fb9\u6846\uff0c\u5de6\u3001\u4e0a\u3001\u53f3\u8fb9\u6846\u662f\u6d45\u7070\u8272\uff0c\u4e0b\u8fb9\u6846\u662f\u6df1\u7070\u8272\uff1a\\r\\n\\r\\n![](./img/loader.png)\\r\\n\\r\\n```css\\r\\n#loader {\\r\\n  width: 25px;\\r\\n  height: 25px;\\r\\n  border: 3px solid #ddd;\\r\\n  border-radius: 50%;\\r\\n  border-bottom: 3px solid #717171;\\r\\n  transform: rotate(0deg);\\r\\n}\\r\\n```\\r\\n\\r\\n\u6211\u4eec\u7ed9 loader \u5143\u7d20\u589e\u52a0\u4e00\u4e2a\u52a8\u753b\uff0c\u8ba9\u5b83\u4ece 0 \u5ea6\u5230 360 \u5ea6\u65e0\u9650\u65cb\u8f6c\uff0c\u5c31\u5b9e\u73b0\u4e86\u52a0\u8f7d\u52a8\u753b\uff1a\\r\\n\\r\\n![](./img/loading.gif)\\r\\n\\r\\n```css\\r\\n#loader {\\r\\n  ...\\r\\n  animation: loading 1s linear infinite;\\r\\n}\\r\\n\\r\\n@keyframes loading {\\r\\n  from { transform: rotate(0deg); }\\r\\n  to { transform: rotate(360deg); }\\r\\n}\\r\\n```\\r\\n\\r\\n**loader \u4e5f\u662f\u6211\u4eec\u771f\u6b63\u9700\u8981\u76d1\u542c\u662f\u5426\u8fdb\u5165\u89c6\u53e3\u7684\u5143\u7d20\u3002**\\r\\n\\r\\n### \u903b\u8f91\u4ee3\u7801\\r\\n\\r\\n\u5173\u952e\u903b\u8f91\u4ee3\u78014\u548c\u539f\u7406\u4e2d\u4e00\u81f4\uff0c\u6211\u4eec\u53ea\u9700\u8981\u76d1\u542c\u5230\u52a8\u753b loader \u8fdb\u5165\u89c6\u53e3\uff0c\u5c31\u76f4\u63a5\u8c03\u7528 pullUp \u51fd\u6570\u3002\\r\\n\\r\\n```js\\r\\nconst loader = document.getElementById(\'loader\')\\r\\nconst observer = new IntersectionObserver(([entry]) => {\\r\\n  if (entry.isIntersecting) {\\r\\n    pullUp()\\r\\n  }\\r\\n}, {\\r\\n  root: null,\\r\\n  rootMargin: \'0px\',\\r\\n  threshold: 0\\r\\n})\\r\\n\\r\\nobserver.observe(loader)\\r\\n```\\r\\n\\r\\n## \u4e0a\u6ed1\u52a0\u8f7d\u7684\u4e24\u4e2a\u6ce8\u610f\u70b9\\r\\n\\r\\n\u5b9e\u73b0\u4e0a\u6ed1\u52a0\u8f7d\uff0c\u6211\u4eec\u9664\u4e86\u5173\u952e\u5b8c\u5e03\u5c40\u4ee3\u7801\u3001\u903b\u8f91\u4ee3\u7801\u5916\uff0c\u8fd8\u6709\u4e09\u4e2a\u70b9\u9700\u8981\u6ce8\u610f\uff1a\\r\\n\\r\\n### \u52a0\u8f7d\u9501\\r\\n\\r\\n\u7b2c\u4e00\u70b9\uff0c\u524d\u4e00\u6b21\u4e0a\u6ed1\u52a0\u8f7d\u672a\u5b8c\u6210\u4e4b\u524d\uff0c\u4e0d\u5e94\u8be5\u518d\u6b21\u89e6\u53d1\u4e0a\u6ed1\u52a0\u8f7d\u3002\\r\\n\\r\\n\u4e3a\u6b64\uff0c\u6211\u4eec\u9700\u8981\u521b\u5efa\u4e00\u4e2a\u52a0\u8f7d\u9501\u53d8\u91cf loadLock\uff0c\u6570\u636e\u52a0\u8f7d\u524d\u5148\u628a loadLock \u8d4b\u503c\u4e3a true\uff0c\u6570\u636e\u52a0\u8f7d\u5b8c\u6210\u540e\u518d\u628a loadLock \u8d4b\u503c\u4e3a false\u3002\u5982\u679c loadLock \u4e00\u76f4\u4e3a true\uff0c\u5c31\u8bf4\u660e\u524d\u4e00\u6b21\u52a0\u8f7d\u672a\u5b8c\u6210\uff0c\u6211\u4eec\u9700\u8981\u76f4\u63a5 return \u7ed3\u675f pullUp \u51fd\u6570\u3002\\r\\n\\r\\n\u4ee3\u7801\u5982\u4e0b\uff1a\\r\\n\\r\\n```js\\r\\nlet loadLock = false\\r\\n\\r\\nfunction pullUp() {\\r\\n  ...\\r\\n  if (loadLock) { return }\\r\\n  loadData()\\r\\n}\\r\\n\\r\\nfunction loadData() {\\r\\n  ...\\r\\n  loadLock = true\\r\\n  setTimeout(() => {\\r\\n    ...\\r\\n    loadLock = false\\r\\n  }, LOADING_TIME)\\r\\n}\\r\\n```\\r\\n\\r\\n### \u6ca1\u6709\u66f4\u591a\u6570\u636e\\r\\n\\r\\n\u7b2c\u4e8c\u70b9\uff0c\u9700\u8981\u8003\u8651\u6ca1\u6709\u66f4\u591a\u6570\u636e\u7684\u60c5\u51b5\u3002\u4e0a\u6ed1\u52a0\u8f7d\u8bf7\u6c42\u7684\u6570\u636e\u662f\u5206\u9875\u7684\uff0c\u4e00\u5b9a\u6709\u8bf7\u6c42\u7ed3\u675f\u7684\u60c5\u51b5\u3002\u8bf7\u6c42\u7ed3\u675f\u65f6\uff0c\u6211\u4eec\u9700\u8981\u7ed9\u7528\u6237\u4e00\u4e9b\u63d0\u793a\u3002\\r\\n\\r\\n\u6211\u4eec\u53ef\u4ee5\u8bbe\u7f6e\u4e00\u4e2a hasMore \u53d8\u91cf\u3002hasMore \u4e3a true \u8868\u793a\u65f6\u5019\u6709\u66f4\u591a\u6570\u636e\uff0c\u4e3a false \u65f6\u8868\u793a\u6570\u636e\u4e86\uff0c\u5e94\u8be5\u9690\u85cf\u52a0\u8f7d\u52a8\u753b\uff0c\u5c55\u793a\u300c\u6ca1\u6709\u66f4\u591a\u4e86\u300d\u63d0\u793a\u3002\\r\\n\\r\\n\u4ee3\u7801\u5982\u4e0b\uff0c\u6211\u9650\u5236\u4e86\u5206\u9875\u6570\u636e\u6700\u591a\u53ea\u6709 LIST_LIMIT_CNT \u6761\uff1a\\r\\n\\r\\n```js\\r\\nlet hasMore = true\\r\\n\\r\\nfunction pullUp() {\\r\\n  if (!hasMore) { return }\\r\\n  ...\\r\\n  loadData()\\r\\n}\\r\\n\\r\\nfunction loadData() {\\r\\n  ...\\r\\n  setTimeout(() => {\\r\\n    if (len >= LIST_LIMIT_CNT) {\\r\\n      loader.className = \'hidden\'\\r\\n      nothing.className = \'\'\\r\\n      hasMore = false\\r\\n      return\\r\\n    }\\r\\n    ...\\r\\n  }, LOADING_TIME);\\r\\n}\\r\\n```\\r\\n\\r\\n### \u8bf7\u6c42\u5931\u8d25\\r\\n\\r\\n\u7b2c\u4e09\u70b9\uff0c\u9700\u8981\u8003\u8651\u8bf7\u6c42\u5931\u8d25\u7684\u60c5\u51b5\u3002\u6211\u4eec\u65e0\u6cd5\u4fdd\u8bc1\u670d\u52a1\u5668\u4e00\u76f4\u8fd0\u8f6c\u6b63\u5e38\uff0c\u5f88\u53ef\u80fd\u5217\u8868\u524d\u4e00\u6b21\u5206\u9875\u8bf7\u6c42\u8fd8\u6210\u529f\uff0c\u540e\u4e00\u6b21\u5206\u9875\u8bf7\u6c42\u5c31\u5931\u8d25\u4e86\u3002\\r\\n\\r\\n\u8fd9\u79cd\u60c5\u51b5\u6709\u4e24\u79cd\u5e38\u89c1\u4ea4\u4e92\uff1a\\r\\n\\r\\n- \u76f4\u63a5\u5c55\u793a\u300c\u8bf7\u6c42\u51fa\u9519\u4e86\u300d\uff0c\u8ba9\u7528\u6237\u70b9\u51fb\u91cd\u8bd5\u3002\\r\\n- \u7ee7\u7eed\u5c55\u793a\u52a0\u8f7d\u52a8\u753b\uff0c\u91cd\u65b0\u8bf7\u6c42\u670d\u52a1\u5668\u6570\u636e\u3002\\r\\n\\r\\n\u56e0\u4e3a\u8bf7\u6c42\u5931\u8d25\u4e0d\u597d\u6a21\u62df\uff0c\u6240\u4ee5 Demo \u4e2d\u53ea\u5b9e\u73b0\u4e86\u52a0\u8f7d\u9501\u548c\u6ca1\u6709\u66f4\u591a\u6570\u636e\u7684\u60c5\u51b5\uff0c\u4f60\u53ef\u4ee5\u6839\u636e\u81ea\u5df1\u7684\u9700\u8981\u6539\u5199 Demo\u3002\\r\\n\\r\\n## \u793a\u4f8b\u4ee3\u7801\\r\\n\\r\\n[\u4e0a\u6ed1\u52a0\u8f7d\u3001\u89e6\u5e95\u52a0\u8f7d | codepen](https://codepen.io/lijunlin2022/pen/OJrJePE)\\r\\n\\r\\n## \u603b\u7ed3\\r\\n\\r\\n\u672c\u6587\u8bb2\u89e3\u4e86\u4e0a\u6ed1\u52a0\u8f7d\u7684\u539f\u7406\u2014\u2014\u5229\u7528 IntersectionObserver \u76d1\u542c\u52a0\u8f7d\u52a8\u753b\u662f\u5426\u8fdb\u5165\u89c6\u53e3\uff0c\u5982\u679c\u52a8\u753b\u8fdb\u5165\u5219\u8bf7\u6c42\u4e0b\u4e00\u9875\u6570\u636e\u3002\u6b64\u5916\uff0c\u672c\u6587\u8fd8\u8bf4\u660e\u4e86\u4e0a\u6ed1\u52a0\u8f7d\u9700\u8981\u6ce8\u610f\u7684\u4e09\u4e2a\u70b9\uff1a\u52a0\u8f7d\u9501\u3001\u6ca1\u6709\u66f4\u591a\u6570\u636e\u548c\u8bf7\u6c42\u5931\u8d25\u3002"},{"id":"/2024/02/28/pull-down","metadata":{"permalink":"/blog/2024/02/28/pull-down","source":"@site/blog/2024-02-28-pull-down/index.md","title":"H5 \u4e0b\u62c9\u5237\u65b0\u5982\u4f55\u5b9e\u73b0\uff1f","description":"\u6700\u8fd1\u6211\u9700\u8981\u505a\u4e00\u4e2a\u4e0b\u62c9\u5237\u65b0\u7684\u529f\u80fd\uff0c\u5b9e\u73b0\u529f\u80fd\u540e\u6211\u53d1\u73b0\uff0c\u5b83\u9700\u8981\u5904\u7406\u7684\u60c5\u51b5\u8fd8\u86ee\u591a\uff0c\u4e8e\u662f\u6211\u6574\u7406\u4e86\u8fd9\u7bc7\u6587\u7ae0\u3002","date":"2024-02-28T00:00:00.000Z","tags":[{"inline":true,"label":"H5","permalink":"/blog/tags/h-5"}],"readingTime":12.025,"hasTruncateMarker":false,"authors":[],"frontMatter":{"tags":["H5"]},"unlisted":false,"prevItem":{"title":"H5 \u4e0a\u6ed1\u52a0\u8f7d\uff08\u89e6\u5e95\u52a0\u8f7d\uff09\u5982\u4f55\u5b9e\u73b0\uff1f","permalink":"/blog/2024/03/02/pull-up"},"nextItem":{"title":"H5\u3001\u5c0f\u7a0b\u5e8f\u4e2d\u56db\u4e2a\u53cd\u5411\u5706\u89d2\u7684\u56fe\u7247\u5982\u4f55\u5b9e\u73b0\uff1f","permalink":"/blog/2024/02/19/reverse-border-radius"}},"content":"\u6700\u8fd1\u6211\u9700\u8981\u505a\u4e00\u4e2a\u4e0b\u62c9\u5237\u65b0\u7684\u529f\u80fd\uff0c\u5b9e\u73b0\u529f\u80fd\u540e\u6211\u53d1\u73b0\uff0c\u5b83\u9700\u8981\u5904\u7406\u7684\u60c5\u51b5\u8fd8\u86ee\u591a\uff0c\u4e8e\u662f\u6211\u6574\u7406\u4e86\u8fd9\u7bc7\u6587\u7ae0\u3002\\r\\n\\r\\n\u4e0b\u56fe\u662f\u6211\u5b9e\u73b0\u7684\u6548\u679c\uff0c\u5206\u4e3a\u4e09\u6b65\uff1a\u5f00\u59cb\u4e0b\u62c9\u65f6\uff0c\u5c4f\u5e55\u9876\u90e8\u4f1a\u51fa\u73b0\u52a0\u8f7d\u52a8\u753b\uff1b\u52a0\u8f7d\u8fc7\u7a0b\u4e2d\uff0c\u5c4f\u5e55\u9876\u90e8\u9ad8\u5ea6\u4fdd\u6301\u4e0d\u53d8\uff1b\u52a0\u8f7d\u5b8c\u6210\u540e\uff0c\u52a0\u8f7d\u52a8\u753b\u9690\u85cf\u3002\\r\\n\\r\\n![](./img/pull-down.gif)\\r\\n\\r\\n\u9996\u5148\u6211\u4f1a\u8bb2\u89e3\u4e0b\u62c9\u7684\u539f\u7406\u3001\u6839\u636e\u539f\u7406\u5199\u51fa\u521d\u59cb\u4ee3\u7801\uff1b\u7136\u540e\u6211\u4f1a\u8bf4\u660e\u4ee3\u7801\u5b58\u5728\u7684\u7f3a\u9677\u3001\u89e3\u51b3\u7f3a\u9677\u5e76\u505a\u4e9b\u989d\u5916\u4f18\u5316\uff1b\u6700\u540e\u6211\u4f1a\u7ed9\u51fa\u5b8c\u6574\u4ee3\u7801\uff0c\u5e76\u505a\u4e00\u4e2a\u603b\u7ed3\u3002\\r\\n\\r\\n## \u4e0b\u62c9\u7684\u539f\u7406\\r\\n\\r\\n![](./img/prinple.png)\\r\\n\\r\\n\u5982\u56fe\u6240\u793a\uff0c\u84dd\u8272\u6846\u4ee3\u8868\u89c6\u53e3\uff0c\u7eff\u8272\u6846\u4ee3\u8868\u5bb9\u5668\uff0c\u6a59\u8272\u6846\u4ee3\u8868\u52a0\u8f7d\u52a8\u753b\u3002\u6700\u5f00\u59cb\u65f6\uff0c\u52a0\u8f7d\u52a8\u753b\u5904\u4e8e\u89c6\u53e3\u5916\uff1b\u5f00\u59cb\u4e0b\u62c9\u4e4b\u540e\uff0c\u5bb9\u5668\u5411\u4e0b\u79fb\u52a8\uff0c\u52a0\u8f7d\u52a8\u753b\u4ece\u4e0a\u65b9\u8fdb\u5165\u89c6\u53e3\uff1b\u7ed3\u675f\u4e0b\u62c9\u540e\uff0c\u5bb9\u5668\u53c8\u5f00\u59cb\u5411\u4e0a\u79fb\u52a8\uff0c\u52a0\u8f7d\u52a8\u753b\u4e5f\u4ece\u4e0a\u65b9\u9000\u51fa\u89c6\u53e3\u3002\\r\\n\\r\\n## \u4e0b\u62c9\u57fa\u7840\u4ee3\u7801\\r\\n\\r\\n\u77e5\u9053\u539f\u7406\uff0c\u6211\u4eec\u73b0\u5728\u5f00\u59cb\u5199\u4ee3\u7801\uff0c\u9996\u5148\u662f\u5e03\u5c40\u7684\u4ee3\u7801\uff1a\\r\\n\\r\\n### \u5e03\u5c40\u4ee3\u7801\\r\\n\\r\\n\u6211\u4eec\u628a box \u5143\u7d20\u5f53\u4f5c\u5bb9\u5668\uff0c\u628a loader-box\uff0cloader-box + loading \u5143\u7d20\u5f53\u4f5c\u52a8\u753b\uff0c\u81f3\u4e8e h1 \u5143\u7d20\u4e0d\u9700\u8981\u5173\u6ce8\uff0c\u6211\u4eec\u53ea\u628a\u5b83\u5f53\u4f5c\u64cd\u4f5c\u63d0\u793a\u3002\\r\\n\\r\\n```html\\r\\n<div id=\\"box\\">\\r\\n  <div class=\\"loader-box\\">\\r\\n    <div id=\\"loading\\"></div>\\r\\n  </div>\\r\\n  <h1>\u4e0b\u62c9\u5237\u65b0 \u2193</h1>\\r\\n</div>\\r\\n```\\r\\n\\r\\nloader-box \u7684\u9ad8\u5ea6\u662f 80px\uff0c\u6309\u4e0a\u4e00\u8282\u539f\u7406\u4e2d\u7684\u5206\u6790\uff0c\u521d\u59cb\u65f6\u6211\u4eec\u9700\u8981\u8ba9 loader-box \u4f4d\u4e8e\u89c6\u53e3\u4e0a\u65b9\uff0c\u56e0\u6b64 CSS \u4ee3\u7801\u4e2d\u6211\u4eec\u9700\u8981\u628a\u5b83\u7684\u4f4d\u7f6e\u5411\u4e0a\u79fb\u52a8 80px\u3002\\r\\n\\r\\n```css\\r\\n.loader-box {\\r\\n  position: relative;\\r\\n  top: -80px;\\r\\n  height: 80px;\\r\\n}\\r\\n```\\r\\n\\r\\nloader-box \u4e2d\u7684 loader \u662f\u7eaf CSS \u7684\u52a0\u8f7d\u52a8\u753b\u3002\u6211\u4eec\u5229\u7528 border \u753b\u51fa\u7684\u4e00\u4e2a\u5706\u5f62\u8fb9\u6846\uff0c\u5de6\u3001\u4e0a\u3001\u53f3\u8fb9\u6846\u662f\u6d45\u7070\u8272\uff0c\u4e0b\u8fb9\u6846\u662f\u6df1\u7070\u8272\uff1a\\r\\n\\r\\n![](./img/loader.png)\\r\\n\\r\\n```css\\r\\n#loader {\\r\\n  width: 25px;\\r\\n  height: 25px;\\r\\n  border: 3px solid #ddd;\\r\\n  border-radius: 50%;\\r\\n  border-bottom: 3px solid #717171;\\r\\n  transform: rotate(0deg);\\r\\n}\\r\\n```\\r\\n\\r\\n\u5f00\u59cb\u5237\u65b0\u65f6\uff0c\u6211\u4eec\u7ed9 loader \u5143\u7d20\u589e\u52a0\u4e00\u4e2a\u52a8\u753b\uff0c\u8ba9\u5b83\u4ece 0 \u5ea6\u5230 360 \u5ea6\u65e0\u9650\u65cb\u8f6c\uff0c\u5c31\u5b9e\u73b0\u4e86\u52a0\u8f7d\u52a8\u753b\uff1a\\r\\n\\r\\n![](./img/loading.gif)\\r\\n\\r\\n```css\\r\\n#loader.loading {\\r\\n  animation: loading 1s linear infinite;\\r\\n}\\r\\n\\r\\n@keyframes loading {\\r\\n  from { transform: rotate(0deg); }\\r\\n  to { transform: rotate(360deg); }\\r\\n}\\r\\n```\\r\\n\\r\\n### \u903b\u8f91\u4ee3\u7801\\r\\n\\r\\n\u770b\u5b8c\u5e03\u5c40\u4ee3\u7801\uff0c\u6211\u4eec\u518d\u770b\u903b\u8f91\u4ee3\u7801\u3002\u903b\u8f91\u4ee3\u7801\u4e2d\uff0c\u6211\u4eec\u8981\u76d1\u542c\u7528\u6237\u7684\u624b\u6307\u6ed1\u52a8\u3001\u5b9e\u73b0\u4e0b\u62c9\u624b\u52bf\u3002\u6211\u4eec\u9700\u8981\u7528\u5230\u4e09\u4e2a\u4e8b\u4ef6\uff1a\\r\\n\\r\\n- [touchstart](https://developer.mozilla.org/zh-CN/docs/Web/API/Element/touchstart_event) \u4ee3\u8868\u89e6\u6478\u5f00\u59cb\uff1b\\r\\n- [touchmove](https://developer.mozilla.org/zh-CN/docs/Web/API/Element/touchmove_event) \u4ee3\u8868\u89e6\u6478\u79fb\u52a8\uff1b\\r\\n- [touchend](https://developer.mozilla.org/zh-CN/docs/Web/API/Element/touchend_event) \u4ee3\u8868\u89e6\u6478\u7ed3\u675f\u3002\\r\\n\\r\\n\u4ece `touchstart` \u548c `touchmove` \u4e8b\u4ef6\u4e2d\u6211\u4eec\u53ef\u4ee5\u83b7\u53d6\u624b\u6307\u7684\u5750\u6807\uff0c\u6bd4\u5982 `event.touches[0].clientX` \u662f\u624b\u6307\u76f8\u5bf9\u89c6\u53e3\u5de6\u8fb9\u7f18\u7684 X \u5750\u6807\uff0c`event.touches[0].clientY` \u662f\u624b\u6307\u76f8\u5bf9\u89c6\u53e3\u4e0a\u8fb9\u7f18\u7684 Y \u5750\u6807\uff1b\u4ece `touchend` \u4e8b\u4ef6\u4e2d\u6211\u4eec\u5219\u65e0\u6cd5\u83b7\u5f97 `clientX` \u548c `clientY`\u3002\\r\\n\\r\\n\u6211\u4eec\u53ef\u4ee5\u5148\u8bb0\u5f55\u7528\u6237\u624b\u6307 touchstart \u7684 clientY \u4f5c\u4e3a\u5f00\u59cb\u5750\u6807\uff0c\u8bb0\u5f55\u7528\u6237\u6700\u540e\u4e00\u6b21\u89e6\u53d1 touchmove \u7684 clientY \u4f5c\u4e3a\u7ed3\u675f\u5750\u6807\uff0c\u4e8c\u8005\u76f8\u51cf\u5c31\u5f97\u5230\u624b\u6307\u79fb\u52a8\u7684\u8ddd\u79bb distanceY\u3002\\r\\n\\r\\n\u8bbe\u7f6e\u624b\u6307\u79fb\u52a8\u591a\u5c11\u8ddd\u79bb\uff0c\u5bb9\u5668\u5c31\u79fb\u52a8\u591a\u5c11\u8ddd\u79bb\uff0c\u5c31\u5f97\u5230\u4e86\u6211\u4eec\u7684\u903b\u8f91\u4ee3\u7801\uff1a\\r\\n\\r\\n```js\\r\\nconst box = document.getElementById(\'box\')\\r\\nconst loader = document.getElementById(\'loader\')\\r\\nlet startY = 0, endY = 0, distanceY = 0\\r\\n\\r\\nfunction start(e) {\\r\\n  startY = e.touches[0].clientY\\r\\n}\\r\\n\\r\\nfunction move(e) {\\r\\n  endY =  e.touches[0].clientY\\r\\n  distanceY = endY - startY\\r\\n  box.style = `\\r\\n    transform: translateY(${distanceY}px);\\r\\n    transition: all 0.3s linear;\\r\\n  `\\r\\n}\\r\\n\\r\\nfunction end() {\\r\\n  setTimeout(() => {\\r\\n    box.style = `\\r\\n      transform: translateY(0);\\r\\n      transition: all 0.3s linear;\\r\\n    `\\r\\n    loader.className = \'loading\'\\r\\n  }, 1000)\\r\\n}\\r\\n\\r\\nbox.addEventListener(\'touchstart\', start)\\r\\nbox.addEventListener(\'touchmove\', move)\\r\\nbox.addEventListener(\'touchend\', end)\\r\\n```\\r\\n\\r\\n\u903b\u8f91\u4ee3\u7801\u5b9e\u73b0\u4e00\u4e2a\u7b80\u964b\u7684\u4e0b\u62c9\u6548\u679c\uff0c\u5f53\u7136\u73b0\u5728\u8fd8\u6709\u5f88\u591a\u7f3a\u9677\u3002\\r\\n\\r\\n![](./img/pull-down-basic.gif)\\r\\n\\r\\n## \u7b80\u964b\u4e0b\u62c9\u6548\u679c\u7684 6 \u4e2a\u7f3a\u9677\\r\\n\\r\\n\u4e4b\u524d\u6211\u4eec\u5b9e\u73b0\u4e86\u7b80\u964b\u7684\u4e0b\u62c9\u6548\u679c\uff0c\u5b83\u8fd8\u9700\u8981\u89e3\u51b3 6 \u4e2a\u7f3a\u9677\uff0c\u624d\u80fd\u7b97\u4e00\u4e2a\u5b8c\u5584\u7684\u529f\u80fd\u3002\\r\\n\\r\\n### \u6ca1\u6709\u6700\u5c0f\u3001\u6700\u5927\u8ddd\u79bb\u9650\u5236\\r\\n\\r\\n\u7b2c\u4e00\u4e2a\u7f3a\u9677\u662f\uff0c\u4e0b\u62c9\u6ca1\u6709\u505a\u6700\u5c0f\u3001\u6700\u5927\u8ddd\u79bb\u7684\u9650\u5236\u3002\\r\\n\\r\\n\u901a\u5e38\u6765\u8bf4\uff0c\u6211\u4eec\u4e0b\u62c9\u5c4f\u5e55\u65f6\uff0c\u8ddd\u79bb\u592a\u5c0f\u5e94\u8be5\u4e0d\u80fd\u89e6\u53d1\u5237\u65b0\uff0c\u8ddd\u79bb\u592a\u5927\u4e5f\u4e0d\u884c\uff0c\u4e0b\u6ed1\u5230\u4e00\u5b9a\u8ddd\u79bb\u540e\uff0c\u5c31\u5e94\u8be5\u65e0\u6cd5\u7ee7\u7eed\u4e0b\u6ed1\u3002\\r\\n\\r\\n\u56e0\u6b64\u6211\u4eec\u53ef\u4ee5\u7ed9\u4e0b\u62c9\u8bbe\u7f6e\u6700\u5c0f\u8ddd\u79bb\u9650\u5236 `DISTANCE_Y_MIN_LIMIT`\u3001\u6700\u5927\u8ddd\u79bb\u9650\u5236 `DISTANCE_Y_MAX_LIMIT`\u3002\u5982\u679c touchend \u4e2d\u53d1\u73b0\u4e0b\u62c9\u8ddd\u79bb\u5c0f\u4e8e\u6700\u5c0f\u8ddd\u79bb\uff0c\u76f4\u63a5\u4e0d\u89e6\u53d1\u52a0\u8f7d\uff1b\u5982\u679c touchmove \u4e2d\u4e0b\u62c9\u8ddd\u79bb\u8d85\u8fc7\u6700\u5927\u8ddd\u79bb\uff0c\u9875\u9762\u53ea\u5411\u4e0b\u79fb\u52a8\u6700\u5927\u8ddd\u79bb\u3002\\r\\n\\r\\n\u89e3\u51b3\u7f3a\u9677\u5173\u952e\u4ee3\u7801\u5982\u4e0b\uff1a\\r\\n\\r\\n```js\\r\\nconst DISTANCE_Y_MAX_LIMIT = 150\\r\\n  DISTANCE_Y_MIN_LIMIT = 80\\r\\n\\r\\nfunction move(e) {\\r\\n  endY =  e.touches[0].clientY\\r\\n  distanceY = endY - startY\\r\\n  if (distanceY > DISTANCE_Y_LIMIT) {\\r\\n    distanceY = DISTANCE_Y_LIMIT\\r\\n  }\\r\\n  box.style = `\\r\\n    transform: translateY(${distanceY}px);\\r\\n    transition: all 0.3s linear;\\r\\n  `\\r\\n}\\r\\n\\r\\nfunction end() {\\r\\n  if (distanceY < DISTANCE_Y_MIN_LIMIT) {\\r\\n    box.style = `\\r\\n      transform: translateY(0px);\\r\\n      transition: all 0.3s linear;\\r\\n    `\\r\\n    return\\r\\n  }\\r\\n  ...\\r\\n}\\r\\n```\\r\\n\\r\\n### \u52a0\u8f7d\u52a8\u753b\u6ca1\u6709\u505c\u7559\u5728\u89c6\u53e3\u9876\u90e8\\r\\n\\r\\n\u7b2c\u4e8c\u4e2a\u7f3a\u9677\u662f\uff0c\u4e0b\u62c9\u6ca1\u6709\u8ba9\u52a0\u8f7d\u52a8\u753b\u505c\u7559\u5728\u89c6\u53e3\u9876\u90e8\u3002\\r\\n\\r\\n\u6211\u4eec\u53ef\u4ee5\u628a end \u51fd\u6570\u52a0\u4ee5\u6539\u9020\uff0c\u5728\u6570\u636e\u8fd8\u6ca1\u6709\u52a0\u8f7d\u5b8c\u6210\u65f6\uff08\u7528 setTimeout \u6a21\u62df\u7684\uff09\uff0c\u8ba9\u52a0\u8f7d\u52a8\u753b style \u7684 `translateY` \u4e00\u76f4\u662f 80px\uff0c`translateY(80px)` \u53ef\u4ee5\u548c \u521d\u59cb CSS \u7684 `top: -80px;` \u76f8\u4e92\u62b5\u6d88\uff0c\u8ba9\u52a8\u753b\u5728\u672a\u5237\u65b0\u5b8c\u6210\u524d\u505c\u7559\u5728\u89c6\u53e3\u9876\u90e8\u3002\\r\\n\\r\\n```js\\r\\nfunction end() {\\r\\n  ...\\r\\n  box.style = `\\r\\n    transform: translateY(80px);\\r\\n    transition: all 0.3s linear;\\r\\n  `\\r\\n  loader.className = \'loading\'\\r\\n  setTimeout(() => {\\r\\n    box.style = `\\r\\n      transform: translateY(0px);\\r\\n      transition: all 0.3s linear;\\r\\n    `\\r\\n    loader.className = \'\'\\r\\n  }, 1000)\\r\\n}\\r\\n```\\r\\n\\r\\n### \u91cd\u590d\u89e6\u53d1\\r\\n\\r\\n\u7b2c\u4e09\u4e2a\u7f3a\u9677\u662f\uff0c\u4e0b\u62c9\u53ef\u4ee5\u91cd\u590d\u89e6\u53d1\u3002\\r\\n\\r\\n\u6b63\u5e38\u6765\u8bf4\uff0c\u5982\u679c\u6211\u4eec\u5df2\u7ecf\u4e0b\u62c9\u8fc7\uff0c\u6570\u636e\u6b63\u5728\u52a0\u8f7d\u4e2d\u65f6\uff0c\u6211\u4eec\u4e0d\u80fd\u7ee7\u7eed\u4e0b\u62c9\u3002\\r\\n\\r\\n\u6211\u4eec\u53ef\u4ee5\u589e\u52a0\u4e00\u4e2a\u52a0\u8f7d\u9501 loadLock\u3002\u5f53\u52a0\u8f7d\u9501\u5f00\u542f\u65f6\uff0cstart\uff0cmove \u548c end \u4e8b\u4ef6\u90fd\u4e0d\u4f1a\u89e6\u53d1\u3002\\r\\n\\r\\n```js\\r\\nlet loadLock = false\\r\\n\\r\\nfunction start(e) {\\r\\n  if (loadLock) { return }\\r\\n  ...\\r\\n}\\r\\n\\r\\nfunction move(e) {\\r\\n  if (loadLock) { return }\\r\\n  ...\\r\\n}\\r\\n\\r\\nfunction end(e) {\\r\\n  if (loadLock) { return }\\r\\n  ...\\r\\n  setTimeout(() => {\\r\\n    ...\\r\\n    loadLock = true\\r\\n    ...\\r\\n  }, 1000)\\r\\n}\\r\\n```\\r\\n\\r\\n### \u6ca1\u6709\u9650\u5236\u65b9\u5411\\r\\n\\r\\n\u7b2c\u56db\u4e2a\u7f3a\u9677\u662f\uff0c\u6ca1\u6709\u9650\u5236\u65b9\u5411\u3002\\r\\n\\r\\n\u76ee\u524d\u6211\u4eec\u7684\u4ee3\u7801\uff0c\u7528\u6237\u4e0a\u62c9\u4e5f\u80fd\u89e6\u53d1\u3002\u6211\u4eec\u53ef\u4ee5\u589e\u52a0\u5224\u65ad\uff0c\u5f53 `endY - startY` \u5c0f\u4e8e 0 \u65f6\uff0c\u963b\u6b62 `touchmove` \u548c `touchend` \u7684\u903b\u8f91\u3002\\r\\n\\r\\n```js\\r\\nfunction move(e) {\\r\\n  ...\\r\\n  if (endY - startY < 0) { return }\\r\\n  ...\\r\\n}\\r\\n\\r\\nfunction end() {\\r\\n  if (endY - startY < 0) { return }\\r\\n  ...\\r\\n}\\r\\n```\\r\\n\\r\\n\u4f60\u53ef\u80fd\u4f1a\u7591\u60d1\uff0c\u4e3a\u4ec0\u4e48\u6211\u5b81\u613f\u5199\u591a\u4e2a\u5224\u65ad\u62e6\u622a\uff0c\u4e5f\u4e0d\u53d6\u6d88\u76d1\u542c\u4e8b\u4ef6\u3002\u8fd9\u662f\u56e0\u4e3a**\u4e00\u65e6\u53d6\u6d88\u76d1\u542c\u4e8b\u4ef6\uff0c\u6211\u4eec\u9700\u8981\u8003\u8651\u5728\u4e00\u4e2a\u5408\u9002\u7684\u65f6\u95f4\u91cd\u65b0\u76d1\u542c**\uff0c\u8fd9\u4f1a\u628a\u95ee\u9898\u53d8\u5f97\u66f4\u590d\u6742\u3002\\r\\n\\r\\n### \u6ca1\u6709\u963b\u6b62\u539f\u751f\u6eda\u52a8\\r\\n\\r\\n\u7b2c\u4e94\u4e2a\u7f3a\u9677\u65f6\uff0c\u6211\u4eec\u5728\u52a0\u8f7d\u6570\u636e\u65f6\u6ca1\u6709\u963b\u6b62\u539f\u751f\u6eda\u52a8\u3002\\r\\n\\r\\n\u867d\u7136\u6211\u4eec\u5df2\u7ecf\u963b\u6b62\u4e86\u91cd\u590d\u4e0b\u62c9\uff0ctouchmove \u548c touchend \u4e8b\u4ef6\u88ab\u62e6\u622a\u4e86\uff0c\u4f46\u662f H5 \u539f\u751f\u6eda\u52a8\u8fd8\u80fd\u7528\u3002\\r\\n\\r\\n\u6211\u4eec\u53ef\u4ee5\u5728\u5237\u65b0\u65f6\u7ed9 body \u8bbe\u7f6e\u4e00\u4e2a `overflow: hidden;` \u5c5e\u6027\uff0c\u5237\u65b0\u7ed3\u675f\u540e\u6e05\u9664 `overflow: hidden`\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u963b\u6b62\u539f\u751f\u6eda\u52a8\u3002\\r\\n\\r\\n```css\\r\\nbody.overflowHidden {\\r\\n  overflow: hidden;\\r\\n}\\r\\n```\\r\\n\\r\\n```js\\r\\nconst body = document.body\\r\\nfunction end() {\\r\\n  ...\\r\\n  box.style = `\\r\\n    transform: translateY(80px);\\r\\n    transition: all 0.3s linear;\\r\\n  `\\r\\n  loader.className = \'loading\'\\r\\n  body.className = \'overflowHidden\'\\r\\n  setTimeout(() => {\\r\\n    ...\\r\\n    box.style = `\\r\\n      transform: translateY(0px);\\r\\n      transition: all 0.3s linear;\\r\\n    `\\r\\n    loader.className = \'\'\\r\\n    body.className = \'\'\\r\\n  }, 1000)\\r\\n}\\r\\n```\\r\\n\\r\\n### \u6ca1\u6709\u963b\u6b62 iOS \u6a61\u76ae\u7b4b\u6548\u679c\\r\\n\\r\\n\u7b2c 6 \u4e2a\u7f3a\u9677\u662f\uff0c\u6ca1\u6709\u963b\u6b62 iOS \u7684\u6a61\u76ae\u7b4b\u6548\u679c\u3002\\r\\n\\r\\niOS \u6d4f\u89c8\u5668\u9ed8\u8ba4\u6ed1\u52a8\u65f6\u6709\u4e00\u4e2a\u6a61\u76ae\u7b4b\u6548\u679c\uff0c\u6211\u4eec\u9700\u8981\u963b\u6b62\u5b83\uff0c\u907f\u514d\u5f71\u54cd\u6211\u4eec\u7684\u4e0b\u62c9\u624b\u52bf\u3002\u963b\u6b62\u65b9\u5f0f\u5c31\u662f\u7ed9\u76d1\u542c\u5668\u8bbe\u7f6e `passive: false`\u3002\\r\\n\\r\\n```js\\r\\nfunction addTouchEvent() {\\r\\n  box.addEventListener(\'touchstart\', start, { passive: false })\\r\\n  box.addEventListener(\'touchmove\', move, { passive: false })\\r\\n  box.addEventListener(\'touchend\', end, { passive: false })\\r\\n}\\r\\n\\r\\naddTouchEvent()\\r\\n```\\r\\n\\r\\n\u89e3\u51b3\u5b8c 6 \u4e2a\u7f3a\u9677\u540e\uff0c\u6211\u4eec\u5df2\u7ecf\u5f97\u5230\u65e0\u7f3a\u9677\u7684\u4e0b\u62c9\u5237\u65b0\u529f\u80fd\uff0c\u4f46\u79bb\u4e1d\u6ed1\u7684\u4e0b\u62c9\u5237\u65b0\u8fd8\u6709\u4e00\u6bb5\u8ddd\u79bb\u3002\u6211\u4eec\u8fd8\u53ef\u4ee5\u505a\u4e00\u4e9b\u4f18\u5316\uff0c\u8ba9\u4e0b\u62c9\u5237\u65b0\u66f4\u5b8c\u5584\u3002\\r\\n\\r\\n## \u4f18\u5316\\r\\n\\r\\n\u6211\u4eec\u53ef\u4ee5\u505a\u4e24\u4e2a\u4f18\u5316\uff0c\u7b2c\u4e00\u4e2a\u4f18\u5316\u662f\u6dfb\u52a0\u963b\u5c3c\u6548\u679c\uff1a\\r\\n\\r\\n### \u589e\u52a0\u963b\u5c3c\u6548\u679c\\r\\n\\r\\n\u6240\u8c13\u963b\u5c3c\u6548\u679c\uff0c\u5c31\u662f\u4e0b\u62c9\u8fc7\u7a0b\u6211\u4eec\u53ef\u4ee5\u611f\u53d7\u5230\u4e00\u80a1\u963b\u529b\u7684\u5b58\u5728\uff0c\u867d\u7136\u6211\u4eec\u4e0b\u62c9\u529b\u5ea6\u662f\u4e00\u6837\u7684\uff0c\u4f46\u8ddd\u79bb\u7684\u589e\u52a0\u901f\u5ea6\u53d8\u6162\u4e86\u3002\u7528\u7269\u7406\u672f\u8bed\u8868\u793a\u7684\u8bdd\uff0c\u5c31\u662f\u52a0\u901f\u5ea6\u53d8\u5c0f\u4e86\u3002\\r\\n\\r\\n\u4f53\u73b0\u5230\u4ee3\u7801\u4e0a\uff0c\u6211\u4eec\u53ef\u4ee5\u8bbe\u7f6e\u4e00\u4e2a\u767e\u5206\u6bd4\uff0c\u767e\u5206\u6bd4\u4f1a\u968f\u7740\u4e0b\u62c9\u8ddd\u79bb\u589e\u52a0\u800c\u51cf\u5c11\uff0c\u628a\u767e\u5206\u6bd4\u4e58\u4ee5\u8ddd\u79bb\u5f53\u4f5c\u6700\u540e\u7684\u8ddd\u79bb\u3002\\r\\n\\r\\n\u4ee3\u7801\u4e2d\u767e\u5206\u6bd4 `percent` \u8bbe\u4e3a `(100 - distanceY * 0.5) / 100`\uff0c\u5f53 `distanceY` \u8d8a\u6765\u8d8a\u5927\u65f6\uff0c\u767e\u5206\u6bd4 `percent` \u8d8a\u6765\u8d8a\u5c0f\uff0c\u6700\u540e\u518d\u628a `distanceY * percent` \u8d4b\u503c\u7ed9 `distanceY`\u3002\\r\\n\\r\\n```js\\r\\nfunction move(e) {\\r\\n  ...\\r\\n  distanceY = endY - startY\\r\\n  let percent = (100 - distanceY * 0.5) / 100\\r\\n  percent = Math.max(0.5, percent)\\r\\n  distanceY = distanceY * percent\\r\\n  if (distanceY > DISTANCE_Y_MAX_LIMIT) {\\r\\n    distanceY = DISTANCE_Y_MAX_LIMIT\\r\\n  }\\r\\n  ...\\r\\n}\\r\\n```\\r\\n\\r\\n### \u5229\u7528\u89d2\u5ea6\u5224\u65ad\u7528\u6237\u4e0b\u62c9\u610f\u56fe\\r\\n\\r\\n\u7b2c\u4e8c\u4e2a\u4f18\u5316\u662f\u5229\u7528\u89d2\u5ea6\u5224\u65ad\u7528\u6237\u4e0b\u62c9\u610f\u56fe\u3002\\r\\n\\r\\n\u4e0b\u56fe\u5c55\u793a\u4e86\u4e24\u79cd\u7528\u6237\u4e0b\u62c9\u7684\u60c5\u51b5\uff0c\u03b2 \u89d2\u5ea6\u6bd4 \u03b1 \u89d2\u5ea6\u5c0f\uff0c\u89d2\u5ea6\u8d8a\u5c0f\u7528\u6237\u4e0b\u62c9\u610f\u56fe\u8d8a\u660e\u663e\u3001\u8bef\u89e6\u7684\u53ef\u80fd\u6027\u66f4\u5c0f\u3002\\r\\n\\r\\n![](./img/intension.png)\\r\\n\\r\\n\u6211\u4eec\u53ef\u4ee5\u5229\u7528\u53cd\u4e09\u89d2\u51fd\u6570\u6c42\u51fa\u89d2\u5ea6\u6765\u5224\u65ad\u4e0b\u62c9\u610f\u56fe\u3002\\r\\n\\r\\nJavaScript \u4e2d\uff0c\u53cd\u6b63\u5207\u51fd\u6570\u662f `Math.atan()`\uff0c\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u53cd\u6b63\u5207\u51fd\u6570\u7b97\u51fa\u7684\u662f\u5f27\u5ea6\uff0c\u6211\u4eec\u8fd8\u9700\u8981\u5c06\u5b83\u4e58\u4ee5 `180 / \u03c0` \u624d\u80fd\u83b7\u53d6\u89d2\u5ea6\u3002\\r\\n\\r\\n\u4e0b\u9762\u7684\u4ee3\u7801\u4e2d\uff0c\u6211\u4eec\u505a\u4e86\u4e00\u4e2a\u9650\u5236\uff0c\u53ea\u6709\u89d2\u5ea6\u5c0f\u4e8e 40 \u65f6\uff0c\u6211\u4eec\u624d\u8ba4\u4e3a\u7528\u6237\u7684\u771f\u5b9e\u610f\u56fe\u662f\u60f3\u8981\u4e0b\u62c9\u5237\u65b0\u3002\\r\\n\\r\\n```js\\r\\nconst DEG_LIMIT = 40\\r\\nfunction move(e) {\\r\\n  ...\\r\\n  distanceY = endY - startY\\r\\n  distanceX = endX - startX\\r\\n  const deg = Math.atan(Math.abs(distanceX) / distanceY)\\r\\n    * (180 / Math.PI)\\r\\n  if (deg > DEG_LIMIT) {\\r\\n    [startY, startX] = [endY, endX]\\r\\n    return\\r\\n  }\\r\\n  ...\\r\\n}\\r\\n```\\r\\n\\r\\n## \u4ee3\u7801\u793a\u4f8b\\r\\n\\r\\n\u4f60\u53ef\u4ee5\u5728 [codepen](https://codepen.io/lijunlin2022/pen/xxBeZrr) \u4e2d\u67e5\u770b\u6548\u679c\uff0cweb \u7aef\u9700\u8981\u6309 F12 \u7528\u624b\u673a\u6d4f\u89c8\u5668\u6253\u5f00\u3002\\r\\n\\r\\n![](./img/codepen.gif)\\r\\n\\r\\n## \u603b\u7ed3\\r\\n\\r\\n\u672c\u6587\u8bb2\u89e3\u4e86\u4e0b\u62c9\u7684\u539f\u7406\u3001\u5e76\u6839\u636e\u539f\u7406\u5199\u51fa\u521d\u59cb\u4ee3\u7801\u3002\u5728\u521d\u59cb\u4ee3\u7801\u7684\u57fa\u7840\u4e0a\uff0c\u6211\u89e3\u51b3\u4e86 6 \u4e2a\u7f3a\u9677\u3001\u505a\u4e86 2 \u4e2a\u4f18\u5316\uff0c\u5b9e\u73b0\u4e86\u4e00\u4e2a\u5b8c\u5584\u7684\u4e0b\u62c9\u5237\u65b0\u6548\u679c\u3002"},{"id":"/2024/02/19/reverse-border-radius","metadata":{"permalink":"/blog/2024/02/19/reverse-border-radius","source":"@site/blog/2024-02-19-reverse-border-radius/index.md","title":"H5\u3001\u5c0f\u7a0b\u5e8f\u4e2d\u56db\u4e2a\u53cd\u5411\u5706\u89d2\u7684\u56fe\u7247\u5982\u4f55\u5b9e\u73b0\uff1f","description":"\u6700\u8fd1\u6211\u901b\u70ed\u98ce\u5c0f\u7a0b\u5e8f\uff08\u4e00\u4e2a\u5356\u978b\u7684\u5c0f\u7a0b\u5e8f\uff09\u65f6\uff0c\u53d1\u73b0\u4e86\u4e00\u4e2a\u5947\u7279\u7684\u56fe\u7247\u6837\u5f0f\u3002\u56fe\u7247\u7684\u56db\u4e2a\u5706\u89d2\u662f\u53cd\u5411\u7684\uff0c\u548c\u5e38\u89c4\u56fe\u7247\u4e0d\u4e00\u6837\u3002","date":"2024-02-19T00:00:00.000Z","tags":[{"inline":true,"label":"H5","permalink":"/blog/tags/h-5"},{"inline":true,"label":"\u5c0f\u7a0b\u5e8f","permalink":"/blog/tags/\u5c0f\u7a0b\u5e8f"}],"readingTime":8.49,"hasTruncateMarker":false,"authors":[],"frontMatter":{"tags":["H5","\u5c0f\u7a0b\u5e8f"]},"unlisted":false,"prevItem":{"title":"H5 \u4e0b\u62c9\u5237\u65b0\u5982\u4f55\u5b9e\u73b0\uff1f","permalink":"/blog/2024/02/28/pull-down"},"nextItem":{"title":"H5\u3001\u5c0f\u7a0b\u5e8f\u9ad8\u5ea6\u53d8\u5316\u7684\u8f6e\u64ad\u56fe\u5982\u4f55\u5b9e\u73b0\uff1f","permalink":"/blog/2024/02/16/variable-height-swiper"}},"content":"\u6700\u8fd1\u6211\u901b\u70ed\u98ce\u5c0f\u7a0b\u5e8f\uff08\u4e00\u4e2a\u5356\u978b\u7684\u5c0f\u7a0b\u5e8f\uff09\u65f6\uff0c\u53d1\u73b0\u4e86\u4e00\u4e2a\u5947\u7279\u7684\u56fe\u7247\u6837\u5f0f\u3002\u56fe\u7247\u7684\u56db\u4e2a\u5706\u89d2\u662f\u53cd\u5411\u7684\uff0c\u548c\u5e38\u89c4\u56fe\u7247\u4e0d\u4e00\u6837\u3002\\r\\n\\r\\n![](./img/hotwind.jpg)\\r\\n\\r\\n\u601d\u7d22\u4e00\u756a\u540e\uff0c\u6211\u53d1\u73b0\u60f3\u5b9e\u73b0\u8fd9\u4e2a\u6548\u679c\uff0c\u9700\u8981\u7684 CSS \u77e5\u8bc6\u8fd8\u633a\u591a\uff0c\u4e8e\u662f\u6574\u7406\u8fd9\u7bc7\u6587\u7ae0\u3002\\r\\n\\r\\n\u4e0b\u9762\u6211\u4f1a\u5148\u4ecb\u7ecd\u5982\u4f55\u5b9e\u73b0\u56db\u4e2a\u53cd\u5411\u5706\u89d2\u7684\u77e9\u5f62\uff0c\u518d\u4ecb\u7ecd\u5982\u4f55\u628a\u7279\u6b8a\u77e9\u5f62\u4f5c\u4e3a\u906e\u7f69\u3001\u5f97\u5230\u548c\u70ed\u98ce\u5c0f\u7a0b\u5e8f\u7684\u56fe\u7247\u6548\u679c\u3002\u63a5\u7740\uff0c\u6211\u4f1a\u7ed9\u51fa\u5b8c\u6574\u7684\u4ee3\u7801\uff0c\u6700\u540e\uff0c\u6211\u4f1a\u7ed9\u505a\u4e00\u4e2a\u7b80\u5355\u7684\u603b\u7ed3\u3002\\r\\n\\r\\n## \u5982\u4f55\u5b9e\u73b0\u56db\u4e2a\u53cd\u5411\u5706\u89d2\u7684\u77e9\u5f62\\r\\n\\r\\n\u4e0d\u96be\u60f3\u5230\uff0c\u56db\u4e2a\u53cd\u5411\u5706\u89d2\u7684\u77e9\u5f62\uff0c\u5c31\u662f\u56db\u4e2a\u8fb9\u89d2\u90fd\u88ab\u5706\u906e\u6321\u7684\u77e9\u5f62\u3002\\r\\n\\r\\n![](./img/rect-and-circle.png)\\r\\n\\r\\n### \u5f84\u5411\u6e10\u53d8\\r\\n\\r\\n\u77e5\u9053\u5706\u906e\u6321\u77e9\u5f62\u7684\u539f\u7406\u540e\uff0c\u6211\u4eec\u6700\u5bb9\u6613\u60f3\u5230\u7684\u529e\u6cd5\u662f \u2014\u2014 \u5148\u7528 50% \u7684 border-radius \u5f97\u5230\u5706\uff0c\u518d\u6539\u53d8\u5706\u5f62\u7684\u5b9a\u4f4d\u53bb\u906e\u6321\u77e9\u5f62\u3002\\r\\n\\r\\n\u4e0d\u8fc7\u8fd9\u79cd\u65b9\u6cd5\u9700\u8981\u591a\u4e2a\u5143\u7d20\uff0c\u5e76\u4e0d\u4f18\u96c5\uff0c\u6211\u5c06\u4ecb\u7ecd\u53e6\u4e00\u79cd\u66f4\u5de7\u5999\u7684\u529e\u6cd5\u3002\\r\\n\\r\\n\u6211\u4eec\u9700\u8981\u5148\u4e86\u89e3\u4e00\u4e2a CSS \u51fd\u6570 \u2014\u2014 [radial-gradient](https://developer.mozilla.org/zh-CN/docs/Web/CSS/gradient/radial-gradient)\u3002`radial-gradient` \u4e2d\u6587\u540d\u79f0\u662f\u5f84\u5411\u6e10\u53d8\uff0c\u5b83\u53ef\u4ee5\u6307\u5b9a\u6e10\u53d8\u7684\u4e2d\u5fc3\u3001\u5f62\u72b6\u3001\u989c\u8272\u548c\u7ed3\u675f\u4f4d\u7f6e\u3002\u8bed\u6cd5\u5982\u4e0b\uff1a\\r\\n\\r\\n```css\\r\\n/*\\r\\n * \u5f62\u72b6 at \u4f4d\u7f6e\\r\\n * \u6e10\u53d8\u989c\u8272 \u6e10\u53d8\u4f4d\u7f6e\\r\\n * ...\\r\\n * \u6e10\u53d8\u989c\u8272 \u6e10\u53d8\u4f4d\u7f6e\\r\\n */\\r\\nbackground-image:\\r\\n  radial-gradient(\\r\\n    circle at center,\\r\\n    transparent 0,\\r\\n    transparent 20px,\\r\\n    #ddd 20px\\r\\n  );\\r\\n```\\r\\n\\r\\n### \u5229\u7528\u5f84\u5411\u6e10\u53d8\u5728\u77e9\u5f62\u4e2d\u5fc3\u753b\u5706\\r\\n\\r\\n\u5149\u770b\u8bed\u6cd5\u6bd4\u8f83\u62bd\u8c61\uff0c\u6211\u4eec\u7528\u4ee3\u7801\u5199\u4e00\u4e2a\u5b9e\u9645\u7684\u4f8b\u5b50\u3002\u5982\u56fe\u6240\u793a\uff0c\u6211\u4eec\u8981\u5728\u77e9\u5f62\u4e2d\u5fc3\u753b\u5706\uff1a\\r\\n\\r\\n![](./img/rect0.png)\\r\\n\\r\\n\u4e0b\u9762\u662f\u5173\u952e\u4ee3\u7801\uff1a\\r\\n\\r\\n```css\\r\\nbackground: radial-gradient(\\r\\n  circle at center,\\r\\n  transparent 0,\\r\\n  transparent 20px,\\r\\n  #ddd 20px\\r\\n);\\r\\n```\\r\\n\\r\\n\u5176\u4e2d\uff1a\\r\\n\\r\\n- `radial-gradient` \u51fd\u6570\u7528\u4e8e\u521b\u5efa\u6e10\u53d8\u6548\u679c\u3002\\r\\n- `circle at center` \u6307\u5b9a\u4e86\u5706\u5f62\u6e10\u53d8\uff0c\u5e76\u4e14\u6e10\u53d8\u7684\u4e2d\u5fc3\u5728\u77e9\u5f62\u7684\u4e2d\u5fc3\u3002\\r\\n- `transparent 0` \u6307\u5b9a\u4e86\u7b2c\u4e00\u4e2a\u6e10\u53d8\u989c\u8272\u4e3a\u900f\u660e\uff0c\u4f4d\u7f6e\u662f\u4ece\u4e2d\u5fc3\u5f00\u59cb\u3002\\r\\n- `transparent 20px` \u6307\u5b9a\u4e86\u7b2c\u4e8c\u4e2a\u6e10\u53d8\u989c\u8272\u4e5f\u4e3a\u900f\u660e\uff0c\u4f4d\u7f6e\u8ddd\u79bb\u4e2d\u5fc3 20px\u3002\\r\\n- `#ddd 20px` \u6307\u5b9a\u4e86\u7b2c\u4e09\u4e2a\u6e10\u53d8\u989c\u8272\u4e3a\u6de1\u7070\u8272\uff0c\u4f4d\u7f6e\u8ddd\u79bb\u4e2d\u5fc3 20px\uff0c\u7b2c\u4e09\u4e2a\u6e10\u53d8\u989c\u8272\u4e4b\u540e\u7684\u989c\u8272\u90fd\u662f\u6de1\u7070\u8272\u3002\\r\\n\\r\\n\u901a\u8fc7 `radial-gradient`\uff0c\u6211\u4eec\u6210\u529f\u8ba9\u77e9\u5f62\u4e2d\u5fc3\u3001\u534a\u5f84\u4e3a 20px \u7684\u5706\u53d8\u900f\u660e\uff0c\u8d85\u8fc7\u534a\u5f84 20px \u7684\u5730\u65b9\u989c\u8272\u90fd\u53d8\u4e3a\u7070\u8272\uff0c\u8fd9\u6837\u770b\u8d77\u6765\u5c31\u662f\u77e9\u5f62\u4e2d\u5fc3\u6709\u4e00\u4e2a\u5706\u3002\\r\\n\\r\\n### \u77e9\u5f62\u5de6\u4e0a\u89d2\u753b\u5706\\r\\n\\r\\n\u4e0d\u96be\u60f3\u5230\uff0c\u53ea\u8981\u6211\u4eec\u628a\u5706\u7684\u4e2d\u5fc3\u4ece\u77e9\u5f62\u4e2d\u5fc3\u79fb\u52a8\u5230\u77e9\u5f62\u7684\u5de6\u4e0a\u89d2\uff0c\u5c31\u53ef\u4ee5\u8ba9\u5706\u6321\u4f4f\u77e9\u5f62\u5de6\u4e0a\u89d2\uff0c\u5f97\u5230\u4e00\u4e2a\u53cd\u5411\u5706\u89d2\u3002\\r\\n\\r\\n![](./img/rect1.png)\\r\\n\\r\\n\u5173\u952e\u4ee3\u7801\u5982\u4e0b\uff0c\u6211\u4eec\u53ef\u4ee5\u628a `circle at center` \u6539\u5199\u4e3a `circle at left top`\uff1a\\r\\n\\r\\n```css\\r\\nbackground: radial-gradient(\\r\\n  circle at left top,\\r\\n  transparent 0,\\r\\n  transparent 20px,\\r\\n  #ddd 20px\\r\\n);\\r\\n```\\r\\n\\r\\n### \u77e9\u5f62\u56db\u4e2a\u89d2\u753b\u5706\\r\\n\\r\\n\u6211\u4eec\u5df2\u7ecf\u77e5\u9053 `radial-gradient` \u5982\u4f55\u5b9e\u73b0 1 \u4e2a\u53cd\u5411\u5706\u89d2\uff0c\u63a5\u4e0b\u6765\u518d\u770b\u5982\u4f55\u5b9e\u73b0 4 \u4e2a\u53cd\u5411\u5706\u89d2\u3002\u7ee7\u7eed\u4e4b\u524d\u7684\u601d\u8def\uff0c\u6211\u4eec\u5f88\u5bb9\u6613\u60f3\u5230\u7ed9 `background` \u8bbe\u7f6e\u591a\u4e2a\u53cd\u5411\u6e10\u53d8\u3002\\r\\n\\r\\n\u591a\u4e2a\u6e10\u53d8\u4e4b\u95f4\u53ef\u4ee5\u7528\u9017\u53f7\u5206\u9694\u3001\u4e14\u5b83\u4eec\u4f1a\u6309\u7167\u58f0\u660e\u7684\u987a\u5e8f\u4f9d\u6b21\u5806\u53e0\u3002\u4e8e\u662f\u6211\u4eec\u4f1a\u5199\u51fa\u5982\u4e0b\u5173\u952e\u4ee3\u7801\uff1a\\r\\n\\r\\n```css\\r\\nbackground: radial-gradient(\\r\\n  circle at left top,\\r\\n  transparent 0,\\r\\n  transparent 20px,\\r\\n  #ddd 20px\\r\\n),\\r\\n/* ... */\\r\\nradial-gradient(\\r\\n  circle at right bottom,\\r\\n  transparent 0,\\r\\n  transparent 20px,\\r\\n  #ddd 20px\\r\\n);\\r\\n```\\r\\n\\r\\n\u9057\u61be\u7684\u662f\uff0c\u4e0a\u8ff0\u4ee3\u7801\u8fd0\u884c\u540e\u6211\u4eec\u770b\u4e0d\u5230\u56db\u4e2a\u53cd\u5411\u5706\u89d2\uff0c\u800c\u662f\u770b\u5230\u4e00\u4e2a\u77e9\u5f62\u3002\\r\\n\\r\\n![](./img/rect.png)\\r\\n\\r\\n\\r\\n\u8fd9\u662f\u56e0\u4e3a\u56db\u4e2a\u77e9\u5f62\u4e92\u76f8\u5806\u53e0\uff0c\u53cd\u800c\u628a\u53cd\u5411\u5706\u89d2\u7ed9\u906e\u4f4f\u4e86\u3002\\r\\n\\r\\n![](./img/overlay.png)\\r\\n\\r\\n\u906e\u6321\u600e\u4e48\u89e3\u51b3\u5462\uff1f\u6211\u4eec\u53ef\u4ee5\u5206\u56db\u6b65\u6765\u89e3\u51b3\u3002\\r\\n\\r\\n#### \u8bbe\u7f6e\u80cc\u666f\u5bbd\u5ea6\u548c\u9ad8\u5ea6\\r\\n\\r\\n\u6211\u4eec\u5148\u5355\u72ec\u770b\u4e00\u4e2a\u5f84\u5411\u6e10\u53d8\u3002\\r\\n\\r\\n\u7b2c\u4e00\u6b65\u662f\u8bbe\u7f6e `background-size: 50% 50%;`\uff0c\u5b83\u8bbe\u7f6e\u4e86\u80cc\u666f\u56fe\u50cf\u7684\u5927\u5c0f\u662f\u5bb9\u5668\u5bbd\u5ea6\u548c\u9ad8\u5ea6\u7684 50%\u3002\u4ee3\u7801\u8fd0\u884c\u540e\u6548\u679c\u5982\u4e0b\uff1a\\r\\n\\r\\n![](./img/background-size.png)\\r\\n\\r\\n\u53ef\u4ee5\u770b\u5230\u5de6\u4e0a\u89d2\u6709\u53cd\u5411\u5706\u89d2\u7684\u77e9\u5f62\u91cd\u590d\u51fa\u73b0\u4e86\u56db\u6b21\u3002\\r\\n\\r\\n#### \u8bbe\u7f6e\u4e0d\u5141\u8bb8\u91cd\u590d\\r\\n\\r\\n\u7b2c\u4e8c\u6b65\u662f\u8bbe\u7f6e `background-repeat: no-repeat;`\u3002\u6211\u4eec\u9700\u8981\u53bb\u9664\u7b2c\u4e00\u6b65\u4e2d\u51fa\u73b0\u7684\u91cd\u590d\u3002\u4ee3\u7801\u8fd0\u884c\u540e\u6548\u679c\u5982\u4e0b\uff1a\\r\\n\\r\\n![](./img/no-repeat.png)\\r\\n\\r\\n#### \u7ed9\u6bcf\u4e2a\u5f84\u5411\u6e10\u53d8\u8bbe\u7f6e\u4f4d\u7f6e\\r\\n\u7b2c\u4e09\u6b65\u662f\u8bbe\u7f6e\u4e0d\u5141\u8bb8\u91cd\u590d\u65f6\uff0c\u5e94\u8be5\u4fdd\u7559\u7684\u80cc\u666f\u56fe\u50cf\u4f4d\u7f6e\u3002\\r\\n\\r\\n\u7b2c\u4e00\u6b65\u4e2d\u5de6\u4e0a\u89d2\u662f\u53cd\u5411\u5706\u89d2\u7684\u77e9\u5f62\u51fa\u73b0\u4e86\u56db\u6b21\uff0c\u7b2c\u4e8c\u6b65\u4e0d\u5141\u8bb8\u91cd\u590d\u65f6\u9ed8\u8ba4\u4fdd\u7559\u4e86\u5de6\u4e0a\u89d2\u7684\u77e9\u5f62\u3002\u4e8b\u5b9e\u4e0a\u6211\u4eec\u53ef\u4ee5\u9009\u62e9\u4fdd\u7559\u56db\u4e2a\u77e9\u5f62\u4e2d\u7684\u4efb\u4f55\u4e00\u4e2a\uff0c\u6bd4\u5982\u6211\u4eec\u53ef\u4ee5\u9009\u62e9\u4fdd\u7559\u53f3\u4e0b\u89d2\u7684\u77e9\u5f62\u3002\\r\\n\\r\\n```css\\r\\nbackground: \\r\\n  radial-gradient(\\r\\n    circle at left top,\\r\\n    transparent 0,\\r\\n    transparent 20px,\\r\\n    #ddd 20px\\r\\n  )\\r\\n  right bottom;\\r\\n```\\r\\n\\r\\n\u4ee3\u7801\u8fd0\u884c\u540e\u6548\u679c\u5982\u4e0b\uff1a\\r\\n\\r\\n![](./img/no-repeat-right-bottom.png)\\r\\n\\r\\n#### \u7ec4\u5408\u524d\u4e09\u4e2a\u6b65\u9aa4\\r\\n\\r\\n\u7b2c\u56db\u6b65\u662f\u7ec4\u5408\u524d\u4e09\u4e2a\u6b65\u9aa4\u7684\u8bed\u6cd5\u3002\\r\\n\\r\\n\u770b\u5b8c\u7b2c\u4e09\u6b65\u540e\uff0c\u4e00\u4e2a\u5f88\u81ea\u7136\u7684\u60f3\u6cd5\uff0c\u5c31\u662f\u7528\u56db\u4e2a\u6e10\u53d8\u5206\u522b\u5f62\u6210\u56db\u4e2a\u7279\u6b8a\u77e9\u5f62\uff0c\u7136\u540e\u628a\u56db\u4e2a\u7279\u6b8a\u77e9\u5f62\u5206\u522b\u653e\u5728\u5de6\u4e0a\u3001\u53f3\u4e0a\u3001\u5de6\u4e0b\u548c\u53f3\u4e0b\u89d2\uff0c\u6700\u540e\u5f97\u5230\u6709\u56db\u4e2a\u53cd\u5411\u5706\u89d2\u7684\u77e9\u5f62\u3002\\r\\n\\r\\n\u5173\u952e\u4ee3\u7801\u5982\u4e0b,\u4e3a\u4e86\u533a\u5206\u56db\u4e2a\u5f84\u5411\u6e10\u53d8\uff0c\u6211\u7ed9\u5de6\u4e0a\u3001\u53f3\u4e0a\u3001\u5de6\u4e0b\u3001\u53f3\u4e0b\u5206\u522b\u8bbe\u7f6e\u4e86\u7ea2\u3001\u7eff\u3001\u84dd\u3001\u9ec4\u56db\u79cd\u989c\u8272\uff1a\\r\\n\\r\\n```css\\r\\nbackground: radial-gradient(\\r\\n      circle at left top,\\r\\n      transparent 0,\\r\\n      transparent 20px,\\r\\n      red 20px\\r\\n    )\\r\\n    left top,\\r\\n  radial-gradient(\\r\\n      circle at right top,\\r\\n      transparent 0,\\r\\n      transparent 20px,\\r\\n      green 20px\\r\\n    )\\r\\n    right top,\\r\\n  radial-gradient(\\r\\n      circle at left bottom,\\r\\n      transparent 0,\\r\\n      transparent 20px,\\r\\n      blue 20px\\r\\n    )\\r\\n    left bottom,\\r\\n  radial-gradient(\\r\\n      circle at right bottom,\\r\\n      transparent 0,\\r\\n      transparent 20px,\\r\\n      yellow 20px\\r\\n    )\\r\\n    right bottom;\\r\\nbackground-repeat: no-repeat;\\r\\nbackground-size: 50% 50%;\\r\\n```\\r\\n\\r\\n\u4ee3\u7801\u8fd0\u884c\u6548\u679c\u5982\u4e0b\uff1a\\r\\n\\r\\n![](./img/rect2.png)\\r\\n\\r\\n\u4e0d\u96be\u60f3\u5230\uff0c\u53ea\u8981\u628a\u7ea2\u3001\u7eff\u3001\u84dd\u3001\u9ec4\u90fd\u6362\u4e3a\u7070\u8272\uff0c\u5c31\u53ef\u4ee5\u5f97\u5230\u4e00\u4e2a\u5168\u7070\u3001\u6709\u56db\u4e2a\u53cd\u5411\u5706\u89d2\u7684\u77e9\u5f62\u3002\\r\\n\\r\\n![](./img/rect2-gray.png)\\r\\n\\r\\n### \u628a\u80cc\u666f\u6539\u5199\u4e3a\u906e\u7f69\\r\\n\\r\\n\u77e5\u9053\u56db\u4e2a\u53cd\u5411\u5706\u89d2\u7684\u77e9\u5f62\u5982\u4f55\u5b9e\u73b0\u540e\uff0c\u6211\u4eec\u53ef\u4ee5\uff1a\\r\\n\\r\\n- \u628a `background-size` \u6539\u5199\u4e3a `mask-size`\uff1b\\r\\n- \u628a `background-repeat` \u6539\u5199\u4e3a `mask-repeat`;\\r\\n- \u628a `background` \u6539\u5199\u4e3a `mask`\uff1b\\r\\n\\r\\n\u8fd9\u6837\u5c31\u53ef\u4ee5\u5f97\u5230\u56db\u4e2a\u53cd\u5411\u5706\u89d2\u7684\u77e9\u5f62\u906e\u7f69\u3002\\r\\n\\r\\n```css\\r\\nmask: radial-gradient(\\r\\n      circle at left top,\\r\\n      transparent 0,\\r\\n      transparent 20px,\\r\\n      #ddd 20px\\r\\n    )\\r\\n    left top,\\r\\n  radial-gradient(\\r\\n      circle at right top,\\r\\n      transparent 0,\\r\\n      transparent 20px,\\r\\n      red 20px\\r\\n    )\\r\\n    right top,\\r\\n  radial-gradient(\\r\\n      circle at left bottom,\\r\\n      transparent 0,\\r\\n      transparent 20px,\\r\\n      red 20px\\r\\n    )\\r\\n    left bottom,\\r\\n  radial-gradient(\\r\\n      circle at right bottom,\\r\\n      transparent 0,\\r\\n      transparent 20px,\\r\\n      red 20px\\r\\n    )\\r\\n    right bottom;\\r\\nmask-size: 50% 50%;\\r\\nmask-repeat: no-repeat;\\r\\n```\\r\\n\\r\\n\u6211\u4eec\u53ef\u4ee5\u628a\u56db\u4e2a\u53cd\u5411\u5706\u89d2\u7684\u77e9\u5f62\u8986\u76d6\u5728\u4e00\u5f20\u80cc\u666f\u56fe\u7247\u4e0a\uff0c\u5c31\u5f97\u5230\u4e86\u548c\u70ed\u98ce\u5c0f\u7a0b\u5e8f\u4e00\u6837\u7684\u6548\u679c\uff1a\\r\\n\\r\\n![](./img/rect3.png)\\r\\n\\r\\n\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u90e8\u5206\u624b\u673a\u6d4f\u89c8\u5668\u4e0d\u652f\u6301 mask \u8bed\u6cd5\uff0c\u6240\u4ee5\u6211\u4eec\u6709\u5fc5\u8981\u518d\u8bbe\u7f6e\u4e00\u4efd `-webkit-mask`\u3001`-webkit-mask-size` \u548c `-webkit-mask-repeat`\u3002\\r\\n\\r\\n## \u4ee3\u7801\u793a\u4f8b\\r\\n\\r\\n[\u56db\u4e2a\u53cd\u5411\u5706\u89d2\u7684\u56fe\u7247 | codepen](https://codepen.io/lijunlin2022/pen/GReBjEO)\\r\\n\\r\\n## \u603b\u7ed3\\r\\n\\r\\n\u672c\u6587\u6211\u4eec\u4ecb\u7ecd\u4e86\u5982\u4f55\u5b9e\u73b0\u56db\u4e2a\u53cd\u5411\u5706\u89d2\u7684\u56fe\u7247\u3002\\r\\n\\r\\n\u6211\u4eec\u53ef\u4ee5\u5229\u7528\u5f84\u5411\u6e10\u53d8\uff0c\u5b9e\u73b0\u56db\u4e2a\u53cd\u5411\u5706\u89d2\u7684\u77e9\u5f62\u3002\u7136\u540e\u6211\u4eec\u628a\u8fd9\u4e2a\u77e9\u5f62\u4f5c\u4e3a\u906e\u7f69\uff0c\u8986\u76d6\u5728\u80cc\u666f\u56fe\u7247\u4e0a\uff0c\u8fd9\u6837\u5c31\u5b9e\u73b0\u4e86\u56db\u4e2a\u53cd\u5411\u5706\u89d2\u7684\u56fe\u7247\u3002"},{"id":"/2024/02/16/variable-height-swiper","metadata":{"permalink":"/blog/2024/02/16/variable-height-swiper","source":"@site/blog/2024-02-16-variable-height-swiper/index.md","title":"H5\u3001\u5c0f\u7a0b\u5e8f\u9ad8\u5ea6\u53d8\u5316\u7684\u8f6e\u64ad\u56fe\u5982\u4f55\u5b9e\u73b0\uff1f","description":"\u9ad8\u5ea6\u56fa\u5b9a\u7684\u8f6e\u64ad\u56fe\uff0c\u4f60\u80af\u5b9a\u7ecf\u5e38\u770b\u5230\u3001\u5e76\u77e5\u9053\u600e\u4e48\u5b9e\u73b0\uff0c\u4f46\u9ad8\u5ea6\u53d8\u5316\u7684\u8f6e\u64ad\u56fe\u5462\uff1f","date":"2024-02-16T00:00:00.000Z","tags":[{"inline":true,"label":"H5","permalink":"/blog/tags/h-5"},{"inline":true,"label":"\u5c0f\u7a0b\u5e8f","permalink":"/blog/tags/\u5c0f\u7a0b\u5e8f"}],"readingTime":4.29,"hasTruncateMarker":false,"authors":[],"frontMatter":{"tags":["H5","\u5c0f\u7a0b\u5e8f"]},"unlisted":false,"prevItem":{"title":"H5\u3001\u5c0f\u7a0b\u5e8f\u4e2d\u56db\u4e2a\u53cd\u5411\u5706\u89d2\u7684\u56fe\u7247\u5982\u4f55\u5b9e\u73b0\uff1f","permalink":"/blog/2024/02/19/reverse-border-radius"},"nextItem":{"title":"H5 \u86df\u9f99\u95f9\u6d77\u52a8\u753b\u5982\u4f55\u5b9e\u73b0\uff08\u4e0d\u5f15\u7528\u56fe\u7247\uff09\uff1f","permalink":"/blog/2024/02/09/dragon-troubles-the-sea"}},"content":"\u9ad8\u5ea6\u56fa\u5b9a\u7684\u8f6e\u64ad\u56fe\uff0c\u4f60\u80af\u5b9a\u7ecf\u5e38\u770b\u5230\u3001\u5e76\u77e5\u9053\u600e\u4e48\u5b9e\u73b0\uff0c\u4f46\u9ad8\u5ea6\u53d8\u5316\u7684\u8f6e\u64ad\u56fe\u5462\uff1f\\r\\n\\r\\n\u4e0b\u9762\u662f Keep \u7684\u8bfe\u7a0b\u8f6e\u64ad\uff0c\u53ef\u4ee5\u770b\u5230 9 \u53f7\u7684\u89c6\u9891\u6570\u91cf\u662f\u5c11\u4e8e 10 \u53f7\u548c 11 \u53f7\u7684\uff0c\u6240\u4ee5 9 \u53f7\u7684\u89c6\u9891\u5217\u8868\u7684\u9ad8\u5ea6\u6bd4 10\u300111 \u53f7\u4f4e\u3002\u5f53\u64ad\u653e\u5230 9 \u53f7\u8bfe\u7a0b\u65f6\uff0c\u4e0b\u65b9\u7684\u4e3b\u9898\u8bfe\u7a0b\u6a21\u5757\u4f1a\u5f80\u4e0a\u79fb\u52a8\uff0c\u586b\u5145 9 \u53f7\u89c6\u9891\u5217\u8868\u4e0b\u65b9\u7684\u7a7a\u767d\u3002\\r\\n\\r\\n![](./img/keep.gif)\\r\\n\\r\\n\u5982\u679c\u4f60\u4e5f\u60f3\u5b9e\u73b0\u9ad8\u5ea6\u53d8\u5316\u7684\u8f6e\u64ad\uff0c\u770b\u5b8c\u8fd9\u7bc7\u6587\u7ae0\uff0c\u4f60\u4e00\u5b9a\u6709\u6240\u6536\u83b7\u3002\u6211\u4f1a\u5148\u89e3\u91ca\u9ad8\u5ea6\u53d8\u5316\u7684\u539f\u7406\uff0c\u7136\u540e\u8bf4\u660e\u5173\u952e\u5b9e\u73b0\uff0c\u6700\u540e\u518d\u7ed9\u51fa\u539f\u751f H5 \u548c\u5c0f\u7a0b\u5e8f\u7684\u793a\u4f8b\u4ee3\u7801\u3002\u4ee3\u7801\u6548\u679c\u5982\u4e0b\uff1a\\r\\n\\r\\n![](./img/variable-height-swiper.gif)\\r\\n\\r\\n## \u9ad8\u5ea6\u53d8\u5316\u7684\u539f\u7406\\r\\n\\r\\n\u5982\u679c\u6211\u4eec\u4f7f\u7528 flex \u5e03\u5c40\u5b9e\u73b0\u8f6e\u64ad\u56fe Swiper\uff0c\u90a3\u4e48\u8f6e\u64ad\u56fe\u7684\u6574\u4f53\u9ad8\u5ea6\uff0c\u5c06\u4f1a\u662f\u6700\u9ad8\u4e00\u9879\u7684\u9ad8\u5ea6\u3002\\r\\n\\r\\n\u5982\u4e0b\u56fe\uff0c\u865a\u7ebf\u6846\u4ee3\u8868 Swiper\uff0cSwiper \u7684\u6bcf\u9879\u90fd\u662f List\u3002\u5982\u679c\u64ad\u653e\u5230\u67d0\u4e2a List\uff0c\u8fd9\u4e2a List \u5c31\u662f\u7ea2\u8272\u3002\u53ef\u4ee5\u770b\u5230\uff0c\u53ea\u8981\u8f6e\u64ad\u56fe\u64ad\u653e\u5230\u8f83\u77ee\u9879\uff0c\u5c31\u4f1a\u5728\u8f83\u77ee\u9879\u5e95\u90e8\u7559\u4e0b\u5927\u91cf\u7a7a\u767d\u3002\\r\\n\\r\\n![](./img/principle-1.png)\\r\\n\\r\\n\u8981\u60f3\u5b9e\u73b0\u9ad8\u5ea6\u53d8\u5316\u3001\u4e14\u4e0d\u7559\u4e0b\u7a7a\u767d\u7684\u8f6e\u64ad\u56fe\uff0c\u539f\u7406\u5f88\u7b80\u5355\u3002\u6211\u4eec\u53ea\u9700\u8981\u5728\u8f6e\u64ad\u5207\u6362\u65f6\uff0c\u5148\u83b7\u53d6\u5373\u5c06\u64ad\u653e\u7684 List \u9ad8\u5ea6\uff0c\u518d\u628a\u5b83\u7684\u9ad8\u5ea6\u8bbe\u7f6e\u7ed9 Swiper\u3002\\r\\n\\r\\n\u5982\u4e0b\u56fe\uff0c\u64ad\u653e\u5230\u67d0\u4e2a List\uff0cSwiper \u7684\u9ad8\u5ea6\u5c31\u53d8\u4e3a\u8fd9\u4e2a List \u7684\u9ad8\u5ea6\u3002\u6211\u4eec\u8fd8\u53ef\u4ee5\u7ed9 Swiper \u8bbe\u7f6e `overflow: hidden;`\uff0c\u628a\u627e\u51fa Swiper \u8303\u56f4\u7684\u5143\u7d20\u90fd\u7ed9\u9690\u85cf\u6389\u3002\\r\\n\\r\\n![](./img/principle-2.png)\\r\\n\\r\\n## \u5173\u952e\u4ee3\u7801\u5b9e\u73b0\\r\\n\\r\\n\u804a\u5b8c\u539f\u7406\uff0c\u6211\u4eec\u6765\u770b\u4ee3\u7801\uff0c\u4ee3\u7801\u975e\u5e38\u7b80\u5355\u7c97\u66b4\u3002\\r\\n\\r\\n\u6211\u4eec\u4e3a\u6bcf\u4e2a List \u90fd\u8bbe\u7f6e\u4e86\u4e00\u4e2a id\uff0c\u5229\u7528 id \u83b7\u53d6 List \u7684\u9ad8\u5ea6\u518d\u8bbe\u7f6e\u5230 Swiper \u5143\u7d20\u7684 style \u4e0a\u3002\\r\\n\\r\\n```js\\r\\nfunction updateSwiperHeight (currentIndex) {\\r\\n  const height = document.querySelector(`#item-box-${currentIndex}`).offsetHeight\\r\\n  swiper.style.height = height + \'px\'\\r\\n  swiper.style.overflow = \'hidden\'\\r\\n}\\r\\n```\\r\\n\\r\\n## \u4ee3\u7801\u793a\u4f8b\\r\\n\\r\\n\u73b0\u5728\u6765\u770b H5 \u548c\u5c0f\u7a0b\u5e8f\u7684\u4ee3\u7801\u793a\u4f8b\uff0c\u4e3a\u4e86\u7a81\u51fa\u91cd\u70b9\uff0c\u6211\u5e76\u6ca1\u6709\u5b9e\u73b0\u5de6\u53f3\u6ed1\u52a8\uff0c\u800c\u662f\u7528\u70b9\u51fb\u5207\u6362\u8fd1\u4f3c\u66ff\u4ee3\uff1a\\r\\n\\r\\n### H5\\r\\n\\r\\n[\u9ad8\u5ea6\u53d8\u5316\u7684\u8f6e\u64ad\u56fe | codepen](https://codepen.io/lijunlin2022/pen/qBLxNzQ)\\r\\n\\r\\n### \u5c0f\u7a0b\u5e8f\\r\\n\\r\\n[\u9ad8\u5ea6\u53d8\u5316\u7684\u8f6e\u64ad\u56fe | \u5c0f\u7a0b\u5e8f](https://developers.weixin.qq.com/s/ct5irIm37eOg)\\r\\n\\r\\n:::info\\r\\n- \u5c0f\u7a0b\u5e8f\u6709\u539f\u751f\u7684 swiper \u7ec4\u4ef6\uff0c\u6211\u4eec\u53ef\u4ee5\u7ed9 swiper \u76f4\u63a5\u589e\u52a0\u4e00\u4e2a style\uff0c\u5728 style \u4e2d\u6539\u53d8 swiper \u7684\u9ad8\u5ea6\u3002\\r\\n- \u5c0f\u7a0b\u5e8f\u6ca1\u6709 `querySelector()`\uff0c\u53ef\u4ee5\u7528 `createSelectorQuery()` \u66ff\u4ee3\u3002\\r\\n:::\\r\\n\\r\\n## \u989d\u5916\u63d0\u9192\\r\\n\\r\\n\u9ad8\u5ea6\u53d8\u5316\u7684\u8f6e\u64ad\u56fe\u975e\u5e38\u5c11\u89c1\uff0c\u4f60\u9700\u8981\u4ed4\u7ec6\u659f\u914c\u4ec0\u4e48\u65f6\u5019\u7528\u5b83\u3002\\r\\n\\r\\n\u5982\u679c\u4f60\u4e0d\u9700\u8981\u5de6\u53f3\u6ed1\u52a8\uff0c\u90a3\u4e48\u9009\u62e9 Tab + \u5361\u7247\u66f4\u9002\u5408\u3002\u6bd4\u5982 12306 \u7684\u9009\u9879\u5361\uff0c\u9ad8\u5ea6\u5c31\u662f\u4e0d\u7b49\u7684\uff1a\\r\\n\\r\\n![](./img/12306.gif)\\r\\n\\r\\n\u5982\u679c\u8f6e\u64ad\u6bcf\u4e00\u9879\u8f6e\u64ad\u90fd\u662f\u957f\u5217\u8868\uff0c\u4e14\u968f\u7740\u7528\u6237\u4e0a\u62c9\u5c4f\u5e55\uff0c\u5217\u8868\u52a0\u8f7d\u7684\u6570\u636e\u8fd8\u4f1a\u53d8\u591a\u3002**\u8fd9\u79cd\u8f6e\u64ad\u901a\u5e38\u8fd8\u662f\u56fa\u5b9a\u9ad8\u5ea6\uff08100vh\uff09\u7684\u8f6e\u64ad**\u3002\\r\\n\\r\\n\u5b83\u5728\u62fc\u591a\u591a\u3001\u6dd8\u5b9d\u3001\u4eac\u4e1c\u4e0a\u5f88\u5e38\u89c1\u3002\u4f60\u9700\u8981\u6ce8\u610f\uff0c**\u8fd9\u79cd\u8f6e\u64ad\u6bcf\u4e00\u9879\u9700\u8981\u81ea\u5e26\u6eda\u52a8\u6761\uff0c\u5426\u5219\u5904\u7406\u5217\u8868\u6eda\u52a8\u6761\u4f1a\u53d8\u5f97\u975e\u5e38\u9ebb\u70e6**\u3002\u56e0\u4e3a\u8fd9\u79cd\u8f6e\u64ad\u5f80\u5f80\u8981\u6c42\u8bb0\u4f4f\u7528\u6237\u5728\u6bcf\u4e2a\u5217\u8868\u6eda\u52a8\u7684\u4f4d\u7f6e\uff0c\u5982\u679c\u8f6e\u64ad\u5171\u7528\u6eda\u52a8\u6761\uff0c\u5de6\u53f3\u5207\u6362\u4f1a\u6709\u4e00\u4e2a\u5f88\u660e\u663e\u7684\u95ea\u70c1\u3002\\r\\n\\r\\n![](./img/pdd.gif)\\r\\n\\r\\n## \u603b\u7ed3\\r\\n\\r\\n\u672c\u6587\u6211\u4eec\u4ecb\u7ecd\u4e86\u9ad8\u5ea6\u53d8\u5316\u7684\u8f6e\u64ad\u56fe\u5b9e\u73b0\u539f\u7406\u2014\u2014\u5148\u83b7\u53d6\u5bf9\u5e94\u8f6e\u64ad\u9879\u7684\u9ad8\u5ea6\uff0c\u518d\u6539\u53d8\u8f6e\u64ad\u56fe\u7684\u6574\u4f53\u9ad8\u5ea6\u3002\u4e4b\u540e\u6211\u4eec\u7ed9\u51fa\u4e86 H5 \u548c\u5c0f\u7a0b\u5e8f\u7684\u4ee3\u7801\u793a\u4f8b\u3002"},{"id":"/2024/02/09/dragon-troubles-the-sea","metadata":{"permalink":"/blog/2024/02/09/dragon-troubles-the-sea","source":"@site/blog/2024-02-09-dragon-troubles-the-sea/index.md","title":"H5 \u86df\u9f99\u95f9\u6d77\u52a8\u753b\u5982\u4f55\u5b9e\u73b0\uff08\u4e0d\u5f15\u7528\u56fe\u7247\uff09\uff1f","description":"\u9f99\u5e74\u8981\u5230\u4e86\uff0c\u795d\u5927\u5bb6\u5728\u65b0\u7684\u4e00\u5e74\u91cc\uff0c\u5982\u9f99\u817e\u98de\u3001\u4e8b\u4e1a\u6709\u6210\uff1b\u5982\u9f99\u5165\u6d77\u3001\u8d22\u6e90\u5e7f\u8fdb\u3002","date":"2024-02-09T00:00:00.000Z","tags":[{"inline":true,"label":"H5","permalink":"/blog/tags/h-5"}],"readingTime":3.855,"hasTruncateMarker":false,"authors":[],"frontMatter":{"tags":["H5"]},"unlisted":false,"prevItem":{"title":"H5\u3001\u5c0f\u7a0b\u5e8f\u9ad8\u5ea6\u53d8\u5316\u7684\u8f6e\u64ad\u56fe\u5982\u4f55\u5b9e\u73b0\uff1f","permalink":"/blog/2024/02/16/variable-height-swiper"},"nextItem":{"title":"H5\u3001\u5c0f\u7a0b\u5e8f\u5546\u54c1\u52a0\u5165\u8d2d\u7269\u8f66\u7684\u629b\u7269\u7ebf\u52a8\u753b\u5982\u4f55\u5b9e\u73b0\uff1f","permalink":"/blog/2024/02/03/parabolic-animation"}},"content":"\u9f99\u5e74\u8981\u5230\u4e86\uff0c\u795d\u5927\u5bb6\u5728\u65b0\u7684\u4e00\u5e74\u91cc\uff0c\u5982\u9f99\u817e\u98de\u3001\u4e8b\u4e1a\u6709\u6210\uff1b\u5982\u9f99\u5165\u6d77\u3001\u8d22\u6e90\u5e7f\u8fdb\u3002\\r\\n\\r\\n\u6211\u4f7f\u7528 HTML \u548c CSS \u5b9e\u73b0\u4e86\u4e00\u4e2a\u86df\u9f99\u95f9\u6d77\u6548\u679c\u3002\\r\\n\\r\\n![](./img/dragon-troubles-the-sea.gif)\\r\\n\\r\\n\u5b83\u5f88\u7b80\u7565\uff0c\u4f46\u662f\u4ee3\u7801\u4e2d\u6211\u6ca1\u6709\u5f15\u7528\u56fe\u7247\uff0c\u6211\u662f\u600e\u4e48\u505a\u7684\u5462\uff1f\\r\\n\\r\\n\u4e0b\u9762\u6211\u4f1a\u4ece\u4e0b\u5f80\u4e0a\u3001\u4f9d\u6b21\u89e3\u91ca\u5982\u4f55\u5b9e\u73b0\u6d77\u6d6a\u3001\u9f99\u548c\u4e91\u6735\uff0c\u63a5\u7740\u6211\u4f1a\u7ed9\u51fa\u6574\u4f53\u4ee3\u7801\uff0c\u6700\u540e\uff0c\u6211\u4f1a\u505a\u4e00\u4e2a\u7b80\u5355\u603b\u7ed3\u3002\\r\\n\\r\\n## \u6d77\u6d6a\u5982\u4f55\u5b9e\u73b0\\r\\n\\r\\n\u6211\u4f7f\u7528 2 \u4e2a\u4e0d\u540c border-radius \u5706\u89d2\u7684\u6b63\u65b9\u5f62\u5b9e\u73b0\u4e86\u6d77\u6d6a\u6548\u679c\u3002\u9996\u5148\uff0c\u6211\u5b9e\u73b0\u4e86\u4e00\u4e2a\u5706\u5f62\u548c\u4e24\u4e2a\u5706\u89d2\u6b63\u65b9\u5f62\uff0c\u7136\u540e\u628a\u4e24\u4e2a\u5706\u89d2\u6b63\u65b9\u5f62\u79fb\u52a8\u5230\u5706\u5f62\u7684\u5e95\u90e8\u3002\\r\\n\\r\\n![](./img/sea.png)\\r\\n\\r\\n\u7136\u540e\uff0c\u6211\u7ed9\u5706\u89d2\u6b63\u65b9\u5f62\u6dfb\u52a0\u65cb\u8f6c\u52a8\u753b\uff0c\\r\\n\\r\\n![](./img/sea.gif)\\r\\n\\r\\n\u4e4b\u540e\u7ed9\u5706\u5f62\u6dfb\u52a0 `overflow: hidden;`\uff0c\u5c31\u53ef\u4ee5\u5f97\u5230\u6d77\u6d6a\u6548\u679c\u3002\\r\\n\\r\\n![](./img/wave.gif)\\r\\n\\r\\n## \u9f99\u5982\u4f55\u5b9e\u73b0\\r\\n\\r\\n\u518d\u770b\u4e0b\u9f99\u5982\u4f55\u5b9e\u73b0\uff0c\u6211\u4f7f\u7528 `clip-path` \u5b9e\u73b0\u4e86\u9f99\u7684\u6548\u679c\u3002\\r\\n\\r\\n`clip-path` \u662f CSS \u4e00\u4e2a\u5c5e\u6027\uff0c\u53ef\u4ee5\u88c1\u526a\u5143\u7d20\u3002\u88c1\u526a\u533a\u57df\u5185\u7684\u663e\u793a\uff0c\u533a\u57df\u5916\u7684\u9690\u85cf\u3002\u53ef\u4ee5\u5229\u7528 `ploygon()` \u5b9a\u4e49\u591a\u4e2a\u9876\u70b9\uff0c\u8fde\u63a5\u597d\u540e\u5c31\u6210\u4e3a\u4e86\u591a\u8fb9\u5f62\u3002\\r\\n\\r\\n\u6211\u88c1\u526a\u4e86 10 \u4e2a\u591a\u8fb9\u5f62\uff0c\u7ec4\u5408\u6210\u4e86\u9f99\u3002\u5176\u4e2d 1 \u4e2a 8 \u8fb9\u5f62\u662f\u9f99\u5934\u30011 \u4e2a 4 \u8fb9\u5f62\u662f\u773c\u775b\u30012 \u4e2a 5 \u8fb9\u5f62\u662f\u9f99\u89d2\u30014 \u4e2a 4 \u8fb9\u5f62\u662f\u9b03\u6bdb\uff0c\u8fd8\u6709 1 \u4e2a 12 \u8fb9\u5f62\u662f\u8116\u5b50\u30011 \u4e2a 12 \u8fb9\u5f62\u662f\u809a\u5b50\u3002\\r\\n\\r\\n\u4e0d\u8fc7\uff0c\u4ee5\u6211\u7684\u8bbe\u8ba1\u7ecf\u9a8c\uff0c\u80af\u5b9a\u662f\u6ca1\u529e\u6cd5\u8f7b\u677e\u88c1\u526a\u51fa\u8fd9\u4e9b\u591a\u8fb9\u5f62\u7684\uff0c\u6211\u4f7f\u7528\u4e86 [clippy](https://www.jiangweishan.com/tool/clippy/) \u8fd9\u4e2a\u5de5\u5177\uff0c\u8fd9\u4e2a\u5de5\u5177\u53ef\u4ee5\u50cf\u63cf\u56fe\u4e00\u6837\u628a\u591a\u8fb9\u5f62\u88c1\u526a\u51fa\u6765\u3002\\r\\n\\r\\n![](./img/clippy-dragon.jpg)\\r\\n\\r\\n\u7406\u8bba\u4e0a\u88c1\u526a\u5f97\u8d8a\u7cbe\u7ec6\uff0c\u591a\u8fb9\u5f62\u6570\u91cf\u8d8a\u591a\uff0c\u63cf\u8fb9\u7684\u9f99\u5c31\u8d8a\u50cf\u3002\u8fd9\u662f\u7eaf\u7cb9\u7684\u4f53\u529b\u6d3b\uff0c\u6211\u8fd9\u91cc\u5077\u4e2a\u61d2\uff0c\u53ea\u88c1\u526a\u51fa\u5927\u6982\u7684\u5f62\u72b6\u3002\\r\\n\\r\\n## \u4e91\u6735\u5982\u4f55\u5b9e\u73b0\\r\\n\\r\\n\u5b9e\u73b0\u4e86\u9f99\uff0c\u6211\u4eec\u518d\u770b\u4e0b\u4e91\u6735\u5982\u4f55\u5b9e\u73b0\uff0c\u6211\u4f7f\u7528 6 \u4e2a\u5706\u91cd\u53e0\u5f62\u6210\u4e86\u4e91\u6735\u3002\\r\\n\\r\\n\u7b80\u5355\u753b 6 \u4e2a\u5706\uff0c\u5982\u4e0b\u6240\u793a\uff1a\\r\\n\\r\\n![](./img/cloud-border.png)\\r\\n\\r\\n\u53ea\u8981\u5c06\u8fd9\u4e9b\u5706\u7684\u8fb9\u6846\u5168\u90e8\u53d8\u900f\u660e\uff0c\u518d\u586b\u5145\u4e0a\u989c\u8272\uff0c\u5c31\u53ef\u4ee5\u5f97\u5230\u4e00\u6735\u4e91\u3002\\r\\n\\r\\n![](./img/cloud-fill.png)\\r\\n\\r\\n\u6211\u6ca1\u6709\u521b\u5efa 6 \u4e2a div \u5143\u7d20\u7136\u540e\u53e0\u52a0\uff0c\u800c\u662f\u4f7f\u7528\u4e86 box-shadow \u6765\u5b9e\u73b0\u3002box-shadow \u6700\u591a\u6709\u4e94\u4e2a\u53c2\u6570\u3002\\r\\n\\r\\n```css\\r\\n/* x \u504f\u79fb\u91cf | y \u504f\u79fb\u91cf | \u9634\u5f71\u6a21\u7cca\u534a\u5f84 | \u9634\u5f71\u6269\u6563\u534a\u5f84 | \u9634\u5f71\u989c\u8272 */\\r\\nbox-shadow: 2px 2px 2px 1px rgba(0, 0, 0, 0.2);\\r\\n```\\r\\n\\r\\n\u4e0d\u9700\u8981\u9634\u5f71\u6a21\u7cca\u534a\u5f84\u548c\u9634\u5f71\u6269\u6563\u534a\u5f84\uff0c\u53ea\u9700\u8981\u8bbe\u7f6e x \u504f\u79fb\u91cf\u548c y \u504f\u79fb\u91cf\uff0c\u5c31\u53ef\u4ee5\u5b9e\u73b0\u5706\u5f62\u7684\u504f\u79fb\uff1a\\r\\n\\r\\n```css\\r\\nbox-shadow:\\r\\n  10px 5px 0 0 #ddd,\\r\\n  10px -5px 0 0 #ddd,\\r\\n  20px 6px 0 0 #ddd,\\r\\n  20px 0 0 0 #ddd,\\r\\n  30px 0px 0 0 #ddd;\\r\\n```\\r\\n\\r\\n## \u793a\u4f8b\u4ee3\u7801\\r\\n\\r\\n\u73b0\u5728\uff0c\u6211\u4eec\u770b\u5b8c\u6574\u4ee3\u7801\uff1a\\r\\n\\r\\n[\u86df\u9f99\u95f9\u6d77 | codepen](https://codepen.io/lijunlin2022/pen/abQewmE)\\r\\n\\r\\n## \u603b\u7ed3\\r\\n\\r\\n\u672c\u6587\u6211\u4eec\u5229\u7528 HTML \u548c CSS \u5b9e\u73b0\u4e86\u4e00\u4e2a\u86df\u9f99\u95f9\u6d77\u6548\u679c\u3002\u5176\u4e2d\uff1a\\r\\n\\r\\n1.  \u6d77\u6d6a\uff0c\u53ef\u4ee5\u4f7f\u7528\u4e24\u4e2a\u65cb\u8f6c\u7684\u5706\u89d2\u6b63\u65b9\u5f62\u5b9e\u73b0\u3002\\r\\n2.  \u9f99\uff0c\u53ef\u4ee5\u4f7f\u7528 clip-path \u88c1\u526a\u591a\u8fb9\u5f62\uff0c\u518d\u62fc\u63a5\u591a\u8fb9\u5f62\u5b9e\u73b0\u3002\\r\\n3.  \u4e91\u6735\uff0c\u4e0d\u9700\u8981\u521b\u5efa\u591a\u4e2a\u5143\u7d20\uff0c\u53ef\u4ee5\u4f7f\u7528 box-shadow \u5e76\u8bbe\u7f6e\u591a\u7ec4\u503c\u5b9e\u73b0\u3002"},{"id":"/2024/02/03/parabolic-animation","metadata":{"permalink":"/blog/2024/02/03/parabolic-animation","source":"@site/blog/2024-02-03-parabolic-animation/index.md","title":"H5\u3001\u5c0f\u7a0b\u5e8f\u5546\u54c1\u52a0\u5165\u8d2d\u7269\u8f66\u7684\u629b\u7269\u7ebf\u52a8\u753b\u5982\u4f55\u5b9e\u73b0\uff1f","description":"\u7535\u5546\u7c7b H5\u3001\u5c0f\u7a0b\u5e8f\u628a\u5546\u54c1\u52a0\u5165\u5230\u8d2d\u7269\u8f66\u65f6\uff0c\u5e38\u5e38\u6709\u4e00\u4e2a\u629b\u7269\u7ebf\u52a8\u753b\u3002\u6bd4\u5982\u9ea6\u5f53\u52b3\u5c0f\u7a0b\u5e8f\uff0c\u5f53\u4f60\u70b9\u51fb\u52a0\u8d2d\u6309\u94ae\u65f6\uff0c\u4f1a\u770b\u5230\u6709\u4e00\u4e2a\u5c0f\u6c49\u5821\u4ece\u5361\u7247\u6c49\u5821\u4e0a\u629b\u51fa\uff0c\u7136\u540e\u6389\u843d\u5230\u8d2d\u7269\u888b\u91cc\u3002","date":"2024-02-03T00:00:00.000Z","tags":[{"inline":true,"label":"H5","permalink":"/blog/tags/h-5"},{"inline":true,"label":"\u5c0f\u7a0b\u5e8f","permalink":"/blog/tags/\u5c0f\u7a0b\u5e8f"}],"readingTime":4.065,"hasTruncateMarker":false,"authors":[],"frontMatter":{"tags":["H5","\u5c0f\u7a0b\u5e8f"]},"unlisted":false,"prevItem":{"title":"H5 \u86df\u9f99\u95f9\u6d77\u52a8\u753b\u5982\u4f55\u5b9e\u73b0\uff08\u4e0d\u5f15\u7528\u56fe\u7247\uff09\uff1f","permalink":"/blog/2024/02/09/dragon-troubles-the-sea"},"nextItem":{"title":"H5 \u79bb\u7ebf\u5305\u653e\u5165 HTML \u540e\u964d\u7ea7\u65b9\u6848\u5982\u4f55\u8bbe\u8ba1\uff1f","permalink":"/blog/2024/01/27/offline-package-rollback"}},"content":"\u7535\u5546\u7c7b H5\u3001\u5c0f\u7a0b\u5e8f\u628a\u5546\u54c1\u52a0\u5165\u5230\u8d2d\u7269\u8f66\u65f6\uff0c\u5e38\u5e38\u6709\u4e00\u4e2a\u629b\u7269\u7ebf\u52a8\u753b\u3002\u6bd4\u5982\u9ea6\u5f53\u52b3\u5c0f\u7a0b\u5e8f\uff0c\u5f53\u4f60\u70b9\u51fb\u52a0\u8d2d\u6309\u94ae\u65f6\uff0c\u4f1a\u770b\u5230\u6709\u4e00\u4e2a\u5c0f\u6c49\u5821\u4ece\u5361\u7247\u6c49\u5821\u4e0a\u629b\u51fa\uff0c\u7136\u540e\u6389\u843d\u5230\u8d2d\u7269\u888b\u91cc\u3002\\r\\n\\r\\n![](./img/mcdonald\'s.gif)\\r\\n\\r\\n\u8fd9\u79cd\u52a8\u753b\u8be5\u600e\u4e48\u505a\u5462\uff1f\u5982\u679c\u4f60\u4e5f\u60f3\u5b9e\u73b0\u5b83\uff0c\u770b\u5b8c\u8fd9\u7bc7\u6587\u7ae0\uff0c\u4f60\u4e00\u5b9a\u6709\u6240\u6536\u83b7\u3002\u6211\u4f1a\u5148\u8bf4\u660e\u629b\u7269\u7ebf\u52a8\u753b\u7684\u539f\u7406\uff0c\u518d\u89e3\u91ca\u5b9e\u73b0\u5b83\u7684\u5173\u952e\u4ee3\u7801\uff0c\u6700\u540e\u7ed9\u51fa\u5b8c\u6574\u7684\u4ee3\u7801\u793a\u4f8b\u3002\u4ee3\u7801\u6548\u679c\u5982\u4e0b\uff1a\\r\\n\\r\\n![](./img/parabola.gif)\\r\\n\\r\\n## \u629b\u7269\u7ebf\u52a8\u753b\u7684\u539f\u7406\\r\\n\\r\\n\u9ad8\u4e2d\u7269\u7406\u544a\u8bc9\u6211\u4eec\uff0c\u5e73\u629b\u8fd0\u52a8\u3001\u659c\u629b\u8fd0\u52a8\u53ef\u4ee5\u5206\u89e3\u4e3a\u6c34\u5e73\u65b9\u5411\u7684\u5300\u901f\u76f4\u7ebf\u8fd0\u52a8\u3001\u7ad6\u76f4\u65b9\u5411\u81ea\u7531\u843d\u4f53\u8fd0\u52a8\uff08\u5300\u52a0\u901f\u76f4\u7ebf\u8fd0\u52a8\uff09\u3002\\r\\n\\r\\n![](./img/principle.png)\\r\\n\\r\\n\u540c\u7406\uff0c\u6211\u4eec\u53ef\u4ee5\u628a\u629b\u7269\u7ebf\u52a8\u753b\u5206\u89e3\u4e3a\u6c34\u5e73\u7684\u5300\u901f\u52a8\u753b\u3001\u7ad6\u76f4\u7684\u5300\u52a0\u901f\u52a8\u753b\u3002\\r\\n\\r\\n\u6c34\u5e73\u5300\u901f\u52a8\u753b\u5f88\u5bb9\u6613\u5b9e\u73b0\uff0c\u76f4\u63a5 `animation-timing-function` \u53d6\u503c `linear` \u5c31\u884c\u3002\\r\\n\\r\\n\u7ad6\u76f4\u7684\u5300\u52a0\u901f\u76f4\u7ebf\u8fd0\u52a8\uff0c\u4e25\u683c\u5b9e\u73b0\u975e\u5e38\u56f0\u96be\uff0c\u6211\u4eec\u53ef\u4ee5\u8fd1\u4f3c\u5b9e\u73b0\u3002\u56e0\u4e3a\u5300\u52a0\u901f\u76f4\u7ebf\u8fd0\u52a8\uff0c\u901f\u5ea6\u662f\u8d8a\u6765\u8d8a\u5feb\u7684\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u7528\u4e00\u4e2a\u5148\u6162\u540e\u5feb\u7684\u52a8\u753b\u66ff\u4ee3\uff0c\u4f60\u53ef\u80fd\u7acb\u523b\u5c31\u60f3\u5230\u7ed9 `animation-timing-function` \u8bbe\u7f6e `ease-in`\u3002\u4e0d\u8fc7 `ease-in` \u5148\u6162\u540e\u5feb\u7684\u6548\u679c\u4e0d\u662f\u5f88\u660e\u663e\u3002\u9488\u5bf9\u8fd9\u4e2a\u95ee\u9898\uff0c\u5f20\u946b\u65ed\u5927\u4f6c\u63d0\u4f9b\u4e86\u4e00\u4e2a\u8d1d\u585e\u5c14\u66f2\u7ebf `cubic-bezier(0.55, 0, 0.85, 0.36);`[^1]\u3002\u5f53\u7136\uff0c\u4f60\u4e5f\u53ef\u4ee5\u7528 [cubic-bezier](https://cubic-bezier.com/) \u81ea\u5df1\u8c03\u4e00\u4e2a\u5148\u6162\u540e\u5feb\u7684\u8d1d\u585e\u5c14\u66f2\u7ebf\u3002\\r\\n\\r\\n## \u5173\u952e\u4ee3\u7801\u5b9e\u73b0\\r\\n\\r\\n\u6211\u4eec\u628a\u4ee3\u7801\u5206\u4e3a\u4e24\u90e8\u5206\uff0c\u7b2c\u4e00\u90e8\u5206\u662f\u5e03\u5c40\u4ee3\u7801\u3001\u7b2c\u4e8c\u90e8\u5206\u662f\u52a8\u753b\u4ee3\u7801\u3002\\r\\n\\r\\n### \u5e03\u5c40\u4ee3\u7801\\r\\n\\r\\n\u9996\u5148\u662f HTML \u4ee3\u7801\uff0c\u4ee3\u7801\u975e\u5e38\u7b80\u5355\u3002\u4e0b\u56fe\u4e2d\u5c0f\u7403\u4ee3\u8868\u5546\u54c1\u3001\u957f\u65b9\u5f62\u4ee3\u8868\u8d2d\u7269\u8f66\u3002\\r\\n\\r\\n![](./img/ball-and-cart.png)\\r\\n\\r\\n```html\\r\\n<div class=\\"ball-box\\">\\r\\n  <div class=\\"ball\\"></div>\\r\\n</div>\\r\\n<div class=\\"cart\\"></div>\\r\\n```\\r\\n\\r\\n\u4f60\u53ef\u80fd\u6bd4\u8f83\u597d\u5947\uff0c\u5c0f\u7403\u7528\u4e00\u4e2a ball \u5143\u7d20\u5c31\u53ef\u4ee5\u5b9e\u73b0\uff0c\u4e3a\u4ec0\u4e48\u6211\u8981\u7528 ball \u548c ball-box \u4e24\u4e2a\u5143\u7d20\u5462\uff1f\u56e0\u4e3a animation **\u53ea\u80fd\u7ed9\u4e00\u4e2a\u5143\u7d20\u5b9a\u4e49\u4e00\u4e2a\u52a8\u753b\u6548\u679c**\uff0c\u800c\u6211\u4eec\u9700\u8981\u7ed9\u5c0f\u7403\u6dfb\u52a0\u4e24\u4e2a\u52a8\u753b\u6548\u679c\u3002\u4e8e\u662f\u6211\u4eec\u5c06\u52a8\u753b\u5206\u89e3\uff0c\u7ed9 ball-box \u6dfb\u52a0\u6c34\u5e73\u8fd0\u52a8\u7684\u52a8\u753b\uff0c\u7ed9 ball \u6dfb\u52a0\u7ad6\u76f4\u8fd0\u52a8\u7684\u52a8\u753b\u3002\\r\\n\\r\\n### \u52a8\u753b\u4ee3\u7801\\r\\n\\r\\n\u518d\u770b\u52a8\u753b\u4ee3\u7801\uff0cmoveX \u662f\u6c34\u5e73\u8fd0\u52a8\u52a8\u753b\uff0cmoveY \u662f\u7ad6\u76f4\u52a8\u753b\uff0c\u52a8\u753b\u65f6\u95f4\u5747\u4e3a 1s\u3002\u4e3a\u4e86\u8ba9\u6548\u679c\u66f4\u52a0\u660e\u663e\uff0c\u6211\u8fd8\u7279\u610f\u5c06\u52a8\u753b\u8bbe\u7f6e\u6210\u65e0\u9650\u5faa\u73af\u7684\u52a8\u753b\u3002\\r\\n\\r\\n```css\\r\\n.ball-box {\\r\\n  /* ... */\\r\\n  animation: moveX 1s linear infinite;\\r\\n}\\r\\n\\r\\n.ball {\\r\\n  /* ... */\\r\\n  animation: moveY 1s cubic-bezier(0.55, 0, 0.85, 0.36) infinite;\\r\\n}\\r\\n\\r\\n@keyframes moveX {\\r\\n  to {\\r\\n    transform: translateX(-250px);\\r\\n  }\\r\\n}\\r\\n\\r\\n@keyframes moveY {\\r\\n  to {\\r\\n    transform: translateY(250px);\\r\\n  }\\r\\n}\\r\\n```\\r\\n\\r\\n## \u4ee3\u7801\u793a\u4f8b\\r\\n\\r\\n[\u629b\u7269\u7ebf\u52a8\u753b | codepen](https://codepen.io/lijunlin2022/pen/NWoLgyV)\\r\\n\\r\\n## \u603b\u7ed3\\r\\n\\r\\n\u672c\u6587\u6211\u4eec\u4ecb\u7ecd\u4e86\u629b\u7269\u7ebf\u52a8\u753b\u7684\u5b9e\u73b0\u65b9\u6cd5\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06\u629b\u7269\u7ebf\u52a8\u753b\u62c6\u5206\u4e3a\u6c34\u5e73\u5300\u901f\u76f4\u7ebf\u52a8\u753b\u548c\u7ad6\u76f4\u4ece\u6162\u53d8\u5feb\u7684\u52a8\u753b\uff0c\u6c34\u5e73\u52a8\u753b\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 linear \u6765\u5b9e\u73b0\uff0c\u7ad6\u76f4\u52a8\u753b\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u4e00\u4e2a\u5148\u6162\u540e\u5feb\u7684\u8d1d\u585e\u5c14\u66f2\u7ebf\u66ff\u4ee3\u3002\u8bbe\u7f6e\u52a8\u753b\u65f6\uff0c\u6211\u4eec\u8fd8\u9700\u8981\u6ce8\u610f\uff0c\u4e00\u4e2a\u5143\u7d20\u53ea\u80fd\u8bbe\u7f6e\u4e00\u4e2a\u52a8\u753b\u3002\\r\\n\\r\\n[^1]: [\u8fd9\u56de\u8bd5\u8bd5\u4f7f\u7528CSS\u5b9e\u73b0\u629b\u7269\u7ebf\u8fd0\u52a8\u6548\u679c | \u5f20\u946b\u65ed](https://www.zhangxinxu.com/wordpress/2018/08/css-css3-%e6%8a%9b%e7%89%a9%e7%ba%bf%e5%8a%a8%e7%94%bb/)"},{"id":"/2024/01/27/offline-package-rollback","metadata":{"permalink":"/blog/2024/01/27/offline-package-rollback","source":"@site/blog/2024-01-27-offline-package-rollback/index.md","title":"H5 \u79bb\u7ebf\u5305\u653e\u5165 HTML \u540e\u964d\u7ea7\u65b9\u6848\u5982\u4f55\u8bbe\u8ba1\uff1f","description":"\u79bb\u7ebf\u5305\u662f\u79fb\u52a8\u7aef H5 \u5e38\u89c1\u7684\u6027\u80fd\u4f18\u5316\u65b9\u6848\u3002\u5f00\u53d1\u8005\u4eec\u6216\u591a\u6216\u5c11\u90fd\u63a5\u89e6\u8fc7\u79bb\u7ebf\u5305\u3002francecil \u5927\u4f6c\u8fd8\u603b\u7ed3\u4e86\u79bb\u7ebf\u5305\u662f\u5426\u8981\u653e\u5165 HTML \u7684\u4e24\u79cd\u51b3\u7b56\uff0c\u4ee5\u53ca\u51b3\u7b56\u7684\u4f18\u7f3a\u70b9\uff1a \uff1a","date":"2024-01-27T00:00:00.000Z","tags":[{"inline":true,"label":"H5","permalink":"/blog/tags/h-5"}],"readingTime":8.44,"hasTruncateMarker":false,"authors":[],"frontMatter":{"tags":["H5"]},"unlisted":false,"prevItem":{"title":"H5\u3001\u5c0f\u7a0b\u5e8f\u5546\u54c1\u52a0\u5165\u8d2d\u7269\u8f66\u7684\u629b\u7269\u7ebf\u52a8\u753b\u5982\u4f55\u5b9e\u73b0\uff1f","permalink":"/blog/2024/02/03/parabolic-animation"},"nextItem":{"title":"\u53d6\u4f59\u548c\u53d6\u6a21\u5982\u4f55\u533a\u5206\u4e0e\u5e94\u7528\uff1f","permalink":"/blog/2024/01/18/remainder-and-modulo"}},"content":"\u79bb\u7ebf\u5305\u662f\u79fb\u52a8\u7aef H5 \u5e38\u89c1\u7684\u6027\u80fd\u4f18\u5316\u65b9\u6848\u3002\u5f00\u53d1\u8005\u4eec\u6216\u591a\u6216\u5c11\u90fd\u63a5\u89e6\u8fc7\u79bb\u7ebf\u5305\u3002francecil \u5927\u4f6c\u8fd8\u603b\u7ed3\u4e86\u79bb\u7ebf\u5305\u662f\u5426\u8981\u653e\u5165 HTML \u7684\u4e24\u79cd\u51b3\u7b56\uff0c\u4ee5\u53ca\u51b3\u7b56\u7684\u4f18\u7f3a\u70b9\uff1a [^1]\uff1a\\r\\n\\r\\n- \u653e\u5165 HTML\uff08\u7f13\u5b58\u4f18\u5148\uff09\uff1a\u66f4\u597d\u7684\u6027\u80fd\uff0c\u4f46\u66f4\u65b0\u4e0d\u53ca\u65f6\u3002\\r\\n- \u4e0d\u653e\u5165 HTML\uff08\u7f51\u7edc\u4f18\u5148\uff09\uff1a\u5b9e\u65f6\u66f4\u65b0\uff0c\u4f46\u6027\u80fd\u8f83\u5dee\uff0c\u53ef\u80fd\u4f1a\u52a0\u8f7d\u5931\u8d25\u3002\\r\\n\\r\\n\u6211\u9009\u62e9\u628a HTML \u653e\u5165\u79bb\u7ebf\u5305\uff0c\u8fd9\u610f\u5473\u7740 H5 \u51fa\u73b0\u7ebf\u4e0a\u6545\u969c\u65f6\uff0c\u6ca1\u6709\u529e\u6cd5\u53ca\u65f6\u4fee\u590d\u3002\u56e0\u6b64\uff0c\u6211\u5fc5\u987b\u989d\u5916\u8bbe\u8ba1\u4e00\u5957\u964d\u7ea7\u65b9\u6848\uff0c\u4fdd\u8bc1\u79bb\u7ebf\u5305\u53d1\u751f\u6545\u969c\u65f6\u80fd\u591f\u5feb\u901f\u964d\u7ea7\u3002\\r\\n\\r\\n\u5982\u679c\u4f60\u4e5f\u4e3a\u79bb\u7ebf\u5305\u7684\u964d\u7ea7\u800c\u70e6\u607c\uff0c\u770b\u4e86\u8fd9\u7bc7\u6587\u7ae0\uff0c\u4f60\u4e00\u5b9a\u6709\u6240\u6536\u83b7\u3002\u6211\u4f1a\u4ece\u79bb\u7ebf\u5305\u7684\u673a\u5236\u8bf4\u8d77\uff0c\u89e3\u91ca\u79bb\u7ebf\u5305\u653e\u5165 HTML \u540e\u4e3a\u4ec0\u4e48\u66f4\u65b0\u4e0d\u53ca\u65f6\uff0c\u7136\u540e\u6211\u4f1a\u4ecb\u7ecd\u81ea\u5df1\u8bbe\u8ba1\u7684\u964d\u7ea7\u65b9\u6848\uff0c\u6700\u540e\u6211\u4f1a\u5bf9\u8fd9\u4e2a\u65b9\u6848\u505a\u4e00\u4e2a\u603b\u7ed3\u3002\\r\\n\\r\\n## \u79bb\u7ebf\u5305\u7684\u751f\u6548\u673a\u5236\\r\\n\\r\\n\u4e3a\u4ec0\u4e48\u79bb\u7ebf\u5305\u653e\u5165 HTML \u540e\u66f4\u65b0\u4e0d\u53ca\u65f6\uff1f\u4e3a\u4e86\u56de\u7b54\u8fd9\u4e2a\u95ee\u9898\uff0c\u6211\u4eec\u5fc5\u987b\u5148\u77e5\u9053\u5b83\u662f\u5982\u4f55\u751f\u6548\u7684\u3002\\r\\n\\r\\n\u79bb\u7ebf\u5305\u9996\u5148\u4f1a\u628a HTML\u3001CSS \u548c JS \u7b49\u8d44\u6e90\u6587\u4ef6\u6253\u5305\u6210\u4e00\u4e2a\u538b\u7f29\u5305\uff0c\u5e76\u9884\u5148\u4e0b\u8f7d\u5230 App \u672c\u5730\uff0c\u89e3\u538b\u5230\u7f13\u5b58\u4e2d\u3002\u5f53\u7528\u6237\u8bbf\u95ee H5 \u65f6\uff0cWebview \u5f00\u59cb\u52a0\u8f7d\u8d44\u6e90\u7684 URL \u5e76\u53d1\u51fa\u8d44\u6e90\u8bf7\u6c42\uff0cApp \u4f1a\u62e6\u622a\u8fd9\u4e9b\u8bf7\u6c42\u3002\\r\\n\\r\\n- \u5982\u679c\u7f13\u5b58\u4e2d\u6709\u6ee1\u8db3\u8bf7\u6c42\u7684\u8d44\u6e90\uff0cApp \u4f1a\u4f7f\u7528\u7f13\u5b58\u8d44\u6e90\uff1b\\r\\n- \u5982\u679c\u7f13\u5b58\u4e2d\u6ca1\u6709\u6ee1\u8db3\u8bf7\u6c42\u7684\u8d44\u6e90\uff0cApp \u4f1a\u4f7f\u7528\u7ebf\u4e0a\u8d44\u6e90\u3002\\r\\n\\r\\n```mermaid\\r\\nflowchart LR\\r\\n  A(\u52a0\u8f7d\u79bb\u7ebf\u5305) --\x3e B[\u89e3\u538b\u5230\u7f13\u5b58]\\r\\n  B --\x3e C[Webview \u52a0\u8f7d URL]\\r\\n  C --\x3e D{{\u4ece\u7f13\u5b58\u8bfb\u53d6}}\\r\\n  D --\x3e |\u6709|E[\u8fd4\u56de\u7f13\u5b58\u6570\u636e]\\r\\n  D --\x3e |\u65e0|F[\u8bf7\u6c42\u7ebf\u4e0a\u5730\u5740]\\r\\n```\\r\\n\\r\\n\u4ec0\u4e48\u65f6\u5019\u53eb\u7f13\u5b58\u8d44\u6e90\u6ee1\u8db3\u8bf7\u6c42\u5462\uff1f\u5c31\u662f\u7f13\u5b58\u6587\u4ef6\u540d\u5b57\u548c\u8bf7\u6c42\u6587\u4ef6\u540d\u5b57\u4e00\u81f4\u3002\\r\\n\\r\\n- \u5982\u679c\u6211\u4eec\u5728\u79bb\u7ebf\u5305\u91cc\u653e\u5165 HTML\uff0c\u7531\u4e8e HTML \u6587\u4ef6\u4e0d\u4f1a\u8f7b\u6613\u6539\u53d8\uff0c\u5373\u4f7f\u7ebf\u4e0a\u8d44\u6e90\u6709\u66f4\u65b0\uff0cApp \u4e5f\u4f1a\u4f18\u5148\u4f7f\u7528\u7f13\u5b58\u8d44\u6e90\uff1b\\r\\n- \u5982\u679c\u6211\u4eec\u4e0d\u653e\u5165 HTML\uff0c\u7531\u4e8e CSS \u548c JS \u6587\u4ef6\u540d\u7684\u54c8\u5e0c\u4f1a\u6539\u53d8\uff0c\u6240\u4ee5\u7ebf\u4e0a\u8d44\u6e90\u6709\u66f4\u65b0\u65f6\uff0cApp \u5185 HTML\u3001CSS \u548c JS \u90fd\u4f1a\u4f7f\u7528\u7ebf\u4e0a\u8d44\u6e90\u3002\\r\\n\\r\\n## \u6211\u8bbe\u8ba1\u7684\u964d\u7ea7\u65b9\u6848\\r\\n\\r\\n\u4e0a\u4e00\u8282\u6211\u4eec\u5df2\u7ecf\u77e5\u9053\uff0cHTML \u6587\u4ef6\u540d\u6ca1\u6709\u53d8\u5316\uff0c\u79bb\u7ebf\u5305\u5c31\u4e0d\u4f1a\u5931\u6548\u3002\u6211\u4eec\u53ef\u4ee5\u5229\u7528\u8df3\u8f6c\u95f4\u63a5\u6539\u53d8\u6587\u4ef6\u540d\u3002\\r\\n\\r\\n### \u5229\u7528\u8df3\u8f6c\u964d\u7ea7\u79bb\u7ebf\u5305\\r\\n\\r\\n\u9996\u5148\uff0c\u6211\u4eec\u9700\u8981\u51c6\u5907\u4e24\u4e2a\u5185\u5bb9\u4e00\u6837\u7684 HTML\uff0c\u4e00\u4e2a\u662f index.html\uff0c\u53e6\u4e00\u4e2a\u662f index-online.html\u3002\\r\\n\\r\\n- index.html \u4f1a\u653e\u5165\u79bb\u7ebf\u5305\uff1b\\r\\n- index-online.html \u4e0d\u4f1a\u653e\u5165\u79bb\u7ebf\u5305\u3002\\r\\n\\r\\n\\r\\n\u7136\u540e\uff0c\u6211\u4eec\u4f1a\u8bbe\u8ba1\u4e00\u4e2a\u5f00\u5173\uff0c\u63a7\u5236 index.html \u662f\u5426\u8981\u8df3\u8f6c\u3002\\r\\n\\r\\n- \u5f00\u5173\u5f00\u542f\u65f6\uff0cindex.html \u4f1a\u8df3\u8f6c\u5230 index-online.html\uff1b\\r\\n- \u5f00\u5173\u5173\u95ed\u65f6\uff0cindex.html \u4fdd\u6301\u539f\u59cb\u903b\u8f91\u3002\\r\\n\\r\\n\u8fd9\u6837\u53d1\u751f\u7ebf\u4e0a\u6545\u969c\u65f6\uff0c\u6211\u4eec\u53ef\u4ee5\u56de\u6eda\u7ebf\u4e0a\u7684 H5 \u9875\u9762\uff0c\u6b64\u65f6 index-online.html \u6062\u590d\u6b63\u5e38\uff0c\u800c\u7f13\u5b58\u5728\u7528\u6237 App \u672c\u5730\u7684 index.html \u8fd8\u6709\u95ee\u9898\u3002\\r\\n\\r\\n\u6211\u4eec\u5f00\u542f\u5f00\u5173\u540e\uff0c\u79bb\u7ebf\u7684 index.html \u76f4\u63a5\u8df3\u8f6c\u5230\u5df2\u7ecf\u6062\u590d\u6b63\u5e38\u7684 index-online.html\uff0c\u5c31\u5b9e\u73b0\u4e86\u79bb\u7ebf\u5305\u7684\u964d\u7ea7\u3002\\r\\n\\r\\n### \u5229\u7528\u7248\u672c\u5927\u5c0f\u8bbe\u8ba1\u5f00\u5173\\r\\n\\r\\n\u4e0a\u4e00\u5c0f\u8282\uff0c\u6211\u4eec\u63d0\u5230\u964d\u7ea7\u65b9\u6848\u9700\u8981\u4e00\u4e2a\u5f00\u5173\uff0c\u8bbe\u8ba1\u8fd9\u4e2a\u5f00\u5173\uff0c\u6211\u4eec\u9700\u8981\u8003\u8651\u4e24\u4e2a\u95ee\u9898\uff1a\\r\\n\\r\\n- \u79bb\u7ebf\u5305\u6709 n \u4e2a\u7248\u672c\uff0c\u6709\u65f6\u591a\u4e2a\u7248\u672c\u5747\u5b58\u5728\u95ee\u9898\u3002\u6bd4\u5982 1.0.0 \u79bb\u7ebf\u5305\u6ca1\u6709\u95ee\u9898\uff0c1.0.1 \u548c 1.0.2 \u90fd\u6709\u95ee\u9898\uff0c\u6211\u4eec\u9700\u8981\u4fdd\u8bc1\u5f00\u5173\u80fd\u591f\u964d\u7ea7\u591a\u4e2a\u7248\u672c\u3002\\r\\n\\r\\n```mermaid\\r\\nflowchart LR\\r\\nA[1.0.0 \u6b63\u786e] --\x3e B[1.0.1 \u9519\u8bef] --\x3e C[1.0.2 \u9519\u8bef]\\r\\n```\\r\\n\\r\\n- \u6211\u4eec\u4f1a\u53d1\u5e03\u4fee\u590d\u7684\u79bb\u7ebf\u5305\uff0c\u6bd4\u5982\u6211\u4eec\u4f1a\u5728 1.0.3 \u4fee\u590d\u95ee\u9898\u3002\u5f00\u5173\u6253\u5f00\u540e\uff0c\u4e0d\u80fd\u628a\u4fee\u590d\u7248\u672c\u964d\u7ea7\u3002\\r\\n\\r\\n```mermaid\\r\\nflowchart LR\\r\\nA[1.0.0 \u6b63\u786e] --\x3e B[1.0.1 \u9519\u8bef] --\x3e C[1.0.2 \u9519\u8bef] --\x3e D[1.0.3 \u6b63\u786e]\\r\\n```\\r\\n\\r\\n\u600e\u4e48\u8bbe\u8ba1\u5462\uff1f\u6211\u8fd9\u91cc\u91c7\u53d6\u6700\u7b80\u5355\u7c97\u66b4\u7684\u601d\u8def\uff0c\u628a\u79bb\u7ebf\u5305\u672c\u8eab\u7684\u7248\u672c H5_VERSION \u548c\u8981\u964d\u7ea7\u7684\u7248\u672c rollbackVersion \u505a\u4e00\u4e2a\u6bd4\u8f83\u3002\\r\\n\\r\\n- `H5_VERSION <= rollbackVersion`\uff0c\u76f8\u5f53\u4e8e\u6253\u5f00\u964d\u7ea7\u5f00\u5173\u3002\\r\\n- `H5_VERSION > rollbackVersion`\uff0c\u76f8\u5f53\u4e8e\u5173\u95ed\u964d\u7ea7\u5f00\u5173\u3002\\r\\n\\r\\n\u7ee7\u7eed\u4f7f\u7528\u4e4b\u524d\u7684\u4f8b\u5b50\uff0c1.0.2 \u662f\u51fa\u73b0\u95ee\u9898\u7684\u6700\u9ad8\u7248\u672c\uff0c\u6211\u4eec\u53ef\u4ee5\u628a rollbackVersion \u8bbe\u7f6e\u4e3a 1.0.2\uff0c`<= 1.0.2` \u5168\u90e8\u964d\u7ea7\u3002\u8fd9\u6837\u867d\u7136\u4f1a\u8bef\u4f24 1.0.0 \u7248\u672c\uff0c\u4f46\u80fd\u65e2\u6ee1\u8db3\u964d\u7ea7\u591a\u4e2a\u6709\u95ee\u9898\u7684\u7248\u672c\uff0c\u53c8\u6ee1\u8db3\u4e0d\u964d\u7ea7\u4fee\u590d\u7248\u672c\u3002\\r\\n\\r\\n```mermaid\\r\\nflowchart LR\\r\\nsubgraph \u964d\u7ea7\\r\\nA[1.0.0 \u6b63\u786e] --\x3e B[1.0.1 \u9519\u8bef] --\x3e C[1.0.2 \u9519\u8bef]\\r\\nend\\r\\nC --\x3e D[1.0.3 \u6b63\u786e]\\r\\n```\\r\\n\\r\\n\u53d1\u751f\u4e0b\u4e00\u6b21\u6545\u969c\u65f6\uff0c\u6211\u4eec\u518d\u66f4\u65b0 rollbackVersion\uff0c\u6bd4\u5982 1.0.4 \u53d1\u751f\u4e86\u6545\u969c\uff0c\u6211\u4eec\u628a rollbackVersion \u8bbe\u7f6e\u4e3a 1.0.4\uff0c`<= 1.0.4` \u5168\u90e8\u964d\u7ea7\u3002\\r\\n\\r\\n```mermaid\\r\\nflowchart LR\\r\\nsubgraph \u964d\u7ea7\\r\\nA[1.0.0 \u6b63\u786e] --\x3e B[1.0.1 \u9519\u8bef] --\x3e C[1.0.2 \u9519\u8bef] --\x3e D[1.0.3 \u6b63\u786e] --\x3e E[1.0.4 \u9519\u8bef]\\r\\nend\\r\\nE --\x3e F[1.0.5 \u6b63\u786e]\\r\\n```\\r\\n\\r\\n### \u5229\u7528 localStorage \u5ef6\u8fdf\u5f00\u5173\u751f\u6548\u65f6\u95f4\\r\\n\\r\\n\u4e0a\u4e00\u8282\u6211\u4eec\u4ecb\u7ecd\u4e86\u5982\u4f55\u8bbe\u8ba1\u5f00\u5173\u3002\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u6211\u4eec\u4e0d\u80fd\u4e00\u53d1\u73b0\u5f00\u5173\u6253\u5f00\u3001\u5c31\u7acb\u5373\u8df3\u8f6c\uff0c\u8fd9\u4f1a\u4e2d\u65ad\u7528\u6237\u6b63\u5e38\u7684\u64cd\u4f5c\u3002\uff08\u6bd4\u5982\u7528\u6237\u6b63\u5728\u6d4f\u89c8\u9875\u9762\uff0c\u7a81\u7136\u9875\u9762\u8df3\u8f6c\uff09\\r\\n\\r\\n\u6211\u4eec\u7b49\u5f00\u5173\u6253\u5f00\u540e\uff0c\u5728 localStorage \u4e2d\u5b58\u50a8\u4e00\u4e0b\u4ee3\u8868\u6253\u5f00\u7684\u6807\u8bc6\uff0c\u7b49\u5230\u7528\u6237\u4e0b\u6b21\u8fdb\u5165\u9875\u9762\u65f6\uff0c\u53d1\u73b0\u6709\u6253\u5f00\u6807\u8bc6\u518d\u8df3\u8f6c\u5230 index-online.html\u3002\\r\\n\\r\\n### \u6d41\u7a0b\u56fe\\r\\n\\r\\n\u8003\u8651\u5b8c\u4e0a\u9762\u4e09\u4e2a\u95ee\u9898\u540e\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u8bbe\u8ba1\u4e00\u4e2a\u6bd4\u8f83\u5b8c\u5584\u7684\u964d\u7ea7\u65b9\u6848\u4e86\uff0c\u5b83\u7684\u6d41\u7a0b\u56fe\u5982\u4e0b\uff1a\\r\\n\\r\\n```mermaid\\r\\nflowchart TD\\r\\n  A(\u5f00\u59cb) --\x3e B[\u83b7\u53d6 localStorage \u4e2d\u7684 needRollback]\\r\\n  B --\x3e C{{needRollback \u7b49\u4e8e 1}}\\r\\n  C --\x3e |No| D[\u83b7\u53d6 H5 \u7248\u672c\u53f7 H5_VERSION, \u83b7\u53d6\u964d\u7ea7\u79bb\u7ebf\u5305\u7684\u914d\u7f6e rollbackVersion]\\r\\n  C --\x3e |Yes| E[\u8df3\u8f6c index-online.html]\\r\\n  E --\x3e I(\u7ed3\u675f)\\r\\n  D --\x3e F{{H5_VERSION \u5c0f\u4e8e\u7b49\u4e8e rollbackVersion}}\\r\\n  F --\x3e |Yes| G[\u5728 localStorage \u4e2d\u8bbe\u7f6e needRollback]\\r\\n  F --\x3e |No| H[\u5220\u9664 localStorage \u4e2d\u7684 needRollback]\\r\\n  G --\x3e I\\r\\n  H --\x3e I\\r\\n```\\r\\n\\r\\n1. \u7528\u6237\u4e00\u8fdb\u5165\u9875\u9762\uff0c\u4f1a\u5148\u83b7\u53d6 localStorage \u4e2d\u7684 needRollback \u5f00\u5173\u6807\u8bc6\u3002\\r\\n2. \u5982\u679c needRollback \u6807\u8bc6\u6253\u5f00\uff0c\u5219\u8df3\u8f6c index-online.html \u5b9e\u73b0\u964d\u7ea7\u3002\uff08\u6ce8\uff1a**index-online.html \u4e2d\u4e0d\u80fd\u7ee7\u7eed\u5224\u65ad needRollback\uff0c\u5426\u5219\u4f1a\u65e0\u9650\u8df3\u8f6c**\uff09\\r\\n3. \u5982\u679c needRollback \u6807\u8bc6\u6ca1\u6709\u6253\u5f00\uff0c\u5219\u7ee7\u7eed\u83b7\u53d6 H5 \u672c\u8eab\u7684\u7248\u672c\u53f7\uff0c\u4ee5\u53ca\u63a5\u53e3\u4e0b\u53d1\u7684 rollbackVersion\u3002\\r\\n4. \u5982\u679c `H5_VERSION <= rollbackVersion`\uff0c\u5219\u5728 localStorage \u628a needRollback \u8bbe\u7f6e\u4e3a 1\u3002\\r\\n5. \u5982\u679c `H5_VERSION > rollbackVersion`\uff0c\u5219\u5220\u9664 localStorage \u4e2d\u7684 needRollback \u6807\u8bc6\u3002\\r\\n\\r\\n## \u603b\u7ed3\\r\\n\\r\\n\u672c\u6587\u4ecb\u7ecd\u4e86\u4e00\u79cd\u79bb\u7ebf\u5305\u653e\u5165 HTML \u7684\u964d\u7ea7\u65b9\u6848\uff0c\u5b83\u4e3b\u8981\u6709\u4e09\u4e2a\u7279\u70b9\uff1a\\r\\n\\r\\n1. \u5229\u7528\u4ece\u79bb\u7ebf\u5316\u7684 index.html \u8df3\u8f6c\u5230\u7ebf\u4e0a\u7684 index-online.html \u5b9e\u73b0\u964d\u7ea7\u3002\\r\\n2. \u5229\u7528\u79bb\u7ebf\u5305\u7248\u672c `H5_VERSION <= rollbackVersion` \u505a\u5f00\u5173\uff0c\u5224\u65ad\u662f\u5426\u9700\u8981\u964d\u7ea7\u3002\\r\\n3. \u5229\u7528 localStorage \u4e2d\u8bbe\u7f6e needRollback \u6807\u8bc6\uff0c\u5ef6\u8fdf\u5f00\u5173\u4f5c\u7528\u65f6\u95f4\u3002\\r\\n\\r\\n\u8fd9\u79cd\u65b9\u6848\u662f\u79bb\u7ebf\u5305\u653e\u5165 HTML \u540e\uff0c\u4e00\u79cd\u6210\u672c\u8f83\u4f4e\u7684\u964d\u7ea7\u65b9\u6848\u3002\u5b83\u4f1a\u5728\u964d\u7ea7\u65f6\u8bef\u4f24\u4f4e\u7248\u672c\u7684\u79bb\u7ebf\u5305\uff0c\u4ee5\u635f\u8017\u6027\u80fd\u4e3a\u4ee3\u4ef7\uff0c\u4fdd\u969c\u8d28\u91cf\u3002\\r\\n\\r\\n[^1]: [HTML \u653e\u5165\u79bb\u7ebf\u5305\uff1f\u4f60\u9700\u8981\u4e86\u89e3\u7684\u79bb\u7ebf\u7b56\u7565](https://juejin.cn/post/7254549436625256506)"},{"id":"/2024/01/18/remainder-and-modulo","metadata":{"permalink":"/blog/2024/01/18/remainder-and-modulo","source":"@site/blog/2024-01-18-remainder-and-modulo/index.md","title":"\u53d6\u4f59\u548c\u53d6\u6a21\u5982\u4f55\u533a\u5206\u4e0e\u5e94\u7528\uff1f","description":"\u53d6\u4f59\uff08remainer\uff09\u548c\u53d6\u6a21\uff08modulo\uff09\uff0c\u5f88\u591a\u4e66\u7c4d\u6ca1\u6709\u8bf4\u660e\u5b83\u4eec\u7684\u533a\u522b\u3001\u4e5f\u6ca1\u6709\u8bf4\u660e\u5b83\u4eec\u7684\u5e94\u7528\u573a\u666f\u3002\u6bd4\u5982\u300aJavaScript \u9ad8\u7ea7\u7a0b\u5e8f\u8bbe\u8ba1\uff08\u7b2c 4 \u7248\uff09\u300b\u76f4\u63a5\u8bf4\uff1a","date":"2024-01-18T00:00:00.000Z","tags":[],"readingTime":7.175,"hasTruncateMarker":false,"authors":[],"frontMatter":{},"unlisted":false,"prevItem":{"title":"H5 \u79bb\u7ebf\u5305\u653e\u5165 HTML \u540e\u964d\u7ea7\u65b9\u6848\u5982\u4f55\u8bbe\u8ba1\uff1f","permalink":"/blog/2024/01/27/offline-package-rollback"},"nextItem":{"title":"H5 \u4e0d\u590d\u5236\u5143\u7d20\u7684\u5faa\u73af\u8f6e\u64ad\u56fe\u5982\u4f55\u5b9e\u73b0\uff1f\u2014\u2014\u53d6\u6a21","permalink":"/blog/2023/12/14/loop-swiper"}},"content":"\u53d6\u4f59\uff08remainer\uff09\u548c\u53d6\u6a21\uff08modulo\uff09\uff0c\u5f88\u591a\u4e66\u7c4d\u6ca1\u6709\u8bf4\u660e\u5b83\u4eec\u7684\u533a\u522b\u3001\u4e5f\u6ca1\u6709\u8bf4\u660e\u5b83\u4eec\u7684\u5e94\u7528\u573a\u666f\u3002\u6bd4\u5982\u300aJavaScript \u9ad8\u7ea7\u7a0b\u5e8f\u8bbe\u8ba1\uff08\u7b2c 4 \u7248\uff09\u300b\u76f4\u63a5\u8bf4\uff1a\\r\\n\\r\\n> \u53d6\u6a21\uff08\u4f59\u6570\uff09\u64cd\u4f5c\u7b26\u7531\u4e00\u4e2a\u767e\u5206\u6bd4\u7b26\u53f7\uff08%\uff09\u8868\u793a\u3002\\r\\n\\r\\n\u4f46\u5b9e\u9645\u4e0a\uff0c\u4e24\u4e2a\u6982\u5ff5\u5e76\u4e0d\u5b8c\u5168\u4e00\u81f4\u3002\u4e25\u683c\u6765\u8bf4\uff0cJavaScript \u4e2d\u7684 % \u662f\u53d6\u4f59\uff0c\u800c\u4e0d\u662f\u53d6\u6a21\u3002\\r\\n\\r\\n\u6709\u8bfb\u8005\u53ef\u80fd\u8ba4\u4e3a\uff0c\u6ca1\u5fc5\u8981\u533a\u5206\u53d6\u4f59\u548c\u53d6\u6a21\u3002\u4f46\u6211\u60f3\u8bf4\uff0c\u533a\u5206\u53d6\u4f59\u548c\u53d6\u6a21\uff0c\u80fd\u5e2e\u52a9\u4f60\u5199\u51fa\u66f4\u4f18\u96c5\u7684\u4ee3\u7801\u3002\\r\\n\\r\\n\u4ee5\u6398\u91d1\u7684\u521b\u4f5c\u8bdd\u9898\u8f6e\u64ad\u4e3a\u4f8b\uff0c\u5b83\u5e26\u6709\u7070\u8272\u8fdb\u5ea6\u6761\uff0c\u5f53\u4f60\u5de6\u6ed1\u6216\u53f3\u6ed1\u65f6\uff0c\u8bdd\u9898\u5bf9\u5e94\u7684\u5706\u70b9\u4f1a\u53d8\u957f\u3002\\r\\n\\r\\n![](./img/loop-progress.gif)\\r\\n\\r\\n\u5047\u5982\u8ba9\u4f60\u6765\u5b9e\u73b0\u7070\u8272\u8fdb\u5ea6\u6761\uff0c\u9700\u8981\u8ba1\u7b97\u5de6\u6ed1\u540e\u7684\u4e0b\u6807\uff08prevIndex\uff09\u548c\u53f3\u6ed1\u540e\u7684\u4e0b\u6807\uff08nextIndex\uff09\uff0c\u4f60\u4f1a\u600e\u4e48\u505a\u5462\uff1f\\r\\n\\r\\n- \u8981\u662f\u4f60\u5b8c\u5168\u4e0d\u7406\u89e3\u53d6\u4f59\u548c\u53d6\u6a21\uff0c\u4e3a\u4e86\u517c\u987e\u5de6\u6ed1\u3001\u53f3\u6ed1\u7684\u8fb9\u754c\u60c5\u51b5\uff0c\u4f60\u53ef\u80fd\u4f1a\u8fd9\u6837\u5199\uff1a\\r\\n\\r\\n```js\\r\\nconst prevIndex = currentIndex - 1 < 0 ?\\r\\n                  len - 1 :\\r\\n                  currentIndex - 1\\r\\n\\r\\nconst nextIndex = currentIndex + 1 > len - 1 ?\\r\\n                  0 :\\r\\n                  currentIndex + 1\\r\\n```\\r\\n\\r\\n- \u8981\u662f\u4f60\u53ea\u7406\u89e3\u53d6\u4f59\uff0c\u4e0d\u7406\u89e3\u53d6\u6a21\uff0c\u4f60\u53ef\u80fd\u4f1a\u8fd9\u6837\u5199\uff1a\\r\\n\\r\\n```js\\r\\nconst prevIndex = (currentIndex - 1) % len < 0 ?\\r\\n                  (currentIndex - 1) + len :\\r\\n                  currentIndex - 1\\r\\n\\r\\nconst nextIndex = (currentIndex + 1) % len\\r\\n```\\r\\n\\r\\n- \u8981\u662f\u4f60\u65e2\u7406\u89e3\u53d6\u4f59\uff0c\u53c8\u7406\u89e3\u53d6\u6a21\uff0c\u4f60\u53ef\u4ee5\u5199\u51fa\u66f4\u4f18\u96c5\u7684\u4ee3\u7801\uff1a\uff08mod \u4e0d\u662f JavaScript \u539f\u751f\u51fd\u6570\uff0c\u9700\u8981\u989d\u5916\u5b9e\u73b0\uff09\\r\\n\\r\\n```js\\r\\nconst prevIndex = mod(currentIndex - 1, len)\\r\\nconst nextIndex = mod(currentIndex + 1, len)\\r\\n```\\r\\n\\r\\n\u5982\u679c\u4f60\u60f3\u77e5\u9053\u53d6\u4f59\u548c\u53d6\u6a21\u7684\u533a\u522b\u548c\u5e94\u7528\u3001\u4ee5\u53ca mod \u51fd\u6570\u5982\u4f55\u5b9e\u73b0\uff0c\u770b\u5b8c\u8fd9\u7bc7\u6587\u7ae0\uff0c\u4f60\u4e00\u5b9a\u6709\u6240\u6536\u83b7\u3002\\r\\n\\r\\n\u6211\u4f1a\u5148\u7ed9\u51fa\u53d6\u4f59\u548c\u53d6\u6a21\u7684\u8ba1\u7b97\u65b9\u5f0f\uff0c\u518d\u7528\u56db\u4e2a\u4f8b\u5b50\u89e3\u91ca\u8ba1\u7b97\u65b9\u5f0f\uff0c\u63a5\u7740\u6211\u4f1a\u8c08\u4e00\u8c08\u4ec0\u4e48\u65f6\u5019\u8be5\u53d6\u4f59\uff0c\u4ec0\u4e48\u65f6\u5019\u8be5\u53d6\u6a21\uff0c\u6700\u540e\u6211\u4f1a\u4ecb\u7ecd JavaScript \u4e2d 2 \u79cd\u5b9e\u73b0 mod \u51fd\u6570\u7684\u65b9\u6cd5\u3002\\r\\n\\r\\n## \u8ba1\u7b97\u65b9\u5f0f\\r\\n\\r\\n\u4f59\u6570\u548c\u6a21\u7684\u8ba1\u7b97\u65b9\u5f0f\u5982\u4e0b\u56fe\uff1a\\r\\n\\r\\n![](./img/rem-mod.png)\\r\\n\\r\\n\u5176\u4e2d fix \u4ee3\u8868\u5411 0 \u53d6\u6574\uff0c\u800c floor \u4ee3\u8868\u5411\u8d1f\u65e0\u7a77\u53d6\u6574\u3002\u4f60\u53ef\u80fd\u5e76\u4e0d\u7406\u89e3\u4ec0\u4e48\u53eb\u4f5c\u300c\u5411 0 \u53d6\u6574\u300d\uff0c\u4ec0\u4e48\u53eb\u4f5c\u300c\u5411\u8d1f\u65e0\u7a77\u53d6\u6574\u300d\uff0c\u5148\u4e0d\u8981\u7740\u6025\uff0c\u5728\u4f8b\u5b50\u4e2d\u6211\u4f1a\u8be6\u7ec6\u8bb2\u89e3\u3002\\r\\n\\r\\n## \u4f8b\u5b50\\r\\n\\r\\n### 5 \u9664\u4ee5 2\\r\\n\\r\\n\u628a x = 5\uff0cy = 2 \u4ee3\u5165\u516c\u5f0f\u540e\uff0c\u4f60\u9700\u8981\u8ba1\u7b97\u7684\u662f `fix(2.5)` \u548c `floor(2.5)`\u3002\\r\\n\\r\\n![](./img/5rem2.png)\\r\\n\\r\\n\u4f60\u53ef\u4ee5\u753b\u51fa\u4e00\u4e2a\u53f3\u7bad\u5934\uff0c\u4ee3\u8868\u4ece\u8d1f\u65e0\u7a77\u6307\u5411\u6b63\u65e0\u7a77\u7684\u6570\u8f74\u3002\\r\\n\\r\\n\u627e\u5230 2.5 \u7684\u4f4d\u7f6e\uff0c\u53ef\u4ee5\u53d1\u73b0 0 \u548c\u8d1f\u65e0\u7a77\u90fd\u5728 2.5 \u7684\u5de6\u8fb9\u3002\u5bf9 2.5 \u6765\u8bf4\uff0c\u5411 0 \u53d6\u6574\u548c\u5411\u8d1f\u65e0\u7a77\u53d6\u6574\uff0c\u90fd\u662f\u5f80\u5de6\u8fb9\u53d6\u3002\\r\\n\\r\\n\u6240\u4ee5 `fix(2.5) = 2`\uff0c `floor(2.5) = 2`\uff0c\u628a\u5b83\u4eec\u4ee3\u5165\u516c\u5f0f\uff0c\u5f97\u5230\u4f59\u6570\u548c\u6a21\u90fd\u662f 1\u3002\\r\\n\\r\\n### -5 \u9664\u4ee5 2\\r\\n\\r\\n\u518d\u770b -5 \u9664\u4ee5 2\uff0c\u7ee7\u7eed\u4ee3\u5165\u516c\u5f0f\u753b\u6570\u8f74\uff0c\u4f60\u9700\u8981\u8ba1\u7b97\u7684\u662f `fix(-2.5)` \u548c `floor(-2.5)`\u3002\\r\\n\\r\\n![](./img/-5rem2.png)\\r\\n\\r\\n\u627e\u5230 -2.5 \u7684\u4f4d\u7f6e\uff0c\u53ef\u4ee5\u770b\u5230 0 \u5728 -2.5 \u7684\u53f3\u8fb9\uff0c\u800c\u8d1f\u65e0\u7a77\u5728 -2.5 \u7684\u5de6\u8fb9\u3002\u6b64\u65f6\u5411 0 \u53d6\u6574\u5c31\u662f\u53d6 -2.5 \u53f3\u8fb9\u7684\u6574\u6570\uff0c\u5411\u8d1f\u65e0\u7a77\u53d6\u6574\u5c31\u662f\u53d6 -2.5 \u5de6\u8fb9\u7684\u6574\u6570\u3002\\r\\n\\r\\n\u6240\u4ee5 `fix(-2.5) = -2`\uff0c`floor(-2.5) = -3`\u3002\u628a\u5b83\u4eec\u4ee3\u5165\u516c\u5f0f\uff0c\u5f97\u5230\u4f59\u6570\u4e3a -1\uff0c\u6a21\u4e3a 1\u3002\\r\\n\\r\\n### 5 \u9664\u4ee5 -2\\r\\n\\r\\n\u7ee7\u7eed\u770b 5 \u9664\u4ee5 -2\uff0c\u4f60\u9700\u8981\u8ba1\u7b97\u7684\u662f `fix(-2.5)` \u548c `floor(-2.5)`\u3002\\r\\n\\r\\n![](./img/5rem-2.png)\\r\\n\\r\\n\u4e4b\u524d\u5df2\u7ecf\u77e5\u9053 `fix(-2.5) = -2`\uff0c`floor(-2.5) = -3`\uff0c\u628a\u5b83\u4eec\u4ee3\u5165\u516c\u5f0f\uff0c\u5f97\u5230\u4f59\u6570\u4e3a 1\uff0c\u6a21\u4e3a -1\u3002\\r\\n\\r\\n### -5 \u9664\u4ee5 -2\\r\\n\\r\\n\u6700\u540e\u770b -5 \u9664\u4ee5 -2\uff0c\u4f60\u9700\u8981\u8ba1\u7b97\u7684\u662f `fix(2.5)` \u548c `floor(2.5)`\u3002\\r\\n\\r\\n![](./img/-5rem-2.png)\\r\\n\\r\\n\u4e4b\u524d\u5df2\u7ecf\u77e5\u9053 `fix(2.5) = 2`\uff0c`floor(2.5) = 2`\uff0c\u628a\u5b83\u4eec\u4ee3\u5165\u516c\u793a\u540e\u5f97\u5230\u4f59\u6570\u548c\u6a21\u90fd\u662f -1\u3002\\r\\n\\r\\n## \u4f59\u6570\u548c\u6a21\u7684\u533a\u522b\\r\\n\\r\\n\u89c2\u5bdf\u4e0a\u9762\u7684 4 \u4e2a\u4f8b\u5b50\uff0c\u4e0d\u96be\u53d1\u73b0\uff0c\u53d6\u4f59\u548c\u53d6\u6a21\u7684\u7ed3\u679c\uff0c\u548c x \u548c y \u7684\u6b63\u8d1f\u53f7\u6709\u5173\u3002\\r\\n\\r\\n- \u5f53 x \u548c y \u540c\u4e3a\u6b63\u6570\u3001\u6216\u8005\u540c\u4e3a\u8d1f\u6570\u65f6\uff0cx rem y \u548c x mod y \u7684\u7ed3\u679c\u4e00\u6837\u3002\\r\\n- \u5f53 x \u548c y \u7b26\u53f7\u4e0d\u4e00\u81f4\u65f6\uff0cx rem y \u548c x mod y \u7684\u7ed3\u679c\u4e0d\u4e00\u6837\u3002rem \u8ba1\u7b97\u7ed3\u679c\u7b26\u53f7\u548c x \u4e00\u6837\uff0cmod \u8ba1\u7b97\u7ed3\u679c\u548c y \u4e00\u6837\u3002\\r\\n\\r\\n\u5b9e\u9645\u5e94\u7528\u4e2d\uff0cy \u4e00\u822c\u90fd\u662f\u6b63\u6570\uff0c\u56e0\u6b64\u53ea\u9700\u8981\u8003\u8651 x \u7b26\u53f7\u7684\u6b63\u8d1f\u3002\\r\\n\\r\\n- \u5f53 x \u4e3a\u6b63\u6570\u65f6\uff0c\u6b64\u65f6\u53d6\u4f59\u6570\u548c\u53d6\u6a21\u7ed3\u679c\u4e00\u81f4\uff0c\u56e0\u6b64\u6700\u597d\u4f7f\u7528 JavaScript \u7684 % \u8fd0\u7b97\u7b26\u3002\\r\\n\\r\\n  \u4f8b\u5982\u4f60\u60f3\u8bbf\u95ee\u6570\u7ec4\u4e2d\u7684\u67d0\u4e2a\u5143\u7d20\uff0c\u53c8\u62c5\u5fc3\u4e0b\u6807\u8d85\u51fa\u6570\u7ec4\u7684\u8303\u56f4\uff0c\u4f60\u53ef\u4ee5\u5148\u6c42\u4e0b\u6807\u9664\u4ee5\u6570\u7ec4\u957f\u5ea6\u7684\u4f59\u6570\uff0c\u628a\u4f59\u6570\u4f5c\u4e3a\u65b0\u4e0b\u6807\u3002\\r\\n\\r\\n- \u5f53 x \u53ef\u80fd\u4e3a\u6b63\u6570\u4e5f\u53ef\u80fd\u4e3a\u8d1f\u6570\u65f6\uff0c\u6b64\u65f6\u53ef\u4ee5\u5b9e\u73b0\u4e00\u4e2a mod \u51fd\u6570\u3002\\r\\n\\r\\n  \u4f8b\u5982\u6211\u5728\u6587\u7ae0\u5f00\u5934\u4e3e\u7684\u4f8b\u5b50\uff0cprevIndex \u53ef\u80fd\u662f\u4e00\u4e2a\u8d1f\u6570\uff0c\u4f60\u53ef\u4ee5\u76f4\u63a5\u6c42 prevIndex \u9664\u4ee5\u8f6e\u64ad\u957f\u5ea6\u7684\u6a21\u3002\\r\\n\\r\\n## \u5b9e\u73b0\u53d6\u6a21\u51fd\u6570\\r\\n\\r\\n\u53d6\u6a21\u51fd\u6570\uff0c\u6211\u77e5\u9053\u7684\u6709\u4e24\u79cd\u5b9e\u73b0\u65b9\u6cd5\uff0c\u4e00\u79cd\u662f\u504f\u91cd\u5de5\u7a0b\uff0c\u53e6\u4e00\u79cd\u504f\u91cd\u5b66\u672f\u3002\u4e24\u8005\u6709\u4ec0\u4e48\u533a\u522b\u5462\uff1f\\r\\n\\r\\n\u4e4b\u524d\u63d0\u5230\u8fc7\uff0c\u5b9e\u9645\u5e94\u7528\u4e2d\uff0cx mod y \u65f6\uff0cy \u4e00\u822c\u662f\u6b63\u6570\u3002\\r\\n\\r\\n- **\u5de5\u7a0b\u65b9\u6cd5\u8ffd\u6c42\u7b80\u5355\u5b9e\u7528\uff0c\u53ea\u8003\u8651 y \u4e3a\u6b63\u6570\u7684\u60c5\u51b5\u3002**\\r\\n\\r\\n\u5b83\u7684\u5199\u6cd5\u7b80\u5355\u6613\u61c2\uff0c\u5148\u6c42 x \u9664\u4ee5 y \u7684\u4f59\u6570\uff0c\u5982\u679c\u7ed3\u679c\u4e3a\u8d1f\u6570\uff0c\u5c31\u7ed9\u7ed3\u679c\u518d\u52a0\u4e0a\u4e00\u4e2a y\uff0c\u4fdd\u8bc1\u7ed3\u679c\u59cb\u7ec8\u4e3a\u6b63\u6570\u3002\\r\\n\\r\\n```js\\r\\nfunction mod(x, y) {\\r\\n  const res = x % y\\r\\n  return res < 0 ? res + y : res\\r\\n}\\r\\n```\\r\\n\\r\\n![](./img/verify-func-1.png)\\r\\n\\r\\nAnt Design Mobile Swiper [^1] \u6e90\u7801\u7528\u7684\u5c31\u662f\u8fd9\u79cd\u65b9\u6cd5\u3002\\r\\n\\r\\n- **\u5b66\u672f\u65b9\u6cd5\u8ffd\u6c42\u903b\u8f91\u4e25\u5bc6\uff0c\u65e2\u4f1a\u8003\u8651 y \u4e3a\u6b63\u6570\uff0c\u4e5f\u4f1a\u8003\u8651 y \u4e3a\u8d1f\u6570\u3002**\\r\\n  \\r\\n\u5b83\u7684\u5199\u6cd5\u5982\u4e0b\uff0c\u6211\u4e0d\u6e05\u695a\u600e\u4e48\u8bc1\u660e\uff0c\u4f46\u4ee3\u5165\u6570\u5b57\u8ba1\u7b97\uff0c\u53ef\u4ee5\u9a8c\u8bc1\u7ed3\u679c\u6b63\u786e\u3002\\r\\n\\r\\n```js\\r\\nfunction mod(x, y) {\\r\\n  return ((x % y) + y) % y;\\r\\n}\\r\\n```\\r\\n\\r\\n![](./img/verify-func-2.png)\\r\\n\\r\\nMDN [^2] \u548c stackoverflow [^3] \u63a8\u8350\u7684\u5c31\u662f\u8fd9\u79cd\u65b9\u6cd5\u3002\\r\\n\\r\\n[^1]: [ant-design-mobile | github](https://github.com/ant-design/ant-design-mobile/blob/master/src/components/swiper/swiper.tsx) \\r\\n[^2]: [remainder | mdn](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Operators/Remainder)\\r\\n[^3]: [JavaScript % (modulo) gives a negative result for negative numbers | stackoverflow](https://stackoverflow.com/questions/4467539/javascript-modulo-gives-a-negative-result-for-negative-numbers/17323608#17323608)"},{"id":"/2023/12/14/loop-swiper","metadata":{"permalink":"/blog/2023/12/14/loop-swiper","source":"@site/blog/2023-12-14-loop-swiper/index.md","title":"H5 \u4e0d\u590d\u5236\u5143\u7d20\u7684\u5faa\u73af\u8f6e\u64ad\u56fe\u5982\u4f55\u5b9e\u73b0\uff1f\u2014\u2014\u53d6\u6a21","description":"\u5faa\u73af\u8f6e\u64ad\u56fe\uff0c\u4f60\u80af\u5b9a\u5e76\u4e0d\u964c\u751f\uff0c\u5b9e\u73b0\u65b9\u6848\u975e\u5e38\u591a\u3002\u5927\u591a\u6570\u5b9e\u73b0\u65b9\u6848\u9700\u8981\u590d\u5236\u5143\u7d20\uff0c\u6bd4\u5982\u5b9e\u73b0 5 \u4e2a\u5143\u7d20\u7684\u8f6e\u64ad\u9700\u8981\u7528 7 \u4e2a\u5143\u7d20\u3002\u591a\u51fa\u7684 2 \u4e2a\u5143\u7d20\u4e00\u4e2a\u662f\u5934\u90e8\u5143\u7d20\uff0c\u53e6\u4e00\u4e2a\u662f\u5c3e\u90e8\u5143\u7d20\u3002","date":"2023-12-14T00:00:00.000Z","tags":[{"inline":true,"label":"H5","permalink":"/blog/tags/h-5"}],"readingTime":10.915,"hasTruncateMarker":false,"authors":[],"frontMatter":{"tags":["H5"]},"unlisted":false,"prevItem":{"title":"\u53d6\u4f59\u548c\u53d6\u6a21\u5982\u4f55\u533a\u5206\u4e0e\u5e94\u7528\uff1f","permalink":"/blog/2024/01/18/remainder-and-modulo"},"nextItem":{"title":"H5\u3001\u5c0f\u7a0b\u5e8f Tab \u5982\u4f55\u6eda\u52a8\u5c45\u4e2d\uff1f","permalink":"/blog/2023/07/30/tab-scroll-to-center"}},"content":"\u5faa\u73af\u8f6e\u64ad\u56fe\uff0c\u4f60\u80af\u5b9a\u5e76\u4e0d\u964c\u751f\uff0c\u5b9e\u73b0\u65b9\u6848\u975e\u5e38\u591a\u3002\u5927\u591a\u6570\u5b9e\u73b0\u65b9\u6848\u9700\u8981\u590d\u5236\u5143\u7d20\uff0c\u6bd4\u5982\u5b9e\u73b0 5 \u4e2a\u5143\u7d20\u7684\u8f6e\u64ad\u9700\u8981\u7528 7 \u4e2a\u5143\u7d20\u3002\u591a\u51fa\u7684 2 \u4e2a\u5143\u7d20\u4e00\u4e2a\u662f\u5934\u90e8\u5143\u7d20\uff0c\u53e6\u4e00\u4e2a\u662f\u5c3e\u90e8\u5143\u7d20\u3002\\r\\n\\r\\n![](./img/old-method.png)\\r\\n\\r\\n\u80fd\u4e0d\u590d\u5236\u5143\u7d20\u5417\uff1f\u53ef\u4ee5\u7684\uff0cAnt Design Mobile Swiper [^1] \u5c31\u505a\u5230\u4e86\u3002\u5b83\u4e0d\u9700\u8981\u590d\u5236\u5143\u7d20\uff0c\u53ea\u9700\u8981\u6539\u53d8 translate3d\uff0c\u5c31\u80fd\u5faa\u73af\u64ad\u653e\u3002\\r\\n\\r\\n![](./img/antd-mobile.gif)\\r\\n\\r\\n\u5982\u679c\u4f60\u4e5f\u60f3\u77e5\u9053\u5b83\u662f\u600e\u4e48\u505a\u5230\u7684\uff0c\u770b\u4e86\u8fd9\u7bc7\u6587\u7ae0\uff0c\u4f60\u4e00\u5b9a\u6709\u6240\u6536\u83b7\u3002\u6211\u4f1a\u5148\u89e3\u91ca\u5faa\u73af\u8f6e\u64ad\u7684\u539f\u7406\uff0c\u518d\u7528 HTML + JavaScript \u5b9e\u73b0\u5faa\u73af\u8f6e\u64ad\uff0c\u6548\u679c\u5982\u4e0b\uff1a\\r\\n\\r\\n![](./img/demo.gif)\\r\\n\\r\\n## \u8f6e\u64ad\u7684\u539f\u7406\\r\\n\\r\\n**\u521d\u59cb\u987a\u5e8f**\\r\\n\\r\\n\u6211\u4eec\u5148\u601d\u8003\u4e00\u4e2a\u95ee\u9898\u30025 \u4e2a\u5143\u7d20\u3001\u8f6e\u64ad\u521d\u59cb\u987a\u5e8f\u5e94\u8be5\u600e\u4e48\u6392\uff1f\u7b54\u6848\u662f 34012\u3002\\r\\n\\r\\n![](./img/item0-center.png)\\r\\n\\r\\n\u9996\u5148\uff0cItem 0 \u5fc5\u987b\u653e\u5728\u653e\u5230\u89c6\u53e3\u4e2d\u592e\uff08\u6a58\u9ec4\u8272\uff09\uff0c\u6211\u4eec\u8981\u4fdd\u8bc1\u7528\u6237\u5f80\u5de6\u6ed1\u3001\u5f80\u53f3\u6ed1\u90fd\u80fd\u770b\u5230\u5143\u7d20\u3002\\r\\n\\r\\n\u5176\u6b21\uff0cItem 0 \u524d\u4e00\u4e2a\u5143\u7d20\u5fc5\u987b\u662f Item 4\uff0c\u540e\u4e00\u4e2a\u5143\u7d20\u5fc5\u987b\u662f Item 1\u3002\u56e0\u4e3a\u6211\u4eec\u8981\u6b3a\u9a97\u7528\u6237\u89c6\u89c9\uff0c\u8ba9\u7528\u6237\u89c9\u5f97\u81ea\u5df1\u770b\u5230\u7684\u662f 01234 \u5faa\u73af\u64ad\u653e\u3002\\r\\n\\r\\n\u540c\u7406\uff0c\u4e3a\u4e86\u6b3a\u9a97\u7528\u6237\u89c6\u89c9\uff0cItem 4 \u7684\u524d\u4e00\u4e2a\u5143\u7d20\u5fc5\u987b\u662f Item 3\uff0cItem 1 \u7684\u540e\u4e00\u4e2a\u5143\u7d20\u5fc5\u987b\u662f Item 2\u3002\\r\\n\\r\\n\u7ecf\u8fc7\u63a8\u7406\u6211\u4eec\u5f97\u5230\u7b54\u6848 34012\u3002\u4f46\u63a8\u7406\u8fc7\u7a0b\u592a\u9ebb\u70e6\u4e86\uff0c\u6709\u6ca1\u6709\u529e\u6cd5\u53ef\u4ee5\u7b80\u5316\u601d\u8003\u5462\uff1f\\r\\n\\r\\n\u6211\u4eec\u53ef\u4ee5\u8fd9\u6837\u60f3\uff0c\u628a Item \u6309 01234 \u7684\u987a\u5e8f\uff0c\u4ece\u4e2d\u592e\u533a\u57df\u5f00\u59cb\u5411\u53f3\u653e\u7f6e\u3002\u653e\u5b8c Item 0\u3001Item 1 \u548c Item 2\uff0cItem 0 \u53f3\u8fb9\u5df2\u7ecf\u6709 2 \u4e2a\u5143\u7d20\u3002\u63a5\u4e0b\u6765\u6211\u4eec\u53ea\u9700\u8981\u628a Item 3 \u548c Item 4 \u5e73\u79fb\u5230 Item 0 \u5de6\u8fb9\uff0c\u5c31\u53ef\u4ee5\u5f97\u5230\u7b54\u6848 34012\u3002\\r\\n\\r\\n![](./img/item0-mod.png)\\r\\n\\r\\n**\u5411\u53f3\u6ed1\u52a8**\\r\\n\\r\\n\u63a5\u4e0b\u6765\u601d\u8003\u7b2c\u4e8c\u4e2a\u95ee\u9898\u30025 \u4e2a\u5143\u7d20\u7684\u8f6e\u64ad\u5411\u53f3\u64ad\u653e\u4e00\u5f20\u540e\uff0c\u5e94\u8be5\u600e\u4e48\u6392\uff1f\u7b54\u6848\u662f 40123\u3002\\r\\n\\r\\n![](./img/item1-center.png)\\r\\n\\r\\n\u6211\u4eec\u53ef\u4ee5\u5ef6\u7eed\u4e4b\u524d\u7684\u601d\u8def\uff0c\u628a Item 1 \u653e\u5728\u4e2d\u592e\uff0c\u518d\u6309 12340 \u7684\u987a\u5e8f\u5411\u53f3\u653e\u7f6e\u3002\u653e\u5b8c Item 1\u3001Item 2 \u548c Item 3 \u540e\uff0cItem 1 \u53f3\u8fb9\u5df2\u7ecf\u6709 2 \u4e2a\u5143\u7d20\uff0c\u63a5\u4e0b\u6765\u6211\u4eec\u53ea\u9700\u8981\u628a Item 4 \u548c Item 0 \u5e73\u79fb\u5230 Item 1 \u5de6\u8fb9\uff0c\u5c31\u5f97\u5230\u4e86 40123\u3002\\r\\n\\r\\n![](./img/item1-mod.png)\\r\\n\\r\\n**\u8f6e\u64ad\u5faa\u73af**\\r\\n\\r\\n\u6cbf\u7740\u4e4b\u524d\u7684\u601d\u8def\uff0c\u6211\u4eec\u8fd9\u6837\u628a Item 2\u3001Item 3 \u548c Item 4 \u8f6e\u6d41\u653e\u5728\u4e2d\u592e\u770b\u770b\u60c5\u51b5\uff1a\\r\\n\\r\\n- 2 \u653e\u5728\u4e2d\u592e\uff0c\u6309 23401 \u7684\u987a\u5e8f\uff0c\u9700\u8981\u628a 3\u30014 \u653e\u5230 2 \u53f3\u8fb9\uff0c\u518d\u628a 0\u30011 \u5e73\u79fb\u5230 2 \u5de6\u8fb9\uff1b\\r\\n- 3 \u653e\u5728\u4e2d\u592e\uff0c\u6309 34012 \u7684\u987a\u5e8f\uff0c\u9700\u8981\u628a 4\u30010 \u653e\u5230 3 \u53f3\u8fb9\uff0c\u518d\u628a 1\u30012 \u5e73\u79fb\u5230 3 \u5de6\u8fb9\uff1b\\r\\n- 4 \u653e\u5728\u4e2d\u592e\uff0c\u6309 40123 \u7684\u987a\u5e8f\uff0c\u9700\u8981\u628a 0\u30011 \u653e\u5230 4 \u53f3\u8fb9\uff0c\u518d\u628a 2\u30013 \u5e73\u79fb\u5230 4 \u5de6\u8fb9\u3002\\r\\n\\r\\n\u8fd9\u6837\u5c31\u5f97\u5230\u5faa\u73af\u8f6e\u64ad\uff0c\u793a\u610f\u56fe\u5982\u4e0b\uff1a\\r\\n\\r\\n![](./img/loop.png)\\r\\n\\r\\n## \u8ba1\u7b97\u8f6e\u64ad\u4f4d\u7f6e\u7684\u4ee3\u7801\\r\\n\\r\\n\u73b0\u5728\u6211\u4eec\u4e00\u8d77\u628a\u4e0a\u8ff0\u601d\u8def\u8f6c\u53d8\u4e3a\u4ee3\u7801\u3002\u5148\u770b HTML \u5e03\u5c40\u4ee3\u7801\uff0c\u6211\u53ea\u4fdd\u7559\u5e03\u5c40\u5173\u952e\u90e8\u5206\uff0c\u8fd9\u6837\u4ee3\u7801\u66f4\u7cbe\u7b80\u3002\\r\\n\\r\\n### \u5e03\u5c40\u4ee3\u7801\\r\\n\\r\\nHTML \u521d\u59cb\u5e03\u5c40\u4ee3\u7801\u5982\u4e0b\uff08**\u6240\u6709\u7684 `<li>` \u5b9a\u4f4d\u4e3a\u76f8\u5bf9\u5b9a\u4f4d**\uff09\uff1a\\r\\n\\r\\n```html\\r\\n<ul>\\r\\n  <li style=\\"transform: translateX(0%); left: 0%;\\">0</li>\\r\\n  <li style=\\"transform: translateX(100%); left: -100%;\\">1</li>\\r\\n  <li style=\\"transform: translateX(200%); left: -200%;\\">2</li>\\r\\n  <li style=\\"transform: translateX(-200%); left: -300%;\\">3</li>\\r\\n  <li style=\\"transform: translateX(-100%); left: -400%;\\">4</li>\\r\\n</ul>\\r\\n```\\r\\n\\r\\n\u5b83\u7684\u6548\u679c\u793a\u610f\u56fe\u5982\u4e0b\uff0c\u6b63\u662f\u6211\u4eec\u5728\u300c\u8f6e\u64ad\u7684\u539f\u7406\u300d\u4e00\u8282\u63d0\u5230\u7684\u300c\u521d\u59cb\u987a\u5e8f\u300d\uff1a\\r\\n\\r\\n![](./img/code-explain-second.png)\\r\\n\\r\\n\u8fd9\u4e2a\u5e03\u5c40\u662f\u5982\u4f55\u5f97\u5230\u7684\u5462\uff1f\\r\\n\\r\\n\u9996\u5148\u6211\u4eec\u628a\u6bcf\u4e2a\u5143\u7d20\u7684 translateX \u8bbe\u7f6e\u4e3a 0%\u3001\u518d\u628a Item 0 ~ Item 4 \u7684 left \u8bbe\u7f6e\u6210 0% ~ -400%\u3002\\r\\n\\r\\n```html\\r\\n<ul>\\r\\n  <li style=\\"transform: translateX(0%); left: 0%;\\">0</li>\\r\\n  <li style=\\"transform: translateX(0%); left: -100%\\">1</li>\\r\\n  <li style=\\"transform: translateX(0%); left: -200%\\">2</li>\\r\\n  <li style=\\"transform: translateX(0%); left: -300%\\">3</li>\\r\\n  <li style=\\"transform: translateX(0%); left: -400%\\">4</li>\\r\\n</ul>\\r\\n```\\r\\n\\r\\n\u6548\u679c\u56fe\u5982\u4e0b\uff0c\u6240\u6709 Item \u90fd\u91cd\u53e0\u5728\u4e2d\u592e\uff1a\\r\\n\\r\\n![](./img/code-explain-init.png)\\r\\n\\r\\n\u63a5\u7740\uff0c\u6211\u4eec\u628a Item 0 ~ Item 4 \u7684 translateX \u8bbe\u7f6e\u6210 0% ~ 400%\u3002\\r\\n\\r\\n```html\\r\\n<ul>\\r\\n  <li style=\\"transform: translateX(0%); left: 0%;\\">0</li>\\r\\n  <li style=\\"transform: translateX(100%); left: -100%\\">1</li>\\r\\n  <li style=\\"transform: translateX(200%); left: -200%\\">2</li>\\r\\n  <li style=\\"transform: translateX(300%); left: -300%\\">3</li>\\r\\n  <li style=\\"transform: translateX(400%); left: -400%\\">4</li>\\r\\n</ul>\\r\\n```\\r\\n\\r\\n\u6548\u679c\u56fe\u5982\u4e0b\uff0c\u6b63\u662f\u6211\u4eec\u5728\u300c\u8f6e\u64ad\u7684\u539f\u7406\u300d\u4e00\u8282\u63d0\u5230\u7684\u300c\u628a Item \u6309 01234 \u7684\u987a\u5e8f\uff0c\u4ece\u4e2d\u592e\u533a\u57df\u5f00\u59cb\u5411\u53f3\u653e\u7f6e\u300d\uff1a\\r\\n\\r\\n![](./img/code-explain-first.png)\\r\\n\\r\\n\u4e0b\u4e00\u6b65\u6211\u4eec\u8981\u628a Item 3 \u548c Item 4 \u5e73\u79fb\u5230 Item 0 \u5de6\u8fb9\uff0c\u4e5f\u5c31\u662f\u628a Item 3\u3001Item 4 \u7684 translateX \u51cf\u53bb 500%\uff08\u8f6e\u64ad\u7684\u6574\u4f53\u957f\u5ea6\uff09\u3002\\r\\n\\r\\n```html\\r\\n<ul>\\r\\n  <li style=\\"transform: translateX(0%); left: 0%;\\">0</li>\\r\\n  <li style=\\"transform: translateX(100%); left: -100%\\">1</li>\\r\\n  <li style=\\"transform: translateX(200%); left: -200%\\">2</li>\\r\\n  <li style=\\"transform: translateX(-200%); left: -300%\\">3</li>\\r\\n  <li style=\\"transform: translateX(-100%); left: -400%\\">4</li>\\r\\n</ul>\\r\\n```\\r\\n\\r\\n\u6548\u679c\u56fe\u5982\u4e0b\uff0c\u8fd9\u6837\u5c31\u5b9e\u73b0\u4e86 Item 3 \u548c Item 4 \u5411\u5de6\u5e73\u79fb\uff1a\\r\\n\\r\\n![](./img/item0-mod.png)\\r\\n\\r\\n\u5230\u8fd9\u91cc\uff0c\u5982\u4f55\u5f97\u5230 HTML \u521d\u59cb\u5e03\u5c40\u6211\u4eec\u5df2\u7ecf\u89e3\u7b54\u5b8c\u6bd5\u3002\\r\\n\\r\\n### \u903b\u8f91\u4ee3\u7801\\r\\n\\r\\n\u63a5\u4e0b\u6765\uff0c\u6211\u4eec\u770b\u770b JavaScript \u4ee3\u7801\u3002HTML \u4ee3\u7801\uff0c\u53ea\u662f\u5b9e\u73b0\u8f6e\u64ad\u56fe\u7684\u521d\u59cb\u987a\u5e8f\uff0c\u800c JavaScript \u4ee3\u7801\uff0c\u5219\u662f\u5b9e\u73b0\u64ad\u653e\u524d\u4e00\u4e2a\u5143\u7d20\u3001\u64ad\u653e\u540e\u4e00\u4e2a\u5143\u7d20\u3002\\r\\n\\r\\n```js\\r\\nprevBtn.addEventListener(\\"click\\", (event) => {\\r\\n  onBtnClick(currentIndex - 1)\\r\\n});\\r\\n\\r\\nnextBtn.addEventListener(\\"click\\", () => {\\r\\n  onBtnClick(currentIndex + 1)\\r\\n});\\r\\n\\r\\nfunction onBtnClick (activeIndex) {\\r\\n  currentIndex = mod(activeIndex, len)\\r\\n  Array.from(items.children).forEach((ch, index) => {\\r\\n    const position = (index - currentIndex) * 100\\r\\n    const finalPosition = mod(position + halfWidth, totalWidth) - halfWidth\\r\\n    ch.style.transform = `translateX(${finalPosition}%)`\\r\\n  })\\r\\n}\\r\\n```\\r\\n\\r\\n\u6211\u4eec\u6765\u9010\u53e5\u89e3\u8bfb\u4ee3\u7801\u3002\u53ef\u4ee5\u770b\u5230\uff0c\u6211\u4eec\u76d1\u542c\u4e86 prevBtn \u548c nextBtn \u7684\u70b9\u51fb\u4e8b\u4ef6\u3002\u5f53 prevBtn \u88ab\u70b9\u51fb\u65f6\uff0ccurrentIndex \u88ab\u66f4\u65b0\u4e3a `currentIndex - 1`\uff0c\u610f\u601d\u662f\u64ad\u653e\u524d\u4e00\u4e2a\u5143\u7d20\uff1b\u5f53 nextBtn \u88ab\u70b9\u51fb\u65f6\uff0ccurrentIndex \u88ab\u66f4\u65b0\u4e3a `currentIndex + 1`\uff0c\u610f\u601d\u662f\u64ad\u653e\u540e\u4e00\u4e2a\u5143\u7d20\u3002\\r\\n\\r\\n\u63a5\u4e0b\u6765\uff0c`mod(activeIndex, len)` \u662f\u6c42 activeIndex \u9664\u4ee5 len \u7684\u6a21\uff0c\u4f5c\u7528\u662f\u628a currentIndex \u53d6\u503c\u9650\u5b9a\u5728 0 ~ 4\uff0c\u5982\u679c activeIndex \u7b49\u4e8e 5\uff0ccurrentIndex \u5c31\u53d8\u4e3a 0\u3002\u5982\u679c activeIndex \u7b49\u4e8e -1\uff0ccurrentIndex \u5c31\u53d8\u4e3a 4\u3002\u5982\u679c\u4f60\u4e0d\u7406\u89e3\u53d6\u6a21\u51fd\u6570\uff0c\u53ef\u4ee5\u5148\u770b\u6211\u7684\u53e6\u4e00\u7bc7\u6587\u7ae0 [\u53d6\u4f59\u548c\u53d6\u6a21\u5982\u4f55\u533a\u5206\u548c\u5e94\u7528](https://lijunlin2022.github.io/blog/2024/01/18/remainder-and-modulo)\u3002\\r\\n\\r\\n\u7136\u540e\uff0cforEach \u7ed9\u6bcf\u4e00\u4e2a\u5143\u7d20\u8bbe\u7f6e\u4e86 translateX\uff0c\u4f5c\u7528\u662f\u2014\u2014\u628a\u5143\u7d20\u5f80\u4e2d\u592e\u5143\u7d20\u7684\u53f3\u8fb9\u653e\u7f6e\uff0c\u53d1\u73b0\u4e2d\u592e Item \u53f3\u4fa7\u6709 2 \u4e2a\u5143\u7d20\u540e\uff0c\u518d\u628a\u5269\u4f59\u5143\u7d20\u653e\u5230 Item \u5de6\u8fb9\u3002\u6211\u4eec\u4ee5 01234 \u53d8\u4e3a 34012 \u4e3a\u4f8b\uff1a\\r\\n\\r\\n\u628a Item 0 ~ Item 4 \u7684\u4e0b\u6807\u4ee3\u5165\u4ee3\u7801\u4e2d\u8ba1\u7b97 position\uff0c\u4e0d\u96be\u53d1\u73b0\uff0ccurrentIndex \u4e3a 0 \u65f6\uff1a\\r\\n\\r\\n- Item 0 \u7684 position \u4e3a 0\\r\\n- Item 1 \u7684 position \u4e3a 100%\\r\\n- Item 2 \u7684 position \u4e3a 200%\\r\\n- Item 3 \u7684 position \u4e3a 300%\\r\\n- Item 4 \u7684 position \u4e3a 400%\\r\\n\\r\\n\u5982\u679c\u76f4\u63a5\u4ee5 position \u4e3a translateX\uff0c\u6548\u679c\u5982\u4e0b\uff0c\u548c\u4e4b\u524d\u63d0\u5230\u7684\u300c\u628a Item \u6309 01234 \u7684\u987a\u5e8f\uff0c\u4ece\u4e2d\u592e\u533a\u57df\u5f00\u59cb\u5411\u53f3\u653e\u7f6e\u300d\u6548\u679c\u4e00\u81f4\uff1a\\r\\n\\r\\n![](./img/code-explain-first.png)\\r\\n\\r\\n\u7136\u540e\u6211\u4eec\u518d\u628a Item0 ~ Item 4 \u7684 position \u4ee3\u5165\u4ee3\u7801\u4e2d\u8ba1\u7b97 finalPosition\uff0c\u4e0d\u96be\u53d1\u73b0\uff1a\\r\\n\\r\\n- Item 0\u3001Item 1 \u548c Item2 \u7684 finalPosition \u7b49\u4e8e position\uff0c\u4e5f\u5c31\u662f\u8bf4 3 \u8005\u7684\u4f4d\u7f6e\u6ca1\u6709\u53d8\u52a8\u3002\u8fd9\u662f\u56e0\u4e3a\u5b83\u4eec\u7684 `position + halfTotalWidth` \u662f 250%\u3001350% \u548c 450%\uff0c\u90fd\u6bd4 totalWidth \u5c0f\uff1b\\r\\n- Item 3 \u548c Item 4 \u7684 finalPosition \u7b49\u4e8e position - totalWidth\uff0c\u4e5f\u5c31\u662f\u8bf4 2 \u8005\u7684\u4f4d\u7f6e\u90fd\u5f80\u5de6\u5e73\u79fb\u4e86 totalWidth\uff08500%\uff09\u3002\u8fd9\u662f\u56e0\u4e3a\u5b83\u4eec\u7684 `position + halfTotalWidth` \u662f 550% \u548c 650%\uff0c\u90fd\u6bd4 totalWidth \u5927\u3002\\r\\n\\r\\n![](./img/item0-mod.png)\\r\\n\\r\\n\u8fd9\u4e48\u8bf4\u4f60\u53ef\u80fd\u8fd8\u662f\u96be\u4ee5\u7406\u89e3\uff0c\u6211\u518d\u6362\u53e6\u4e00\u79cd\u8bf4\u6cd5\u3002\\r\\n\\r\\n\u6211\u4eec\u5df2\u7ecf\u77e5\u9053\u4e24\u4e2a\u6761\u4ef6\uff1a\\r\\n\\r\\n- **\u8981\u5b9e\u73b0\u4e0d\u590d\u5236\u5143\u7d20\u7684\u5faa\u73af\u8f6e\u64ad\uff0c\u9700\u8981\u4fdd\u8bc1\u4e2d\u592e\u5143\u7d20\u5de6\u53f3\u5143\u7d20\u6570\u91cf\u5c3d\u91cf\u76f8\u7b49**\u3002\u8fd9\u6837\u7528\u6237\u5f80\u5de6\u6ed1\u3001\u5f80\u53f3\u6ed1\u90fd\u80fd\u770b\u5230\u5143\u7d20\u3002\\r\\n- \u5f53\u5143\u7d20\u7684 translateX \u4e3a 0% \u65f6\uff0c\u6240\u6709\u5143\u7d20\u4f1a\u91cd\u53e0\u5728\u4e2d\u592e\u3002\\r\\n\\r\\n\u4e0d\u96be\u60f3\u5230\uff0c\u628a\u5143\u7d20\u7684 translateX \u8bbe\u7f6e\u4e3a\u6b63\u6570\uff0c\u5143\u7d20\u5c31\u4f1a\u5728\u4e2d\u592e\u5143\u7d20\u53f3\u4fa7\uff1b\u628a\u5143\u7d20\u7684 translateX \u8bbe\u7f6e\u4e3a\u8d1f\u6570\uff0c\u5143\u7d20\u5c31\u4f1a\u5728\u4e2d\u592e\u5143\u7d20\u5de6\u4fa7\u3002\\r\\n\\r\\n\u4e00\u4e2a\u5408\u7406\u7684\u60f3\u6cd5\u5c31\u662f\uff0c\u628a Item \u7684 translateX \u8303\u56f4\u9650\u5b9a\u5728 -X \u5230 X \u4e4b\u95f4\uff0c\u8fd9\u6837\u5c31\u80fd\u4fdd\u8bc1\u4e2d\u592e\u5143\u7d20\u5de6\u53f3\u7684\u5143\u7d20\u6570\u91cf\u5c3d\u91cf\u76f8\u7b49\u30025 \u5143\u7d20\u7684\u8f6e\u64ad\u56fe\uff0cX \u53ef\u4ee5\u53d6\u503c halfTotalWidth\uff08\u4e5f\u5c31\u662f 250%\uff09\u3002\\r\\n\\r\\n\u4ec0\u4e48\u65b9\u6cd5\u53ef\u4ee5\u9650\u5b9a\u53d6\u503c\u8303\u56f4\u5462\uff1f\u7b54\u6848\u662f\u53d6\u6a21\uff0c\u4e0d\u8fc7\u5f53\u9664\u6570\u662f\u6b63\u6570\u65f6\uff0c\u6c42\u51fa\u7684\u6a21\u4e5f\u5fc5\u5b9a\u662f\u6b63\u6570[^2]\u3002\u5982\u679c\u76f4\u63a5\u7528 `mod(position, totalWidth)` \u9650\u5b9a\u53d6\u503c\u8303\u56f4\uff0c\u4f1a\u628a translateX \u9650\u5b9a\u5728 0% ~ 500% \u4e4b\u95f4\u3002\\r\\n\\r\\n\u6211\u4eec\u53ef\u4ee5\u8fd9\u6837\u505a\uff0c\u5148\u628a `position + halfTotalWidth` \u9664\u4ee5 totalWidth \u53d6\u6a21\uff0c`mod(position + halfTotalWidth, totalWidth)` \u53d6\u503c\u8303\u56f4\u4e3a 0% ~ 500%\uff0c\u7136\u540e\u628a `mod(position + halfTotalWidth, totalWidth)` \u6574\u4f53\u51cf\u53bb halfTotalWidth\uff0c\u53d6\u503c\u8303\u56f4\u5c31\u662f -250% \u5230 250% \u4e86\u3002\\r\\n\\r\\n## \u4ee3\u7801\u793a\u4f8b\\r\\n\\r\\n\u4e0b\u9762\u7ed9\u51fa\u4ee3\u7801\u793a\u4f8b\uff1a\\r\\n\\r\\n[\u65e0\u590d\u5236\u5143\u7d20\u7684\u5faa\u73af\u8f6e\u64ad\u56fe | codepen](https://codepen.io/lijunlin2022/pen/ZEaXKMM)\\r\\n\\r\\n## \u603b\u7ed3\\r\\n\\r\\n\u672c\u6587\u8bf4\u660e\u4e86\u4e0d\u590d\u5236\u5143\u7d20\u7684\u5faa\u73af\u8f6e\u64ad\u5982\u4f55\u5b9e\u73b0\u3002\\r\\n\\r\\n\u9996\u5148\uff0c\u6211\u4eec\u901a\u8fc7 01234 \u8f6c\u53d8\u4e3a 34012 \u7684\u4f8b\u5b50\uff0c\u89e3\u91ca\u5faa\u73af\u8f6e\u64ad\u7684\u521d\u59cb\u987a\u5e8f\u5982\u4f55\u8bbe\u7f6e\u3002\u7136\u540e\uff0c\u6211\u4eec\u7528 HTML \u4ee3\u7801\uff0c\u5b9e\u73b0\u4e86 34012 \u987a\u5e8f\u7684\u8f6e\u64ad\u3002\\r\\n\\r\\n\u63a5\u7740\uff0c\u6211\u4eec\u7528\u4e24\u79cd\u601d\u8def\u89e3\u91ca JavaScript \u4ee3\u7801\uff1a\u7b2c\u4e00\u79cd\u601d\u8def\u662f\u5148\u627e\u5230\u4e2d\u592e\u5143\u7d20\uff0c\u7136\u540e\u5f80\u4e2d\u592e\u5143\u7d20\u7684\u53f3\u8fb9\u653e\u5269\u4f59\u5143\u7d20\uff0c\u653e\u5b8c\u4e00\u534a\u7684\u5269\u4f59\u5143\u7d20\u540e\uff0c\u518d\u628a\u53e6\u5916\u4e00\u534a\u653e\u5230\u4e2d\u592e\u5143\u7d20\u5de6\u8fb9\u3002\u7b2c\u4e8c\u79cd\u601d\u8def\u662f\uff0c\u5148\u627e\u5230 translateX \u4e3a 0% \u7684\u5143\u7d20\uff0c\u5b83\u5c31\u662f\u4e2d\u592e\u5143\u7d20\u3002\u7136\u540e\u7528\u53d6\u6a21\u7684\u65b9\u5f0f\uff0c\u628a\u5176\u4ed6\u5143\u7d20\u7684 translateX \u9650\u5b9a\u5728 -halfTotalWidth \u548c halfTotalWidth \u4e4b\u95f4\u3002\\r\\n\\r\\n\u6700\u540e\uff0c\u6211\u4eec\u7ed9\u51fa\u4e86 JavaScript \u4e0d\u590d\u5236\u5143\u7d20\u5b9e\u73b0\u5faa\u73af\u8f6e\u64ad\u7684\u4ee3\u7801\u3002\\r\\n\\r\\n[^1]: [Ant Design Mobile Swiper](https://mobile.ant.design/components/swiper)\\r\\n[^2]: [\u53d6\u4f59\u548c\u53d6\u6a21\u5982\u4f55\u533a\u5206\u548c\u5e94\u7528](https://lijunlin2022.github.io/blog/2024/01/18/remainder-and-modulo)"},{"id":"/2023/07/30/tab-scroll-to-center","metadata":{"permalink":"/blog/2023/07/30/tab-scroll-to-center","source":"@site/blog/2023-07-30-tab-scroll-to-center/index.md","title":"H5\u3001\u5c0f\u7a0b\u5e8f Tab \u5982\u4f55\u6eda\u52a8\u5c45\u4e2d\uff1f","description":"Tab \u5728 PC \u7aef\u3001\u79fb\u52a8\u7aef\u5e94\u7528\u90fd\u4e0a\u5f88\u5e38\u89c1\uff0c\u4e0d\u8fc7 Tab \u5728\u79fb\u52a8\u7aef \u6bd4 PC \u7aef\u66f4\u590d\u6742\u3002\u4e3a\u4ec0\u4e48\u5462\uff1f\u79fb\u52a8\u7aef\u8bbe\u5907\u5c4f\u5e55\u8f83\u7a84\uff0c\u4e00\u822c\u4ec5\u80fd\u5c55\u793a 4 ~ 7 \u4e2a Item\u3002\u8003\u8651\u5230\u7528\u6237\u4f53\u9a8c\uff0cUI \u5f80\u5f80\u8981\u6c42\u7a0b\u5e8f\u5458\u5b9e\u73b0\u4e00\u4e2a\u529f\u80fd\u2014\u2014\u70b9\u51fb Item \u540e\uff0cItem \u6eda\u52a8\u5230\u5c4f\u5e55\u4e2d\u592e\uff0c\u62fc\u591a\u591a\u7684 Tab \u5c31\u5b9e\u73b0\u4e86\u8fd9\u4e2a\u529f\u80fd\u3002","date":"2023-07-30T00:00:00.000Z","tags":[{"inline":true,"label":"H5","permalink":"/blog/tags/h-5"},{"inline":true,"label":"\u5c0f\u7a0b\u5e8f","permalink":"/blog/tags/\u5c0f\u7a0b\u5e8f"}],"readingTime":4.665,"hasTruncateMarker":false,"authors":[],"frontMatter":{"tags":["H5","\u5c0f\u7a0b\u5e8f"]},"unlisted":false,"prevItem":{"title":"H5 \u4e0d\u590d\u5236\u5143\u7d20\u7684\u5faa\u73af\u8f6e\u64ad\u56fe\u5982\u4f55\u5b9e\u73b0\uff1f\u2014\u2014\u53d6\u6a21","permalink":"/blog/2023/12/14/loop-swiper"}},"content":"Tab \u5728 PC \u7aef\u3001\u79fb\u52a8\u7aef\u5e94\u7528\u90fd\u4e0a\u5f88\u5e38\u89c1\uff0c\u4e0d\u8fc7 Tab \u5728\u79fb\u52a8\u7aef \u6bd4 PC \u7aef\u66f4\u590d\u6742\u3002\u4e3a\u4ec0\u4e48\u5462\uff1f\u79fb\u52a8\u7aef\u8bbe\u5907\u5c4f\u5e55\u8f83\u7a84\uff0c\u4e00\u822c\u4ec5\u80fd\u5c55\u793a 4 ~ 7 \u4e2a Item\u3002\u8003\u8651\u5230\u7528\u6237\u4f53\u9a8c\uff0cUI \u5f80\u5f80\u8981\u6c42\u7a0b\u5e8f\u5458\u5b9e\u73b0\u4e00\u4e2a\u529f\u80fd\u2014\u2014\u70b9\u51fb Item \u540e\uff0cItem \u6eda\u52a8\u5230\u5c4f\u5e55\u4e2d\u592e\uff0c\u62fc\u591a\u591a\u7684 Tab \u5c31\u5b9e\u73b0\u4e86\u8fd9\u4e2a\u529f\u80fd\u3002\\r\\n\\r\\n![](./img/pdd.gif)\\r\\n\\r\\n\u5982\u679c\u4f60\u4e5f\u60f3\u5b9e\u73b0\u8fd9\u4e2a\u529f\u80fd\uff0c\u770b\u4e86\u8fd9\u7bc7\u6587\u7ae0\uff0c\u4f60\u4e00\u5b9a\u4f1a\u6709\u6240\u6536\u83b7\u3002\u6211\u4f1a\u5148\u8bf4\u660e Tab \u6eda\u52a8\u7684\u672c\u8d28\uff0c\u5206\u6790\u51fa\u6eda\u52a8\u8ddd\u79bb\u7684\u8ba1\u7b97\u516c\u5f0f\uff0c\u63a5\u7740\u7ed9\u51fa\u4f2a\u4ee3\u7801\uff0c\u6700\u540e\u518d\u7ed9\u51fa Vue\u3001React \u548c\u5fae\u4fe1\u5c0f\u7a0b\u5e8f\u7684\u793a\u4f8b\u4ee3\u7801\u3002\\r\\n\\r\\n## Tab \u6eda\u52a8\u7684\u672c\u8d28\\r\\n\\r\\nTab \u6eda\u52a8\uff0c\u672c\u8d28\u662f\u5305\u88f9\u7740 Item \u7684\u5bb9\u5668\u5728\u6eda\u52a8\u3002\\r\\n\\r\\n\u5982\u4e0b\u56fe\uff0c\u7ad6\u7740\u7684\u865a\u7ebf\u957f\u65b9\u5f62\u4ee3\u8868\u624b\u673a\u5c4f\u5e55\uff0c\u6a2a\u7740\u7684\u957f\u65b9\u5f62\u4ee3\u8868 Tab \u7684\u5bb9\u5668\uff0c\u6807\u7740\u6570\u5b57\u7684\u5c0f\u6b63\u65b9\u5f62\u4ee3\u8868\u4e00\u4e2a\u4e2a Tab Item\u3002\\r\\n\\r\\n\u5de6\u534a\u90e8\u5206\u4e2d\uff0cTab \u5bb9\u5668\u7d27\u8d34\u624b\u673a\u5c4f\u5e55\u5de6\u4fa7\u3002\u53f3\u534a\u90e8\u5206\u4e2d\uff0cItem 4 \u4f4d\u4e8e\u5c4f\u5e55\u4e2d\u592e\uff0c\u4e24\u90e8\u5206\u8868\u793a Item 4 \u4ece\u5c4f\u5e55\u53f3\u8fb9\u6eda\u52a8\u5230\u5c4f\u5e55\u4e2d\u592e\u3002\\r\\n\\r\\n![](./img/scroll-left.png)\\r\\n\\r\\n\u4e0d\u96be\u770b\u51fa\uff0cItem 4 \u6eda\u52a8\u5c45\u4e2d\uff0c\u5176\u5b9e\u5c31\u662f\u5bb9\u5668\u5411\u5de6\u79fb\u52a8 distance\u3002\u6b64\u65f6\u5bb9\u5668\u6eda\u52a8\u6761\u5230\u5bb9\u5668\u5de6\u8fb9\u7f18\u7684\u8ddd\u79bb\u4e5f\u662f distance\u3002\\r\\n\\r\\n\u6362\u53e5\u8bdd\u8bf4\uff0c**\u8ba9\u5bb9\u5668\u5411\u5de6\u79fb\u52a8 distance\uff0cItem 4 \u5c31\u80fd\u5c45\u4e2d\u3002** \u56e0\u6b64\u53ea\u8981\u4f60\u80fd\u627e\u51fa\u8ba1\u7b97 distance \u7684\u516c\u5f0f\uff0c\u5c31\u80fd\u63a7\u5236\u67d0\u4e2a Item \u5c45\u4e2d\u3002\\r\\n\\r\\n## \u8ba1\u7b97 distance \u7684\u516c\u5f0f\\r\\n\\r\\n\u8be5\u5982\u4f55\u8ba1\u7b97 distance \u5462\uff1f\u4f60\u770b\u4e0b\u65b9\u8fd9\u5f20\u66f4\u7ec6\u81f4\u7684\u793a\u610f\u56fe\u3002\\r\\n\\r\\n\u5c4f\u5e55\u4e2d\u592e\u6709\u4e00\u6761\u7ebf\uff0c\u5b83\u628a Item 4 \u5206\u6210\u4e86\u5de6\u53f3\u7b49\u5bbd\u7684\u4e24\u90e8\u5206\uff0c\u4e5f\u628a\u624b\u673a\u5c4f\u5e55\u5206\u6210\u4e86\u5de6\u53f3\u7b49\u5bbd\u7684\u4e24\u90e8\u5206\u3002\u4f60\u53ef\u4ee5\u628a Item 4 \u4e00\u534a\u7684\u5bbd\u5ea6\u8bb0\u4e3a `halfItemWidth`\uff0c\u628a\u624b\u673a\u5c4f\u5e55\u4e00\u534a\u7684\u5bbd\u5ea6\u8bb0\u4e3a `halfScreenWidth`\u3002\u518d\u628a Item 4 \u5de6\u4fa7\u5230\u5bb9\u5668\u5de6\u4fa7\u7684\u8ddd\u79bb\u8bb0\u4e3a `itemOffsetLeft`\u3002\\r\\n\\r\\n![](./img/calculate-scroll-left.png)\\r\\n\\r\\n\u4e0d\u96be\u770b\u51fa\uff0c\u8fd9\u56db\u4e2a\u503c\u6ee1\u8db3\u5982\u4e0b\u7b49\u5f0f\uff1a\\r\\n\\r\\n```\\r\\ndistance + halfScreenWidth = itemOffsetLeft + halfItemWidth\\r\\n```\\r\\n\\r\\n\u7b80\u5355\u63a8\u5bfc\u4e00\u4e0b\uff0c\u5c31\u5f97\u5230\u4e86\u8ba1\u7b97 distance \u7684\u516c\u5f0f\u3002\\r\\n\\r\\n```\\r\\ndistance = itemOffsetLeft + halfItemWidth - halfScreenWidth\\r\\n```\\r\\n\\r\\n## \u516c\u5f0f\u7684\u4f2a\u4ee3\u7801\u5b9e\u73b0\\r\\n\\r\\n\u73b0\u5728\u5f00\u59cb\u89e3\u91ca\u516c\u5f0f\u7684\u4ee3\u7801\u5b9e\u73b0\u3002\\r\\n\\r\\n\u5148\u770b\u4e0b `itemOffsetLeft`\u3001`halfItemWidth` \u548c `halfScreenWidth` \u5982\u4f55\u83b7\u53d6\u3002\\r\\n\\r\\n- `itemOffsetLeft` \u662f Item \u5143\u7d20\u5230\u5bb9\u5668\u5de6\u4fa7\u7684\u8ddd\u79bb\uff0c\u4f60\u53ef\u4ee5\u7528 [HTMLElement.offsetLeft](https://developer.mozilla.org/zh-CN/docs/Web/API/HTMLElement/offsetLeft) \u4f5c\u5b83\u7684\u503c\u3002\\r\\n\\r\\n- `halfItemWidth` \u662f Item \u5143\u7d20\u4e00\u534a\u7684\u5bbd\u5ea6\u3002[HTMLElement.offsetWidth](https://developer.mozilla.org/zh-CN/docs/Web/API/HTMLElement/offsetWidth) \u662f\u5143\u7d20\u7684\u6574\u4f53\u5bbd\u5ea6\uff0c\u4f60\u53ef\u4ee5\u7528 `offsetWidth / 2` \u4f5c\u5b83\u7684\u503c\uff0c\u4e5f\u53ef\u4ee5\u5148\u7528 [Element.getBoundingClientRect()](https://developer.mozilla.org/zh-CN/docs/Web/API/Element/getBoundingClientRect) \u83b7\u53d6\u4e00\u4e2a `itemRect` \u5bf9\u8c61\uff0c\u518d\u7528 `itemRect.width / 2` \u4f5c\u5b83\u7684\u503c\u3002 \\r\\n\\r\\n- `halfScreenWidth` \u662f\u624b\u673a\u5c4f\u5e55\u4e00\u534a\u7684\u5bbd\u5ea6\u3002 [window.innerWidth](https://developer.mozilla.org/zh-CN/docs/Web/API/Window/innerWidth) \u662f\u624b\u673a\u5c4f\u5e55\u7684\u6574\u4f53\u5bbd\u5ea6\uff0c\u4f60\u53ef\u4ee5\u7528 `innerWidth / 2` \u4f5c\u5b83\u7684\u503c\u3002\\r\\n\\r\\n\u518d\u770b\u4e0b\u5982\u4f55\u628a distance \u8bbe\u7f6e\u5230\u5bb9\u5668\u4e0a\u3002\\r\\n\\r\\n\u5728 HTML \u4e2d\uff0c\u4f60\u53ef\u4ee5\u4f7f\u7528 [Element.scrollLeft](https://developer.mozilla.org/zh-CN/docs/Web/API/Element/scrollLeft) \u6765\u8bfb\u53d6\u548c\u8bbe\u7f6e\u5143\u7d20\u6eda\u52a8\u6761\u5230\u5143\u7d20\u5de6\u8fb9\u7684\u4f4d\u7f6e\u3002\u56e0\u6b64\uff0c\u4f60\u53ea\u9700\u8981\u5bb9\u5668\u7684 `scrollLeft` \u8d4b\u503c\u4e3a distance\uff0c\u5c31\u53ef\u4ee5\u5b9e\u73b0 Item \u5143\u7d20\u6eda\u52a8\u5c45\u4e2d\u3002\\r\\n\\r\\n\u73b0\u5728\u7ed9\u51fa\u70b9\u51fb tab \u7684\u51fd\u6570\u7684\u4f2a\u4ee3\u7801\uff1a\\r\\n\\r\\n```js\\r\\nconst onClick = () => {\\r\\n  const itemOffsetLeft = item.offsetLeft;\\r\\n  const halfItemWidth = item.offsetWidth / 2;\\r\\n  const halfScreenWidth = window.innerWidth / 2;\\r\\n  tabContainer.scrollLeft = itemOffsetLeft + halfItemWidth - halfScreenWidth\\r\\n}\\r\\n```\\r\\n\\r\\n## \u4ee3\u7801\u793a\u4f8b\\r\\n\\r\\n### Vue\\r\\n\\r\\n[Tab \u6eda\u52a8\u5c45\u4e2d | Vue](https://codesandbox.io/p/sandbox/vue-tab-scroll-to-center-qxw4vc)\\r\\n\\r\\n### React\\r\\n\\r\\n[Tab \u6eda\u52a8\u5c45\u4e2d | React](https://codesandbox.io/p/sandbox/react-tab-scroll-to-center-22939z)\\r\\n\\r\\n### \u5fae\u4fe1\u5c0f\u7a0b\u5e8f\\r\\n\\r\\n[Tab \u6eda\u52a8\u5c45\u4e2d | \u5fae\u4fe1\u5c0f\u7a0b\u5e8f](https://developers.weixin.qq.com/s/npBjVpmj7XKc)\\r\\n\\r\\n:::info\\r\\n\u5c0f\u7a0b\u5e8f\u7684 API \u548c\u6d4f\u89c8\u5668\u7684 API \u6709\u5dee\u5f02\u3002\\r\\n\\r\\n- `itemOffsetLeft` \uff0c\u4f60\u9700\u8981\u4ece\u70b9\u51fb\u4e8b\u4ef6\u7684 `event.currentTarget` \u4e2d\u83b7\u53d6\u3002\\r\\n- `halfItemWidth`\uff0c\u4f60\u9700\u8981\u5148\u7528 `wx.createSelectorQuery()` \u9009\u53d6\u5230 Item \u540e\uff0c\u4ece `exec()` \u7684\u6267\u884c\u7ed3\u679c\u4e2d\u83b7\u53d6\u5230 Item \u6574\u4f53\u5bbd\u5ea6\uff0c\u7136\u540e\u518d\u9664\u4ee5 2\u3002\\r\\n- `halfScreenWidth`\uff0c\u4f60\u9700\u8981\u5148\u7528 `wx.getSystemInfoSync()` \u83b7\u53d6\u5c4f\u5e55\u6574\u4f53\u5bbd\u5ea6\uff0c\u7136\u540e\u518d\u9664\u4ee5 2\u3002\\r\\n\\r\\n\u81f3\u4e8e\u628a `distance` \u8bbe\u7f6e\u5230\u5bb9\u5668\u4e0a\uff0c\u5fae\u4fe1\u5c0f\u7a0b\u5e8f `scroll-view` \u7ec4\u4ef6\u4e2d\uff0c\u6709 `scroll-left` \u8fd9\u4e2a\u5c5e\u6027\uff0c\u4f60\u53ef\u4ee5\u628a `distance` \u8d4b\u503c\u7ed9 `scroll-left`\u3002"}]}}')}}]);