"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[96],{3905:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>f});var s=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,s)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,s,r=function(e,t){if(null==e)return{};var n,s,r={},o=Object.keys(e);for(s=0;s<o.length;s++)n=o[s],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(s=0;s<o.length;s++)n=o[s],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var c=s.createContext({}),l=function(e){var t=s.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):a(a({},t),e)),n},p=function(e){var t=l(e.components);return s.createElement(c.Provider,{value:t},e.children)},m="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return s.createElement(s.Fragment,{},t)}},u=s.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,c=e.parentName,p=i(e,["components","mdxType","originalType","parentName"]),m=l(n),u=r,f=m["".concat(c,".").concat(u)]||m[u]||d[u]||o;return n?s.createElement(f,a(a({ref:t},p),{},{components:n})):s.createElement(f,a({ref:t},p))}));function f(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,a=new Array(o);a[0]=u;var i={};for(var c in t)hasOwnProperty.call(t,c)&&(i[c]=t[c]);i.originalType=e,i[m]="string"==typeof e?e:r,a[1]=i;for(var l=2;l<o;l++)a[l]=n[l];return s.createElement.apply(null,a)}return s.createElement.apply(null,n)}u.displayName="MDXCreateElement"},2103:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>a,default:()=>d,frontMatter:()=>o,metadata:()=>i,toc:()=>l});var s=n(7462),r=(n(7294),n(3905));const o={},a="sms",i={unversionedId:"nestjs/sms",id:"nestjs/sms",title:"sms",description:"\u6211\u4eec\u5f00\u53d1\u4e00\u4e2a\u4ea7\u54c1\u65f6\uff0c\u5f80\u5f80\u9700\u8981\u7528\u5230\u77ed\u4fe1\u9a8c\u8bc1\u7801\u529f\u80fd\uff0c\u4e3a\u6b64\u6211\u4eec\u53ef\u4ee5\u9009\u62e9\u300c\u963f\u91cc\u4e91\u77ed\u4fe1\u670d\u52a1\u300d\u3002",source:"@site/docs/06-nestjs/03-sms.md",sourceDirName:"06-nestjs",slug:"/nestjs/sms",permalink:"/docs/nestjs/sms",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/06-nestjs/03-sms.md",tags:[],version:"current",sidebarPosition:3,frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"oss",permalink:"/docs/nestjs/oss"},next:{title:"mdbook",permalink:"/docs/category/mdbook"}},c={},l=[{value:"\u4f7f\u7528\u6d4b\u8bd5\u6a21\u677f",id:"\u4f7f\u7528\u6d4b\u8bd5\u6a21\u677f",level:2},{value:"\u7f16\u5199\u8c03\u7528\u7684 API \u7684\u4ee3\u7801",id:"\u7f16\u5199\u8c03\u7528\u7684-api-\u7684\u4ee3\u7801",level:2},{value:"\u8bbf\u95ee\u63a7\u5236",id:"\u8bbf\u95ee\u63a7\u5236",level:2}],p={toc:l},m="wrapper";function d(e){let{components:t,...o}=e;return(0,r.kt)(m,(0,s.Z)({},p,o,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"sms"},"sms"),(0,r.kt)("p",null,"\u6211\u4eec\u5f00\u53d1\u4e00\u4e2a\u4ea7\u54c1\u65f6\uff0c\u5f80\u5f80\u9700\u8981\u7528\u5230\u77ed\u4fe1\u9a8c\u8bc1\u7801\u529f\u80fd\uff0c\u4e3a\u6b64\u6211\u4eec\u53ef\u4ee5\u9009\u62e9\u300c\u963f\u91cc\u4e91\u77ed\u4fe1\u670d\u52a1\u300d\u3002"),(0,r.kt)("p",null,"\u53ef\u4ee5\u8bbf\u95ee ",(0,r.kt)("a",{parentName:"p",href:"https://dysms.console.aliyun.com/overview"},"\u963f\u91cc\u4e91\u77ed\u4fe1\u670d\u52a1"),"\u3002"),(0,r.kt)("h2",{id:"\u4f7f\u7528\u6d4b\u8bd5\u6a21\u677f"},"\u4f7f\u7528\u6d4b\u8bd5\u6a21\u677f"),(0,r.kt)("p",null,"\u9009\u62e9\u300c\u901a\u8fc7 API \u53d1\u77ed\u4fe1\u300d->\u300c\u514d\u7b7e\u540d/\u6a21\u677f\u5ba1\u6838\u7684 API \u53d1\u9001\u6d4b\u8bd5\u300d"),(0,r.kt)("p",null,(0,r.kt)("img",{src:n(1733).Z,width:"1373",height:"801"})),(0,r.kt)("p",null,"\u4e3a\u4e86\u5feb\u901f\u4e0a\u624b\u963f\u91cc\u4e91\u77ed\u4fe1\u670d\u52a1\uff0c\u6211\u4eec\u5728\u7ed1\u5b9a\u6d4b\u8bd5\u624b\u673a\u53f7\u540e\uff0c\u53ef\u4ee5\u5148\u4e0d\u9009\u62e9\u7533\u8bf7\u6a21\u677f\uff0c\u800c\u662f\u5148\u4f7f\u7528\u300c\u3010\u4e13\u7528\u3011\u6d4b\u8bd5\u7b7e\u540d/\u6a21\u677f\u300d\u3002"),(0,r.kt)("p",null,(0,r.kt)("img",{src:n(4604).Z,width:"1500",height:"726"})),(0,r.kt)("p",null,"\u4e4b\u540e\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u70b9\u51fb\u8c03\u7528\uff0c\u770b\u770b\u662f\u5426\u6709\u9a8c\u8bc1\u7801\u53d1\u9001\u5230\u6211\u4eec\u7684\u624b\u673a\u4e0a\u3002"),(0,r.kt)("p",null,(0,r.kt)("img",{src:n(9566).Z,width:"1437",height:"937"})),(0,r.kt)("h2",{id:"\u7f16\u5199\u8c03\u7528\u7684-api-\u7684\u4ee3\u7801"},"\u7f16\u5199\u8c03\u7528\u7684 API \u7684\u4ee3\u7801"),(0,r.kt)("p",null,"\u6211\u4eec\u53ef\u4ee5\u9009\u62e9\u300cSDK \u793a\u4f8b\u300d\uff0c\u67e5\u770b\u76f8\u5173\u8bed\u8a00\u7684\u4f8b\u5b50\uff0c\u56e0\u4e3a\u6211\u4f7f\u7528\u7684\u662f Nest.js\uff0c\u6240\u4ee5\u9009\u62e9 TypeScript\u3002"),(0,r.kt)("p",null,(0,r.kt)("img",{src:n(3639).Z,width:"1849",height:"937"})),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-ts"},"import { Injectable } from '@nestjs/common';\nimport Dysmsapi20170525, * as $Dysmsapi20170525 from '@alicloud/dysmsapi20170525';\nimport * as $OpenApi from '@alicloud/openapi-client';\nimport Util, * as $Util from '@alicloud/tea-util';\nimport {\n  aliyunAccessKeyId,\n  aliyunAccessKeySecret,\n  signName,\n  templateCode,\n} from 'src/password.config';\nimport { getRandomCode } from 'src/shared/utils';\n\n@Injectable()\nexport class SMSService {\n  async sendVerificationCode(tel: string): Promise<string> {\n    const code = getRandomCode(4);\n    const config = new $OpenApi.Config({\n      accessKeyId: aliyunAccessKeyId,\n      accessKeySecret: aliyunAccessKeySecret,\n    });\n    config.endpoint = 'dysmsapi.aliyuncs.com';\n    const client = new Dysmsapi20170525(config);\n    const sendSmsRequest = new $Dysmsapi20170525.SendSmsRequest({\n      signName: signName,\n      templateCode: templateCode,\n      phoneNumbers: tel,\n      templateParam: `{\"code\":\"${code}\"}`,\n    });\n    const runtime = new $Util.RuntimeOptions({});\n    try {\n      await client.sendSmsWithOptions(sendSmsRequest, runtime);\n    } catch (error) {\n      Util.assertAsString(error.message);\n    }\n    return code;\n  }\n}\n")),(0,r.kt)("h2",{id:"\u8bbf\u95ee\u63a7\u5236"},"\u8bbf\u95ee\u63a7\u5236"),(0,r.kt)("p",null,"\u4e4b\u540e\u6211\u4eec\u9700\u8981\u5230\u963f\u91cc\u4e91\u8bbf\u95ee\u63a7\u5236\uff0c\u4e3a\u6211\u4eec\u7684\u8eab\u4efd\u6dfb\u52a0\u6743\u9650\u3002"),(0,r.kt)("p",null,(0,r.kt)("img",{src:n(9767).Z,width:"1851",height:"435"}),"\n",(0,r.kt)("img",{src:n(1110).Z,width:"1819",height:"868"})),(0,r.kt)("p",null,"\u8c03\u7528\u4ee3\u7801\u540e\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u76f4\u63a5\u6536\u5230\u77ed\u4fe1\u4e86\u3002"))}d.isMDXComponent=!0},1733:(e,t,n)=>{n.d(t,{Z:()=>s});const s=n.p+"assets/images/sms1-0ad18851e099397f1a0d963ded3ca0ef.png"},4604:(e,t,n)=>{n.d(t,{Z:()=>s});const s=n.p+"assets/images/sms2-9d2b0f8c61f2640eeab302d78772e943.png"},9566:(e,t,n)=>{n.d(t,{Z:()=>s});const s=n.p+"assets/images/sms3-bc4198b42a988cfb7c7adb9a315fe92c.png"},3639:(e,t,n)=>{n.d(t,{Z:()=>s});const s=n.p+"assets/images/sms4-bf97a8ee76190e8cd31799e6ed76e3b6.png"},9767:(e,t,n)=>{n.d(t,{Z:()=>s});const s=n.p+"assets/images/sms5-2e9196d1017272f9337067b2c0c3f4c6.png"},1110:(e,t,n)=>{n.d(t,{Z:()=>s});const s=n.p+"assets/images/sms6-6a1803e528343b99dcf76749e74622a7.png"}}]);